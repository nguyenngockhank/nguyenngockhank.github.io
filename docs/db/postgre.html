<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostgreSql Snippets | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.6906ca04.css" as="style"><link rel="preload" href="/docs/assets/js/app.e037735d.js" as="script"><link rel="preload" href="/docs/assets/js/2.f3b73e05.js" as="script"><link rel="preload" href="/docs/assets/js/291.b391cfb2.js" as="script"><link rel="preload" href="/docs/assets/js/146.ac526bd3.js" as="script"><link rel="preload" href="/docs/assets/js/76.f78684a8.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.d3ece406.js"><link rel="prefetch" href="/docs/assets/js/100.4dc32dfc.js"><link rel="prefetch" href="/docs/assets/js/101.cdfeaedf.js"><link rel="prefetch" href="/docs/assets/js/102.4fc04305.js"><link rel="prefetch" href="/docs/assets/js/103.8ac86816.js"><link rel="prefetch" href="/docs/assets/js/104.83b38884.js"><link rel="prefetch" href="/docs/assets/js/105.6274ba66.js"><link rel="prefetch" href="/docs/assets/js/106.76613f10.js"><link rel="prefetch" href="/docs/assets/js/107.a752dc7c.js"><link rel="prefetch" href="/docs/assets/js/108.9e4cc14b.js"><link rel="prefetch" href="/docs/assets/js/109.188002bd.js"><link rel="prefetch" href="/docs/assets/js/11.5828077a.js"><link rel="prefetch" href="/docs/assets/js/110.c7381f07.js"><link rel="prefetch" href="/docs/assets/js/111.885538b6.js"><link rel="prefetch" href="/docs/assets/js/112.cb0bbf06.js"><link rel="prefetch" href="/docs/assets/js/113.c330c37e.js"><link rel="prefetch" href="/docs/assets/js/114.fafa346b.js"><link rel="prefetch" href="/docs/assets/js/115.6b3294db.js"><link rel="prefetch" href="/docs/assets/js/116.046a8ddb.js"><link rel="prefetch" href="/docs/assets/js/117.991675c6.js"><link rel="prefetch" href="/docs/assets/js/118.740f05a4.js"><link rel="prefetch" href="/docs/assets/js/119.18e7d9f6.js"><link rel="prefetch" href="/docs/assets/js/12.84a6d257.js"><link rel="prefetch" href="/docs/assets/js/120.42677fd4.js"><link rel="prefetch" href="/docs/assets/js/121.6ecd0485.js"><link rel="prefetch" href="/docs/assets/js/122.04a4f4e1.js"><link rel="prefetch" href="/docs/assets/js/123.af2dd5df.js"><link rel="prefetch" href="/docs/assets/js/124.b2c5e938.js"><link rel="prefetch" href="/docs/assets/js/125.22c79ed8.js"><link rel="prefetch" href="/docs/assets/js/126.6489c83a.js"><link rel="prefetch" href="/docs/assets/js/127.36bc2495.js"><link rel="prefetch" href="/docs/assets/js/128.5c60654f.js"><link rel="prefetch" href="/docs/assets/js/129.334cd058.js"><link rel="prefetch" href="/docs/assets/js/13.a163186b.js"><link rel="prefetch" href="/docs/assets/js/130.0dc337ca.js"><link rel="prefetch" href="/docs/assets/js/131.22fa89e8.js"><link rel="prefetch" href="/docs/assets/js/132.558c14cd.js"><link rel="prefetch" href="/docs/assets/js/133.6b510161.js"><link rel="prefetch" href="/docs/assets/js/134.8ad453c7.js"><link rel="prefetch" href="/docs/assets/js/135.05131377.js"><link rel="prefetch" href="/docs/assets/js/136.d6c3dfe5.js"><link rel="prefetch" href="/docs/assets/js/137.53fecdf3.js"><link rel="prefetch" href="/docs/assets/js/138.7119045e.js"><link rel="prefetch" href="/docs/assets/js/139.9c27f4a0.js"><link rel="prefetch" href="/docs/assets/js/14.c802192d.js"><link rel="prefetch" href="/docs/assets/js/140.cc0e1111.js"><link rel="prefetch" href="/docs/assets/js/141.5c1c7312.js"><link rel="prefetch" href="/docs/assets/js/142.e64dc5ec.js"><link rel="prefetch" href="/docs/assets/js/143.481991b5.js"><link rel="prefetch" href="/docs/assets/js/144.0e92f268.js"><link rel="prefetch" href="/docs/assets/js/145.46e06df6.js"><link rel="prefetch" href="/docs/assets/js/147.a6298363.js"><link rel="prefetch" href="/docs/assets/js/148.fd1826e7.js"><link rel="prefetch" href="/docs/assets/js/149.3ef9a1f0.js"><link rel="prefetch" href="/docs/assets/js/15.97b2abe4.js"><link rel="prefetch" href="/docs/assets/js/150.976b9a35.js"><link rel="prefetch" href="/docs/assets/js/151.6d1c2fce.js"><link rel="prefetch" href="/docs/assets/js/152.c425fb68.js"><link rel="prefetch" href="/docs/assets/js/153.31ca4b08.js"><link rel="prefetch" href="/docs/assets/js/154.aada64b2.js"><link rel="prefetch" href="/docs/assets/js/155.e024e686.js"><link rel="prefetch" href="/docs/assets/js/156.41054ec4.js"><link rel="prefetch" href="/docs/assets/js/157.a1b3f72b.js"><link rel="prefetch" href="/docs/assets/js/158.28b369c0.js"><link rel="prefetch" href="/docs/assets/js/159.baa531c4.js"><link rel="prefetch" href="/docs/assets/js/16.f0b5b46b.js"><link rel="prefetch" href="/docs/assets/js/160.792eeb15.js"><link rel="prefetch" href="/docs/assets/js/161.0d89eb60.js"><link rel="prefetch" href="/docs/assets/js/162.0202b9ba.js"><link rel="prefetch" href="/docs/assets/js/163.8756e707.js"><link rel="prefetch" href="/docs/assets/js/164.1f236889.js"><link rel="prefetch" href="/docs/assets/js/165.8d880ce8.js"><link rel="prefetch" href="/docs/assets/js/166.0cdf30aa.js"><link rel="prefetch" href="/docs/assets/js/167.16e88eb7.js"><link rel="prefetch" href="/docs/assets/js/168.5108435f.js"><link rel="prefetch" href="/docs/assets/js/169.e0153255.js"><link rel="prefetch" href="/docs/assets/js/17.1050cf58.js"><link rel="prefetch" href="/docs/assets/js/170.dafc6ca3.js"><link rel="prefetch" href="/docs/assets/js/171.e422a621.js"><link rel="prefetch" href="/docs/assets/js/172.680cf1c5.js"><link rel="prefetch" href="/docs/assets/js/173.4780b497.js"><link rel="prefetch" href="/docs/assets/js/174.a99476fc.js"><link rel="prefetch" href="/docs/assets/js/175.f3bea7b1.js"><link rel="prefetch" href="/docs/assets/js/176.4beca249.js"><link rel="prefetch" href="/docs/assets/js/177.30706620.js"><link rel="prefetch" href="/docs/assets/js/178.41d21cd0.js"><link rel="prefetch" href="/docs/assets/js/179.76a8437e.js"><link rel="prefetch" href="/docs/assets/js/18.12f6089b.js"><link rel="prefetch" href="/docs/assets/js/180.b240a379.js"><link rel="prefetch" href="/docs/assets/js/181.f50a7875.js"><link rel="prefetch" href="/docs/assets/js/182.ca8f6b3a.js"><link rel="prefetch" href="/docs/assets/js/183.62dc840e.js"><link rel="prefetch" href="/docs/assets/js/184.3cd0eef8.js"><link rel="prefetch" href="/docs/assets/js/185.e9759d83.js"><link rel="prefetch" href="/docs/assets/js/186.e60e57c3.js"><link rel="prefetch" href="/docs/assets/js/187.b31d78e1.js"><link rel="prefetch" href="/docs/assets/js/188.38f6e5cd.js"><link rel="prefetch" href="/docs/assets/js/189.95c47735.js"><link rel="prefetch" href="/docs/assets/js/19.6df6026d.js"><link rel="prefetch" href="/docs/assets/js/190.27ff610b.js"><link rel="prefetch" href="/docs/assets/js/191.48145515.js"><link rel="prefetch" href="/docs/assets/js/192.6aeb3a14.js"><link rel="prefetch" href="/docs/assets/js/193.72d5a770.js"><link rel="prefetch" href="/docs/assets/js/194.c9bc48c0.js"><link rel="prefetch" href="/docs/assets/js/195.d360cdb7.js"><link rel="prefetch" href="/docs/assets/js/196.5924385a.js"><link rel="prefetch" href="/docs/assets/js/197.e2d52a12.js"><link rel="prefetch" href="/docs/assets/js/198.f516566b.js"><link rel="prefetch" href="/docs/assets/js/199.751559fb.js"><link rel="prefetch" href="/docs/assets/js/20.974fc68c.js"><link rel="prefetch" href="/docs/assets/js/200.3c060554.js"><link rel="prefetch" href="/docs/assets/js/201.1f31aa87.js"><link rel="prefetch" href="/docs/assets/js/202.e4df3359.js"><link rel="prefetch" href="/docs/assets/js/203.72253423.js"><link rel="prefetch" href="/docs/assets/js/204.a08a23ae.js"><link rel="prefetch" href="/docs/assets/js/205.b6387752.js"><link rel="prefetch" href="/docs/assets/js/206.ee89ee72.js"><link rel="prefetch" href="/docs/assets/js/207.2d417ba6.js"><link rel="prefetch" href="/docs/assets/js/208.e12ed387.js"><link rel="prefetch" href="/docs/assets/js/209.5d52e3c5.js"><link rel="prefetch" href="/docs/assets/js/21.6e299947.js"><link rel="prefetch" href="/docs/assets/js/210.c3545ab2.js"><link rel="prefetch" href="/docs/assets/js/211.27e53847.js"><link rel="prefetch" href="/docs/assets/js/212.0e731e3f.js"><link rel="prefetch" href="/docs/assets/js/213.b4e99789.js"><link rel="prefetch" href="/docs/assets/js/214.c9f1c486.js"><link rel="prefetch" href="/docs/assets/js/215.d4d7e112.js"><link rel="prefetch" href="/docs/assets/js/216.91a11199.js"><link rel="prefetch" href="/docs/assets/js/217.1bed96e5.js"><link rel="prefetch" href="/docs/assets/js/218.2239d59c.js"><link rel="prefetch" href="/docs/assets/js/219.723e864f.js"><link rel="prefetch" href="/docs/assets/js/22.dc8cbeb1.js"><link rel="prefetch" href="/docs/assets/js/220.724d2228.js"><link rel="prefetch" href="/docs/assets/js/221.d648d4f5.js"><link rel="prefetch" href="/docs/assets/js/222.087c17ec.js"><link rel="prefetch" href="/docs/assets/js/223.bd33d3c5.js"><link rel="prefetch" href="/docs/assets/js/224.bcb6613e.js"><link rel="prefetch" href="/docs/assets/js/225.75df38c6.js"><link rel="prefetch" href="/docs/assets/js/226.68918d2b.js"><link rel="prefetch" href="/docs/assets/js/227.d36773c0.js"><link rel="prefetch" href="/docs/assets/js/228.a4f94fd4.js"><link rel="prefetch" href="/docs/assets/js/229.fffe62c4.js"><link rel="prefetch" href="/docs/assets/js/23.46b289d4.js"><link rel="prefetch" href="/docs/assets/js/230.5e540d33.js"><link rel="prefetch" href="/docs/assets/js/231.df8af02d.js"><link rel="prefetch" href="/docs/assets/js/232.883cc2bf.js"><link rel="prefetch" href="/docs/assets/js/233.02451d18.js"><link rel="prefetch" href="/docs/assets/js/234.f35fc363.js"><link rel="prefetch" href="/docs/assets/js/235.ac0ca38a.js"><link rel="prefetch" href="/docs/assets/js/236.96ddcd38.js"><link rel="prefetch" href="/docs/assets/js/237.acb53774.js"><link rel="prefetch" href="/docs/assets/js/238.5cac714f.js"><link rel="prefetch" href="/docs/assets/js/239.93e7f3b1.js"><link rel="prefetch" href="/docs/assets/js/24.110a33fd.js"><link rel="prefetch" href="/docs/assets/js/240.dd3e574e.js"><link rel="prefetch" href="/docs/assets/js/241.3bf7c48e.js"><link rel="prefetch" href="/docs/assets/js/242.4d05c355.js"><link rel="prefetch" href="/docs/assets/js/243.e0f968a4.js"><link rel="prefetch" href="/docs/assets/js/244.7f5e7ab7.js"><link rel="prefetch" href="/docs/assets/js/245.3653a6d7.js"><link rel="prefetch" href="/docs/assets/js/246.2ca0abb0.js"><link rel="prefetch" href="/docs/assets/js/247.3c05da13.js"><link rel="prefetch" href="/docs/assets/js/248.28a2a4b0.js"><link rel="prefetch" href="/docs/assets/js/249.b1149864.js"><link rel="prefetch" href="/docs/assets/js/25.c1e07c74.js"><link rel="prefetch" href="/docs/assets/js/250.fc6485b7.js"><link rel="prefetch" href="/docs/assets/js/251.d9d71bde.js"><link rel="prefetch" href="/docs/assets/js/252.2b87f7ff.js"><link rel="prefetch" href="/docs/assets/js/253.41cec7f5.js"><link rel="prefetch" href="/docs/assets/js/254.aedd4bdb.js"><link rel="prefetch" href="/docs/assets/js/255.df9e1441.js"><link rel="prefetch" href="/docs/assets/js/256.8a9618dd.js"><link rel="prefetch" href="/docs/assets/js/257.8bb49edc.js"><link rel="prefetch" href="/docs/assets/js/258.ff430bf3.js"><link rel="prefetch" href="/docs/assets/js/259.af7d4013.js"><link rel="prefetch" href="/docs/assets/js/26.ea1429ee.js"><link rel="prefetch" href="/docs/assets/js/260.1c647d70.js"><link rel="prefetch" href="/docs/assets/js/261.7d4aebfa.js"><link rel="prefetch" href="/docs/assets/js/262.eb34bd81.js"><link rel="prefetch" href="/docs/assets/js/263.aac15576.js"><link rel="prefetch" href="/docs/assets/js/264.ce1a2aa3.js"><link rel="prefetch" href="/docs/assets/js/265.699a196e.js"><link rel="prefetch" href="/docs/assets/js/266.7204a211.js"><link rel="prefetch" href="/docs/assets/js/267.83be537b.js"><link rel="prefetch" href="/docs/assets/js/268.d082eb06.js"><link rel="prefetch" href="/docs/assets/js/269.72bf0048.js"><link rel="prefetch" href="/docs/assets/js/27.c419e546.js"><link rel="prefetch" href="/docs/assets/js/270.c2d3e12f.js"><link rel="prefetch" href="/docs/assets/js/271.d27a13af.js"><link rel="prefetch" href="/docs/assets/js/272.58f2d0dd.js"><link rel="prefetch" href="/docs/assets/js/273.96db42a4.js"><link rel="prefetch" href="/docs/assets/js/274.96a0f1e2.js"><link rel="prefetch" href="/docs/assets/js/275.9413b8e1.js"><link rel="prefetch" href="/docs/assets/js/276.b5633e3d.js"><link rel="prefetch" href="/docs/assets/js/277.4e8a7864.js"><link rel="prefetch" href="/docs/assets/js/278.0be0e23a.js"><link rel="prefetch" href="/docs/assets/js/279.ba3be2cc.js"><link rel="prefetch" href="/docs/assets/js/28.13b2f41b.js"><link rel="prefetch" href="/docs/assets/js/280.8e1ec965.js"><link rel="prefetch" href="/docs/assets/js/281.ad42b5e9.js"><link rel="prefetch" href="/docs/assets/js/282.12e2bdc5.js"><link rel="prefetch" href="/docs/assets/js/283.ceb2593f.js"><link rel="prefetch" href="/docs/assets/js/284.7561ff34.js"><link rel="prefetch" href="/docs/assets/js/285.81e6335e.js"><link rel="prefetch" href="/docs/assets/js/286.762c60bd.js"><link rel="prefetch" href="/docs/assets/js/287.81711c6b.js"><link rel="prefetch" href="/docs/assets/js/288.58de1d62.js"><link rel="prefetch" href="/docs/assets/js/289.9b2c87d0.js"><link rel="prefetch" href="/docs/assets/js/29.4b761579.js"><link rel="prefetch" href="/docs/assets/js/290.afd3a865.js"><link rel="prefetch" href="/docs/assets/js/292.e0f926c0.js"><link rel="prefetch" href="/docs/assets/js/293.edfb02cc.js"><link rel="prefetch" href="/docs/assets/js/294.327daa55.js"><link rel="prefetch" href="/docs/assets/js/295.d8cb4d73.js"><link rel="prefetch" href="/docs/assets/js/296.4c8a4c2e.js"><link rel="prefetch" href="/docs/assets/js/297.17aea3d4.js"><link rel="prefetch" href="/docs/assets/js/298.84aad3c8.js"><link rel="prefetch" href="/docs/assets/js/299.1a6c8a8e.js"><link rel="prefetch" href="/docs/assets/js/3.74f533f9.js"><link rel="prefetch" href="/docs/assets/js/30.d08a6277.js"><link rel="prefetch" href="/docs/assets/js/300.10c14135.js"><link rel="prefetch" href="/docs/assets/js/301.896f8627.js"><link rel="prefetch" href="/docs/assets/js/302.883df0eb.js"><link rel="prefetch" href="/docs/assets/js/303.8f72c2a1.js"><link rel="prefetch" href="/docs/assets/js/304.620557b1.js"><link rel="prefetch" href="/docs/assets/js/305.68f3d7e2.js"><link rel="prefetch" href="/docs/assets/js/306.784b7d13.js"><link rel="prefetch" href="/docs/assets/js/307.b540e4f5.js"><link rel="prefetch" href="/docs/assets/js/308.f74d21fb.js"><link rel="prefetch" href="/docs/assets/js/309.8deaedbd.js"><link rel="prefetch" href="/docs/assets/js/31.c1387bb0.js"><link rel="prefetch" href="/docs/assets/js/310.1602512f.js"><link rel="prefetch" href="/docs/assets/js/311.48eff31c.js"><link rel="prefetch" href="/docs/assets/js/312.1cee0725.js"><link rel="prefetch" href="/docs/assets/js/313.3fd4dbec.js"><link rel="prefetch" href="/docs/assets/js/314.d0db0bd1.js"><link rel="prefetch" href="/docs/assets/js/315.7d7ad18b.js"><link rel="prefetch" href="/docs/assets/js/316.2a7a755d.js"><link rel="prefetch" href="/docs/assets/js/317.7aa80569.js"><link rel="prefetch" href="/docs/assets/js/318.ad3a6a13.js"><link rel="prefetch" href="/docs/assets/js/319.df629400.js"><link rel="prefetch" href="/docs/assets/js/32.ecf6e134.js"><link rel="prefetch" href="/docs/assets/js/320.c7357a7b.js"><link rel="prefetch" href="/docs/assets/js/321.2dc2419d.js"><link rel="prefetch" href="/docs/assets/js/322.23acb979.js"><link rel="prefetch" href="/docs/assets/js/323.04038af9.js"><link rel="prefetch" href="/docs/assets/js/324.aa6475db.js"><link rel="prefetch" href="/docs/assets/js/325.d037f228.js"><link rel="prefetch" href="/docs/assets/js/326.e8dd6bab.js"><link rel="prefetch" href="/docs/assets/js/327.e35c2d01.js"><link rel="prefetch" href="/docs/assets/js/328.c182b5d9.js"><link rel="prefetch" href="/docs/assets/js/329.c5c21a7e.js"><link rel="prefetch" href="/docs/assets/js/33.1f8e8a41.js"><link rel="prefetch" href="/docs/assets/js/330.f734f519.js"><link rel="prefetch" href="/docs/assets/js/331.6a1eb8ad.js"><link rel="prefetch" href="/docs/assets/js/332.cd5f5f93.js"><link rel="prefetch" href="/docs/assets/js/333.4da9ce1c.js"><link rel="prefetch" href="/docs/assets/js/334.4a89cb9d.js"><link rel="prefetch" href="/docs/assets/js/335.fe7d5b89.js"><link rel="prefetch" href="/docs/assets/js/336.0d257d9c.js"><link rel="prefetch" href="/docs/assets/js/337.91c575e7.js"><link rel="prefetch" href="/docs/assets/js/338.81b5fff3.js"><link rel="prefetch" href="/docs/assets/js/339.c88b6fc9.js"><link rel="prefetch" href="/docs/assets/js/34.3535baf1.js"><link rel="prefetch" href="/docs/assets/js/340.da916736.js"><link rel="prefetch" href="/docs/assets/js/341.ae3813ac.js"><link rel="prefetch" href="/docs/assets/js/342.3dc8335d.js"><link rel="prefetch" href="/docs/assets/js/343.fddcf555.js"><link rel="prefetch" href="/docs/assets/js/344.8d2a5562.js"><link rel="prefetch" href="/docs/assets/js/345.2592b8d0.js"><link rel="prefetch" href="/docs/assets/js/346.db9466d8.js"><link rel="prefetch" href="/docs/assets/js/347.14542263.js"><link rel="prefetch" href="/docs/assets/js/348.a03cba87.js"><link rel="prefetch" href="/docs/assets/js/349.9df7528a.js"><link rel="prefetch" href="/docs/assets/js/35.72d29139.js"><link rel="prefetch" href="/docs/assets/js/350.c8d042a1.js"><link rel="prefetch" href="/docs/assets/js/351.2b042f07.js"><link rel="prefetch" href="/docs/assets/js/352.d382e553.js"><link rel="prefetch" href="/docs/assets/js/353.2637a233.js"><link rel="prefetch" href="/docs/assets/js/354.0271d1a8.js"><link rel="prefetch" href="/docs/assets/js/355.78d3187b.js"><link rel="prefetch" href="/docs/assets/js/356.5fb21f19.js"><link rel="prefetch" href="/docs/assets/js/357.f3bb6dc8.js"><link rel="prefetch" href="/docs/assets/js/358.db413a27.js"><link rel="prefetch" href="/docs/assets/js/359.9c2109cb.js"><link rel="prefetch" href="/docs/assets/js/36.31dc1e7e.js"><link rel="prefetch" href="/docs/assets/js/360.0cf8bcb4.js"><link rel="prefetch" href="/docs/assets/js/361.f061857c.js"><link rel="prefetch" href="/docs/assets/js/362.9abc1985.js"><link rel="prefetch" href="/docs/assets/js/363.2a74f8c8.js"><link rel="prefetch" href="/docs/assets/js/364.00b24052.js"><link rel="prefetch" href="/docs/assets/js/365.9258a71d.js"><link rel="prefetch" href="/docs/assets/js/366.09976440.js"><link rel="prefetch" href="/docs/assets/js/367.a183aba4.js"><link rel="prefetch" href="/docs/assets/js/368.f31c7db8.js"><link rel="prefetch" href="/docs/assets/js/369.206d4ca1.js"><link rel="prefetch" href="/docs/assets/js/37.4afbb733.js"><link rel="prefetch" href="/docs/assets/js/370.7d304dab.js"><link rel="prefetch" href="/docs/assets/js/371.e9d81bc0.js"><link rel="prefetch" href="/docs/assets/js/372.9bb9729f.js"><link rel="prefetch" href="/docs/assets/js/373.55910b0c.js"><link rel="prefetch" href="/docs/assets/js/374.0acd710e.js"><link rel="prefetch" href="/docs/assets/js/375.540eccaf.js"><link rel="prefetch" href="/docs/assets/js/376.6ee3d0ca.js"><link rel="prefetch" href="/docs/assets/js/377.6c851692.js"><link rel="prefetch" href="/docs/assets/js/378.410964aa.js"><link rel="prefetch" href="/docs/assets/js/379.7022392d.js"><link rel="prefetch" href="/docs/assets/js/38.4143e47f.js"><link rel="prefetch" href="/docs/assets/js/380.d7df8ddf.js"><link rel="prefetch" href="/docs/assets/js/381.5902bf10.js"><link rel="prefetch" href="/docs/assets/js/382.da2b367a.js"><link rel="prefetch" href="/docs/assets/js/383.0f0d7bfa.js"><link rel="prefetch" href="/docs/assets/js/384.55820268.js"><link rel="prefetch" href="/docs/assets/js/385.2dd63ee3.js"><link rel="prefetch" href="/docs/assets/js/386.6d4a8f2a.js"><link rel="prefetch" href="/docs/assets/js/387.f52f7c55.js"><link rel="prefetch" href="/docs/assets/js/388.81a74af2.js"><link rel="prefetch" href="/docs/assets/js/389.95c9581f.js"><link rel="prefetch" href="/docs/assets/js/39.43dcb19b.js"><link rel="prefetch" href="/docs/assets/js/390.5cdc5d27.js"><link rel="prefetch" href="/docs/assets/js/391.ecf47212.js"><link rel="prefetch" href="/docs/assets/js/392.0294df41.js"><link rel="prefetch" href="/docs/assets/js/393.4ca24c06.js"><link rel="prefetch" href="/docs/assets/js/394.0531c195.js"><link rel="prefetch" href="/docs/assets/js/395.22c08780.js"><link rel="prefetch" href="/docs/assets/js/396.6195347b.js"><link rel="prefetch" href="/docs/assets/js/397.f5aea126.js"><link rel="prefetch" href="/docs/assets/js/398.93faa0cc.js"><link rel="prefetch" href="/docs/assets/js/399.408c6eca.js"><link rel="prefetch" href="/docs/assets/js/4.814b9b00.js"><link rel="prefetch" href="/docs/assets/js/40.c890c83b.js"><link rel="prefetch" href="/docs/assets/js/400.3d228d95.js"><link rel="prefetch" href="/docs/assets/js/401.42914c5f.js"><link rel="prefetch" href="/docs/assets/js/402.64dda487.js"><link rel="prefetch" href="/docs/assets/js/403.a0f96b4d.js"><link rel="prefetch" href="/docs/assets/js/404.2bbf6e89.js"><link rel="prefetch" href="/docs/assets/js/405.31fcde16.js"><link rel="prefetch" href="/docs/assets/js/406.eb1bb4b0.js"><link rel="prefetch" href="/docs/assets/js/407.732606cf.js"><link rel="prefetch" href="/docs/assets/js/408.9f3fb089.js"><link rel="prefetch" href="/docs/assets/js/409.86192c20.js"><link rel="prefetch" href="/docs/assets/js/41.e2a7e8e9.js"><link rel="prefetch" href="/docs/assets/js/410.2fb0c4cb.js"><link rel="prefetch" href="/docs/assets/js/411.b38f1dcb.js"><link rel="prefetch" href="/docs/assets/js/412.260236bb.js"><link rel="prefetch" href="/docs/assets/js/413.18eb4816.js"><link rel="prefetch" href="/docs/assets/js/414.b96e0262.js"><link rel="prefetch" href="/docs/assets/js/415.a85e2fd1.js"><link rel="prefetch" href="/docs/assets/js/416.c915baac.js"><link rel="prefetch" href="/docs/assets/js/417.6519480a.js"><link rel="prefetch" href="/docs/assets/js/418.c4ab71c0.js"><link rel="prefetch" href="/docs/assets/js/419.097778aa.js"><link rel="prefetch" href="/docs/assets/js/42.de5f206e.js"><link rel="prefetch" href="/docs/assets/js/420.c6566b2b.js"><link rel="prefetch" href="/docs/assets/js/421.9f1c1c5a.js"><link rel="prefetch" href="/docs/assets/js/422.02eefeba.js"><link rel="prefetch" href="/docs/assets/js/423.d00fb0e9.js"><link rel="prefetch" href="/docs/assets/js/424.54dbfc35.js"><link rel="prefetch" href="/docs/assets/js/425.ff36db8e.js"><link rel="prefetch" href="/docs/assets/js/426.decebe6d.js"><link rel="prefetch" href="/docs/assets/js/427.f94a26db.js"><link rel="prefetch" href="/docs/assets/js/428.cabca04c.js"><link rel="prefetch" href="/docs/assets/js/429.b183a0b3.js"><link rel="prefetch" href="/docs/assets/js/43.59b0bc71.js"><link rel="prefetch" href="/docs/assets/js/430.392da296.js"><link rel="prefetch" href="/docs/assets/js/431.61a32c9b.js"><link rel="prefetch" href="/docs/assets/js/432.84e8179d.js"><link rel="prefetch" href="/docs/assets/js/433.c9d56e45.js"><link rel="prefetch" href="/docs/assets/js/434.a7c2de73.js"><link rel="prefetch" href="/docs/assets/js/435.8d60881c.js"><link rel="prefetch" href="/docs/assets/js/436.29c8edab.js"><link rel="prefetch" href="/docs/assets/js/437.96f28480.js"><link rel="prefetch" href="/docs/assets/js/438.f06f1004.js"><link rel="prefetch" href="/docs/assets/js/439.548a597e.js"><link rel="prefetch" href="/docs/assets/js/44.118ab266.js"><link rel="prefetch" href="/docs/assets/js/440.d941c03a.js"><link rel="prefetch" href="/docs/assets/js/441.56ff3905.js"><link rel="prefetch" href="/docs/assets/js/442.ed2b5d5c.js"><link rel="prefetch" href="/docs/assets/js/443.8c36f31c.js"><link rel="prefetch" href="/docs/assets/js/444.73e183ea.js"><link rel="prefetch" href="/docs/assets/js/445.b84974ab.js"><link rel="prefetch" href="/docs/assets/js/446.f382fbda.js"><link rel="prefetch" href="/docs/assets/js/447.e668b37b.js"><link rel="prefetch" href="/docs/assets/js/448.c96e1059.js"><link rel="prefetch" href="/docs/assets/js/449.59508723.js"><link rel="prefetch" href="/docs/assets/js/45.404ad75c.js"><link rel="prefetch" href="/docs/assets/js/450.d4d823ca.js"><link rel="prefetch" href="/docs/assets/js/451.929f2dea.js"><link rel="prefetch" href="/docs/assets/js/452.a6f09152.js"><link rel="prefetch" href="/docs/assets/js/453.5c5f77b1.js"><link rel="prefetch" href="/docs/assets/js/454.1e2852cc.js"><link rel="prefetch" href="/docs/assets/js/455.a87f0094.js"><link rel="prefetch" href="/docs/assets/js/456.8bd1f029.js"><link rel="prefetch" href="/docs/assets/js/457.637d2eb6.js"><link rel="prefetch" href="/docs/assets/js/458.b9728e04.js"><link rel="prefetch" href="/docs/assets/js/459.464e21f3.js"><link rel="prefetch" href="/docs/assets/js/46.d4a77293.js"><link rel="prefetch" href="/docs/assets/js/460.5078de4c.js"><link rel="prefetch" href="/docs/assets/js/461.ae26e433.js"><link rel="prefetch" href="/docs/assets/js/462.0c9c5f39.js"><link rel="prefetch" href="/docs/assets/js/463.ba5db3c0.js"><link rel="prefetch" href="/docs/assets/js/464.a5627bbc.js"><link rel="prefetch" href="/docs/assets/js/465.0c4dda65.js"><link rel="prefetch" href="/docs/assets/js/466.cb9a8e1c.js"><link rel="prefetch" href="/docs/assets/js/467.e44f906c.js"><link rel="prefetch" href="/docs/assets/js/468.61f78b1c.js"><link rel="prefetch" href="/docs/assets/js/469.0a793e2f.js"><link rel="prefetch" href="/docs/assets/js/47.0866703e.js"><link rel="prefetch" href="/docs/assets/js/470.046641a2.js"><link rel="prefetch" href="/docs/assets/js/471.7a7a7e66.js"><link rel="prefetch" href="/docs/assets/js/472.be07f73f.js"><link rel="prefetch" href="/docs/assets/js/473.3681002e.js"><link rel="prefetch" href="/docs/assets/js/474.bbc63738.js"><link rel="prefetch" href="/docs/assets/js/475.9a749309.js"><link rel="prefetch" href="/docs/assets/js/476.c00b8c87.js"><link rel="prefetch" href="/docs/assets/js/477.0ee69db4.js"><link rel="prefetch" href="/docs/assets/js/478.387a161d.js"><link rel="prefetch" href="/docs/assets/js/479.7d2e0ae4.js"><link rel="prefetch" href="/docs/assets/js/48.98d9deb1.js"><link rel="prefetch" href="/docs/assets/js/480.661a0e24.js"><link rel="prefetch" href="/docs/assets/js/481.58703804.js"><link rel="prefetch" href="/docs/assets/js/482.c7b3c6ef.js"><link rel="prefetch" href="/docs/assets/js/483.da2f9d8a.js"><link rel="prefetch" href="/docs/assets/js/484.7a019dc5.js"><link rel="prefetch" href="/docs/assets/js/485.72c2bce5.js"><link rel="prefetch" href="/docs/assets/js/486.c7e38295.js"><link rel="prefetch" href="/docs/assets/js/487.3c27c897.js"><link rel="prefetch" href="/docs/assets/js/488.278b8ec5.js"><link rel="prefetch" href="/docs/assets/js/489.421204c4.js"><link rel="prefetch" href="/docs/assets/js/49.7c893923.js"><link rel="prefetch" href="/docs/assets/js/490.334158c3.js"><link rel="prefetch" href="/docs/assets/js/491.a34fceaa.js"><link rel="prefetch" href="/docs/assets/js/492.794d6fdd.js"><link rel="prefetch" href="/docs/assets/js/493.bbf63302.js"><link rel="prefetch" href="/docs/assets/js/494.9c1cac1b.js"><link rel="prefetch" href="/docs/assets/js/495.5f6bddb6.js"><link rel="prefetch" href="/docs/assets/js/496.b0999e62.js"><link rel="prefetch" href="/docs/assets/js/497.b8ae4e91.js"><link rel="prefetch" href="/docs/assets/js/498.61a25f75.js"><link rel="prefetch" href="/docs/assets/js/499.3854af29.js"><link rel="prefetch" href="/docs/assets/js/5.5e50d4fc.js"><link rel="prefetch" href="/docs/assets/js/50.0d10a6bf.js"><link rel="prefetch" href="/docs/assets/js/500.69e449b3.js"><link rel="prefetch" href="/docs/assets/js/501.81bd9ce4.js"><link rel="prefetch" href="/docs/assets/js/502.23087385.js"><link rel="prefetch" href="/docs/assets/js/503.738271ce.js"><link rel="prefetch" href="/docs/assets/js/504.23bf4002.js"><link rel="prefetch" href="/docs/assets/js/505.71187375.js"><link rel="prefetch" href="/docs/assets/js/506.c41e4bfb.js"><link rel="prefetch" href="/docs/assets/js/507.71fad640.js"><link rel="prefetch" href="/docs/assets/js/508.62f529d9.js"><link rel="prefetch" href="/docs/assets/js/509.25dd21d6.js"><link rel="prefetch" href="/docs/assets/js/51.bbd3842b.js"><link rel="prefetch" href="/docs/assets/js/510.4eb137b0.js"><link rel="prefetch" href="/docs/assets/js/511.3fd7e111.js"><link rel="prefetch" href="/docs/assets/js/512.b1b7b0b0.js"><link rel="prefetch" href="/docs/assets/js/513.6ae660f0.js"><link rel="prefetch" href="/docs/assets/js/514.36c9b5e7.js"><link rel="prefetch" href="/docs/assets/js/515.3ba92c36.js"><link rel="prefetch" href="/docs/assets/js/516.0a9687f0.js"><link rel="prefetch" href="/docs/assets/js/517.29692fc1.js"><link rel="prefetch" href="/docs/assets/js/518.5556b1b8.js"><link rel="prefetch" href="/docs/assets/js/519.2e0967de.js"><link rel="prefetch" href="/docs/assets/js/52.2f39851e.js"><link rel="prefetch" href="/docs/assets/js/520.d9e70252.js"><link rel="prefetch" href="/docs/assets/js/521.23d1005f.js"><link rel="prefetch" href="/docs/assets/js/522.85267ec6.js"><link rel="prefetch" href="/docs/assets/js/523.5eda7b9c.js"><link rel="prefetch" href="/docs/assets/js/524.ba3f973e.js"><link rel="prefetch" href="/docs/assets/js/525.8e9b353d.js"><link rel="prefetch" href="/docs/assets/js/526.7e5b8870.js"><link rel="prefetch" href="/docs/assets/js/527.f7d5ab67.js"><link rel="prefetch" href="/docs/assets/js/528.0b49d032.js"><link rel="prefetch" href="/docs/assets/js/529.db71d55d.js"><link rel="prefetch" href="/docs/assets/js/53.e0d07204.js"><link rel="prefetch" href="/docs/assets/js/530.c635a224.js"><link rel="prefetch" href="/docs/assets/js/531.b3a6000a.js"><link rel="prefetch" href="/docs/assets/js/532.442737ed.js"><link rel="prefetch" href="/docs/assets/js/533.c83dcf8d.js"><link rel="prefetch" href="/docs/assets/js/534.3b12b0e2.js"><link rel="prefetch" href="/docs/assets/js/535.90a47685.js"><link rel="prefetch" href="/docs/assets/js/536.9084f128.js"><link rel="prefetch" href="/docs/assets/js/537.dc42b466.js"><link rel="prefetch" href="/docs/assets/js/538.24620240.js"><link rel="prefetch" href="/docs/assets/js/539.cf3e2776.js"><link rel="prefetch" href="/docs/assets/js/54.501b9ac0.js"><link rel="prefetch" href="/docs/assets/js/540.0b36f09f.js"><link rel="prefetch" href="/docs/assets/js/541.19943114.js"><link rel="prefetch" href="/docs/assets/js/542.240cb3fc.js"><link rel="prefetch" href="/docs/assets/js/543.e63c41b2.js"><link rel="prefetch" href="/docs/assets/js/544.02c3c0d3.js"><link rel="prefetch" href="/docs/assets/js/545.1297101e.js"><link rel="prefetch" href="/docs/assets/js/546.34edb5e7.js"><link rel="prefetch" href="/docs/assets/js/547.3a609d37.js"><link rel="prefetch" href="/docs/assets/js/548.5d5e57e6.js"><link rel="prefetch" href="/docs/assets/js/549.7b65d312.js"><link rel="prefetch" href="/docs/assets/js/55.78f8f3b3.js"><link rel="prefetch" href="/docs/assets/js/550.538e9f03.js"><link rel="prefetch" href="/docs/assets/js/551.01f2dd17.js"><link rel="prefetch" href="/docs/assets/js/552.1664c42c.js"><link rel="prefetch" href="/docs/assets/js/553.cb7966e1.js"><link rel="prefetch" href="/docs/assets/js/554.a716c0f0.js"><link rel="prefetch" href="/docs/assets/js/555.51b1db4d.js"><link rel="prefetch" href="/docs/assets/js/556.32aca1e2.js"><link rel="prefetch" href="/docs/assets/js/557.460e5781.js"><link rel="prefetch" href="/docs/assets/js/558.6a000875.js"><link rel="prefetch" href="/docs/assets/js/559.215b5aa6.js"><link rel="prefetch" href="/docs/assets/js/56.ad344b06.js"><link rel="prefetch" href="/docs/assets/js/560.88be51d3.js"><link rel="prefetch" href="/docs/assets/js/561.34aa0b38.js"><link rel="prefetch" href="/docs/assets/js/562.fd40b955.js"><link rel="prefetch" href="/docs/assets/js/563.af3f3590.js"><link rel="prefetch" href="/docs/assets/js/564.0d60a5c3.js"><link rel="prefetch" href="/docs/assets/js/565.f8e69841.js"><link rel="prefetch" href="/docs/assets/js/566.d2170919.js"><link rel="prefetch" href="/docs/assets/js/567.2f35b9f9.js"><link rel="prefetch" href="/docs/assets/js/568.386ccdb3.js"><link rel="prefetch" href="/docs/assets/js/569.8406b994.js"><link rel="prefetch" href="/docs/assets/js/57.0a461ce5.js"><link rel="prefetch" href="/docs/assets/js/570.f0ead09c.js"><link rel="prefetch" href="/docs/assets/js/571.a7ade73a.js"><link rel="prefetch" href="/docs/assets/js/572.7b473fe1.js"><link rel="prefetch" href="/docs/assets/js/573.c85ff612.js"><link rel="prefetch" href="/docs/assets/js/58.a963e848.js"><link rel="prefetch" href="/docs/assets/js/59.6c4a62f4.js"><link rel="prefetch" href="/docs/assets/js/6.917882ed.js"><link rel="prefetch" href="/docs/assets/js/60.b890d7de.js"><link rel="prefetch" href="/docs/assets/js/61.33acb75e.js"><link rel="prefetch" href="/docs/assets/js/62.09d3ff3e.js"><link rel="prefetch" href="/docs/assets/js/63.9e0efc70.js"><link rel="prefetch" href="/docs/assets/js/64.e5ac08e6.js"><link rel="prefetch" href="/docs/assets/js/65.3b7bafa6.js"><link rel="prefetch" href="/docs/assets/js/66.d4271bec.js"><link rel="prefetch" href="/docs/assets/js/67.392530cb.js"><link rel="prefetch" href="/docs/assets/js/68.5d16551d.js"><link rel="prefetch" href="/docs/assets/js/69.f3b32d9e.js"><link rel="prefetch" href="/docs/assets/js/7.ea4f8cd3.js"><link rel="prefetch" href="/docs/assets/js/70.c890c21a.js"><link rel="prefetch" href="/docs/assets/js/71.9f9325be.js"><link rel="prefetch" href="/docs/assets/js/72.f9e6f771.js"><link rel="prefetch" href="/docs/assets/js/73.3af29e2c.js"><link rel="prefetch" href="/docs/assets/js/74.8677a4ca.js"><link rel="prefetch" href="/docs/assets/js/75.7242e2ad.js"><link rel="prefetch" href="/docs/assets/js/77.941cf7f4.js"><link rel="prefetch" href="/docs/assets/js/78.b33484f4.js"><link rel="prefetch" href="/docs/assets/js/79.80204f1a.js"><link rel="prefetch" href="/docs/assets/js/8.0dad7ba1.js"><link rel="prefetch" href="/docs/assets/js/80.cd4dead5.js"><link rel="prefetch" href="/docs/assets/js/81.58c3a1ff.js"><link rel="prefetch" href="/docs/assets/js/82.49a7e3da.js"><link rel="prefetch" href="/docs/assets/js/83.267de5b3.js"><link rel="prefetch" href="/docs/assets/js/84.9609b3a7.js"><link rel="prefetch" href="/docs/assets/js/85.b16234b6.js"><link rel="prefetch" href="/docs/assets/js/86.d79ceb98.js"><link rel="prefetch" href="/docs/assets/js/87.ba17273c.js"><link rel="prefetch" href="/docs/assets/js/88.197a939f.js"><link rel="prefetch" href="/docs/assets/js/89.7a2640d2.js"><link rel="prefetch" href="/docs/assets/js/9.749668bb.js"><link rel="prefetch" href="/docs/assets/js/90.843f1cb0.js"><link rel="prefetch" href="/docs/assets/js/91.d70fcdc0.js"><link rel="prefetch" href="/docs/assets/js/92.09db1a21.js"><link rel="prefetch" href="/docs/assets/js/93.c66986a7.js"><link rel="prefetch" href="/docs/assets/js/94.fefc7b5a.js"><link rel="prefetch" href="/docs/assets/js/95.e9cd2c75.js"><link rel="prefetch" href="/docs/assets/js/96.bd3162b4.js"><link rel="prefetch" href="/docs/assets/js/97.14d8fdad.js"><link rel="prefetch" href="/docs/assets/js/98.983d7bde.js"><link rel="prefetch" href="/docs/assets/js/99.60a2a3c9.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.6906ca04.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Chuyện muôn thuở</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tools / Toys</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API Guidelines</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Database</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/db/db_overview.html" class="sidebar-link">Database overview</a></li><li><a href="/docs/db/db_types.html" class="sidebar-link">Database types</a></li><li><a href="/docs/db/use-cases.html" class="sidebar-link">Choose a data storage</a></li><li><a href="/docs/db/nosql.html" class="sidebar-link">NoSQL Overview</a></li><li><a href="/docs/db/architect.html" class="sidebar-link">Database Scaling Architectures</a></li><li><a href="/docs/db/optimize_db.html" class="sidebar-link">Database Optimization</a></li><li><a href="/docs/db/db-table-design.html" class="sidebar-link">Database design</a></li><li><a href="/docs/db/relational_db.html" class="sidebar-link">Relational Database</a></li><li><a href="/docs/db/tx-isolation.html" class="sidebar-link">Transaction Isolation Levels</a></li><li><a href="/docs/db/mysql_snippets.html" class="sidebar-link">MySql Snippets</a></li><li><a href="/docs/db/postgre.html" aria-current="page" class="active sidebar-link">PostgreSql Snippets</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#data-type" class="sidebar-link">Data Type</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#recursive-cte" class="sidebar-link">Recursive CTE</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#materialized-view" class="sidebar-link">Materialized View</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#delete-duplicated-rows" class="sidebar-link">Delete duplicated rows</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#table-partitioning" class="sidebar-link">Table Partitioning</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#change-data-capture-cdc" class="sidebar-link">Change Data Capture (CDC)</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#unlogged-table" class="sidebar-link">Unlogged Table</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#managing-disk-spaces" class="sidebar-link">Managing Disk-Spaces</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#_2pc" class="sidebar-link">2PC</a></li><li class="sidebar-sub-header"><a href="/docs/db/postgre.html#references" class="sidebar-link">References</a></li></ul></li><li><a href="/docs/db/couchdb.html" class="sidebar-link">CouchDB Notes</a></li><li><a href="/docs/db/mongodb.html" class="sidebar-link">MongoDB Notes</a></li><li><a href="/docs/db/cassandra.html" class="sidebar-link">Apache Cassandra</a></li><li><a href="/docs/db/elasticsearch.html" class="sidebar-link">Elastic Search</a></li><li><a href="/docs/db/redis.html" class="sidebar-link">Redis Notes</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Giải Toán</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Front end</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>OOP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Thuật ngữ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Payment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Network</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AWS</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="postgresql-snippets"><a href="#postgresql-snippets" class="header-anchor">#</a> PostgreSql Snippets</h1> <div>
  ⚡️ Tags:
  <a href="/docs/tags.html#RDMS">
    📍RDMS
  </a></div> <p><a href="https://www.youtube.com/watch?v=Q56kljmIN14" target="_blank" rel="noopener noreferrer">Postgres Architecture Explained<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="data-type"><a href="#data-type" class="header-anchor">#</a> Data Type</h2> <h3 id="array-type"><a href="#array-type" class="header-anchor">#</a> Array Type</h3> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> monthly_savings <span class="token punctuation">(</span>
   name <span class="token keyword">text</span><span class="token punctuation">,</span>
   saving_per_quarter <span class="token keyword">integer</span> ARRAY<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   scheme <span class="token keyword">text</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> monthly_savings 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>
    <span class="token string">'Manisha'</span><span class="token punctuation">,</span> 
    <span class="token string">'{20000, 14600, 23500, 13250}'</span><span class="token punctuation">,</span> 
    <span class="token string">'{ {“FD”, “MF”}, {“FD”, “Property”} }'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> monthly_savings 
<span class="token keyword">SET</span> saving_per_quarter <span class="token operator">=</span> <span class="token string">'{25000,25000,27000,27000}'</span>
<span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'Manisha'</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> monthly_savings 
<span class="token keyword">WHERE</span> saving_per_quarter<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10000</span> <span class="token operator">OR</span>
    saving_per_quarter<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10000</span> <span class="token operator">OR</span>
    saving_per_quarter<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10000</span> <span class="token operator">OR</span>
    saving_per_quarter<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
</code></pre></div></div></div></div> <h3 id="json-type"><a href="#json-type" class="header-anchor">#</a> JSON Type</h3> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span>
	id <span class="token keyword">serial</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
	info json <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orders <span class="token punctuation">(</span>info<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'{ &quot;customer&quot;: &quot;Lily Bush&quot;, &quot;items&quot;: {&quot;product&quot;: &quot;Diaper&quot;,&quot;qty&quot;: 24}}'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token string">'{ &quot;customer&quot;: &quot;Josh William&quot;, &quot;items&quot;: {&quot;product&quot;: &quot;Toy Car&quot;,&quot;qty&quot;: 1}}'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token string">'{ &quot;customer&quot;: &quot;Mary Clark&quot;, &quot;items&quot;: {&quot;product&quot;: &quot;Toy Train&quot;,&quot;qty&quot;: 2}}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><ul><li>The operator <code>-&gt;</code> returns JSON object field by <code>key</code>.</li> <li>The operator <code>-&gt;&gt;</code> returns JSON object field by <code>text</code>.</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> info <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'items'</span> <span class="token operator">-</span><span class="token operator">&gt;&gt;</span> <span class="token string">'product'</span> <span class="token keyword">as</span> product
<span class="token keyword">FROM</span> orders
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> product<span class="token punctuation">;</span>
</code></pre></div><p><strong>JSON functions</strong></p> <ul><li>json_each</li> <li>json_object_keys</li> <li>json_typeof . It can be <code>number</code>, <code>boolean</code>, <code>null</code>, <code>object</code>, <code>array</code>, and <code>string</code>.</li></ul></div></div></div> <h3 id="composite-type"><a href="#composite-type" class="header-anchor">#</a> Composite Type</h3> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TYPE</span> inventory_item <span class="token keyword">AS</span> <span class="token punctuation">(</span>
   name <span class="token keyword">text</span><span class="token punctuation">,</span>
   supplier_id <span class="token keyword">integer</span><span class="token punctuation">,</span>
   price <span class="token keyword">numeric</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> on_hand <span class="token punctuation">(</span>
   item inventory_item<span class="token punctuation">,</span>
   count <span class="token keyword">integer</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> on_hand 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token keyword">ROW</span><span class="token punctuation">(</span><span class="token string">'fuzzy dice'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">1.99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span>name 
<span class="token keyword">FROM</span> on_hand 
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span>price <span class="token operator">&gt;</span> <span class="token number">9.99</span><span class="token punctuation">;</span>
</code></pre></div></div></div></div> <h2 id="recursive-cte"><a href="#recursive-cte" class="header-anchor">#</a> Recursive CTE</h2> <div class="language- extra-class"><pre class="language-text"><code>WITH RECURSIVE cte_name AS (
    CTE_query_definition -- non-recursive term
    UNION [ALL]
    CTE_query definion  -- recursive term
) SELECT * FROM cte_name;
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">WITH</span> RECURSIVE subordinates <span class="token keyword">AS</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> manager_id<span class="token punctuation">,</span> full_name
        <span class="token keyword">FROM</span> employees
        <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token keyword">UNION</span>
    <span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>manager_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>full_name
        <span class="token keyword">FROM</span> employees e 
        <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> subordinates s <span class="token keyword">ON</span> s<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> e<span class="token punctuation">.</span>manager_id
<span class="token punctuation">)</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> subordinates<span class="token punctuation">;</span>
</code></pre></div><h2 id="materialized-view"><a href="#materialized-view" class="header-anchor">#</a> Materialized View</h2> <ul><li><a href="https://www.postgresqltutorial.com/postgresql-materialized-views/" target="_blank" rel="noopener noreferrer">postgresqltutorial<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.postgresql.org/docs/9.3/rules-materializedviews.html" target="_blank" rel="noopener noreferrer">Materialized Views<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>Create</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> MATERIALIZED <span class="token keyword">VIEW</span> <span class="token string">&quot;UserDashboard&quot;</span> 
<span class="token keyword">AS</span>
   <span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> count <span class="token punctuation">,</span> u<span class="token punctuation">.</span><span class="token string">&quot;isAdmin&quot;</span>
   <span class="token keyword">FROM</span> <span class="token string">&quot;User&quot;</span> u
   <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token string">&quot;isAdmin&quot;</span> 
<span class="token keyword">WITH</span> <span class="token keyword">DATA</span> 
</code></pre></div><p><strong>Refresh</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code>REFRESH MATERIALIZED <span class="token keyword">VIEW</span> <span class="token string">&quot;UserDashboard&quot;</span><span class="token punctuation">;</span>
<span class="token comment">-- allow querying when refreshing data</span>
REFRESH MATERIALIZED <span class="token keyword">VIEW</span> CONCURRENTLY <span class="token string">&quot;UserDashboard&quot;</span><span class="token punctuation">;</span> 
</code></pre></div><p><strong>Drop</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> MATERIALIZED <span class="token keyword">VIEW</span> view_name<span class="token punctuation">;</span>
</code></pre></div><h2 id="delete-duplicated-rows"><a href="#delete-duplicated-rows" class="header-anchor">#</a> Delete duplicated rows</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span>
   basket a
        <span class="token keyword">USING</span> basket b
<span class="token keyword">WHERE</span>
   a<span class="token punctuation">.</span>id <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>id
    <span class="token operator">AND</span> a<span class="token punctuation">.</span>fruit <span class="token operator">=</span> b<span class="token punctuation">.</span>fruit<span class="token punctuation">;</span>
</code></pre></div><h2 id="table-partitioning"><a href="#table-partitioning" class="header-anchor">#</a> Table Partitioning</h2> <p>Postgres provides three built-in partitioning methods:</p> <ul><li><strong>Range Partitioning</strong>: Partition a table by a <em>range of values</em>. This is commonly used with date fields, e.g., a table containing sales data that is divided into monthly partitions according to the sale date.</li> <li><strong>List Partitioning</strong>: Partition a table by a <em>list of known values</em>. This is typically used when the partition key is a categorical value, e.g., a global sales table divided into regional partitions. The partition key in this case can be the country or city code, and each partition will define the list of codes that map to it.</li> <li><strong>Hash Partitioning</strong>: Partition a table using a <em>hash function</em> on the partition key. This is especially useful when there is no obvious way of dividing data into logically similar groups and is often used on categorical partitioning keys that are accessed individually. E.g., if a sales table is often accessed by product, the table might benefit from a hash partition on the product SKU.</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> sale <span class="token punctuation">(</span>
   sale_date       <span class="token keyword">date</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
   country_code    <span class="token keyword">text</span><span class="token punctuation">,</span>
   product_sku     <span class="token keyword">text</span><span class="token punctuation">,</span>
   units           <span class="token keyword">integer</span>
<span class="token punctuation">)</span> <span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> RANGE <span class="token punctuation">(</span>sale_date<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> sale_201901 <span class="token keyword">PARTITION</span> <span class="token keyword">OF</span> sale
   <span class="token keyword">FOR</span> <span class="token keyword">VALUES</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token string">'2019-01-01'</span><span class="token punctuation">)</span> <span class="token keyword">TO</span> <span class="token punctuation">(</span><span class="token string">'2019-02-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> sale_201902 <span class="token keyword">PARTITION</span> <span class="token keyword">OF</span> sale
   <span class="token keyword">FOR</span> <span class="token keyword">VALUES</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token string">'2019-02-01'</span><span class="token punctuation">)</span> <span class="token keyword">TO</span> <span class="token punctuation">(</span><span class="token string">'2019-03-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="change-data-capture-cdc"><a href="#change-data-capture-cdc" class="header-anchor">#</a> Change Data Capture (CDC)</h2> <h3 id="_1-using-triggers"><a href="#_1-using-triggers" class="header-anchor">#</a> 1. Using Triggers</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">FUNCTION</span> audit_log<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">TRIGGER</span> <span class="token keyword">AS</span> $
<span class="token keyword">BEGIN</span>
  <span class="token keyword">IF</span> <span class="token punctuation">(</span>TG_OP <span class="token operator">=</span> <span class="token string">'DELETE'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> audit_table <span class="token punctuation">(</span>id<span class="token punctuation">,</span> old_data<span class="token punctuation">,</span> operation<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>OLD<span class="token punctuation">.</span>id<span class="token punctuation">,</span> OLD<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'DELETE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ELSIF <span class="token punctuation">(</span>TG_OP <span class="token operator">=</span> <span class="token string">'UPDATE'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> audit_table <span class="token punctuation">(</span>id<span class="token punctuation">,</span> old_data<span class="token punctuation">,</span> new_data<span class="token punctuation">,</span> operation<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">.</span>id<span class="token punctuation">,</span> OLD<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">,</span> NEW<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'UPDATE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ELSIF <span class="token punctuation">(</span>TG_OP <span class="token operator">=</span> <span class="token string">'INSERT'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> audit_table <span class="token punctuation">(</span>id<span class="token punctuation">,</span> new_data<span class="token punctuation">,</span> operation<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>NEW<span class="token punctuation">.</span>id<span class="token punctuation">,</span> NEW<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'INSERT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
  <span class="token keyword">RETURN</span> NEW<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
$ <span class="token keyword">LANGUAGE</span> plpgsql<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> audit_trigger
<span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span> <span class="token operator">OR</span> <span class="token keyword">UPDATE</span> <span class="token operator">OR</span> <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> my_table
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">EXECUTE</span> <span class="token keyword">FUNCTION</span> audit_log<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-using-logical-replication"><a href="#_2-using-logical-replication" class="header-anchor">#</a> 2. Using Logical Replication</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- Enable the pglogical extension</span>
<span class="token keyword">CREATE</span> EXTENSION pglogical<span class="token punctuation">;</span>

<span class="token comment">-- Create a replication set</span>
<span class="token keyword">SELECT</span> pglogical<span class="token punctuation">.</span>create_replication_set<span class="token punctuation">(</span><span class="token string">'my_replication_set'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Add the table to the replication set</span>
<span class="token keyword">SELECT</span> pglogical<span class="token punctuation">.</span>replication_set_add_table<span class="token punctuation">(</span><span class="token string">'my_replication_set'</span><span class="token punctuation">,</span> <span class="token string">'my_table'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Create a replication node</span>
<span class="token keyword">SELECT</span> pglogical<span class="token punctuation">.</span>create_node<span class="token punctuation">(</span>
  node_name :<span class="token operator">=</span> <span class="token string">'my_node'</span><span class="token punctuation">,</span>
  dsn :<span class="token operator">=</span> <span class="token string">'host=192.168.1.100 dbname=my_database user=my_user password=my_password'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Create a replication slot</span>
<span class="token keyword">SELECT</span> pglogical<span class="token punctuation">.</span>create_replication_slot<span class="token punctuation">(</span><span class="token string">'my_slot'</span><span class="token punctuation">,</span> <span class="token string">'my_node'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Start the replication worker</span>
<span class="token keyword">SELECT</span> pglogical<span class="token punctuation">.</span>start_replication<span class="token punctuation">(</span>
  slot_name :<span class="token operator">=</span> <span class="token string">'my_slot'</span><span class="token punctuation">,</span>
  create_slot :<span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  replication_sets :<span class="token operator">=</span> ARRAY<span class="token punctuation">[</span><span class="token string">'my_replication_set'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In this example, we enable the pglogical extension and create a replication set called <code>my_replication_set</code>. We then add the <code>my_table</code> table to the replication set and create a replication node called <code>my_node</code> that connects to the publisher database. We create a replication slot called my_slot and start the replication worker to capture data changes in real-time.</p> <h3 id="_3-using-change-data-capture-cdc"><a href="#_3-using-change-data-capture-cdc" class="header-anchor">#</a> 3. Using Change Data Capture (CDC)</h3> <p>Change Data Capture (CDC) is a feature in PostgreSQL that allows you to capture data changes in real-time and store them in a separate table. You can use CDC to capture data changes without affecting the performance of the database.</p> <ol><li>Enable the <code>wal_level</code> parameter in the <code>postgresql.conf</code> file. This parameter determines the amount of information written to the Write-Ahead Log (WAL). Set it to <code>logical</code> to enable logical decoding, which is required for CDC.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>wal_level = logical
</code></pre></div><ol start="2"><li><p>Restart the Postgres server to apply the changes made to the <code>postgresql.conf</code> file.</p></li> <li><p>Create a replication slot using the <code>pg_create_logical_replication_slot</code> function. This function creates a replication slot that can be used to capture changes.</p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> pg_create_logical_replication_slot<span class="token punctuation">(</span><span class="token string">'cdc_slot'</span><span class="token punctuation">,</span> <span class="token string">'wal2json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In the above example, we create a replication slot named <code>cdc_slot</code> using the <code>wal2json</code> output plugin. The <code>wal2json</code> plugin converts the Write-Ahead Log (WAL) into a JSON format, making it easier to consume the changes.</p> <ol start="4"><li>Create a publication to define the tables and columns you want to capture changes for. A publication is a named collection of tables and columns that are tracked for changes.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> PUBLICATION cdc_publication <span class="token keyword">FOR</span> <span class="token keyword">TABLE</span> table1<span class="token punctuation">,</span> table2<span class="token punctuation">;</span>
</code></pre></div><p>In the above example, we create a publication named <code>cdc_publication</code> for <code>table1</code> and <code>table2</code>. Any changes made to these tables will be captured by CDC.</p> <ol start="5"><li>Create a subscription to consume the changes captured by CDC. A subscription defines the connection details and the publication to subscribe to.</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SUBSCRIPTION cdc_subscription CONNECTION <span class="token string">'host=127.0.0.1 port=5432 dbname=mydb user=myuser password=mypassword'</span> PUBLICATION cdc_publication<span class="token punctuation">;</span>
</code></pre></div><p>In the above example, we create a subscription named <code>cdc_subscription</code> that connects to the database <code>mydb</code> using the provided connection details. It subscribes to the <code>cdc_publication</code> publication.</p> <p>Once you have completed these steps, CDC will be set up in your Postgres database. Any changes made to the tables included in the publication will be captured and made available for consumption through the subscription.</p> <p>You can query the changes using the <code>pg_logical_slot_get_changes</code> function or any other method supported by the output plugin you have chosen.</p> <p>Remember to monitor the size of the replication slot and the disk space used by the changes captured by CDC to ensure it does not grow excessively.</p> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example 2</h4> <p>In this example, we create a publication called <code>my_publication</code> for the <code>my_table</code> table on the publisher database. We then create a subscription called <code>my_subscription</code> on the subscriber database that connects to the publisher database and subscribes to the <code>my_publication</code> publication.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- On the publisher database</span>
<span class="token keyword">CREATE</span> PUBLICATION my_publication <span class="token keyword">FOR</span> <span class="token keyword">TABLE</span> my_table<span class="token punctuation">;</span>

<span class="token comment">-- On the subscriber database</span>
<span class="token keyword">CREATE</span> SUBSCRIPTION my_subscription
CONNECTION <span class="token string">'host=192.168.1.100 dbname=my_database user=my_user password=my_password'</span>
PUBLICATION my_publication<span class="token punctuation">;</span>
</code></pre></div><h2 id="unlogged-table"><a href="#unlogged-table" class="header-anchor">#</a> Unlogged Table</h2> <p>Disable <a href="https://www.postgresql.org/docs/9.6/wal.html" target="_blank" rel="noopener noreferrer">WAL (Write-Ahead Log)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Cases to use:</p> <ul><li>large data sets (e.g. computation) which will be only used few times</li> <li>dynamic data with expiration date e.g. user sessions</li> <li>volatile data which can be easily regenerated</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> daily_summary<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> UNLOGGED<span class="token punctuation">;</span>

<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> daily_summary <span class="token keyword">SET</span> UNLOGGED<span class="token punctuation">;</span>
</code></pre></div><p>List all unlogged tables</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> relname <span class="token keyword">FROM</span> pg_class <span class="token keyword">WHERE</span> relpersistence <span class="token operator">=</span> <span class="token string">'u'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="managing-disk-spaces"><a href="#managing-disk-spaces" class="header-anchor">#</a> Managing Disk-Spaces</h2> <ul><li>Hot Data</li> <li>Warm Data</li> <li>Cold Data</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> hot_data LOCATION <span class="token operator">/</span>disk0<span class="token operator">/</span>ssd<span class="token operator">/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> warm_data LOCATION <span class="token operator">/</span>disk0<span class="token operator">/</span>sata2<span class="token operator">/</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> logistics 
<span class="token keyword">TABLESPACE</span> ts_primary<span class="token punctuation">;</span>
</code></pre></div><h2 id="_2pc"><a href="#_2pc" class="header-anchor">#</a> 2PC</h2> <p>use this feature with one coordinator and two nodes</p> <ul><li>The step with [C] means operation on the coordinator node,</li> <li>and with [P] means operation on foreign servers (participant nodes).</li></ul> <h3 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h3> <ol><li>[C] Set GUC parameter max_foreign_prepared_transactions</li></ol> <div class="language- extra-class"><pre class="language-text"><code>$ $EDITOR postgresql.conf
max_connections = 100
max_prepared_foreign_transactions = 200 # max_connections = 100 and two foreign servers
max_foreign_transaction_resolvers = 1
foreign_twophase_commit = required
foreign_transaction_resolution_interval = 5s
froeign_transaction_resolver_timeout = 60s
</code></pre></div><ol start="2"><li>[P] Set GUC parameter max_prepared_transactions</li></ol> <div class="language- extra-class"><pre class="language-text"><code>$ $EDITOR postgresql.conf
max_prepared_transactions = 100 # same as max_connections of the coordinator server
log_statement = all # for testing
log_line_prefix = '&lt;F1&gt; ' # for fs2 server we can set '&lt;F2&gt; '
</code></pre></div><ol start="3"><li><p>[C] Create postgres_fdw extension</p></li> <li><p>[C] Create foreign servers with two_phase_commit parameter = on</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>=# CREATE SERVER fs1 FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host 'fs1', dbname 'postgres', port '5432');
CREATE SERVER

=# CREATE SERVER fs2 FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host 'fs2', dbname 'postgres', port '5342');
CREATE SERVER

=# SELECT * FROM pg_foreign_server;
 oid  | srvname | srvowner | srvfdw | srvtype | srvversion | srvacl |              srvoptions
-------+---------+----------+--------+---------+------------+--------+--------------------------------------
16451 | fs1     |       10 |  16387 |         |            |        | {host=fs1,dbname=postgres,port=5432}
16452 | fs2     |       10 |  16387 |         |            |        | {host=fs2,dbname=postgres,port=5432}
</code></pre></div><ol start="5"><li>[C] Create user mapping</li></ol> <div class="language- extra-class"><pre class="language-text"><code>=# CREATE USER MAPPING FOR PUBLIC SERVER fs1;
CREATE USER MAPPING

=# CREATE USER MAPPING FOR PUBLIC SERVER fs2;
CREATE USER MAPPING
</code></pre></div><h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <div class="language- extra-class"><pre class="language-text"><code>=# BEIGN;
=# INSERT INTO ft1 VALUES (1);
=# INSERT INTO ft2 VALUES (1);
=# COMMIT;
</code></pre></div><p>We will see the following server logs on fs1 server and fs2 server.</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;FS1&gt; LOG:  statement: START TRANSACTION ISOLATION LEVEL REPEATABLE READ
&lt;FS1&gt; LOG:  execute pgsql_fdw_prep_1: INSERT INTO public.s1(col) VALUES ($1)
&lt;FS1&gt; DETAIL:  parameters: $1 = '1'
&lt;FS1&gt; LOG:  statement: DEALLOCATE pgsql_fdw_prep_1

&lt;FS2&gt; LOG:  statement: START TRANSACTION ISOLATION LEVEL REPEATABLE READ
&lt;FS2&gt; LOG:  execute pgsql_fdw_prep_2: INSERT INTO public.s2(col) VALUES ($1)
&lt;FS2&gt; DETAIL:  parameters: $1 = '1'
&lt;FS2&gt; LOG:  statement: DEALLOCATE pgsql_fdw_prep_2

&lt;FS1&gt; LOG:  statement: PREPARE TRANSACTION 'fx_68464475_515_16400_10'
&lt;FS2&gt; LOG:  statement: PREPARE TRANSACTION 'fx_658736079_515_16410_10'
&lt;FS1&gt; LOG:  statement: COMMIT PREPARED 'fx_68464475_515_16400_10'
&lt;FS2&gt; LOG:  statement: COMMIT PREPARED 'fx_658736079_515_16410_10'
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">PREPARE TRANSACTION</p> <p>PREPARE TRANSACTION is not intended for use in applications or interactive sessions. Its purpose is to allow an external transaction manager to perform atomic global transactions across multiple databases or other transactional resources. Unless you're writing a transaction manager, you probably shouldn't be using PREPARE TRANSACTION.</p></div> <p>https://wiki.postgresql.org/wiki/Atomic_Commit_of_Distributed_Transactions</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ul><li><a href="https://www.tutorialspoint.com/postgresql/index.htm" target="_blank" rel="noopener noreferrer">PostgreSQL Tutorial<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.postgresqltutorial.com/postgresql-json/" target="_blank" rel="noopener noreferrer">PostgreSQL JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.postgresql.org/docs/10/ddl-partitioning.html" target="_blank" rel="noopener noreferrer">Table Partitioning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.enterprisedb.com/blog/postgres-table-partitioning" target="_blank" rel="noopener noreferrer">Postgres Table Partitioning<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.postgresqltutorial.com/postgresql-create-tablespace/#:~:text=A%20tablespace%20is%20a%20location,pg_default%20tablespace%20stores%20user%20data." target="_blank" rel="noopener noreferrer">PostgreSQL CREATE TABLESPACE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/db/mysql_snippets.html" class="prev">
        MySql Snippets
      </a></span> <span class="next"><a href="/docs/db/couchdb.html">
        CouchDB Notes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.e037735d.js" defer></script><script src="/docs/assets/js/2.f3b73e05.js" defer></script><script src="/docs/assets/js/291.b391cfb2.js" defer></script><script src="/docs/assets/js/146.ac526bd3.js" defer></script><script src="/docs/assets/js/76.f78684a8.js" defer></script>
  </body>
</html>
