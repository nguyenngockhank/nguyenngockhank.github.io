(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{564:function(e,a,t){"use strict";t.r(a);var s=t(7),n=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"chapter-11-graph-databases"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chapter-11-graph-databases"}},[e._v("#")]),e._v(" Chapter 11. Graph Databases")]),e._v(" "),t("p",[e._v("Graph databases allow you to store entities and relationships between these entities. Entities are also\nknown as nodes, which have properties. Think of a node as an instance of an object in the application.\nRelations are known as edges that can have properties. Edges have directional significance; nodes\nare organized by relationships which allow you to find interesting patterns between the nodes. The\norganization of the graph lets the data to be stored once and then interpreted in different ways based\non relationships.")]),e._v(" "),t("h3",{attrs:{id:"_11-1-what-is-a-graph-database"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-what-is-a-graph-database"}},[e._v("#")]),e._v(" 11.1. What Is a Graph Database?")]),e._v(" "),t("p",[e._v("In the example graph in Figure 11.1, we see a bunch of nodes related to each other. Nodes are entities\nthat have properties, such as name. The node of Martin is actually a "),t("strong",[e._v("node")]),e._v(" that has "),t("strong",[e._v("property")]),e._v(" of name\nset to Martin.")]),e._v(" "),t("p",[t("strong",[e._v("Figure 11.1. An example graph structure")]),e._v("\nWe also see that edges have types, such as likes, author, and so on. These properties let us\norganize the nodes; for example, the nodes Martin and Pramod have an "),t("strong",[e._v("edge")]),e._v(" connecting them with a\nrelationship type of friend. Edges can have multiple properties. We can assign a property of since\non the friend relationship type between Martin and Pramod. Relationship types have directional\nsignificance; the friend relationship type is bidirectional but likes is not. When Dawn likes")]),e._v(" "),t("p",[e._v("NoSQL Distilled, it does not automatically mean NoSQL Distilled likes Dawn.")]),e._v(" "),t("p",[e._v("Once we have a graph of these nodes and edges created, we can query the graph in many ways,\nsuch as “get all nodes employed by Big Co that like NoSQL Distilled.” A query on the graph is\nalso known as "),t("strong",[e._v("traversing")]),e._v(" the graph. An advantage of the graph databases is that we can change the\ntraversing requirements without having to change the nodes or edges. If we want to “get all nodes that\nlike NoSQL Distilled,” we can do so without having to change the existing data or the model of\nthe database, because we can traverse the graph any way we like.")]),e._v(" "),t("p",[e._v("Usually, when we store a graph-like structure in RDBMS, it’s for a single type of relationship\n(“who is my manager” is a common example). Adding another relationship to the mix usually means a\nlot of schema changes and data movement, which is not the case when we are using graph databases.\nSimilarly, in relational databases we model the graph beforehand based on the Traversal we want;\nif the Traversal changes, the data will have to change.")]),e._v(" "),t("p",[e._v("In graph databases, traversing the joins or relationships is very fast. The relationship between\nnodes is not calculated at query time but is actually persisted as a relationship. Traversing persisted\nrelationships is faster than calculating them for every query.")]),e._v(" "),t("p",[e._v("Nodes can have different types of relationships between them, allowing you to both represent\nrelationships between the domain entities and to have secondary relationships for things like\ncategory, path, time-trees, quad-trees for spatial indexing, or linked lists for sorted access. Since\nthere is no limit to the number and kind of relationships a node can have, all they can be represented\nin the same graph database.")]),e._v(" "),t("h3",{attrs:{id:"_11-2-features"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-2-features"}},[e._v("#")]),e._v(" 11.2. Features")]),e._v(" "),t("p",[e._v("There are many graph databases available, such as Neo4J [Neo4J], Infinite Graph [Infinite Graph],\nOrientDB [OrientDB], or FlockDB [FlockDB] (which is a special case: a graph database that only\nsupports single-depth relationships or adjacency lists, where you cannot traverse more than one level\ndeep for relationships). We will take Neo4J as a representative of the graph database solutions to\ndiscuss how they work and how they can be used to solve application problems.")]),e._v(" "),t("p",[e._v("In Neo4J, creating a graph is as simple as creating two nodes and then creating a relationship. Let’s\ncreate two nodes, Martin and Pramod:")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Node martin = graphDb.createNode();\nmartin.setProperty("name", "Martin");')]),e._v(" "),t("p",[e._v('Node pramod = graphDb.createNode();\npramod.setProperty("name", "Pramod");')]),e._v(" "),t("p",[e._v("We have assigned the name property of the two nodes the values of Martin and Pramod. Once we\nhave more than one node, we can create a relationship:")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v("martin.createRelationshipTo(pramod, FRIEND);")]),e._v(" "),t("p",[e._v("pramod.createRelationshipTo(martin, FRIEND);")]),e._v(" "),t("p",[e._v("We have to create relationship between the nodes in both directions, for the direction of the\nrelationship matters: For example, a product node can be liked by user but the product cannot like")]),e._v(" "),t("p",[e._v("the user. This directionality helps in designing a rich domain model (Figure 11.2). Nodes know\nabout INCOMING and OUTGOING relationships that are traversable both ways.")]),e._v(" "),t("p",[t("strong",[e._v("Figure 11.2. Relationships with properties")]),e._v("\nRelationships are first-class citizens in graph databases; most of the value of graph databases is\nderived from the relationships. Relationships don’t only have a type, a start node, and an end node,\nbut can have properties of their own. Using these properties on the relationships, we can add\nintelligence to the relationship—for example, since when did they become friends, what is the\ndistance between the nodes, or what aspects are shared between the nodes. These properties on the\nrelationships can be used to query the graph.")]),e._v(" "),t("p",[e._v("Since most of the power from the graph databases comes from the relationships and their\nproperties, a lot of thought and design work is needed to model the relationships in the domain that\nwe are trying to work with. Adding new relationship types is easy; changing existing nodes and their\nrelationships is similar to data migration (“Migrations in Graph Databases,” p. 131 ), because these\nchanges will have to be done on each node and each relationship in the existing data.")]),e._v(" "),t("p",[t("strong",[e._v("11.2.1. Consistency")])]),e._v(" "),t("p",[e._v("Since graph databases are operating on connected nodes, most graph database solutions usually do\nnot support distributing the nodes on different servers. There are some solutions, however, that\nsupport node distribution across a cluster of servers, such as Infinite Graph. Within a single server,\ndata is always consistent, especially in Neo4J which is fully ACID-compliant. When running Neo4J\nin a cluster, a write to the master is eventually synchronized to the slaves, while slaves are always\navailable for read. Writes to slaves are allowed and are immediately synchronized to the master;")]),e._v(" "),t("p",[e._v("other slaves will not be synchronized immediately, though—they will have to wait for the data to\npropagate from the master.")]),e._v(" "),t("p",[e._v("Graph databases ensure consistency through transactions. They do not allow dangling\nrelationships: The start node and end node always have to exist, and nodes can only be deleted if they\ndon’t have any relationships attached to them.")]),e._v(" "),t("p",[t("strong",[e._v("11.2.2. Transactions")])]),e._v(" "),t("p",[e._v("Neo4J is ACID-compliant. Before changing any nodes or adding any relationships to existing nodes,\nwe have to start a transaction. Without wrapping operations in transactions, we will get a\nNotInTransactionException. Read operations can be done without initiating a transaction.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Transaction transaction = database.beginTx();\ntry {\nNode node = database.createNode();\nnode.setProperty("name", "NoSQL Distilled");\nnode.setProperty("published", "2012");\ntransaction.success();\n} finally {\ntransaction.finish();\n}')]),e._v(" "),t("p",[e._v("In the above code, we started a transaction on the database, then created a node and set properties\non it. We marked the transaction as success and finally completed it by finish. A transaction has to\nbe marked as success, otherwise Neo4J assumes that it was a failure and rolls it back when finish\nis issued. Setting success without issuing finish also does not commit the data to the database. This\nway of managing transactions has to be remembered when developing, as it differs from the standard\nway of doing transactions in an RDBMS.")]),e._v(" "),t("p",[t("strong",[e._v("11.2.3. Availability")])]),e._v(" "),t("p",[e._v("Neo4J, as of version 1.8, achieves high availability by providing for replicated slaves. These slaves\ncan also handle writes: When they are written to, they synchronize the write to the current master, and\nthe write is committed first at the master and then at the slave. Other slaves will eventually get the\nupdate. Other graph databases, such as Infinite Graph and FlockDB, provide for distributed storage of\nthe nodes.")]),e._v(" "),t("p",[e._v("Neo4J uses the Apache ZooKeeper [ZooKeeper] to keep track of the last transaction IDs persisted\non each slave node and the current master node. Once a server starts up, it communicates with\nZooKeeper and finds out which server is the master. If the server is the first one to join the cluster, it\nbecomes the master; when a master goes down, the cluster elects a master from the available nodes,\nthus providing high availability.")]),e._v(" "),t("p",[t("strong",[e._v("11.2.4. Query Features")])]),e._v(" "),t("p",[e._v("Graph databases are supported by query languages such as Gremlin [Gremlin]. Gremlin is a domain-\nspecific language for traversing graphs; it can traverse all graph databases that implement the\nBlueprints [Blueprints] property graph. Neo4J also has the Cypher [Cypher] query language for\nquerying the graph. Outside these query languages, Neo4J allows you to query the graph for\nproperties of the nodes, traverse the graph, or navigate the nodes relationships using language\nbindings.")]),e._v(" "),t("p",[e._v("Properties of a node can be indexed using the indexing service. Similarly, properties of\nrelationships or edges can be indexed, so a node or edge can be found by the value. Indexes should be\nqueried to find the starting node to begin a traversal. Let’s look at searching for the node using node\nindexing.")]),e._v(" "),t("p",[e._v("If we have the graph shown in Figure 11.1, we can index the nodes as they are added to the\ndatabase, or we can index all the nodes later by iterating over them. We first need to create an index\nfor the nodes using the "),t("strong",[e._v("IndexManager")]),e._v(".")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Index")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Node")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" nodeIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" graphDb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("forNodes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"nodes"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("p",[e._v("We are indexing the nodes for the name property. Neo4J uses Lucene [Lucene] as its indexing\nservice. We will see later that we can also use the full-text search capability of Lucene. When new\nnodes are created, they can be added to the index.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Transaction")]),e._v(" transaction "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" graphDb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("beginTx")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("try")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Index")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Node")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" nodeIndex "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" graphDb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("forNodes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"nodes"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("martin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" martin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getProperty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("pramod"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" pramod"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getProperty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    transaction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("success")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("finally")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    transaction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("finish")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("p",[e._v("Adding nodes to the index is done inside the context of a transaction. Once the nodes are indexed,\nwe can search them using the indexed property. If we search for the node with the name of Barbara,\nwe would query the index for the property of name to have a value of Barbara.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Node node = nodeIndex.get("name", "Barbara").getSingle();')]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("We get the node whose name is Martin; given the node, we can get all its relationships.\n")])])]),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Node martin = nodeIndex.get("name", "Martin").getSingle();\nallRelationships = martin.getRelationships();')]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("We can get both INCOMING or OUTGOING relationships.\n")])])]),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v("incomingRelations = martin.getRelationships(Direction.INCOMING);")]),e._v(" "),t("p",[e._v("We can also apply directional filters on the queries when querying for a relationship. With the\ngraph in Figure 11.1, if we want to find all people who like NoSQL Distilled, we can find the\nNoSQL Distilled node and then get its relationships with Direction.INCOMING. At this point we\ncan also add the type of relationship to the query filter, since we are looking only for nodes that LIKE\nNoSQL Distilled.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Node nosqlDistilled = nodeIndex.get("name",\n"NoSQL Distilled").getSingle();')]),e._v(" "),t("p",[e._v("relationships = nosqlDistilled.getRelationships(INCOMING, LIKES);\nfor (Relationship relationship : relationships) {\nlikesNoSQLDistilled.add(relationship.getStartNode());\n}")]),e._v(" "),t("p",[e._v("Finding nodes and their immediate relations is easy, but this can also be achieved in RDBMS\ndatabases. Graph databases are really powerful when you want to traverse the graphs at any depth\nand specify a starting node for the traversal. This is especially useful when you are trying to find\nnodes that are related to the starting node at more than one level down. As the depth of the graph\nincreases, it makes more sense to traverse the relationships by using a Traverser where you can\nspecify that you are looking for INCOMING, OUTGOING, or BOTH types of relationships. You can also\nmake the traverser go top-down or sideways on the graph by using Order values of BREADTH_FIRST\nor DEPTH_FIRST. The traversal has to start at some node—in this example, we try to find all the\nnodes at any depth that are related as a FRIEND with Barbara:")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('Node barbara = nodeIndex.get("name", "Barbara").getSingle();')]),e._v(" "),t("p",[e._v("Traverser friendsTraverser = barbara.traverse(Order.BREADTH_FIRST,\nStopEvaluator.END_OF_GRAPH,\nReturnableEvaluator.ALL_BUT_START_NODE,\nEdgeType.FRIEND,\nDirection.OUTGOING);")]),e._v(" "),t("p",[e._v("The friendsTraverser provides us a way to find all the nodes that are related to Barbara where\nthe relationship type is FRIEND. The nodes can be at any depth—friend of a friend at any level—\nallowing you to explore tree structures.")]),e._v(" "),t("p",[e._v("One of the good features of graph databases is finding paths between two nodes—determining if\nthere are multiple paths, finding all of the paths or the shortest path. In the graph in Figure 11.1, we\nknow that Barbara is connected to Jill by two distinct paths; to find all these paths and the distance\nbetween Barbara and Jill along those different paths, we can use")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Node")]),e._v(" barbara "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Barbara"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getSingle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Node")]),e._v(" jill "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Jill"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getSingle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("PathFinder")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" finder "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("GraphAlgoFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("allPaths")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Traversal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("expanderForTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("FRIEND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Direction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("OUTGOING"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" \n            MAX_DEPTH\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Iterable")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" paths "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" finder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("findAllPaths")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" jill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("p",[e._v("This feature is used in social networks to show relationships between any two nodes. To find all\nthe paths and the distance between the nodes for each path, we first get a list of distinct paths between\nthe two nodes. The length of each path is the "),t("strong",[e._v("number of hops")]),e._v(" on the graph needed to reach the\ndestination node from the start node. Often, you need to get the shortest path between two nodes; of\nthe two paths from Barbara to Jill, the shortest path can be found by using")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("PathFinder")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" finder "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("GraphAlgoFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("shortestPath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Traversal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("expanderForTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("FRIEND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Direction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("OUTGOING"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" \n                MAX_DEPTH\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Iterable")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v(" paths "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" finder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("findAllPaths")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" jill"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("p",[e._v("Many other graph algorithms can be applied to the graph at hand, such as Dijkstra’s algorithm")]),e._v(" "),t("p",[e._v("[Dijkstra’s] for finding the shortest or cheapest path between nodes.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("START")]),e._v(" beginingNode "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("beginning node specification"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MATCH")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("relationship"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" pattern matches"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WHERE")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("filtering condition: "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("on")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("data")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("in")]),e._v(" nodes "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("and")]),e._v(" relationships"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RETURN")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("What "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("to")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(": nodes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" relationships"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" properties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ORDER")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("BY")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("properties "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("to")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("order")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("by")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\nSKIP "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nodes "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("to")]),e._v(" skip "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("top")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("LIMIT")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("limit")]),e._v(" results"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),t("p",[e._v("Neo4J also provides the "),t("strong",[e._v("Cypher")]),e._v(" query language to query the graph. Cypher needs a node to START\nthe query. The start node can be identified by its node ID, a list of node IDs, or index lookups. Cypher\nuses the MATCH keyword for matching patterns in relationships; the WHERE keyword filters the\nproperties on a node or relationship. The RETURN keyword specifies what gets returned by the query\n—nodes, relationships, or fields on the nodes or relationships.")]),e._v(" "),t("p",[e._v("Cypher also provides methods to ORDER, AGGREGATE, SKIP, and LIMIT the data. In Figure 11.2, we\nfind all nodes connected to Barbara, either incoming or outgoing, by using the --.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("START")]),e._v(" barbara "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" node:nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Barbara"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MATCH")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("--(connected_node)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RETURN")]),e._v(" connected_node\n")])])]),t("p",[e._v("When interested in directional significance, we can use")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("MATCH (barbara)<--(connected_node)\n")])])]),t("p",[e._v("for incoming relationships or")]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MATCH")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("--\x3e(connected_node)")]),e._v("\n")])])]),t("p",[e._v("for outgoing relationships. Match can also be done on specific relationships using the\n"),t("code",[e._v(":RELATIONSHIP_TYPE")]),e._v(" convention and returning the required fields or nodes.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("p",[e._v('START barbara = node:nodeIndex(name = "Barbara")\nMATCH (barbara)-[:FRIEND]->(friend_node)\nRETURN friend_node.name,friend_node.location')]),e._v(" "),t("p",[e._v("We start with Barbara, find all outgoing relationships with the type of FRIEND, and return the\nfriends’ names. The relationship type query only works for the depth of one level; we can make it\nwork for greater depths and find out the depth of each of the result nodes.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("START")]),e._v(" barbara"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("node:nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Barbara"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MATCH")]),e._v(" path "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" barbara"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(":FRIEND"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v(".3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("end_node\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RETURN")]),e._v(" barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" end_node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),t("p",[e._v("Similarly, we can query for relationships where a particular relationship property exists. We can\nalso filter on the properties of relationships and query if a property exists or not.")]),e._v(" "),t("p",[t("strong",[e._v("Click here to view code image")])]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("START")]),e._v(" barbara "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" node:nodeIndex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("name "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Barbara"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MATCH")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("barbara"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("relation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("related_node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("WHERE")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("relation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'FRIEND'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("AND")]),e._v(" relation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("share")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RETURN")]),e._v(" related_node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" relation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("since\n")])])]),t("p",[e._v("There are many other query features in the Cypher language that can be used to query database\ngraphs.")]),e._v(" "),t("p",[t("strong",[e._v("11.2.5. Scaling")])]),e._v(" "),t("p",[e._v("In NoSQL databases, one of the commonly used scaling techniques is sharding, where data is split\nand distributed across different servers. With graph databases, sharding is difficult, as graph\ndatabases are not aggregate-oriented but relationship-oriented. Since any given node can be related to\nany other node, storing related nodes on the same server is better for graph traversal. Traversing a\ngraph when the nodes are on different machines is not good for performance. Knowing this limitation\nof the graph databases, we can still scale them using some common techniques described by Jim\nWebber [Webber Neo4J Scaling].")]),e._v(" "),t("p",[e._v("Generally speaking, there are three ways to scale graph databases. Since machines now can come\nwith lots of RAM, we can add enough RAM to the server so that the working set of nodes and\nrelationships is held entirely in memory. This technique is only helpful if the dataset that we are\nworking with will fit in a realistic amount of RAM.")]),e._v(" "),t("p",[e._v("We can improve the read scaling of the database by adding more slaves with read-only access to\nthe data, with all the writes going to the master. This pattern of writing once and reading from many\nservers is a proven technique in MySQL clusters and is really useful when the dataset is large enough\nto not fit in a single machine’s RAM, but small enough to be replicated across multiple machines.\nSlaves can also contribute to availability and read-scaling, as they can be configured to never become\na master, remaining always read-only.")]),e._v(" "),t("p",[e._v("When the dataset size makes replication impractical, we can shard (see the “Sharding” section on\np. 38 ) the data from the application side using domain-specific knowledge. For example, nodes that\nrelate to the North America can be created on one server while the nodes that relate to Asia on\nanother. This application-level sharding needs to understand that nodes are stored on physically\ndifferent databases (Figure 11.3).")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Figure 11.3. Application-level sharding of nodes\n")])])]),t("h3",{attrs:{id:"_11-3-suitable-use-cases"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-3-suitable-use-cases"}},[e._v("#")]),e._v(" 11.3. Suitable Use Cases")]),e._v(" "),t("p",[e._v("Let’s look at some suitable use cases for graph databases.")]),e._v(" "),t("p",[t("strong",[e._v("11.3.1. Connected Data")])]),e._v(" "),t("p",[e._v("Social networks are where graph databases can be deployed and used very effectively. These social\ngraphs don’t have to be only of the friend kind; for example, they can represent employees, their\nknowledge, and where they worked with other employees on different projects. Any link-rich domain\nis well suited for graph databases.")]),e._v(" "),t("p",[e._v("If you have relationships between domain entities from different domains (such as social, spatial,\ncommerce) in a single database, you can make these relationships more valuable by providing the\nability to traverse across domains.")]),e._v(" "),t("p",[t("strong",[e._v("11.3.2. Routing, Dispatch, and Location-Based Services")])]),e._v(" "),t("p",[e._v("Every location or address that has a delivery is a node, and all the nodes where the delivery has to be\nmade by the delivery person can be modeled as a graph of nodes. Relationships between nodes can\nhave the property of distance, thus allowing you to deliver the goods in an efficient manner. Distance\nand location properties can also be used in graphs of places of interest, so that your application can\nprovide recommendations of good restaurants or entertainment options nearby. You can also create\nnodes for your points of sales, such as bookstores or restaurants, and notify the users when they are\nclose to any of the nodes to provide location-based services.")]),e._v(" "),t("p",[t("strong",[e._v("11.3.3. Recommendation Engines")])]),e._v(" "),t("p",[e._v("As nodes and relationships are created in the system, they can be used to make recommendations like\n“your friends also bought this product” or “when invoicing this item, these other items are usually\ninvoiced.” Or, it can be used to make recommendations to travelers mentioning that when other")]),e._v(" "),t("p",[e._v("visitors come to Barcelona they usually visit Antonio Gaudi’s creations.")]),e._v(" "),t("p",[e._v("An interesting side effect of using the graph databases for recommendations is that as the data size\ngrows, the number of nodes and relationships available to make the recommendations quickly\nincreases. The same data can also be used to mine information—for example, which products are\nalways bought together, or which items are always invoiced together; alerts can be raised when these\nconditions are not met. Like other recommendation engines, graph databases can be used to search for\npatterns in relationships to detect fraud in transactions.")]),e._v(" "),t("h3",{attrs:{id:"_11-4-when-not-to-use"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-4-when-not-to-use"}},[e._v("#")]),e._v(" 11.4. When Not to Use")]),e._v(" "),t("p",[e._v("In some situations, graph databases may not appropriate. When you want to update all or a subset of\nentities—for example, in an analytics solution where all entities may need to be updated with a\nchanged property—graph databases may not be optimal since changing a property on all the nodes is\nnot a straightforward operation. Even if the data model works for the problem domain, some\ndatabases may be unable to handle lots of data, especially in global graph operations (those involving\nthe whole graph).")])])}),[],!1,null,null,null);a.default=n.exports}}]);