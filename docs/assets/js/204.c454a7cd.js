(window.webpackJsonp=window.webpackJsonp||[]).push([[204],{1112:function(t,n,s){"use strict";s.r(n);var a=s(7),e=Object(a.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"real-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#real-time"}},[t._v("#")]),t._v(" Real time")]),t._v(" "),s("p",[t._v("Con người xã hội ngày càng phát triển và sống càng nhanh đòi hỏi sự phản hồi website là lập tức, tăng tương tác người dùng =))")]),t._v(" "),s("ul",[s("li",[t._v("Chát không thể đợi lâu được")]),t._v(" "),s("li",[t._v("Sàn giao dịch chậm 1 giây là mất cơ hội liền")]),t._v(" "),s("li",[t._v("Game trực tuyến, đánh bài, đánh cờ, các kiểu")]),t._v(" "),s("li",[t._v("... nói chung là realtime =)))")])]),t._v(" "),s("TagLinks"),t._v(" "),s("h2",{attrs:{id:"phuong-phap-đe-realtime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#phuong-phap-đe-realtime"}},[t._v("#")]),t._v(" Phương pháp để realtime")]),t._v(" "),s("p",[t._v("Có thể phân ra 2 loại chính đó là "),s("code",[t._v("Client pull")]),t._v(" và "),s("code",[t._v("Server push")]),t._v(".")]),t._v(" "),s("ul",[s("li",[t._v("Polling: Short Polling và Long Polling là loại Client pull")]),t._v(" "),s("li",[t._v("Websockets và Sever Send Event là loại Server push")])]),t._v(" "),s("h2",{attrs:{id:"short-polling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#short-polling"}},[t._v("#")]),t._v(" Short Polling")]),t._v(" "),s("p",[t._v("Dùng AJAX để hỏi thăm server liên tục xem có dữ liệu mới không?")]),t._v(" "),s("p",[t._v("Đại loại là vậy:")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInterval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" grabNewData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("ul",[s("li",[s("strong",[t._v("Ưu")]),t._v(" : dễ làm, dễ implement, server không cần thay đổi nhiều")]),t._v(" "),s("li",[s("strong",[t._v("Nhược")]),t._v(" : "),s("strong",[t._v("response trả về không đồng bộ")]),t._v(" ; độ trễ cao, bóp d*i server, DDOS server nếu người dùng lớn =))")])]),t._v(" "),s("h2",{attrs:{id:"long-polling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#long-polling"}},[t._v("#")]),t._v(" Long Polling")]),t._v(" "),s("p",[t._v("Cũng dùng AJAX hỏi thăm server, nhưng server sẽ giữ chân cái request lại... khi nào server có dữ liệu mới sẽ tha về")]),t._v(" "),s("p",[t._v("Cách này thì Facebook, Github đang xài")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Ưu")]),t._v(": Độ trễ thấp hơn short polling, ít request từ client gửi hơn")]),t._v(" "),s("li",[s("strong",[t._v("Nhược")]),t._v(": "),s("strong",[t._v("response trả về không đồng bộ")]),t._v(", phải xử lý vấn đề timeout của cả client và server...")])]),t._v(" "),s("h2",{attrs:{id:"server-send-event-sse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-send-event-sse"}},[t._v("#")]),t._v(" Server Send Event (SSE)")]),t._v(" "),s("p",[t._v("Cái này éo support IE =)) Yêu cầu browser phải có "),s("code",[t._v("EventSource")]),t._v(", Polyfill thì vẫn được")]),t._v(" "),s("p",[t._v("Cái này thì client sẽ kết nối bền vững với server 1 lần rồi sau đó, cứ nhận dữ liệu mới từ server trả về... đây là đường 1 chiều ( "),s("code",[t._v("pub - sub 1-way")]),t._v(")  =))")]),t._v(" "),s("p",[t._v("Mặc dù là 1-way nhưng ta vẫn có thể gửi dữ liệu qua đường AJAX")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EventSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"undefined"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" source "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo_sse.php"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   source"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"result"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<br>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[s("strong",[t._v("Ưu")]),t._v(": no delay, chuẩn nên dễ, cách làm bên server cũng giống bên Long polling")]),t._v(" "),s("li",[s("strong",[t._v("Nhược")]),t._v(": ... code tay xử lý string nhiều, cần hiểu biết rộng vì chưa thư viện hỗ trợ nhiều =))")])]),t._v(" "),s("h2",{attrs:{id:"web-socket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-socket"}},[t._v("#")]),t._v(" Web socket")]),t._v(" "),s("p",[t._v("Là một giao thức có kết nối bền vững ăn bám browser =))) Nghĩa là bạn có thể tự viết ra 1 Client app kết nối với web socket server mà ko cần qua http =))) Để chi thì chưa biết ...")]),t._v(" "),s("p",[t._v("Thông qua giao thức này Client và Server có thể gửi dữ liệu lên, xuống thoải mái qua cái Socket đã kết nối ( "),s("code",[t._v("pub - sub 2-way")]),t._v(")")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Ưu")]),t._v(": realtime chính hiệu =)) performance nhanh hơn http; hỗ trợ nhiều thứ hay ho rất gì và này nọ")]),t._v(" "),s("li",[s("strong",[t._v("Nhược")]),t._v(": phía server phải nói là phức tạp về phần cài đặt, cấu hình cũng như cần mindset khác với lập trình web thông thường; thực tế thì rất nhiều case dị =)))")])]),t._v(" "),s("p",[s("strong",[t._v("Lưu ý")]),t._v(":\nScale ngang của websocket ko hề đơn giản như RESTful API. "),s("a",{attrs:{href:"https://tsh.io/blog/how-to-scale-websocket/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Đọc thêm"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"nen-xai-cai-nao"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nen-xai-cai-nao"}},[t._v("#")]),t._v(" Nên xài cái nào")]),t._v(" "),s("p",[t._v("Dựa vào nhiều yếu tốt nhưng mà có vài ý:")]),t._v(" "),s("p",[t._v("Theo Khánk")]),t._v(" "),s("ul",[s("li",[t._v("Ko nên nghĩ tới "),s("code",[t._v("Long polling")]),t._v(", cho mấy anh lớn implement")]),t._v(" "),s("li",[t._v("Nghĩ tới trách nhiệm: khi ta implement xong là có ai support nữa ko, hay mình ôm luôn =)))")])])],1)}),[],!1,null,null,null);n.default=e.exports}}]);