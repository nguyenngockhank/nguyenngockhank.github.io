(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{1445:function(e,t,a){"use strict";a.r(t);var s=a(7),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"database-design"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#database-design"}},[e._v("#")]),e._v(" Database design")]),e._v(" "),s("TagLinks"),e._v(" "),s("h2",{attrs:{id:"cap-theorem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cap-theorem"}},[e._v("#")]),e._v(" CAP theorem")]),e._v(" "),s("p",[e._v("The CAP theorem says that a distributed system can deliver on only two of three desired characteristics: consistency, availability and partition tolerance.")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://i.pinimg.com/originals/5d/45/a0/5d45a01c6048b0ec7c085f8191932212.jpg",alt:"CAP"}})]),e._v(" "),s("h2",{attrs:{id:"tips"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tips"}},[e._v("#")]),e._v(" Tips")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://i.pinimg.com/originals/b8/0b/ed/b80bed198927552727cd7b82943185b9.jpg",alt:""}})]),e._v(" "),s("h3",{attrs:{id:"normalize-your-data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#normalize-your-data"}},[e._v("#")]),e._v(" Normalize Your Data")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://i.pinimg.com/736x/f9/54/e0/f954e03a9bd7c5879a607655cf5f9480.jpg",alt:"Normalization"}})]),e._v(" "),s("ul",[s("li",[e._v("First Normal Form (1NF): Each column should contain atomic (indivisible) values, and each column should contain values of a single type.")]),e._v(" "),s("li",[e._v("Second Normal Form (2NF): Every non-key column must depend on the entire primary key, not just part of it. This applies to tables with composite primary keys (a primary key made of multiple columns).")]),e._v(" "),s("li",[e._v("Third Normal Form (3NF): Every non-key column must depend only on the primary key and nothing else (i.e., no transitive dependencies).")])]),e._v(" "),s("h3",{attrs:{id:"use-appropriate-data-types"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-appropriate-data-types"}},[e._v("#")]),e._v(" Use Appropriate Data Types")]),e._v(" "),s("p",[e._v("Choosing the right data types will impact performance and storage efficiency. Always:")]),e._v(" "),s("ul",[s("li",[e._v("Use the smallest data type that can hold your data.")]),e._v(" "),s("li",[s("strong",[e._v("Avoid")]),e._v(" using "),s("code",[e._v("TEXT")]),e._v(" or "),s("code",[e._v("BLOB")]),e._v(" unless absolutely necessary.")]),e._v(" "),s("li",[e._v("Be mindful of "),s("strong",[e._v("precision requirements")]),e._v(" for "),s("code",[e._v("numeric data")]),e._v(" types.")]),e._v(" "),s("li",[e._v("Use "),s("code",[e._v("DATE")]),e._v(" or "),s("code",[e._v("TIMESTAMP")]),e._v(" for "),s("strong",[e._v("date/time")]),e._v(" data instead of strings.")])]),e._v(" "),s("h3",{attrs:{id:"indexing-strategy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#indexing-strategy"}},[e._v("#")]),e._v(" Indexing Strategy")]),e._v(" "),s("p",[e._v("Indexes will improve query performance but can also slow down "),s("code",[e._v("INSERT")]),e._v(", "),s("code",[e._v("UPDATE")]),e._v(", and "),s("code",[e._v("DELETE")]),e._v(" operations if overused. Develop a balanced indexing strategy:")]),e._v(" "),s("ul",[s("li",[e._v("Index columns are often used in "),s("code",[e._v("WHERE")]),e._v(", "),s("code",[e._v("JOIN")]),e._v(", and "),s("code",[e._v("ORDER BY")]),e._v(" clauses.")]),e._v(" "),s("li",[e._v("Avoid indexing columns that are often updated.")]),e._v(" "),s("li",[e._v("Use composite indexes for queries involving many columns.\n"),s("strong",[e._v("Example")]),e._v(": Add an index if you do lookups often for the email column.")])]),e._v(" "),s("h3",{attrs:{id:"use-constraints-and-relationships"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-constraints-and-relationships"}},[e._v("#")]),e._v(" Use Constraints and Relationships")]),e._v(" "),s("p",[e._v("Enforce data integrity and relationships through constraints:")]),e._v(" "),s("ul",[s("li",[e._v("Use primary keys to identify rows uniquely.")]),e._v(" "),s("li",[e._v("Define foreign keys to enforce referential integrity between tables.")]),e._v(" "),s("li",[e._v("Define unique constraints for columns that require unique values.")]),e._v(" "),s("li",[e._v("Apply check constraints to enforce domain rules at the database level.\n"),s("strong",[e._v("Example")]),e._v(": Use "),s("code",[e._v("NOT NULL")]),e._v(" constraints to ensure critical columns are always filled.")])]),e._v(" "),s("h3",{attrs:{id:"partition-large-tables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#partition-large-tables"}},[e._v("#")]),e._v(" Partition Large Tables")]),e._v(" "),s("ul",[s("li",[e._v("Horizontal Partitioning: Split a table into many tables containing the same columns but different rows.")]),e._v(" "),s("li",[s("strong",[e._v("Vertical Partitioning")]),e._v(": Split a table into many tables containing different columns.\n"),s("strong",[e._v("Example")]),e._v(": Separate infrequently accessed columns into a different table to reduce the size of the main table.")])]),e._v(" "),s("h2",{attrs:{id:"db-isolation-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#db-isolation-options"}},[e._v("#")]),e._v(" DB Isolation options")]),e._v(" "),s("p",[e._v("Data isolation ensures that modules are independent and loosely coupled.")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://i.pinimg.com/564x/76/1f/68/761f684da8d15a28ec2faad9a250e5c4.jpg",alt:"DB Isolation options"}})]),e._v(" "),s("p",[e._v("A modular monolith has strict rules for data integrity:")]),e._v(" "),s("ul",[s("li",[e._v("Each module can only access its own tables")]),e._v(" "),s("li",[e._v("No sharing of tables or objects between modules")]),e._v(" "),s("li",[e._v("Joins are only allowed between tables of the same module")])]),e._v(" "),s("h2",{attrs:{id:"database-normalization"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#database-normalization"}},[e._v("#")]),e._v(" Database Normalization")]),e._v(" "),s("p",[e._v("Database Normalization is a design step which eliminates redundant data stored in form of large monolithic tables making the overall query execution simpler.")]),e._v(" "),s("p",[e._v("The main purpose of this normalized data is logical storage of data using relationships between the tables. As originally proposed by "),s("strong",[e._v("Edgar Codd")]),e._v(", there are six steps involved in the overall process from 1NF to 6NF as described below. Most modern databases follow a standard upto the 4NF step.")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://static.javatpoint.com/dbms/images/dbms-normalization.png",alt:"db normalize"}})]),e._v(" "),s("h2",{attrs:{id:"polymorphic-db-table-design"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#polymorphic-db-table-design"}},[e._v("#")]),e._v(" Polymorphic DB Table Design")]),e._v(" "),s("p",[e._v("Look at "),s("a",{attrs:{href:"https://dba.stackexchange.com/questions/179654/developing-a-database-for-a-funds-transfers-business-where-a-people-and-organi",target:"_blank",rel:"noopener noreferrer"}},[e._v("Example Person and Organization Example"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("source:\n"),s("img",{attrs:{src:a(699),alt:"Polymorphic DB Table Design"}})]),e._v(" "),s("p",[e._v("Key takeaways:")]),e._v(" "),s("ul",[s("li",[e._v('"As demonstrated, Person and Organization are depicted as mutually exclusive subtypes of Party."')]),e._v(" "),s("li",[e._v('"The Party '),s("strong",[e._v("supertype")]),e._v(" holds a discriminator (i.e., PartyTypeCode) and all the properties (or attributes) that are common to its "),s("strong",[e._v("subtypes")]),e._v(', which, in turn, have the properties that apply to each of them."')])]),e._v(" "),s("p",[e._v("Result DB diagram. Pay attention to how the polymorphic relationships resolved using this design:")]),e._v(" "),s("ul",[s("li",[e._v("Person is-a Party")]),e._v(" "),s("li",[e._v("Organization is-a Party")]),e._v(" "),s("li",[e._v("PartyTypeCode is the "),s("strong",[e._v("discriminator")])])]),e._v(" "),s("p",[e._v("See more:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/9174200/how-to-create-multiple-one-to-ones/9178524#9178524",target:"_blank",rel:"noopener noreferrer"}},[e._v("3 ways to implement class hierarchies in relational databases"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.martinfowler.com/eaaCatalog/singleTableInheritance.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Single Table Inheritance"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.martinfowler.com/eaaCatalog/classTableInheritance.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Class Table Inheritance"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.martinfowler.com/eaaCatalog/concreteTableInheritance.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Concrete Table Inheritance"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"metadata-db-table-design"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metadata-db-table-design"}},[e._v("#")]),e._v(" Metadata DB Table Design")]),e._v(" "),s("p",[e._v("Wordpress database is a great example\n"),s("img",{attrs:{src:a(700),alt:"Polymorphic DB Table Design"}})]),e._v(" "),s("p",[s("a",{attrs:{href:"https://stackoverflow.com/questions/3241033/designing-database-to-hold-different-metadata-information",target:"_blank",rel:"noopener noreferrer"}},[e._v("Another one"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"thoughts-on-foreign-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#thoughts-on-foreign-keys"}},[e._v("#")]),e._v(" Thoughts on Foreign Keys")]),e._v(" "),s("p",[e._v("At GitHub we do not use foreign keys, ever, anywhere.")]),e._v(" "),s("ul",[s("li",[e._v("FKs are in your way to shard your database. Your app is accustomed to rely on FK to maintain integrity, instead of doing it on its own. It may even rely on FK to cascade deletes (shudder). When eventually you want to shard or extract data out, you need to change & test the app to an unknown extent.")]),e._v(" "),s("li",[e._v("FKs are a performance impact. The fact they require indexes is likely fine, since those indexes are needed anyhow. But the lookup made for each "),s("code",[e._v("insert")]),e._v("/"),s("code",[e._v("delete")]),e._v(" is an overhead.")]),e._v(" "),s("li",[e._v("FKs don't work well with online schema migrations.")])]),e._v(" "),s("p",[e._v("Read more:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://softwareengineering.stackexchange.com/questions/334624/should-i-define-the-relations-between-tables-in-the-database-or-just-in-code",target:"_blank",rel:"noopener noreferrer"}},[e._v("Should I define the relations between tables in the database or just in code?"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/github/gh-ost/issues/331#issuecomment-266027731",target:"_blank",rel:"noopener noreferrer"}},[e._v("Thoughts on Foreign Keys?"),s("OutboundLink")],1)])])],1)}),[],!1,null,null,null);t.default=o.exports},699:function(e,t,a){e.exports=a.p+"assets/img/Polymorphic-table.eb59cbb9.png"},700:function(e,t,a){e.exports=a.p+"assets/img/wp-metadatatable.c1b9b204.png"}}]);