(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1377:function(e,a,t){"use strict";t.r(a);var i=t(7),r=Object(i.a)({},(function(){var e=this,a=e.$createElement,i=e._self._c||a;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"elastic-load-balancing-elb"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#elastic-load-balancing-elb"}},[e._v("#")]),e._v(" Elastic Load Balancing (ELB)")]),e._v(" "),i("h2",{attrs:{id:"overview"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),i("h3",{attrs:{id:"what"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#what"}},[e._v("#")]),e._v(" What?")]),e._v(" "),i("p",[e._v("Distribute network traffic to improve app scalability")]),e._v(" "),i("h3",{attrs:{id:"why-use-a-load-balancer"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#why-use-a-load-balancer"}},[e._v("#")]),e._v(" Why use a load balancer?")]),e._v(" "),i("ul",[i("li",[e._v("Spread load across multiple downstream instances")]),e._v(" "),i("li",[e._v("Expose a single point of access (DNS) to your application")]),e._v(" "),i("li",[e._v("Seamlessly handle failures of downstream instances")]),e._v(" "),i("li",[e._v("Do regular health checks to your instances")]),e._v(" "),i("li",[e._v("Provide SSL termination (HTTPS) for your websites")]),e._v(" "),i("li",[i("strong",[e._v("High availability")]),e._v(" across zones & automatic scaling")]),e._v(" "),i("li",[e._v("Separate public traffic from private traffic")])]),e._v(" "),i("h3",{attrs:{id:"why-use-an-elastic-load-balancer"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#why-use-an-elastic-load-balancer"}},[e._v("#")]),e._v(" Why use an Elastic Load Balancer?")]),e._v(" "),i("ul",[i("li",[e._v("An Elastic Load Balancer is a managed load balancer\n"),i("ul",[i("li",[e._v("AWS guarantees that it will be working")]),e._v(" "),i("li",[e._v("AWS takes care of upgrades, maintenance, high availability")]),e._v(" "),i("li",[e._v("AWS provides only a few configuration knobs")])])]),e._v(" "),i("li",[e._v("It costs less to setup your own load balancer but it will be a lot more effort on your end")]),e._v(" "),i("li",[e._v("It is integrated with many AWS offerings / services\n"),i("ul",[i("li",[e._v("EC2, EC2 Auto Scaling Groups, Amazon ECS")]),e._v(" "),i("li",[e._v("AWS Certificate Manager (ACM), CloudWatch")]),e._v(" "),i("li",[e._v("Route 53, AWS WAF, AWS Global Accelerator")])])])]),e._v(" "),i("h2",{attrs:{id:"security-groups"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#security-groups"}},[e._v("#")]),e._v(" Security Groups")]),e._v(" "),i("p",[i("strong",[e._v("Load Balancer Security Group")])]),e._v(" "),i("p",[i("img",{attrs:{src:t(554),alt:"Security Group 4 Load Balancer"}})]),e._v(" "),i("p",[i("strong",[e._v("Application Security Group: Allow traffic only from Load Balancer")])]),e._v(" "),i("p",[i("img",{attrs:{src:t(555),alt:"Security Group 4 Application"}})]),e._v(" "),i("h2",{attrs:{id:"types-comparison"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#types-comparison"}},[e._v("#")]),e._v(" Types & Comparison")]),e._v(" "),i("table",[i("thead",[i("tr",[i("th",[e._v("Feature")]),e._v(" "),i("th",[e._v("Application LB")]),e._v(" "),i("th",[e._v("Network LB")]),e._v(" "),i("th",[e._v("Gateway LB")]),e._v(" "),i("th",[e._v("Classic LB")])])]),e._v(" "),i("tbody",[i("tr",[i("td",[e._v("Released Year")]),e._v(" "),i("td",[e._v("2016 v2")]),e._v(" "),i("td",[e._v("2017 v2")]),e._v(" "),i("td",[e._v("2020")]),e._v(" "),i("td",[e._v("2009 v1")])]),e._v(" "),i("tr",[i("td",[e._v("OSI Layer")]),e._v(" "),i("td",[e._v("7")]),e._v(" "),i("td",[e._v("4")]),e._v(" "),i("td",[e._v("3 Gateway + 4 LB")]),e._v(" "),i("td",[e._v("4 / 7")])]),e._v(" "),i("tr",[i("td",[e._v("Target type")]),e._v(" "),i("td",[e._v("IP, Instance, "),i("code",[e._v("Lambda")])]),e._v(" "),i("td",[e._v("IP, Instance, "),i("code",[e._v("ALB")])]),e._v(" "),i("td",[e._v("IP, Instance")]),e._v(" "),i("td")]),e._v(" "),i("tr",[i("td",[e._v("Cross-zone Default")]),e._v(" "),i("td",[e._v("Enabled")]),e._v(" "),i("td",[e._v("Disabled")]),e._v(" "),i("td",[e._v("Disabled")]),e._v(" "),i("td",[e._v("Disabled")])]),e._v(" "),i("tr",[i("td",[e._v("Charges for inter AZ data")]),e._v(" "),i("td",[e._v("No")]),e._v(" "),i("td",[e._v("Yes")]),e._v(" "),i("td",[e._v("Yes")]),e._v(" "),i("td",[e._v("No")])]),e._v(" "),i("tr",[i("td",[e._v("Sticky Sessions")]),e._v(" "),i("td",[e._v("✅")]),e._v(" "),i("td",[e._v("✅")]),e._v(" "),i("td",[e._v("❌")]),e._v(" "),i("td",[e._v("✅")])]),e._v(" "),i("tr",[i("td",[e._v("Terminates flow/ proxy behavior")]),e._v(" "),i("td",[e._v("✅")]),e._v(" "),i("td",[e._v("✅")]),e._v(" "),i("td",[e._v("❌")]),e._v(" "),i("td",[e._v("✅")])]),e._v(" "),i("tr",[i("td",[e._v("Reachable via")]),e._v(" "),i("td",[e._v("VIP")]),e._v(" "),i("td",[e._v("VIP")]),e._v(" "),i("td",[e._v("Route table entry")]),e._v(" "),i("td")]),e._v(" "),i("tr",[i("td",[e._v("Protocol listerners")]),e._v(" "),i("td",[e._v("HTTP, HTTPs, gRPC")]),e._v(" "),i("td",[e._v("TCP, UDP, TLS")]),e._v(" "),i("td",[e._v("IP")]),e._v(" "),i("td",[e._v("TCP, SSL/TLS, HTTP, HTTPS")])]),e._v(" "),i("tr",[i("td",[e._v("SSL Certificates")]),e._v(" "),i("td",[e._v("multiple with SNI")]),e._v(" "),i("td",[e._v("multiple with SNI")]),e._v(" "),i("td",[e._v("❌")]),e._v(" "),i("td",[e._v("only 1")])])])]),e._v(" "),i("p",[e._v("Notes:")]),e._v(" "),i("ul",[i("li",[e._v("Overall, it is recommended to use the newer generation load balancers as they provide more features")]),e._v(" "),i("li",[e._v("Some load balancers can be setup as internal (private) or external (public) ELBs")])]),e._v(" "),i("h2",{attrs:{id:"application-load-balancer-alb"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#application-load-balancer-alb"}},[e._v("#")]),e._v(" Application Load Balancer (ALB)")]),e._v(" "),i("ul",[i("li",[e._v("Load balancing to multiple HTTP applications across machines (target groups)")]),e._v(" "),i("li",[e._v("Load balancing to multiple applications on the same machine (ex: containers)")])]),e._v(" "),i("h3",{attrs:{id:"features"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#features"}},[e._v("#")]),e._v(" Features")]),e._v(" "),i("ul",[i("li",[e._v("Support redirects (from HTTP to HTTPS for example)")]),e._v(" "),i("li",[e._v("Fixed response")]),e._v(" "),i("li",[e._v("Desync Mitigation Mode")]),e._v(" "),i("li",[e._v("Support HTTP2 /gRPC / Websocket")]),e._v(" "),i("li",[e._v("HTTP header based routing. Routing tables to different target groups:\n"),i("ul",[i("li",[e._v("Routing based on path in URL ("),i("code",[e._v("example.com/users")]),e._v(" & "),i("code",[e._v("example.com/posts")]),e._v(")")]),e._v(" "),i("li",[e._v("Routing based on hostname in URL ("),i("code",[e._v("one.example.com")]),e._v(" & "),i("code",[e._v("other.example.c")]),e._v("om)")]),e._v(" "),i("li",[e._v("Routing based on Query String, Headers ("),i("code",[e._v("example.com/users?id=123&order=false")]),e._v(")")])])]),e._v(" "),i("li",[e._v("Has a port mapping feature to redirect to a dynamic port in ECS")]),e._v(" "),i("li",[e._v("ALB are a great fit for micro services & container-based application (example: Docker & Amazon ECS)")]),e._v(" "),i("li",[e._v("In comparison, we’d need multiple Classic Load Balancer per application")])]),e._v(" "),i("h3",{attrs:{id:"target-groups"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#target-groups"}},[e._v("#")]),e._v(" Target groups")]),e._v(" "),i("ul",[i("li",[e._v("EC2 instances (can be managed by an Auto Scaling Group) – HTTP")]),e._v(" "),i("li",[e._v("ECS tasks (managed by ECS itself) – HTTP")]),e._v(" "),i("li",[e._v("Lambda functions – HTTP request is translated into a JSON event")]),e._v(" "),i("li",[e._v("IP Addresses – must be private IPs")]),e._v(" "),i("li",[e._v("ALB can route to "),i("strong",[e._v("multiple target groups")])]),e._v(" "),i("li",[e._v("Health checks are at the target group level")])]),e._v(" "),i("h3",{attrs:{id:"good-to-know"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#good-to-know"}},[e._v("#")]),e._v(" Good to Know")]),e._v(" "),i("ul",[i("li",[e._v("Fixed hostname (XXX.region.elb.amazonaws.com)")]),e._v(" "),i("li",[e._v("The application servers don’t see the IP of the client directly\n"),i("ul",[i("li",[e._v("The true IP of the client is inserted in the header "),i("strong",[e._v("X-Forwarded-For")])]),e._v(" "),i("li",[e._v("We can also get Port (X-Forwarded-Port) and proto (X-Forwarded-Proto)")])])])]),e._v(" "),i("h2",{attrs:{id:"network-load-balancer-nlb"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#network-load-balancer-nlb"}},[e._v("#")]),e._v(" Network Load Balancer (NLB)")]),e._v(" "),i("ul",[i("li",[e._v("Works on layer 4 allow to:\n"),i("ul",[i("li",[e._v("Forward TCP & UDP traffic to your instances")]),e._v(" "),i("li",[e._v("Handle millions of request per seconds")]),e._v(" "),i("li",[e._v("Less latency ~100 ms (vs 400 ms for ALB)")])])]),e._v(" "),i("li",[e._v("NLB has "),i("strong",[e._v("one static IP per AZ")]),e._v(", and supports assigning Elastic IP (helpful for whitelisting specific IP)")]),e._v(" "),i("li",[e._v("NLB are used for extreme performance, TCP or UDP traffic")]),e._v(" "),i("li",[e._v("Not included in the AWS free tier")])]),e._v(" "),i("h3",{attrs:{id:"target-groups-2"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#target-groups-2"}},[e._v("#")]),e._v(" Target Groups")]),e._v(" "),i("ul",[i("li",[e._v("EC2 instances")]),e._v(" "),i("li",[e._v("IP Addresses – must be private IPs")]),e._v(" "),i("li",[e._v("Application Load Balancer")]),e._v(" "),i("li",[e._v("Health Checks support the TCP, HTTP and HTTPS Protocols")])]),e._v(" "),i("h2",{attrs:{id:"gateway-load-balancer-gwlb"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#gateway-load-balancer-gwlb"}},[e._v("#")]),e._v(" Gateway Load Balancer (GWLB)")]),e._v(" "),i("p",[i("img",{attrs:{src:t(556),alt:"img"}})]),e._v(" "),i("ul",[i("li",[e._v("Deploy, scale, and manage a fleet of 3rd party network virtual appliances in AWS")]),e._v(" "),i("li",[e._v("Example: Firewalls, Intrusion Detection and Prevention Systems, Deep Packet Inspection  Systems, payload manipulation, …")]),e._v(" "),i("li",[e._v("Operates at Layer 3 (Network Layer) – IP Packets")]),e._v(" "),i("li",[e._v("Combines the following functions:\n"),i("ul",[i("li",[i("strong",[e._v("Transparent Network Gateway")]),e._v(" – single entry/exit for all traffic")]),e._v(" "),i("li",[i("strong",[e._v("Load Balancer")]),e._v(" – distributes traffic to your virtual appliances")])])]),e._v(" "),i("li",[e._v("Uses the "),i("strong",[e._v("GENEVE")]),e._v(" protocol on port "),i("code",[e._v("6081")])])]),e._v(" "),i("p",[e._v("https://piyushj02.medium.com/aws-gateway-load-balancer-1o1-26d7cf61b798")]),e._v(" "),i("h2",{attrs:{id:"sticky-sessions-session-affinity"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#sticky-sessions-session-affinity"}},[e._v("#")]),e._v(" Sticky Sessions (Session Affinity)")]),e._v(" "),i("ul",[i("li",[e._v("It is possible to implement stickiness so that the same client is always redirected to the same instance behind a load balancer")]),e._v(" "),i("li",[e._v("This doesn't support Gateway Load Balancer")]),e._v(" "),i("li",[e._v("For both CLB & ALB, the “cookie” used for stickiness has an expiration date you control")]),e._v(" "),i("li",[e._v("Enabling stickiness may bring imbalance to the load over the backend EC2 instances")])]),e._v(" "),i("p",[i("strong",[e._v("Use case")]),e._v(": make sure the user doesn’t lose his session data")]),e._v(" "),i("h3",{attrs:{id:"cookie-names"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#cookie-names"}},[e._v("#")]),e._v(" Cookie Names")]),e._v(" "),i("ul",[i("li",[e._v("Application-based Cookies\n"),i("ul",[i("li",[e._v("Custom cookie\n"),i("ul",[i("li",[e._v("Generated by the target")]),e._v(" "),i("li",[e._v("Can include any custom attributes required by the application")]),e._v(" "),i("li",[e._v("Cookie name must be specified individually for each target group")]),e._v(" "),i("li",[e._v("Don’t use "),i("strong",[e._v("AWSALB")]),e._v(", "),i("strong",[e._v("AWSALBAPP")]),e._v(", or "),i("strong",[e._v("AWSALBTG")]),e._v(" (reserved for use by the ELB)")])])]),e._v(" "),i("li",[e._v("Application cookie\n"),i("ul",[i("li",[e._v("Generated by the load balancer")]),e._v(" "),i("li",[e._v("Cookie name is "),i("strong",[e._v("AWSALBAPP")])])])])])]),e._v(" "),i("li",[e._v("Duration-based Cookies\n"),i("ul",[i("li",[e._v("Cookie generated by the load balancer")]),e._v(" "),i("li",[e._v("Cookie name is "),i("strong",[e._v("AWSALB")]),e._v(" for ALB, "),i("strong",[e._v("AWSELB")]),e._v(" for CLB")])])])]),e._v(" "),i("h2",{attrs:{id:"ssl-certificates"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#ssl-certificates"}},[e._v("#")]),e._v(" SSL Certificates")]),e._v(" "),i("ul",[i("li",[e._v("The load balancer uses an X.509 certificate (SSL/TLS server certificate)")]),e._v(" "),i("li",[e._v("You can manage certificates using ACM (AWS Certificate Manager)")]),e._v(" "),i("li",[e._v("You can create upload your own certificates alternatively")]),e._v(" "),i("li",[e._v("HTTPS listener:\n"),i("ul",[i("li",[e._v("You must specify a default certificate")]),e._v(" "),i("li",[e._v("You can add an optional list of certs to support multiple domains")]),e._v(" "),i("li",[i("strong",[e._v("Clients can use SNI (Server Name Indication) to specify the hostname they reach")])]),e._v(" "),i("li",[e._v("Ability to specify a security policy to support older versions of SSL / TLS (legacy clients)")])])])]),e._v(" "),i("h3",{attrs:{id:"server-name-indication-sni"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#server-name-indication-sni"}},[e._v("#")]),e._v(" Server Name Indication (SNI)")]),e._v(" "),i("ul",[i("li",[e._v("SNI solves the problem of loading "),i("strong",[e._v("multiple SSL certificates onto one web server (same public IP)")]),e._v(" (to serve multiple websites)")]),e._v(" "),i("li",[e._v("It’s a “newer” protocol, and requires the client to "),i("strong",[e._v("indicate")]),e._v(" the hostname of the target server in the initial SSL handshake")]),e._v(" "),i("li",[e._v("The server will then find the correct certificate, or return the default one")])]),e._v(" "),i("p",[i("img",{attrs:{src:t(557),alt:"sni"}})]),e._v(" "),i("p",[i("strong",[e._v("Note:")])]),e._v(" "),i("ul",[i("li",[e._v("Only works for ALB & NLB (newer generation), CloudFront")]),e._v(" "),i("li",[e._v("Does not work for CLB (older gen)")])]),e._v(" "),i("h3",{attrs:{id:"add-new-steps"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#add-new-steps"}},[e._v("#")]),e._v(" Add new steps")]),e._v(" "),i("ul",[i("li",[e._v("AWS Certificate Manager to create one, then add listener on port "),i("code",[e._v("443")]),e._v(" in Loadbalancer dashboard")]),e._v(" "),i("li",[e._v("Redirect "),i("code",[e._v("http")]),e._v(" to "),i("code",[e._v("https")]),e._v(" => add listener on port "),i("code",[e._v("80")]),e._v(" choose Action "),i("code",[e._v("Redirect")]),e._v(" => Full URL")])]),e._v(" "),i("h2",{attrs:{id:"deregistration-delay-connection-draining"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#deregistration-delay-connection-draining"}},[e._v("#")]),e._v(" Deregistration Delay / Connection Draining")]),e._v(" "),i("p",[e._v("Same meaning with graceful shutdown.")]),e._v(" "),i("p",[i("strong",[e._v("Feature naming")])]),e._v(" "),i("ul",[i("li",[i("p",[e._v("Connection Draining – for CLB")])]),e._v(" "),i("li",[i("p",[e._v("Deregistration Delay – for ALB & NLB")])]),e._v(" "),i("li",[i("p",[e._v("Time to complete "),i("strong",[e._v("in-flight requests")]),e._v(" while the instance is de-registering or unhealthy")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("Stops sending new requests to the EC2 instance which is de-registering")])])]),e._v(" "),i("li",[i("p",[e._v("Between 1 to 3600 seconds (default: "),i("code",[e._v("300 seconds")]),e._v(")")]),e._v(" "),i("ul",[i("li",[e._v("Can be disabled (set value to 0)")]),e._v(" "),i("li",[e._v("Set to a low value if your requests are short")])])])]),e._v(" "),i("p",[i("a",{attrs:{href:"https://aws.amazon.com/blogs/aws/elb-connection-draining-remove-instances-from-service-with-care/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Connection Draining – Remove Instances From Service With Care"),i("OutboundLink")],1)]),e._v(" "),i("h2",{attrs:{id:"auto-scaling-group-asg"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#auto-scaling-group-asg"}},[e._v("#")]),e._v(" Auto Scaling Group (ASG)")]),e._v(" "),i("h3",{attrs:{id:"attributes"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#attributes"}},[e._v("#")]),e._v(" Attributes")]),e._v(" "),i("p",[i("img",{attrs:{src:t(558),alt:"attrs"}})]),e._v(" "),i("ul",[i("li",[e._v("A Launch Template (older “Launch Configurations” are deprecated)\n"),i("ul",[i("li",[e._v("AMI + Instance Type")]),e._v(" "),i("li",[e._v("EC2 User Data")]),e._v(" "),i("li",[e._v("EBS Volumes")]),e._v(" "),i("li",[e._v("Security Groups")]),e._v(" "),i("li",[e._v("SSH Key Pair")]),e._v(" "),i("li",[e._v("IAM Roles for your EC2 Instances")]),e._v(" "),i("li",[e._v("Network + Subnets Information")]),e._v(" "),i("li",[e._v("Load Balancer Information")])])]),e._v(" "),i("li",[e._v("Min Size / Max Size / Initial Capacity")]),e._v(" "),i("li",[e._v("Scaling Policies")])]),e._v(" "),i("h3",{attrs:{id:"cloudwatch-alarms-scaling"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#cloudwatch-alarms-scaling"}},[e._v("#")]),e._v(" CloudWatch Alarms & Scaling")]),e._v(" "),i("ul",[i("li",[e._v("It is possible to scale an ASG based on CloudWatch alarms")]),e._v(" "),i("li",[e._v("An alarm monitors a metric (such as "),i("strong",[e._v("Average CPU")]),e._v(", or a "),i("strong",[e._v("custom metric")]),e._v(")")]),e._v(" "),i("li",[e._v("Metrics such as Average CPU are computed for the overall ASG instances")]),e._v(" "),i("li",[e._v("Based on the alarm:\n"),i("ul",[i("li",[e._v("We can create scale-out policies (increase the number of instances)")]),e._v(" "),i("li",[e._v("We can create scale-in policies (decrease the number of instances)")])])])]),e._v(" "),i("h3",{attrs:{id:"dynamic-scaling-policies"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-scaling-policies"}},[e._v("#")]),e._v(" Dynamic Scaling Policies")]),e._v(" "),i("ul",[i("li",[i("strong",[e._v("Target Tracking Scaling")]),e._v(" "),i("ul",[i("li",[e._v("Most simple and easy to set-up")]),e._v(" "),i("li",[e._v("Example: I want the average ASG CPU to stay at around 40%")])])]),e._v(" "),i("li",[i("strong",[e._v("Simple / Step Scaling")]),e._v(" "),i("ul",[i("li",[e._v("When a CloudWatch alarm is triggered (example CPU > 70%), then add 2 units")]),e._v(" "),i("li",[e._v("When a CloudWatch alarm is triggered (example CPU < 30%), then remove 1")])])]),e._v(" "),i("li",[i("strong",[e._v("Scheduled Actions")]),e._v(" "),i("ul",[i("li",[e._v("Anticipate a scaling based on known usage patterns")]),e._v(" "),i("li",[e._v("Example: increase the min capacity to 10 at 5 pm on Fridays")])])])]),e._v(" "),i("h3",{attrs:{id:"good-metrics-to-scale-on"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#good-metrics-to-scale-on"}},[e._v("#")]),e._v(" Good metrics to scale on")]),e._v(" "),i("ul",[i("li",[i("strong",[e._v("CPUUtilization")]),e._v(": Average CPU utilization across your instances")]),e._v(" "),i("li",[i("strong",[e._v("RequestCountPerTarget")]),e._v(": to make sure the number of requests per EC2 instances is stable")]),e._v(" "),i("li",[i("strong",[e._v("Average Network In / Out")]),e._v(" (if you’re application is network bound)")]),e._v(" "),i("li",[i("strong",[e._v("Any custom metric")]),e._v(" (that you push using CloudWatch)")])]),e._v(" "),i("h3",{attrs:{id:"predictive-scaling"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#predictive-scaling"}},[e._v("#")]),e._v(" Predictive Scaling")]),e._v(" "),i("p",[e._v("Predictive scaling: continuously forecast load and schedule scaling ahead")]),e._v(" "),i("p",[i("img",{attrs:{src:t(559),alt:"predictive"}})]),e._v(" "),i("h3",{attrs:{id:"scaling-cooldowns"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#scaling-cooldowns"}},[e._v("#")]),e._v(" Scaling Cooldowns")]),e._v(" "),i("ul",[i("li",[e._v("After a scaling activity happens, you are in the "),i("strong",[e._v("cooldown period (default 300 seconds)")])]),e._v(" "),i("li",[e._v("During the cooldown period, the ASG will not launch or terminate additional instances (to allow for metrics to stabilize)")]),e._v(" "),i("li",[i("strong",[e._v("Advice")]),e._v(": Use a "),i("code",[e._v("ready-to-use AMI")]),e._v(" to reduce configuration time in order to be serving request fasters and reduce the cooldown period")])]),e._v(" "),i("h2",{attrs:{id:"pricing"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#pricing"}},[e._v("#")]),e._v(" Pricing")]),e._v(" "),i("ul",[i("li",[e._v("Pay for each running / partial running hour")]),e._v(" "),i("li",[e._v("Number of LCU used per hour\n"),i("ul",[i("li",[e._v("ALB: LCU")]),e._v(" "),i("li",[e._v("NLB: NLCU")]),e._v(" "),i("li",[e._v("GLB: GLCU")])])]),e._v(" "),i("li",[e._v("For GLB, pay for GWLBE (AWS PrivateLink)")]),e._v(" "),i("li",[e._v("Free Tier:\n"),i("ul",[i("li",[e._v("12 months, 750 hours shared per month for CLB, ALB")]),e._v(" "),i("li",[e._v("15GB data for CLB, 15 LCUs for ALB")])])])]),e._v(" "),i("h3",{attrs:{id:"lcu"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#lcu"}},[e._v("#")]),e._v(" LCU")]),e._v(" "),i("ul",[i("li",[e._v("Dimensions: Charge at highest elements\n"),i("ul",[i("li",[e._v("New connections per hour")]),e._v(" "),i("li",[e._v("Active connections per hour")]),e._v(" "),i("li",[e._v("Processed bytes per hour")]),e._v(" "),i("li",[e._v("Rule evaluations")])])]),e._v(" "),i("li",[e._v("1 LCU:\n"),i("ul",[i("li",[e._v("25 new connections per second")]),e._v(" "),i("li",[e._v("3,000 active connections per minutes")]),e._v(" "),i("li",[e._v("1GB data processed for Amazon EC2, containers or IP; 0.4GB data processed for Lambda.")]),e._v(" "),i("li",[e._v("1,000 rule evaluation per second")])])])]),e._v(" "),i("h3",{attrs:{id:"example"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),i("p",[e._v("An application receives an average of 500 new connections per seconds, 10,000 active connections per minute.")]),e._v(" "),i("p",[e._v("Request/response messages has 8KB.")]),e._v(" "),i("p",[e._v("You configured 20 rules on ALB for validation.")]),e._v(" "),i("p",[e._v("System is served by 70% EC2 and 30% Lambda.")]),e._v(" "),i("p",[e._v("As a Solution Architect, what is the pricing estimation for this scenario?")]),e._v(" "),i("p",[i("strong",[e._v("Analysis:")])]),e._v(" "),i("ul",[i("li",[e._v("New connections per second (25): 500 => 20 LCU")]),e._v(" "),i("li",[e._v("Active connections per minute (3,000): 10,000 => 3.33 LCU")]),e._v(" "),i("li",[e._v("Proceed data per hour (1GB EC2, 0.4GB Lambda): 10.08GB for EC2, 4.32GB for Lambda => LCU = 10.08 + 10.8 = 20.88 LCU")]),e._v(" "),i("li",[e._v("Rule validation per second (1,000): 20* 500 = 10,000 => LCU = 10")])]),e._v(" "),i("p",[i("strong",[e._v("Pricing (Singapore):")])]),e._v(" "),i("ul",[i("li",[e._v("Provision hour: $0.0252")]),e._v(" "),i("li",[e._v("LCU = 20.88 * $0.008 = $0.16704")]),e._v(" "),i("li",[e._v("Hourly: $0.19224 => Monthly: $138.41")])]),e._v(" "),i("p",[i("a",{attrs:{href:"https://aws.amazon.com/elasticloadbalancing/pricing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Detail"),i("OutboundLink")],1)]),e._v(" "),i("h2",{attrs:{id:"others"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#others"}},[e._v("#")]),e._v(" Others")]),e._v(" "),i("h3",{attrs:{id:"elb-quotas"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#elb-quotas"}},[e._v("#")]),e._v(" ELB Quotas")]),e._v(" "),i("ul",[i("li",[e._v("ELB per Region: 50")]),e._v(" "),i("li",[e._v("Target Group per Region: 3,000")]),e._v(" "),i("li",[e._v("Listeners per LB: 50")]),e._v(" "),i("li",[e._v("Targets per LB: 100")]),e._v(" "),i("li",[e._v("Security Group per LB: 5")]),e._v(" "),i("li",[e._v("Rules per LB (not counting default rules): 100")]),e._v(" "),i("li",[e._v("Certificates per LB (not counting default cer): 25")]),e._v(" "),i("li",[e._v("LBs per Target group: 1")]),e._v(" "),i("li",[e._v("EC2 / IP per Target group: 1,000")]),e._v(" "),i("li",[e._v("Lambda per Target group: 1")])]),e._v(" "),i("p",[i("a",{attrs:{href:"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-limits.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Detail"),i("OutboundLink")],1)]),e._v(" "),i("h3",{attrs:{id:"alias-dns-name"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#alias-dns-name"}},[e._v("#")]),e._v(" Alias DNS name:")]),e._v(" "),i("p",[e._v("Use Route53 Service to create an alias for url (DNS Name generated by AWS)")]),e._v(" "),i("h2",{attrs:{id:"refs"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#refs"}},[e._v("#")]),e._v(" Refs")]),e._v(" "),i("ul",[i("li",[e._v("AMI: Amazon Machine Image")]),e._v(" "),i("li",[e._v("LCU: Load Balancer Capacity Units")]),e._v(" "),i("li",[e._v("VIP: Virtual IP Load Balancing")]),e._v(" "),i("li",[e._v("ALB: Application Load Balancer")]),e._v(" "),i("li",[e._v("NLB: Network Load Balancer")]),e._v(" "),i("li",[e._v("GLB: Gateway Load Balancer")]),e._v(" "),i("li",[e._v("SNI: Server Name Indication")])]),e._v(" "),i("p",[e._v("https://jayendrapatil.com/tag/elb-vs-alb-vs-nlb/")])])}),[],!1,null,null,null);a.default=r.exports},554:function(e,a,t){e.exports=t.p+"assets/img/sg-4lb.8c52a9f9.png"},555:function(e,a,t){e.exports=t.p+"assets/img/sg-4app.ef530fcd.png"},556:function(e,a,t){e.exports=t.p+"assets/img/gwlb.d5fb5b04.png"},557:function(e,a,t){e.exports=t.p+"assets/img/sni.fb482471.png"},558:function(e,a,t){e.exports=t.p+"assets/img/asg-attrs.ed08cc16.png"},559:function(e,a,t){e.exports=t.p+"assets/img/Predictive-Scaling.1b44a7ca.png"}}]);