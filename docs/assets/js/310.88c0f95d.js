(window.webpackJsonp=window.webpackJsonp||[]).push([[310],{903:function(t,a,s){"use strict";s.r(a);var n=s(7),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"google-app-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#google-app-script"}},[t._v("#")]),t._v(" Google App Script")]),t._v(" "),s("p",[t._v("Mình có đề cập sử dụng "),s("strong",[t._v("Google Sheet")]),t._v(" như là công cụ để "),s("RouterLink",{attrs:{to:"/common/crawl.html#google-sheet"}},[t._v("crawl dữ liệu")]),t._v(".")],1),t._v(" "),s("p",[t._v("Dạng kiểu bạn có thể viết "),s("code",[t._v("VB")]),t._v(" trong "),s("code",[t._v("Excel")]),t._v(".")]),t._v(" "),s("p",[t._v("Thì đây với cương vị là một JS developer không biết cái tool này thì hơi phí.")]),t._v(" "),s("h2",{attrs:{id:"yeah-start-with-why"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yeah-start-with-why"}},[t._v("#")]),t._v(" Yeah, start with "),s("code",[t._v("Why")])]),t._v(" "),s("p",[s("strong",[t._v("Why?")])]),t._v(" "),s("ul",[s("li",[t._v("Xử lý data, lọc data, format lại data")]),t._v(" "),s("li",[t._v("Xử lý công thức phức tạp không thể nào sử dụng Formula bình thường")]),t._v(" "),s("li",[t._v("Nhiều feature hay: đặt lịch tự động chạy script, tự động trigger script theo sự kiện, viết bằng JS nè, ...")])]),t._v(" "),s("p",[s("strong",[t._v("How?")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("Trên thanh công cụ")]),t._v(" > "),s("code",[t._v("Trình chỉnh sửa tập lệnh")])]),t._v(" "),s("li",[t._v("Đặt tên dự án + Viết Code")]),t._v(" "),s("li",[s("code",[t._v("Chạy")]),t._v(" > "),s("code",[t._v("Chạy hàm")]),t._v(" > "),s("code",[t._v("Chọn")]),t._v(" > "),s("code",[t._v("Xem kết quả")])])]),t._v(" "),s("p",[s("strong",[t._v("Tài liệu nghiên cứu")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://developers.google.com/apps-script/guides/triggers/events?csw=1",target:"_blank",rel:"noopener noreferrer"}},[t._v("Guide của GG"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developers.google.com/apps-script/reference/spreadsheet/range",target:"_blank",rel:"noopener noreferrer"}},[t._v("API cửu chương cũng từ GG"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("Rất nhiều thứ hay ho ở đây như:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("UrlFetchApp")]),t._v(" để fetch HTML về nè,")]),t._v(" "),s("li",[s("code",[t._v("Cheerio")]),t._v(" để xử lý HTML string như jQuery xử lý DOM vậy")])]),t._v(" "),s("h2",{attrs:{id:"get-sheet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-sheet"}},[t._v("#")]),t._v(" Get Sheet")]),t._v(" "),s("p",[t._v("Để xử lý dữ liệu, trước hết phải biết thao tác trên trang nào, dưới đây là 2 cái mình hay dùng")]),t._v(" "),s("h3",{attrs:{id:"sheet-đang-active"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sheet-đang-active"}},[t._v("#")]),t._v(" Sheet đang active")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" activeSheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SpreadsheetApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveSpreadsheet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveSheet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"sheet-qua-ten"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sheet-qua-ten"}},[t._v("#")]),t._v(" Sheet qua tên")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" sheetName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DS Lớp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" activeSheet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SpreadsheetApp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveSpreadsheet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSheetByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sheetName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"get-set-cell-data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-set-cell-data"}},[t._v("#")]),t._v(" Get & Set Cell Data")]),t._v(" "),s("p",[t._v("Sau khi lấy được sheet thì cần get / set data vào Cell. Viết nó thành helpers để sau này nhìn tham số mà truyền vào thôi.")]),t._v(" "),s("p",[t._v("Tại vì cái getRange origin nó quá phức tạp đi =)) mình thì lười mở API lên đọc. Thế thôi, với lại cũng khá ý nghĩa")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCellValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rowIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rowIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCellValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rowIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rowIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("em",[t._v("Note")]),t._v(": "),s("code",[t._v("rowIndex")]),t._v(", "),s("code",[t._v("colIndex")]),t._v(" đều được đếm từ 1 nhé. Không phải số 0 giống mảng trong lập trình đâu.")]),t._v(" "),s("h2",{attrs:{id:"ham-tien-ich-khac"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ham-tien-ich-khac"}},[t._v("#")]),t._v(" Hàm tiện ích khác")]),t._v(" "),s("h3",{attrs:{id:"getmaxrows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getmaxrows"}},[t._v("#")]),t._v(" getMaxRows")]),t._v(" "),s("p",[t._v("Lấy số dòng của Sheet")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMaxRows")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"getdatarange"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getdatarange"}},[t._v("#")]),t._v(" getDataRange")]),t._v(" "),s("p",[t._v("Lấy tất cả data. Có thể parse nó qua thành JSON các kiểu =))")]),t._v(" "),s("p",[t._v("Nhưng mà parse xong thì đừng set nó vào Cell, vì mỗi Cell chiều dài có giới hạn")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDataRange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValues")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" jsonData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),s("h2",{attrs:{id:"len-lich"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#len-lich"}},[t._v("#")]),t._v(" Lên lịch")]),t._v(" "),s("ul",[s("li",[t._v("Dưới thanh công cụ trong trình chỉnh sửa Code, đó là thanh công cụ thứ 2 =))")]),t._v(" "),s("li",[t._v("Trên thanh đó có nút "),s("code",[t._v("Save")]),t._v(" dạng icon")]),t._v(" "),s("li",[t._v("Cạnh nút ấy, bên phải có cái icon "),s("code",[t._v("Đồng hồ")]),t._v(", click vào đấy bạn sẽ đến nơi muốn đến")]),t._v(" "),s("li",[t._v("Tại ấy, tìm "),s("code",[t._v("Tạo trình kích hoạt mới")])]),t._v(" "),s("li",[t._v("Mò tiếp =))")])]),t._v(" "),s("h2",{attrs:{id:"to-be-continued"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#to-be-continued"}},[t._v("#")]),t._v(" To be continued")]),t._v(" "),s("p",[t._v("... Sau này update thêm")])])}),[],!1,null,null,null);a.default=e.exports}}]);