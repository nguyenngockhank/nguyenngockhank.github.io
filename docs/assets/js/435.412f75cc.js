(window.webpackJsonp=window.webpackJsonp||[]).push([[435],{1564:function(t,e,a){"use strict";a.r(e);var s=a(7),o=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"streaming-protocols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#streaming-protocols"}},[t._v("#")]),t._v(" Streaming Protocols")]),t._v(" "),a("ul",[a("li",[t._v("RTMP: Real-Time Messaging Protocol")]),t._v(" "),a("li",[t._v("RTSP: Real Time Streaming Protocol")]),t._v(" "),a("li",[t._v("HLS: HTTP Live Streaming")]),t._v(" "),a("li",[t._v("RTP: Real-time Transport Protocol")]),t._v(" "),a("li",[t._v("CMAF: Common Media Application Format")])]),t._v(" "),a("h2",{attrs:{id:"traditional-video-streaming-protocols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#traditional-video-streaming-protocols"}},[t._v("#")]),t._v(" Traditional Video Streaming Protocols")]),t._v(" "),a("p",[t._v("Traditional streaming protocols, such as RTSP and RTMP, support low-latency streaming. But they aren’t natively supported on most endpoints (e.g., browsers, mobile devices, computers, and televisions). Today, these streaming formats work best for transporting video between and IP camera or encoder and a dedicated media server.")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.wowza.com/wp-content/uploads/latency-continuum-2021-with-protocols-700x300-1.webp",alt:"streamming latency"}})]),t._v(" "),a("p",[t._v("As shown above, RTMP delivers video at roughly the same pace as a cable broadcast — in just over five seconds. RTSP/RTP is even quicker at around two seconds. Both formats achieve such speed by transmitting the data using a firehose approach rather than requiring local download or caching. But because very few players support RTMP and RTSP, they aren’t optimized for great viewing experiences at scale. Many broadcasters choose to transport live streams to the media server using a stateful protocol like RTMP. From there, they can transcode it into an HTTP-based technology for multi-device delivery.")]),t._v(" "),a("h2",{attrs:{id:"adobe-rtmp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adobe-rtmp"}},[t._v("#")]),t._v(" Adobe RTMP")]),t._v(" "),a("p",[t._v("Adobe designed the RTMP specification at the dawn of streaming. The protocol could transport audio and video data between a dedicated streaming server and the Adobe Flash Player. Reliable and efficient, this worked great for live streaming. But open standards and adaptive bitrate streaming eventually edged RTMP out. The writing on the wall came when Adobe announced the death of Flash — which officially ended in 2020.")]),t._v(" "),a("p",[t._v("While Flash’s end-of-life date was overdue, the same cannot be said for using RTMP for video contribution. RTMP encoders are still a go-to for many content producers, even though the proprietary protocol has fallen out of favor for last-mile delivery.")]),t._v(" "),a("p",[t._v("In fact, in our 2021 Video Streaming Latency Report, more than 76% of content distributors indicated they use RTMP for ingest.")]),t._v(" "),a("p",[a("strong",[t._v("Which streaming formats are you currently using for ingest?")]),t._v(" "),a("img",{attrs:{src:"https://www.wowza.com/wp-content/uploads/Low-Latency-Graphs_Q8-700x461.png",alt:"img"}})]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Video Codecs")]),t._v(": H.264, VP8, VP6, Sorenson Spark®, Screen Video v1 & v2")]),t._v(" "),a("li",[a("strong",[t._v("Audio Codecs")]),t._v(": AAC, AAC-LC, HE-AAC+ v1 & v2, MP3, Speex, Opus, Vorbis")]),t._v(" "),a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Not widely supported (Flash Player, Adobe AIR, RTMP-compatible players)")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Low-latency and requires no buffering")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": Not optimized for quality of experience or scalability")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 5 seconds")]),t._v(" "),a("li",[a("strong",[t._v("Variant Formats")]),t._v(": RTMPT (tunneled through HTTP), RTMPE (encrypted), RTMPTE (tunneled and encrypted), RTMPS (encrypted over SSL), RTMFP (travels over UDP instead of TCP)")])]),t._v(" "),a("h3",{attrs:{id:"rtsp-rtp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rtsp-rtp"}},[t._v("#")]),t._v(" RTSP/RTP")]),t._v(" "),a("p",[t._v("Like RTMP, RTSP/RTP describes an old-school technology used for video contribution. RTSP and RTP are often used interchangeably. But to be clear: RTSP is a presentation-layer protocol that lets end users command media servers via pause and play capabilities, whereas RTP is the transport protocol used to move said data.")]),t._v(" "),a("p",[t._v("Android and iOS devices don’t have RTSP-compatible players out of the box, making this another protocol that’s rarely used for playback. That said, RTSP remains standard in many surveillance and closed-circuit television (CCTV) architectures. Why? The reason is simple. RTSP support is still ubiquitous in IP cameras.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Video Codecs")]),t._v(": H.265 (preview), H.264, VP9, VP8")]),t._v(" "),a("li",[a("strong",[t._v("Audio Codecs")]),t._v(": AAC, AAC-LC, HE-AAC+ v1 & v2, MP3, Speex, Opus, Vorbis")]),t._v(" "),a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Not widely supported (Quicktime Player and other RTSP/RTP-compliant players, VideoLAN VLC media player, 3Gpp-compatible mobile devices)")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Low-latency and supported by most IP cameras")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": No longer used for video delivery to end users")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 2 seconds")]),t._v(" "),a("li",[a("strong",[t._v("Variant Formats")]),t._v(": The entire stack of RTP, RTCP (Real-Time Control Protocol), and RTSP is often referred to as RTSP")])]),t._v(" "),a("h2",{attrs:{id:"adaptive-http-based-streaming-protocols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adaptive-http-based-streaming-protocols"}},[t._v("#")]),t._v(" Adaptive HTTP-Based Streaming Protocols")]),t._v(" "),a("p",[t._v("Streams deployed over HTTP are not technically “streams.” Rather, they’re progressive downloads sent via regular web servers. Using adaptive bitrate streaming, HTTP-based protocols deliver the best video quality and viewer experience possible — no matter the connection, software, or device. Some of the most common HTTP-based protocols include MPEG-DASH and Apple’s HLS.")]),t._v(" "),a("h3",{attrs:{id:"apple-hls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apple-hls"}},[t._v("#")]),t._v(" Apple HLS")]),t._v(" "),a("p",[t._v("Since Apple is a major player in the world of internet-connected devices, it follows that Apple’s HLS protocol rules the digital video landscape. For one, the protocol supports adaptive bitrate streaming, which is key to viewer experience. More importantly, a stream delivered via HLS will play back on the majority of devices — thereby ensuring accessibility to a large audience.")]),t._v(" "),a("p",[t._v("HLS support was initially limited to iOS devices such as iPhones and iPads, but native support has since been added to a wide range of platforms. All Google Chrome browsers, as well as Android, Linux, Microsoft, and MacOS devices, can play streams delivered using HLS.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Video Codecs")]),t._v(": H.265, H.264")]),t._v(" "),a("li",[a("strong",[t._v("Audio Codecs")]),t._v(": AAC-LC, HE-AAC+ v1 & v2, xHE-AAC, Apple Lossless, FLAC")]),t._v(" "),a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Great (All Google Chrome browsers; Android, Linux, Microsoft, and MacOS devices; several set-top boxes, smart TVs, and other players)")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Adaptive bitrate and widely supported")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": Quality of experience is prioritized over low latency")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 6-30 seconds (lower latency only possible when tuned)")]),t._v(" "),a("li",[a("strong",[t._v("Variant")]),t._v(" Formats: Low-Latency HLS (see below), PHLS (Protected HTTP Live Streaming)")])]),t._v(" "),a("h3",{attrs:{id:"low-latency-hls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#low-latency-hls"}},[t._v("#")]),t._v(" Low-Latency HLS")]),t._v(" "),a("p",[t._v("Low-Latency HLS (LL-HLS) is the latest and greatest technology when it comes to low-latency streaming. The proprietary protocol promises to deliver sub-three-second streams globally. It also offers backward compatibility to existing clients.")]),t._v(" "),a("p",[t._v("In other words, it’s designed to deliver the same simplicity, scalability, and quality as HLS — while significantly shrinking the latency. At Wowza, we call this combination the streaming trifecta.")]),t._v(" "),a("p",[t._v("Even so, successful deployments of Low-Latency HLS require integration from vendors across the video delivery ecosystem. Support is still lacking, and large-scale deployments of Low-Latency HLS are few and far between.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Any players that aren’t optimized for Low-Latency HLS can fall back to standard (higher-latency) HLS behavior\n"),a("ul",[a("li",[t._v("HLS-compatible devices include MacOS, Microsoft, Android, and Linux devices; all Google Chrome browsers; several set-top boxes, smart TVs, and other players")])])]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Low latency, scalability, and high quality… Oh, and did we mention backward compatibility?")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": As an emerging spec, vendors are still implementing support")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 2 seconds or less")])]),t._v(" "),a("h3",{attrs:{id:"mpeg-dash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mpeg-dash"}},[t._v("#")]),t._v(" MPEG-DASH")]),t._v(" "),a("p",[t._v("MPEG-DASH is a vendor-independent alternative to HLS. Basically, with DASH you get a non-proprietary option that ensures the same scalability and quality. But because Apple tends to prioritize its own tech stack, support for DASH plays second fiddle in the slew of Apple devices out there.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Video Codecs")]),t._v(": Codec-agnostic")]),t._v(" "),a("li",[a("strong",[t._v("Audio Codecs")]),t._v(": Codec-agnostic")]),t._v(" "),a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Good (All Android devices; most post-2012 Samsung, Philips, Panasonic, and Sony TVs; Chrome, Safari, and Firefox browsers)")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Vendor-independent, international standard for adaptive bitrate")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": Not supported by iOS or Apple TV")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 6-30 seconds (lower latency only possible when tuned)")]),t._v(" "),a("li",[a("strong",[t._v("Variant Formats")]),t._v(": MPEG-DASH CENC (Common Encryption)")])]),t._v(" "),a("h3",{attrs:{id:"low-latency-cmaf-for-dash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#low-latency-cmaf-for-dash"}},[t._v("#")]),t._v(" Low-Latency CMAF for DASH")]),t._v(" "),a("p",[t._v("Low-latency CMAF for DASH is another emerging technology for speeding up HTTP-based video delivery. Although it’s still in its infancy, the technology shows promise in delivering superfast video at scale by using shorter data segments. That said, many vendors have prioritized support for Low-Latency HLS over that of low-latency CMAF for DASH.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Any players that aren’t optimized for low-latency CMAF for DASH can fall back to standard (higher-latency) DASH behavior")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Low latency meets HTTP-based streaming")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": As an emerging spec, vendors are still implementing support")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 3 seconds or less")])]),t._v(" "),a("h3",{attrs:{id:"microsoft-smooth-streaming"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#microsoft-smooth-streaming"}},[t._v("#")]),t._v(" Microsoft Smooth Streaming")]),t._v(" "),a("p",[t._v("Microsoft developed Microsoft Smooth Streaming in 2008 for use with Silverlight player applications. It enables adaptive delivery to all Microsoft devices. The protocol can’t compete with other HTTP-based formats and is falling out of use. In fact, in our 2021 Video Streaming Latency Report, only 5 percent of respondents were using Smooth Streaming.")]),t._v(" "),a("p",[a("strong",[t._v("Which streaming formats are you currently using?")]),t._v(" "),a("img",{attrs:{src:"https://www.wowza.com/wp-content/uploads/Low-Latency-Graphs_Q9-1.png",alt:"IMG"}})]),t._v(" "),a("ul",[a("li",[t._v("Video Codecs: H.264, VC-1")]),t._v(" "),a("li",[t._v("Audio Codecs: AAC, MP3, WMA")]),t._v(" "),a("li",[t._v("Playback Compatibility: Good (Microsoft and iOS devices, Xbox, many smart TVs, Silverlight player-enabled browsers)")]),t._v(" "),a("li",[t._v("Benefits: Adaptive bitrate and supported by iOS")]),t._v(" "),a("li",[t._v("Drawbacks: Proprietary technology, doesn’t compete with HLS and DASH")]),t._v(" "),a("li",[t._v("Latency: 6-30 seconds (lower latency only possible when tuned)")])]),t._v(" "),a("h3",{attrs:{id:"adobe-hds"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adobe-hds"}},[t._v("#")]),t._v(" Adobe HDS")]),t._v(" "),a("p",[t._v("HDS was developed for use with Flash Player as the first adaptive bitrate protocol. Because Flash is no more, it’s also slowly dying. Don’t believe us? Just take a look at the graph above.")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Video Codecs")]),t._v(": H.264, VP6")]),t._v(" "),a("li",[a("strong",[t._v("Audio Codecs")]),t._v(": AAC, MP3")]),t._v(" "),a("li",[a("strong",[t._v("Playback Compatibility")]),t._v(": Not widely supported (Flash Player, Adobe AIR)")]),t._v(" "),a("li",[a("strong",[t._v("Benefits")]),t._v(": Adaptive bitrate technology for Flash")]),t._v(" "),a("li",[a("strong",[t._v("Drawbacks")]),t._v(": Proprietary technology with lacking support")]),t._v(" "),a("li",[a("strong",[t._v("Latency")]),t._v(": 6-30 seconds (lower latency only possible when tuned)")])]),t._v(" "),a("h2",{attrs:{id:"new-technologies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#new-technologies"}},[t._v("#")]),t._v(" New Technologies")]),t._v(" "),a("p",[t._v("Last but not least, new technologies like WebRTC and SRT promise to change the landscape. Similar to low-latency CMAF for DASH and Apple Low-Latency HLS, these protocols were designed with latency in mind.")]),t._v(" "),a("h3",{attrs:{id:"srt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#srt"}},[t._v("#")]),t._v(" SRT")]),t._v(" "),a("p",[t._v("This open-source protocol is recognized as a proven alternative to proprietary transport technologies — helping to deliver reliable streams, regardless of network quality. It competes directly with RTMP and RTSP as a first-mile solution, but it’s still being adopted as encoders, decoders, and players add support.")]),t._v(" "),a("p",[t._v("From recovering lost packets to preserving timing behavior, SRT was designed to solve the challenges of video contribution and distribution across the public internet. And it’s quickly taking the industry by storm. One interactive use case for which SRT proved instrumental was the 2020 virtual NFL draft.  The NFL used this game-changing technology to connect 600 live feeds for the first entirely virtual event.")]),t._v(" "),a("ul",[a("li",[t._v("Video Codecs: Codec-agnostic")]),t._v(" "),a("li",[t._v("Audio Codecs: Codec-agnostic")]),t._v(" "),a("li",[t._v("Playback Compatibility: Limited (VLC Media Player, FFPlay, Haivision Play Pro, Haivision Play, Larix Player, Brightcove)")]),t._v(" "),a("li",[t._v("Benefits: High-quality, low-latency video over suboptimal networks")]),t._v(" "),a("li",[t._v("Drawbacks: Not widely supported for video playback")]),t._v(" "),a("li",[t._v("Latency: 3 seconds or less, tunable based on how much latency you want to trade for packet loss")])]),t._v(" "),a("h3",{attrs:{id:"webrtc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc"}},[t._v("#")]),t._v(" WebRTC")]),t._v(" "),a("p",[t._v("As the speediest technology available, WebRTC delivers near-instantaneous voice and video streaming to and from any major browser. It can also be used end-to-end and thus competes with ingest and delivery protocols. The framework was designed for pure chat-based applications, but it’s now finding its way into more diverse use cases.")]),t._v(" "),a("p",[t._v("Scalability remains a challenge with WebRTC, though, so you’ll need to use a solution like Wowza’s Real-Time Streaming at Scale feature to overcome this. The solution deploys WebRTC across a custom CDN to provide near-limitless scale. This allows broadcasters to reach a million viewers with sub-500 ms delivery — a once impossible feat.")]),t._v(" "),a("p",[a("strong",[t._v("Workflow: Real-Time Streaming at Scale for Wowza Video")]),t._v(" "),a("img",{attrs:{src:"https://www.wowza.com/wp-content/uploads/Real-Time-Streaming-Wowza-Video-Workflow-1920x605-1-1-700x221.png",alt:"img"}})]),t._v(" "),a("ul",[a("li",[t._v("Video Codecs: H.264, VP8, VP9")]),t._v(" "),a("li",[t._v("Audio Codecs: Opus, iSAC, iLBC")]),t._v(" "),a("li",[t._v("Playback Compatibility: Chrome, Firefox, and Safari support WebRTC without any plugin")]),t._v(" "),a("li",[t._v("Benefits: Super fast and browser-based")]),t._v(" "),a("li",[t._v("Drawbacks: Designed for video conferencing and not scale")]),t._v(" "),a("li",[t._v("Latency: Sub-500-millisecond delivery")])]),t._v(" "),a("h3",{attrs:{id:"considerations-when-choosing-a-streaming-protocol"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#considerations-when-choosing-a-streaming-protocol"}},[t._v("#")]),t._v(" Considerations When Choosing a Streaming Protocol")]),t._v(" "),a("p",[t._v("Selecting the right media streaming protocol starts with defining what you’re trying to achieve. Latency, playback compatibility, and viewing experience can all be impacted. What’s more, content distributors don’t always stick with the same protocol from capture to playback. Many broadcasters use RTMP to get from the encoder to server and then transcode the stream into an adaptive HTTP-based format.")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.wowza.com/wp-content/uploads/Basic-RTMP-to-HLS-Workflow-700x371.png",alt:"img"}})]),t._v(" "),a("p",[t._v("Media streaming protocols differ in the following areas:")]),t._v(" "),a("p",[t._v("First-mile contribution vs. last-mile delivery")]),t._v(" "),a("ul",[a("li",[t._v("Playback support")]),t._v(" "),a("li",[t._v("Encoder support")]),t._v(" "),a("li",[t._v("Scalability")]),t._v(" "),a("li",[t._v("Latency")]),t._v(" "),a("li",[t._v("Quality of experience (adaptive bitrate enabled, etc.)")]),t._v(" "),a("li",[t._v("Security\nBy prioritizing the above considerations, it’s easy to narrow down what’s best for you.")])]),t._v(" "),a("h2",{attrs:{id:"contribution-vs-delivery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contribution-vs-delivery"}},[t._v("#")]),t._v(" Contribution vs. Delivery")]),t._v(" "),a("p",[t._v("RTMP and SRT are great bets for first-mile contribution, while both DASH and HLS lead the way when it comes to playback. On the flip side, RTMP has fallen entirely out of favor for delivery, and HLS isn’t an ideal ingest format. That’s why most content distributors rely on a media server or cloud-based video platform to transcode their content from one protocol to another.")]),t._v(" "),a("h3",{attrs:{id:"playback-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playback-support"}},[t._v("#")]),t._v(" Playback Support")]),t._v(" "),a("p",[t._v("What’s the point of distributing a stream if viewers can’t access it? Lacking playback support is the reason RTMP no longer plays a role in delivery to end users. And ubiquitous playback support is the reason why HLS is the most popular protocol today.")]),t._v(" "),a("h3",{attrs:{id:"encoder-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#encoder-support"}},[t._v("#")]),t._v(" Encoder Support")]),t._v(" "),a("p",[t._v("The inverse of playback support is encoder support. RTMP maintains a stronghold despite its many flaws due to the prevalence of RTMP encoders already out there. Similarly, RTSP has stayed relevant in the surveillance industry because it’s the protocol of choice for IP cameras.")]),t._v(" "),a("p",[t._v("WebRTC is unique in that it can be used for browser-based publishing and playback without any additional technologies, enabling simple streaming for use cases that don’t require production-quality encoders and cameras.")]),t._v(" "),a("h3",{attrs:{id:"scalability"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scalability"}},[t._v("#")]),t._v(" Scalability")]),t._v(" "),a("p",[t._v("HLS is synonymous with scalability. The widely-supported HTTP-based protocol leverages web servers to reach any device worth reaching today. But what it delivers in scalability, it lacks in terms of latency. That’s because latency and scalability have traditionally been at odds with one another. New technologies like Real-Time Streaming at Scale, however, resolve this polarity.")]),t._v(" "),a("h3",{attrs:{id:"latency"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#latency"}},[t._v("#")]),t._v(" Latency")]),t._v(" "),a("p",[t._v("Low-Latency HLS, low-latency CMAF for DASH, and WebRTC were all designed with speedy delivery in mind. Anyone deploying interactive video environments should limit themselves to one of these three delivery protocols.")]),t._v(" "),a("h2",{attrs:{id:"video-stream"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#video-stream"}},[t._v("#")]),t._v(" Video stream")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/video"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ensure there is a range given for the video")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" range "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Requires Range header"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get video stats (about 61MB)")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" videoPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bigbuck.mp4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" videoSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("statSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bigbuck.mp4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Parse Range")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Example: "bytes=32324-"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CHUNK_SIZE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1MB")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\D")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" end "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("min")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CHUNK_SIZE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" videoSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create headers")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" contentLength "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" end "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" headers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Range"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("bytes ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("end"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("videoSize"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Accept-Ranges"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bytes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Length"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" contentLength"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"video/mp4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// HTTP Status 206 for Partial Content")]),t._v("\n  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("206")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// create video read stream for this particular chunk")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" videoStream "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReadStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("videoPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Stream the video chunk to the client")]),t._v("\n  videoStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("a",{attrs:{href:"https://github.com/Abdisalan/blog-code-examples/blob/main/http-video-stream/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("http-video-stream"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"webrtc-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc-2"}},[t._v("#")]),t._v(" WebRTC")]),t._v(" "),a("p",[t._v("https://www.youtube.com/watch?v=WmR9IMUD_CY")]),t._v(" "),a("h2",{attrs:{id:"prevent-download"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prevent-download"}},[t._v("#")]),t._v(" Prevent download")]),t._v(" "),a("p",[t._v("https://stackoverflow.com/questions/9756837/prevent-html5-video-from-being-downloaded-right-click-saved")]),t._v(" "),a("p",[t._v("http://html5doctor.com/video-canvas-magic/")])])}),[],!1,null,null,null);e.default=o.exports}}]);