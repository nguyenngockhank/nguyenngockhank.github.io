(window.webpackJsonp=window.webpackJsonp||[]).push([[518],{1758:function(t,e,s){"use strict";s.r(e);var a=s(7),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kafka-schema-registry"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka-schema-registry"}},[t._v("#")]),t._v(" Kafka Schema registry")]),t._v(" "),s("p",[t._v("In event-driven architecture, a schema registry is a crucial component that helps manage the schemas of events exchanged between different services or systems. It provides a centralized location where schemas can be registered, validated, and accessed by all the participating services.")]),t._v(" "),s("p",[t._v("In event-driven architecture, a schema registry is a crucial component that helps manage the schemas of events exchanged between different services or systems. It provides a centralized location where schemas can be registered, validated, and accessed by all the participating services.")]),t._v(" "),s("p",[t._v("There are several tools available that can be used as a schema registry, each with its own set of features and capabilities. One popular tool in this space is Apache Kafka's Schema Registry.")]),t._v(" "),s("p",[t._v("Apache Kafka is a distributed streaming platform that allows you to build real-time data pipelines and streaming applications. It provides a schema registry as part of its ecosystem, which enables you to define and manage the schemas for the events being produced and consumed by Kafka.")]),t._v(" "),s("p",[t._v("The Kafka Schema Registry stores the schemas in a centralized repository and assigns a unique identifier to each schema. This identifier is used by producers and consumers to serialize and deserialize the events, ensuring compatibility and consistency across different services.")]),t._v(" "),s("p",[t._v("Using the Kafka Schema Registry has several benefits. Firstly, it provides a single source of truth for schemas, making it easier to manage schema evolution and compatibility. It also enables schema validation, ensuring that only valid events are produced and consumed. Additionally, it supports schema evolution, allowing you to evolve your schemas over time without breaking existing consumers.")]),t._v(" "),s("p",[t._v("To use the Kafka Schema Registry, you need to integrate it with your event producers and consumers. Producers serialize the events using the registered schema and send them to Kafka, while consumers deserialize the events using the schema retrieved from the registry.")]),t._v(" "),s("p",[t._v("Here's an example of how you can use the Kafka Schema Registry with the Confluent Python client:")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" confluent_kafka "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" avro\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" confluent_kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("avro "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" AvroProducer\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure the Kafka Schema Registry URL")]),t._v("\nschema_registry_url "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8081'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Create an AvroProducer with the Schema Registry URL")]),t._v("\nproducer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" AvroProducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bootstrap.servers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9092'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'schema.registry.url'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" schema_registry_url\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Define the Avro schema for the event")]),t._v("\nschema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" avro"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loads"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"type":"record","name":"example","fields":[{"name":"id","type":"int"},{"name":"name","type":"string"}]}\'')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Produce an event using the schema")]),t._v("\nproducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("produce"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("topic"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'example-topic'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'John Doe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value_schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Flush the producer to ensure the event is sent")]),t._v("\nproducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("In this example, we configure the AvroProducer with the Kafka bootstrap servers and the Schema Registry URL. We define the Avro schema for the event and produce an event using the schema. The producer automatically registers the schema with the Schema Registry and serializes the event accordingly.")]),t._v(" "),s("p",[t._v("On the consumer side, you can use the Confluent Python client to consume events with the registered schema:")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" confluent_kafka "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" avro\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" confluent_kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("avro "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" AvroConsumer\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Configure the Kafka Schema Registry URL")]),t._v("\nschema_registry_url "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:8081'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Create an AvroConsumer with the Schema Registry URL")]),t._v("\nconsumer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" AvroConsumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bootstrap.servers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9092'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'group.id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'example-group'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'schema.registry.url'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" schema_registry_url\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Subscribe to the topic")]),t._v("\nconsumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscribe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'example-topic'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Consume events with the registered schema")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" consumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("poll"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" msg "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Consumer error: {}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n\n    value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Received event: {}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Close the consumer")]),t._v("\nconsumer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("In this consumer example, we configure the AvroConsumer with the Kafka bootstrap servers, the consumer group ID, and the Schema Registry URL. We subscribe to the topic and consume events with the registered schema. The consumer automatically retrieves the schema from the Schema Registry and deserializes the event accordingly.")]),t._v(" "),s("p",[t._v("Overall, the Kafka Schema Registry is a powerful tool for managing schemas in event-driven architecture. It provides a centralized and reliable way to handle schema evolution, compatibility, and validation, ensuring the smooth exchange of events between different services or systems.")])])}),[],!1,null,null,null);e.default=n.exports}}]);