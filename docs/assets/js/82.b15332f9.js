(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1300:function(t,a,s){"use strict";s.r(a);var e=s(7),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"logging-audit-notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#logging-audit-notes"}},[t._v("#")]),t._v(" Logging / Audit notes")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("You never know what data you can collect today that will be useful to you tomorrow.")])]),t._v(" "),e("TagLinks"),t._v(" "),e("h2",{attrs:{id:"logging-vs-auditing"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#logging-vs-auditing"}},[t._v("#")]),t._v(" Logging vs Auditing")]),t._v(" "),e("p",[t._v("Logging typically means the recording of implementation level events that happen as the program is running (methods get called, objects are created, etc.). As such it focuses on things that interest programmers")]),t._v(" "),e("p",[t._v("Auditing is about recording domain-level events: a transaction is created, a user is performing an action, etc. In certain types of application (Banking) there is a legal obligation to record such events.")]),t._v(" "),e("h2",{attrs:{id:"notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[t._v("#")]),t._v(" Notes")]),t._v(" "),e("ul",[e("li",[t._v("put context into the log")]),t._v(" "),e("li",[t._v("Don’t use "),e("code",[t._v("debug")]),t._v(" level for system monitoring data")]),t._v(" "),e("li",[t._v("Do NOT log sensitive information!")])]),t._v(" "),e("h2",{attrs:{id:"types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#types"}},[t._v("#")]),t._v(" Types")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Auditing")]),t._v(": this is sometimes a business requirement. The idea is to capture significant events that matter to the management or legal people. These are statements that describe usually what users of the system are doing (like who signed-in, who edited that, etc…).")]),t._v(" "),e("li",[e("strong",[t._v("Profiling")]),t._v(": as logs are timestamped (sometimes to the millisecond level), it can become a good tool to profile sections of a program, for instance by logging the start and end of an operation, you can either automatically (by parsing the log) or during troubleshooting infer some performance metrics without adding those metrics to the program itself.")]),t._v(" "),e("li",[e("strong",[t._v("Statistics")]),t._v(": if you log each time a certain event happens (like a certain kind of error or event) you can compute interesting statistics about the running program (or the user behaviors). It’s also possible to hook this to an alert system that can detect too many errors in a row.")])]),t._v(" "),e("h2",{attrs:{id:"log-what"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-what"}},[t._v("#")]),t._v(" Log what")]),t._v(" "),e("h3",{attrs:{id:"requests"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#requests"}},[t._v("#")]),t._v(" Requests")]),t._v(" "),e("ul",[e("li",[t._v("time / start / stop")]),t._v(" "),e("li",[t._v("correlation id")]),t._v(" "),e("li",[t._v("user agent")]),t._v(" "),e("li",[t._v("IP / GPS / ...")]),t._v(" "),e("li",[t._v("user id / request id / idempotent key")])]),t._v(" "),e("h3",{attrs:{id:"errors-and-exceptions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#errors-and-exceptions"}},[t._v("#")]),t._v(" Errors and Exceptions:")]),t._v(" "),e("p",[t._v("Logging errors and exceptions is crucial for troubleshooting and debugging. It helps developers identify and fix issues quickly. When an error occurs, logging the relevant error message, stack trace, and any contextual information can provide valuable insights into the root cause of the problem.")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Code that may throw an exception")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Exception e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    logger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"An error occurred: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"performance-metrics-availability"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#performance-metrics-availability"}},[t._v("#")]),t._v(" Performance Metrics / Availability")]),t._v(" "),e("p",[t._v("Logging performance metrics such as response times, database queries, or resource utilization can help identify bottlenecks and optimize the application's performance. This information can be valuable for capacity planning, load testing, and identifying areas for improvement.")]),t._v(" "),e("ul",[e("li",[t._v("Slow queries")]),t._v(" "),e("li",[t._v("Network error")]),t._v(" "),e("li",[t._v("At infra layer / firewall / gateway / ...")])]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" startTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Code to measure performance")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" endTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" executionTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" endTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlogger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Execution time: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" executionTime "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ms"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"configuration-changes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration-changes"}},[t._v("#")]),t._v(" Configuration Changes")]),t._v(" "),e("p",[t._v("Logging configuration changes can help track modifications made to the application's settings or environment.")]),t._v(" "),e("p",[t._v("This can be useful for troubleshooting issues related to configuration changes or "),e("strong",[t._v("ensuring compliance")]),t._v(" with security and regulatory requirements.")]),t._v(" "),e("h3",{attrs:{id:"user-actions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-actions"}},[t._v("#")]),t._v(" User Actions")]),t._v(" "),e("p",[t._v("Logging user actions can be useful for auditing, security, and understanding user behavior. It can help track user interactions, identify patterns, and detect any suspicious or unauthorized activities.")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("logger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User {username} logged in"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"application-events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-events"}},[t._v("#")]),t._v(" Application Events")]),t._v(" "),e("ul",[e("li",[t._v("Background threads / async job")])]),t._v(" "),e("p",[t._v("Logging important application events can help track the flow of execution and provide a detailed history of the application's behavior. This includes logging when the application starts or stops, when specific actions are performed, or when significant milestones are reached.")]),t._v(" "),e("h3",{attrs:{id:"third-party-integrations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#third-party-integrations"}},[t._v("#")]),t._v(" Third-Party Integrations")]),t._v(" "),e("p",[t._v("If your application integrates with external services or APIs, logging the interactions with these integrations can help diagnose issues and monitor their performance.")]),t._v(" "),e("h3",{attrs:{id:"security-events-threats"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#security-events-threats"}},[t._v("#")]),t._v(" Security Events/ Threats")]),t._v(" "),e("p",[t._v("Logging security-related events, such as failed login attempts, access control violations, or suspicious activities, can help detect and respond to potential security breaches")]),t._v(" "),e("ul",[e("li",[t._v("suspicious activities")]),t._v(" "),e("li",[t._v("unauthorized access to restricted processes or data")]),t._v(" "),e("li",[t._v("invalid parameters or input")]),t._v(" "),e("li",[t._v("warnings by the application’s security mechanisms.")])]),t._v(" "),e("h3",{attrs:{id:"trace-logging-audit-trail"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-logging-audit-trail"}},[t._v("#")]),t._v(" Trace Logging / Audit Trail")]),t._v(" "),e("ul",[e("li",[t._v("correlation id")])]),t._v(" "),e("h2",{attrs:{id:"what-not-to-log"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-not-to-log"}},[t._v("#")]),t._v(" What Not to Log")]),t._v(" "),e("ul",[e("li",[t._v("large messages")]),t._v(" "),e("li",[t._v("known errors, all errors")])]),t._v(" "),e("h3",{attrs:{id:"personally-identifiable-information-pii"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#personally-identifiable-information-pii"}},[t._v("#")]),t._v(" Personally Identifiable Information (PII)")]),t._v(" "),e("p",[t._v("PII includes sensitive data such as "),e("code",[t._v("names")]),t._v(", "),e("code",[t._v("emails")]),t._v(", "),e("code",[t._v("addresses")]),t._v(", "),e("code",[t._v("social security numbers")]),t._v(", "),e("code",[t._v("credit card details")]),t._v(", and other personally identifiable information. Logging this information can pose a significant risk to user privacy and may violate data protection laws.")]),t._v(" "),e("div",{staticClass:"language-py extra-class"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example: Logging PII should be avoided")]),t._v("\nlogger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string-interpolation"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"User ')]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v(" logged in with password ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("password"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"authentication-credentials"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication-credentials"}},[t._v("#")]),t._v(" Authentication Credentials")]),t._v(" "),e("p",[t._v("Logging usernames, passwords, or any other authentication credentials is highly discouraged. Storing this information in logs can lead to unauthorized access and compromise the security of user accounts.")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Example: Avoid logging authentication credentials")]),t._v("\nlogger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User login attempt with username: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" username "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" and password: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" password"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"sensitive-business-data"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sensitive-business-data"}},[t._v("#")]),t._v(" Sensitive Business Data")]),t._v(" "),e("p",[t._v("Logging sensitive business data, such as trade secrets, financial information, or proprietary algorithms, can expose critical information to unauthorized individuals. It is crucial to protect this type of data from being logged.")]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Example: Avoid logging sensitive business data")]),t._v("\nlogger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("LogInformation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Customer XYZ purchased product ABC for $1000"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"session-identifiers-and-tokens"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#session-identifiers-and-tokens"}},[t._v("#")]),t._v(" Session Identifiers and Tokens")]),t._v(" "),e("p",[t._v("Session identifiers, access tokens, or any other session-related information should not be logged. These values can be used to impersonate users or gain unauthorized access to their accounts.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Example: Do not log session identifiers or tokens")]),t._v("\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Session ID: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" sessionId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"internal-system-details"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#internal-system-details"}},[t._v("#")]),t._v(" Internal System Details")]),t._v(" "),e("p",[t._v("Logging internal system details, such as server configurations, database connection strings, or API keys, can expose critical infrastructure information to potential attackers. It is essential to keep this information confidential and not log it.")]),t._v(" "),e("div",{staticClass:"language-ruby extra-class"},[e("pre",{pre:!0,attrs:{class:"language-ruby"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example: Avoid logging internal system details")]),t._v("\nlogger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Database connection string: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" dbConnectionString"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"architecture"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#architecture"}},[t._v("#")]),t._v(" Architecture")]),t._v(" "),e("p",[e("img",{attrs:{src:s(402),alt:"arch"}})]),t._v(" "),e("ul",[e("li",[t._v("metrics source - your app")]),t._v(" "),e("li",[t._v("collector - promtail")]),t._v(" "),e("li",[t._v("DB - prometheus/S3")]),t._v(" "),e("li",[t._v("query service - loki")]),t._v(" "),e("li",[t._v("visual - grafana,")]),t._v(" "),e("li",[t._v("alert is alertmanager")])]),t._v(" "),e("p",[e("img",{attrs:{src:s(469),alt:"k8s monitoring"}})]),t._v(" "),e("h2",{attrs:{id:"refs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#refs"}},[t._v("#")]),t._v(" Refs")]),t._v(" "),e("p",[t._v("https://stackoverflow.com/questions/967970/what-information-should-i-be-logging-in-my-web-app")]),t._v(" "),e("p",[t._v("https://www.dataset.com/blog/the-10-commandments-of-logging/")]),t._v(" "),e("p",[t._v("https://www.freecodecamp.org/news/how-to-use-logs-effectively-in-your-code/")]),t._v(" "),e("p",[t._v("https://www.bloghoctap.com/security/authentication-authorization-va-accounting.html")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://jessicagreben.medium.com/four-minute-paper-facebooks-time-series-database-gorilla-800697717d72",target:"_blank",rel:"noopener noreferrer"}},[t._v("Four Minute Paper: Facebook’s time series database, Gorilla"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://k21academy.com/docker-kubernetes/prometheus-grafana-monitoring/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kubernetes Monitoring: Install Prometheus and Grafana using Helm"),e("OutboundLink")],1)])],1)}),[],!1,null,null,null);a.default=n.exports},402:function(t,a,s){t.exports=s.p+"assets/img/f6.54b4a63c.png"},469:function(t,a,s){t.exports=s.p+"assets/img/Prometheus-Server_Chart.a793fd6e.png"}}]);