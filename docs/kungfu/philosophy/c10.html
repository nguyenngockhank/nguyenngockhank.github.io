<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>10.  Dene Errors Out Of Existence | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.5d974432.css" as="style"><link rel="preload" href="/docs/assets/js/app.feff3dbb.js" as="script"><link rel="preload" href="/docs/assets/js/2.aca46d71.js" as="script"><link rel="preload" href="/docs/assets/js/249.29294a64.js" as="script"><link rel="preload" href="/docs/assets/js/27.5ed2ce18.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e2dac1de.js"><link rel="prefetch" href="/docs/assets/js/100.072f86f4.js"><link rel="prefetch" href="/docs/assets/js/101.fc0bc918.js"><link rel="prefetch" href="/docs/assets/js/102.ddeddef2.js"><link rel="prefetch" href="/docs/assets/js/103.a299e414.js"><link rel="prefetch" href="/docs/assets/js/104.29aa9c20.js"><link rel="prefetch" href="/docs/assets/js/105.5211965b.js"><link rel="prefetch" href="/docs/assets/js/106.f091e57b.js"><link rel="prefetch" href="/docs/assets/js/107.80acce0d.js"><link rel="prefetch" href="/docs/assets/js/108.b0108b40.js"><link rel="prefetch" href="/docs/assets/js/109.7953f94a.js"><link rel="prefetch" href="/docs/assets/js/11.34f9e1bc.js"><link rel="prefetch" href="/docs/assets/js/110.59b888f8.js"><link rel="prefetch" href="/docs/assets/js/111.5b11b553.js"><link rel="prefetch" href="/docs/assets/js/112.8a857b53.js"><link rel="prefetch" href="/docs/assets/js/113.5aab77e8.js"><link rel="prefetch" href="/docs/assets/js/114.aef8a2f2.js"><link rel="prefetch" href="/docs/assets/js/115.777be1e9.js"><link rel="prefetch" href="/docs/assets/js/116.3092451f.js"><link rel="prefetch" href="/docs/assets/js/117.3345c37e.js"><link rel="prefetch" href="/docs/assets/js/118.be055f62.js"><link rel="prefetch" href="/docs/assets/js/119.77b121e6.js"><link rel="prefetch" href="/docs/assets/js/12.a704c651.js"><link rel="prefetch" href="/docs/assets/js/120.2d64d4ae.js"><link rel="prefetch" href="/docs/assets/js/121.954a3ba9.js"><link rel="prefetch" href="/docs/assets/js/122.f8032cd6.js"><link rel="prefetch" href="/docs/assets/js/123.96d7858b.js"><link rel="prefetch" href="/docs/assets/js/124.f12d4c00.js"><link rel="prefetch" href="/docs/assets/js/125.47b679a8.js"><link rel="prefetch" href="/docs/assets/js/126.725c596d.js"><link rel="prefetch" href="/docs/assets/js/127.75f3139f.js"><link rel="prefetch" href="/docs/assets/js/128.9862473f.js"><link rel="prefetch" href="/docs/assets/js/129.0f09cf34.js"><link rel="prefetch" href="/docs/assets/js/13.66fe2f7e.js"><link rel="prefetch" href="/docs/assets/js/130.d20c4272.js"><link rel="prefetch" href="/docs/assets/js/131.771cb92a.js"><link rel="prefetch" href="/docs/assets/js/132.308ce22e.js"><link rel="prefetch" href="/docs/assets/js/133.99780c7f.js"><link rel="prefetch" href="/docs/assets/js/134.c8bb3739.js"><link rel="prefetch" href="/docs/assets/js/135.d22b8cd4.js"><link rel="prefetch" href="/docs/assets/js/136.0f7f2732.js"><link rel="prefetch" href="/docs/assets/js/137.66315d8b.js"><link rel="prefetch" href="/docs/assets/js/138.bc1e4151.js"><link rel="prefetch" href="/docs/assets/js/139.4bf7c284.js"><link rel="prefetch" href="/docs/assets/js/14.57825f78.js"><link rel="prefetch" href="/docs/assets/js/140.023cb781.js"><link rel="prefetch" href="/docs/assets/js/141.3ed2d77a.js"><link rel="prefetch" href="/docs/assets/js/142.97feece5.js"><link rel="prefetch" href="/docs/assets/js/143.22b3a1b2.js"><link rel="prefetch" href="/docs/assets/js/144.3b8c0d53.js"><link rel="prefetch" href="/docs/assets/js/145.c187e405.js"><link rel="prefetch" href="/docs/assets/js/146.02e7dc46.js"><link rel="prefetch" href="/docs/assets/js/147.1ea04230.js"><link rel="prefetch" href="/docs/assets/js/148.eceb141f.js"><link rel="prefetch" href="/docs/assets/js/149.7bc98406.js"><link rel="prefetch" href="/docs/assets/js/15.cbcf56bd.js"><link rel="prefetch" href="/docs/assets/js/150.345f53e1.js"><link rel="prefetch" href="/docs/assets/js/151.97fd5643.js"><link rel="prefetch" href="/docs/assets/js/152.0f0ace62.js"><link rel="prefetch" href="/docs/assets/js/153.5ae906c9.js"><link rel="prefetch" href="/docs/assets/js/154.4524d48f.js"><link rel="prefetch" href="/docs/assets/js/155.d7cbb04b.js"><link rel="prefetch" href="/docs/assets/js/156.51743cf0.js"><link rel="prefetch" href="/docs/assets/js/157.12aa1a8a.js"><link rel="prefetch" href="/docs/assets/js/158.04757c69.js"><link rel="prefetch" href="/docs/assets/js/159.7a8588a6.js"><link rel="prefetch" href="/docs/assets/js/16.b9864c9c.js"><link rel="prefetch" href="/docs/assets/js/160.79ec6015.js"><link rel="prefetch" href="/docs/assets/js/161.4f0b5cd9.js"><link rel="prefetch" href="/docs/assets/js/162.6cc1f3af.js"><link rel="prefetch" href="/docs/assets/js/163.187c5335.js"><link rel="prefetch" href="/docs/assets/js/164.556dc6d8.js"><link rel="prefetch" href="/docs/assets/js/165.6c6e1f75.js"><link rel="prefetch" href="/docs/assets/js/166.afe12552.js"><link rel="prefetch" href="/docs/assets/js/167.bd3dd81a.js"><link rel="prefetch" href="/docs/assets/js/168.b5e90a8d.js"><link rel="prefetch" href="/docs/assets/js/169.80b477b3.js"><link rel="prefetch" href="/docs/assets/js/17.8983ce9d.js"><link rel="prefetch" href="/docs/assets/js/170.4fcbc9a3.js"><link rel="prefetch" href="/docs/assets/js/171.6c7ccd83.js"><link rel="prefetch" href="/docs/assets/js/172.e02d80ea.js"><link rel="prefetch" href="/docs/assets/js/173.66fb904a.js"><link rel="prefetch" href="/docs/assets/js/174.4f18cc78.js"><link rel="prefetch" href="/docs/assets/js/175.b1c5644a.js"><link rel="prefetch" href="/docs/assets/js/176.bd684253.js"><link rel="prefetch" href="/docs/assets/js/177.c62f362d.js"><link rel="prefetch" href="/docs/assets/js/178.f953855f.js"><link rel="prefetch" href="/docs/assets/js/179.10404ee2.js"><link rel="prefetch" href="/docs/assets/js/18.5efe21b3.js"><link rel="prefetch" href="/docs/assets/js/180.c4330ec2.js"><link rel="prefetch" href="/docs/assets/js/181.02c26c33.js"><link rel="prefetch" href="/docs/assets/js/182.773ba280.js"><link rel="prefetch" href="/docs/assets/js/183.064d5ae1.js"><link rel="prefetch" href="/docs/assets/js/184.2c64e798.js"><link rel="prefetch" href="/docs/assets/js/185.38c7b6e9.js"><link rel="prefetch" href="/docs/assets/js/186.d95e2e7a.js"><link rel="prefetch" href="/docs/assets/js/187.8aad3033.js"><link rel="prefetch" href="/docs/assets/js/188.7f201e8d.js"><link rel="prefetch" href="/docs/assets/js/189.6cefdb59.js"><link rel="prefetch" href="/docs/assets/js/19.58823304.js"><link rel="prefetch" href="/docs/assets/js/190.90e5aa35.js"><link rel="prefetch" href="/docs/assets/js/191.3e1cf065.js"><link rel="prefetch" href="/docs/assets/js/192.a2c49267.js"><link rel="prefetch" href="/docs/assets/js/193.cd7650f2.js"><link rel="prefetch" href="/docs/assets/js/194.1d2ca753.js"><link rel="prefetch" href="/docs/assets/js/195.e29ca5e1.js"><link rel="prefetch" href="/docs/assets/js/196.ff519f9d.js"><link rel="prefetch" href="/docs/assets/js/197.d7c7a2c2.js"><link rel="prefetch" href="/docs/assets/js/198.77259c6a.js"><link rel="prefetch" href="/docs/assets/js/199.7983bd3b.js"><link rel="prefetch" href="/docs/assets/js/20.3b486daa.js"><link rel="prefetch" href="/docs/assets/js/200.e9a796d0.js"><link rel="prefetch" href="/docs/assets/js/201.b4449da8.js"><link rel="prefetch" href="/docs/assets/js/202.ab520617.js"><link rel="prefetch" href="/docs/assets/js/203.1944c871.js"><link rel="prefetch" href="/docs/assets/js/204.2ddfe4db.js"><link rel="prefetch" href="/docs/assets/js/205.3a4a5484.js"><link rel="prefetch" href="/docs/assets/js/206.9eaec970.js"><link rel="prefetch" href="/docs/assets/js/207.ca2acd17.js"><link rel="prefetch" href="/docs/assets/js/208.bc4e3070.js"><link rel="prefetch" href="/docs/assets/js/209.8194c212.js"><link rel="prefetch" href="/docs/assets/js/21.1e77a313.js"><link rel="prefetch" href="/docs/assets/js/210.473ccc45.js"><link rel="prefetch" href="/docs/assets/js/211.623b4033.js"><link rel="prefetch" href="/docs/assets/js/212.0f85a611.js"><link rel="prefetch" href="/docs/assets/js/213.191977aa.js"><link rel="prefetch" href="/docs/assets/js/214.a23c6dcc.js"><link rel="prefetch" href="/docs/assets/js/215.25321a42.js"><link rel="prefetch" href="/docs/assets/js/216.e450a05c.js"><link rel="prefetch" href="/docs/assets/js/217.abab04ca.js"><link rel="prefetch" href="/docs/assets/js/218.66e0082a.js"><link rel="prefetch" href="/docs/assets/js/219.5f4ee9fd.js"><link rel="prefetch" href="/docs/assets/js/22.1c51f113.js"><link rel="prefetch" href="/docs/assets/js/220.bbb5df8d.js"><link rel="prefetch" href="/docs/assets/js/221.0d3dfd46.js"><link rel="prefetch" href="/docs/assets/js/222.8e68bdb2.js"><link rel="prefetch" href="/docs/assets/js/223.6c582cd9.js"><link rel="prefetch" href="/docs/assets/js/224.f570e175.js"><link rel="prefetch" href="/docs/assets/js/225.b249063b.js"><link rel="prefetch" href="/docs/assets/js/226.48576d77.js"><link rel="prefetch" href="/docs/assets/js/227.8346e855.js"><link rel="prefetch" href="/docs/assets/js/228.8e3e6ca7.js"><link rel="prefetch" href="/docs/assets/js/229.faed0af8.js"><link rel="prefetch" href="/docs/assets/js/23.dc13f196.js"><link rel="prefetch" href="/docs/assets/js/230.dcc8e04d.js"><link rel="prefetch" href="/docs/assets/js/231.611372c2.js"><link rel="prefetch" href="/docs/assets/js/232.aaaeb300.js"><link rel="prefetch" href="/docs/assets/js/233.819d8911.js"><link rel="prefetch" href="/docs/assets/js/234.41eb70ca.js"><link rel="prefetch" href="/docs/assets/js/235.acedc064.js"><link rel="prefetch" href="/docs/assets/js/236.fbc4b8f7.js"><link rel="prefetch" href="/docs/assets/js/237.7b217482.js"><link rel="prefetch" href="/docs/assets/js/238.6b2400f7.js"><link rel="prefetch" href="/docs/assets/js/239.570754bf.js"><link rel="prefetch" href="/docs/assets/js/24.d1deb976.js"><link rel="prefetch" href="/docs/assets/js/240.30c365e9.js"><link rel="prefetch" href="/docs/assets/js/241.aebbd7aa.js"><link rel="prefetch" href="/docs/assets/js/242.5df1a85a.js"><link rel="prefetch" href="/docs/assets/js/243.704fb61f.js"><link rel="prefetch" href="/docs/assets/js/244.9bc98748.js"><link rel="prefetch" href="/docs/assets/js/245.38e733b7.js"><link rel="prefetch" href="/docs/assets/js/246.b81c0b24.js"><link rel="prefetch" href="/docs/assets/js/247.c0a84943.js"><link rel="prefetch" href="/docs/assets/js/248.47e7f09b.js"><link rel="prefetch" href="/docs/assets/js/25.ddba0ef8.js"><link rel="prefetch" href="/docs/assets/js/250.7b97771f.js"><link rel="prefetch" href="/docs/assets/js/251.af134ede.js"><link rel="prefetch" href="/docs/assets/js/252.996a9add.js"><link rel="prefetch" href="/docs/assets/js/253.6b08af88.js"><link rel="prefetch" href="/docs/assets/js/254.a14372bd.js"><link rel="prefetch" href="/docs/assets/js/255.868fb43f.js"><link rel="prefetch" href="/docs/assets/js/256.606c2f81.js"><link rel="prefetch" href="/docs/assets/js/257.9c34c318.js"><link rel="prefetch" href="/docs/assets/js/258.236c65be.js"><link rel="prefetch" href="/docs/assets/js/259.dc9c78fd.js"><link rel="prefetch" href="/docs/assets/js/26.23be3024.js"><link rel="prefetch" href="/docs/assets/js/260.228e0898.js"><link rel="prefetch" href="/docs/assets/js/261.7dd0cc1f.js"><link rel="prefetch" href="/docs/assets/js/262.7c674375.js"><link rel="prefetch" href="/docs/assets/js/263.0d61e50b.js"><link rel="prefetch" href="/docs/assets/js/264.0595e5d9.js"><link rel="prefetch" href="/docs/assets/js/265.4f8cb07b.js"><link rel="prefetch" href="/docs/assets/js/266.fe3edb0f.js"><link rel="prefetch" href="/docs/assets/js/267.8942e793.js"><link rel="prefetch" href="/docs/assets/js/268.86eb0eb9.js"><link rel="prefetch" href="/docs/assets/js/269.03f58dca.js"><link rel="prefetch" href="/docs/assets/js/270.90b7be1d.js"><link rel="prefetch" href="/docs/assets/js/271.b556bf53.js"><link rel="prefetch" href="/docs/assets/js/272.0b7f4823.js"><link rel="prefetch" href="/docs/assets/js/273.d311f5f5.js"><link rel="prefetch" href="/docs/assets/js/274.06fb099b.js"><link rel="prefetch" href="/docs/assets/js/275.e40667a2.js"><link rel="prefetch" href="/docs/assets/js/276.d3ab71c4.js"><link rel="prefetch" href="/docs/assets/js/277.5feda584.js"><link rel="prefetch" href="/docs/assets/js/278.beaf14c2.js"><link rel="prefetch" href="/docs/assets/js/279.f7073aaf.js"><link rel="prefetch" href="/docs/assets/js/28.f7b1175c.js"><link rel="prefetch" href="/docs/assets/js/280.72c464b5.js"><link rel="prefetch" href="/docs/assets/js/281.1fc9c7ce.js"><link rel="prefetch" href="/docs/assets/js/282.4e16e559.js"><link rel="prefetch" href="/docs/assets/js/283.4fb4b1a6.js"><link rel="prefetch" href="/docs/assets/js/284.c3baaf64.js"><link rel="prefetch" href="/docs/assets/js/285.a7a948cc.js"><link rel="prefetch" href="/docs/assets/js/286.73a344a9.js"><link rel="prefetch" href="/docs/assets/js/287.6035b91a.js"><link rel="prefetch" href="/docs/assets/js/288.bb0dbdf9.js"><link rel="prefetch" href="/docs/assets/js/289.10918ad5.js"><link rel="prefetch" href="/docs/assets/js/29.d0e3b179.js"><link rel="prefetch" href="/docs/assets/js/290.20c7bcd8.js"><link rel="prefetch" href="/docs/assets/js/291.ee116400.js"><link rel="prefetch" href="/docs/assets/js/292.dfc2e949.js"><link rel="prefetch" href="/docs/assets/js/293.8a851721.js"><link rel="prefetch" href="/docs/assets/js/294.1f4a08e0.js"><link rel="prefetch" href="/docs/assets/js/295.7ba75a19.js"><link rel="prefetch" href="/docs/assets/js/296.b251d4cf.js"><link rel="prefetch" href="/docs/assets/js/297.d56d6d59.js"><link rel="prefetch" href="/docs/assets/js/298.2e259f4b.js"><link rel="prefetch" href="/docs/assets/js/299.7fed62ba.js"><link rel="prefetch" href="/docs/assets/js/3.054cc2ec.js"><link rel="prefetch" href="/docs/assets/js/30.b554c761.js"><link rel="prefetch" href="/docs/assets/js/300.1f947cef.js"><link rel="prefetch" href="/docs/assets/js/301.f708dd5e.js"><link rel="prefetch" href="/docs/assets/js/302.161104b1.js"><link rel="prefetch" href="/docs/assets/js/303.e23692dd.js"><link rel="prefetch" href="/docs/assets/js/304.05659027.js"><link rel="prefetch" href="/docs/assets/js/305.9bf971c9.js"><link rel="prefetch" href="/docs/assets/js/306.ca8deeea.js"><link rel="prefetch" href="/docs/assets/js/307.97a6667e.js"><link rel="prefetch" href="/docs/assets/js/308.693ca743.js"><link rel="prefetch" href="/docs/assets/js/309.fffb02db.js"><link rel="prefetch" href="/docs/assets/js/31.370bb99a.js"><link rel="prefetch" href="/docs/assets/js/310.2bc665a7.js"><link rel="prefetch" href="/docs/assets/js/311.7953e1c2.js"><link rel="prefetch" href="/docs/assets/js/312.fa9bc367.js"><link rel="prefetch" href="/docs/assets/js/313.ac895eeb.js"><link rel="prefetch" href="/docs/assets/js/314.3631b719.js"><link rel="prefetch" href="/docs/assets/js/315.74ff42ab.js"><link rel="prefetch" href="/docs/assets/js/316.3e76797f.js"><link rel="prefetch" href="/docs/assets/js/317.6fb15d7c.js"><link rel="prefetch" href="/docs/assets/js/318.79e44dca.js"><link rel="prefetch" href="/docs/assets/js/319.bc94de5a.js"><link rel="prefetch" href="/docs/assets/js/32.78d1f1eb.js"><link rel="prefetch" href="/docs/assets/js/320.50cf4d33.js"><link rel="prefetch" href="/docs/assets/js/321.92c73aef.js"><link rel="prefetch" href="/docs/assets/js/322.4b083d48.js"><link rel="prefetch" href="/docs/assets/js/323.26c3a0ab.js"><link rel="prefetch" href="/docs/assets/js/324.fcb79d62.js"><link rel="prefetch" href="/docs/assets/js/325.45cede6b.js"><link rel="prefetch" href="/docs/assets/js/326.199b7195.js"><link rel="prefetch" href="/docs/assets/js/327.c396bfb7.js"><link rel="prefetch" href="/docs/assets/js/328.988a3de9.js"><link rel="prefetch" href="/docs/assets/js/329.fe8358a3.js"><link rel="prefetch" href="/docs/assets/js/33.6b9b4e96.js"><link rel="prefetch" href="/docs/assets/js/34.76d3700c.js"><link rel="prefetch" href="/docs/assets/js/35.b61bf772.js"><link rel="prefetch" href="/docs/assets/js/36.7f32760f.js"><link rel="prefetch" href="/docs/assets/js/37.4079c117.js"><link rel="prefetch" href="/docs/assets/js/38.1ac45a99.js"><link rel="prefetch" href="/docs/assets/js/39.0b98297f.js"><link rel="prefetch" href="/docs/assets/js/4.98818668.js"><link rel="prefetch" href="/docs/assets/js/40.bc044ad5.js"><link rel="prefetch" href="/docs/assets/js/41.de0fe499.js"><link rel="prefetch" href="/docs/assets/js/42.e225df72.js"><link rel="prefetch" href="/docs/assets/js/43.5e38f722.js"><link rel="prefetch" href="/docs/assets/js/44.c7251ae2.js"><link rel="prefetch" href="/docs/assets/js/45.47147150.js"><link rel="prefetch" href="/docs/assets/js/46.b91db25b.js"><link rel="prefetch" href="/docs/assets/js/47.40a11e04.js"><link rel="prefetch" href="/docs/assets/js/48.02effbc8.js"><link rel="prefetch" href="/docs/assets/js/49.0daadd89.js"><link rel="prefetch" href="/docs/assets/js/5.c3703f1d.js"><link rel="prefetch" href="/docs/assets/js/50.821b5322.js"><link rel="prefetch" href="/docs/assets/js/51.907927f0.js"><link rel="prefetch" href="/docs/assets/js/52.fbd6f4cb.js"><link rel="prefetch" href="/docs/assets/js/53.f1a0dc32.js"><link rel="prefetch" href="/docs/assets/js/54.8b66e487.js"><link rel="prefetch" href="/docs/assets/js/55.07cf4188.js"><link rel="prefetch" href="/docs/assets/js/56.ba320d44.js"><link rel="prefetch" href="/docs/assets/js/57.13a27667.js"><link rel="prefetch" href="/docs/assets/js/58.ef5d7e10.js"><link rel="prefetch" href="/docs/assets/js/59.dd726a42.js"><link rel="prefetch" href="/docs/assets/js/6.a764175d.js"><link rel="prefetch" href="/docs/assets/js/60.77ab395a.js"><link rel="prefetch" href="/docs/assets/js/61.3634b93f.js"><link rel="prefetch" href="/docs/assets/js/62.4c2d18ec.js"><link rel="prefetch" href="/docs/assets/js/63.57de2c82.js"><link rel="prefetch" href="/docs/assets/js/64.7b6639a9.js"><link rel="prefetch" href="/docs/assets/js/65.563fdeff.js"><link rel="prefetch" href="/docs/assets/js/66.81bd4cf2.js"><link rel="prefetch" href="/docs/assets/js/67.7fa4933d.js"><link rel="prefetch" href="/docs/assets/js/68.beebaf3f.js"><link rel="prefetch" href="/docs/assets/js/69.64313c8f.js"><link rel="prefetch" href="/docs/assets/js/7.2960bb58.js"><link rel="prefetch" href="/docs/assets/js/70.96160c4a.js"><link rel="prefetch" href="/docs/assets/js/71.ddaef725.js"><link rel="prefetch" href="/docs/assets/js/72.96fd17ad.js"><link rel="prefetch" href="/docs/assets/js/73.7ccc2f65.js"><link rel="prefetch" href="/docs/assets/js/74.3198ebf4.js"><link rel="prefetch" href="/docs/assets/js/75.4886a68c.js"><link rel="prefetch" href="/docs/assets/js/76.8d13e16c.js"><link rel="prefetch" href="/docs/assets/js/77.adc7359e.js"><link rel="prefetch" href="/docs/assets/js/78.2e03c285.js"><link rel="prefetch" href="/docs/assets/js/79.7d0ac9a1.js"><link rel="prefetch" href="/docs/assets/js/8.4c0568fd.js"><link rel="prefetch" href="/docs/assets/js/80.0e2710e5.js"><link rel="prefetch" href="/docs/assets/js/81.cdf404cc.js"><link rel="prefetch" href="/docs/assets/js/82.01e97e1f.js"><link rel="prefetch" href="/docs/assets/js/83.90c08f77.js"><link rel="prefetch" href="/docs/assets/js/84.2225a6dc.js"><link rel="prefetch" href="/docs/assets/js/85.49171e3b.js"><link rel="prefetch" href="/docs/assets/js/86.b18603ac.js"><link rel="prefetch" href="/docs/assets/js/87.772b6e3a.js"><link rel="prefetch" href="/docs/assets/js/88.82fdaa52.js"><link rel="prefetch" href="/docs/assets/js/89.bfcd0e62.js"><link rel="prefetch" href="/docs/assets/js/9.c7f05dcb.js"><link rel="prefetch" href="/docs/assets/js/90.ebe887ad.js"><link rel="prefetch" href="/docs/assets/js/91.7006ce28.js"><link rel="prefetch" href="/docs/assets/js/92.e662a7e6.js"><link rel="prefetch" href="/docs/assets/js/93.b97b9d2a.js"><link rel="prefetch" href="/docs/assets/js/94.36f8f62e.js"><link rel="prefetch" href="/docs/assets/js/95.b7192aed.js"><link rel="prefetch" href="/docs/assets/js/96.f0bc5b58.js"><link rel="prefetch" href="/docs/assets/js/97.59dcee0b.js"><link rel="prefetch" href="/docs/assets/js/98.e16eec31.js"><link rel="prefetch" href="/docs/assets/js/99.26ea8045.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.5d974432.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>A Philosophy of Software Design</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/philosophy/c1.html" class="sidebar-link">1. Introduction</a></li><li><a href="/docs/kungfu/philosophy/c2.html" class="sidebar-link">2. The Nature of Complexity</a></li><li><a href="/docs/kungfu/philosophy/c3.html" class="sidebar-link">3. Working Code Isn’t Enough</a></li><li><a href="/docs/kungfu/philosophy/c4.html" class="sidebar-link">4. Modules Should Be Deep</a></li><li><a href="/docs/kungfu/philosophy/c5.html" class="sidebar-link">5.  Information Hiding (and Leakage)</a></li><li><a href="/docs/kungfu/philosophy/c6.html" class="sidebar-link">6.  General-Purpose Modules are Deeper</a></li><li><a href="/docs/kungfu/philosophy/c7.html" class="sidebar-link">7.  Dierent Layer, Dierent Abstraction</a></li><li><a href="/docs/kungfu/philosophy/c8.html" class="sidebar-link">8.  Pull Complexity Downwards</a></li><li><a href="/docs/kungfu/philosophy/c9.html" class="sidebar-link">9.  Better Together Or Better Apart?</a></li><li><a href="/docs/kungfu/philosophy/c10.html" aria-current="page" class="active sidebar-link">10.  Dene Errors Out Of Existence</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-1-why-exceptions-add-complexity" class="sidebar-link">10.1  Why exceptions add complexity</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-2-too-many-exceptions" class="sidebar-link">10.2  Too many exceptions</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-3-dene-errors-out-of-existence" class="sidebar-link">10.3  Dene errors out of existence</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-4-example-le-deletion-in-windows" class="sidebar-link">10.4  Example: le deletion in Windows</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-5-example-java-substring-method" class="sidebar-link">10.5  Example: Java substring method</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-6-mask-exceptions" class="sidebar-link">10.6  Mask exceptions</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-7-exception-aggregation" class="sidebar-link">10.7  Exception aggregation</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-8-just-crash" class="sidebar-link">10.8  Just crash?</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-9-design-special-cases-out-of-existence" class="sidebar-link">10.9  Design special cases out of existence</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-10-taking-it-too-far" class="sidebar-link">10.10  Taking it too far</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/philosophy/c10.html#_10-11-conclusion" class="sidebar-link">10.11  Conclusion</a></li></ul></li><li><a href="/docs/kungfu/philosophy/c11.html" class="sidebar-link">11.  Design it Twice</a></li><li><a href="/docs/kungfu/philosophy/c12.html" class="sidebar-link">12. Why Write Comments? The Four Excuses</a></li><li><a href="/docs/kungfu/philosophy/c13.html" class="sidebar-link">13. Comments Should Describe Things that aren’t Obvious from the Code</a></li><li><a href="/docs/kungfu/philosophy/c14.html" class="sidebar-link">14. Choosing Names</a></li><li><a href="/docs/kungfu/philosophy/c15.html" class="sidebar-link">15.  Write The Comments First</a></li><li><a href="/docs/kungfu/philosophy/c16.html" class="sidebar-link">16. Modifying Existing Code</a></li><li><a href="/docs/kungfu/philosophy/c17.html" class="sidebar-link">17. Consistency</a></li><li><a href="/docs/kungfu/philosophy/c18.html" class="sidebar-link">18. Code Should be Obvious</a></li><li><a href="/docs/kungfu/philosophy/c19.html" class="sidebar-link">19. Software Trends</a></li><li><a href="/docs/kungfu/philosophy/c20.html" class="sidebar-link">20. Designing for Performance</a></li><li><a href="/docs/kungfu/philosophy/c21.html" class="sidebar-link">21. Conclusion</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_10-dene-errors-out-of-existence"><a href="#_10-dene-errors-out-of-existence" class="header-anchor">#</a> 10.  Dene Errors Out Of Existence</h1> <p>Exception handling is one of the worst sources of complexity in software
systems. Code that deals with special conditions is inherently harder to
write than code that deals with normal cases, and developers often define
exceptions without considering how they will be handled. This chapter
discusses why exceptions contribute disproportionately to complexity, then
it shows how to simplify exception handling. The key overall lesson from
this chapter is to reduce the number of places where exceptions must be
handled; in many cases the semantics of operations can be modified so
that the normal behavior handles all situations and there is no exceptional
condition to report (hence the title of this chapter).</p> <h2 id="_10-1-why-exceptions-add-complexity"><a href="#_10-1-why-exceptions-add-complexity" class="header-anchor">#</a> 10.1  Why exceptions add complexity</h2> <p>I use the term exception to refer to any uncommon condition that alters the
normal flow of control in a program. Many programming languages
include a formal exception mechanism that allows exceptions to be thrown
by lower-level code and caught by enclosing code. However, exceptions
can occur even without using a formal exception reporting mechanism,
such as when a method returns a special value indicating that it didn’t
complete its normal behavior. All of these forms of exceptions contribute
to complexity.</p> <p>A particular piece of code may encounter exceptions in several
different ways:
A caller may provide bad arguments or configuration information.
An invoked method may not be able to complete a requested
operation. For example, an I/O operation may fail, or a required
resource may not be available.</p> <div class="language- extra-class"><pre class="language-text"><code>In a distributed system, network packets may be lost or delayed,
servers may not respond in a timely fashion, or peers may
communicate in unexpected ways.
The code may detect bugs, internal inconsistencies, or situations it is
not prepared to handle.
</code></pre></div><p>Large systems have to deal with many exceptional conditions, particularly
if they are distributed or need to be fault-tolerant. Exception handling can
account for a significant fraction of all the code in a system.</p> <p>Exception handling code is inherently more difficult to write than
normal-case code. An exception disrupts the normal flow of the code; it
usually means that something didn’t work as expected. When an exception
occurs, the programmer can deal with it in two ways, each of which can be
complicated. The first approach is to move forward and complete the work
in progress in spite of the exception. For example, if a network packet is
lost, it can be resent; if data is corrupted, perhaps it can be recovered from
a redundant copy. The second approach is to abort the operation in
progress and report the exception upwards. However, aborting can be
complicated because the exception may have occurred at a point where
system state is inconsistent (a data structure might have been partially
initialized); the exception handling code must restore consistency, such as
by unwinding any changes made before the exception occurred.</p> <p>Furthermore, exception handling code creates opportunities for more
exceptions. Consider the case of resending a lost network packet. Perhaps
the packet wasn’t actually lost, but was simply delayed. In this case,
resending the packet will result in duplicate packets arriving at the peer;
this introduces a new exceptional condition that the peer must handle. Or,
consider the case of recovering lost data from a redundant copy: what if
the redundant copy has also been lost? Secondary exceptions occurring
during recovery are often more subtle and complex than the primary
exceptions. If an exception is handled by aborting the operation in
progress, then this must be reported to the caller as another exception. To
prevent an unending cascade of exceptions, the developer must eventually
find a way to handle exceptions without introducing more exceptions.</p> <p>Language support for exceptions tends to be verbose and clunky, which
makes exception handling code hard to read. For example, consider the</p> <p>following code, which reads a collection of tweets from a file using Java’s
support for object serialization and deserialization:
try (
FileInputStream fileStream =</p> <p>new FileInputStream(fileName);
BufferedInputStream bufferedStream =</p> <p>new BufferedInputStream(fileStream);
ObjectInputStream objectStream =</p> <p>new ObjectInputStream(bufferedStream);
) {
for (int i = 0; i &lt; tweetsPerFile; i++) {</p> <p>tweets.add((Tweet) objectStream.readObject());
}
}
catch (FileNotFoundException e) {</p> <p>...
}
catch (ClassNotFoundException e) {
...
}
catch (EOFException e) {</p> <p>// Not a problem: not all tweet files have full
// set of tweets.
}
catch (IOException e) {</p> <p>...
}
catch (ClassCastException e) {
...
}</p> <p>Just the basic try-catch boilerplate accounts for more lines of code than
the code for normal-case operation, without even considering the code that
actually handles the exceptions. It is hard to relate the exception handling
code to the normal-case code: for example, it’s not obvious where each</p> <p>exception is generated. An alternative approach is to break up the code
into many distinct try blocks; in the extreme case there could be a try for</p> <p>each line of code that can generate an exception. This would make it clear
where exceptions occur, but the try blocks themselves break up the flow of
the code and make it harder to read; in addition, some exception handling
code might end up duplicated in multiple try blocks.</p> <p>It’s difficult to ensure that exception handling code really works. Some
exceptions, such as I/O errors, can’t easily be generated in a test
environment, so it’s hard to test the code that handles them. Exceptions
don’t occur very often in running systems, so exception handling code
rarely executes. Bugs can go undetected for a long time, and when the
exception handling code is finally needed, there’s a good chance that it
won’t work (one of my favorite sayings: “code that hasn’t been executed
doesn’t work”). A recent study found that more than 90% of catastrophic
failures in distributed data-intensive systems were caused by incorrect
error handling^1. When exception handling code fails, it’s difficult to debug
the problem, since it occurs so infrequently.</p> <h2 id="_10-2-too-many-exceptions"><a href="#_10-2-too-many-exceptions" class="header-anchor">#</a> 10.2  Too many exceptions</h2> <p>Programmers exacerbate the problems related to exception handling by
defining unnecessary exceptions. Most programmers are taught that it’s
important to detect and report errors; they often interpret this to mean “the
more errors detected, the better.” This leads to an over-defensive style
where anything that looks even a bit suspicious is rejected with an
exception, which results in a proliferation of unnecessary exceptions that
increase the complexity of the system.</p> <p>I made this mistake myself in the design of the Tcl scripting language.
Tcl contains an unset command that can be used to remove a variable. I</p> <p>defined unset so that it throws an error if the variable doesn’t exist. At the
time I thought that it must be a bug if someone tries to delete a variable
that doesn’t exist, so Tcl should report it. However, one of the most
common uses of unset is to clean up temporary state created by some</p> <p>previous operation. It’s often hard to predict exactly what state was
created, particularly if the operation aborted partway through. Thus, the</p> <p>simplest thing is to delete all of the variables that might possibly have
been created. The definition of unset makes this awkward: developers end</p> <p>up enclosing calls to unset in catch statements to catch and ignore errors
thrown by unset. In retrospect, the definition of the unset command is one</p> <p>of the biggest mistakes I made in the design of Tcl.</p> <p>It’s tempting to use exceptions to avoid dealing with difficult
situations: rather than figuring out a clean way to handle it, just throw an
exception and punt the problem to the caller. Some might argue that this
approach empowers callers, since it allows each caller to handle the
exception in a different way. However, if you are having trouble figuring
out what to do for the particular situation, there’s a good chance that the
caller won’t know what to do either. Generating an exception in a situation
like this just passes the problem to someone else and adds to the system’s
complexity.</p> <p>The exceptions thrown by a class are part of its interface; classes with
lots of exceptions have complex interfaces, and they are shallower than
classes with fewer exceptions. An exception is a particularly complex
element of an interface. It can propagate up through several stack levels
before being caught, so it affects not just the method’s caller, but
potentially also higher-level callers (and their interfaces).</p> <p>Throwing exceptions is easy; handling them is hard. Thus, the
complexity of exceptions comes from the exception handling code. The
best way to reduce the complexity damage caused by exception handling is
to reduce the number of places where exceptions have to be handled.
The rest of this chapter will discuss four techniques for reducing the
number of exception handlers.</p> <h2 id="_10-3-dene-errors-out-of-existence"><a href="#_10-3-dene-errors-out-of-existence" class="header-anchor">#</a> 10.3  Dene errors out of existence</h2> <p>The best way to eliminate exception handling complexity is to define your
APIs so that there are no exceptions to handle: define errors out of
existence. This may seem sacrilegious, but it is very effective in practice.
Consider the Tcl unset command discussed above. Rather than throwing an</p> <p>error when unset is asked to delete an unknown variable, it should have
simply returned without doing anything. I should have changed the</p> <p>definition of unset slightly: rather than deleting a variable, unset should</p> <p>ensure that a variable no longer exists. With the first definition, unset
can’t do its job if the variable doesn’t exist, so generating an exception
makes sense. With the second definition, it is perfectly natural for unset to</p> <p>be invoked with the name of a variable that doesn’t exist. In this case, its
work is already done, so it can simply return. There is no longer an error
case to report.</p> <h2 id="_10-4-example-le-deletion-in-windows"><a href="#_10-4-example-le-deletion-in-windows" class="header-anchor">#</a> 10.4  Example: le deletion in Windows</h2> <p>File deletion provides another example of how errors can be defined away.
The Windows operating system does not permit a file to be deleted if it is
open in a process. This is a continual source of frustration for developers
and users. In order to delete a file that is in use, the user must search
through the system to find the process that has the file open, and then kill
that process. Sometimes users give up and reboot their system, just so they
can delete a file.</p> <p>The Unix operating system defines file deletion more elegantly. In
Unix, if a file is open when it is deleted, Unix does not delete the file
immediately. Instead, it marks the file for deletion, then the delete
operation returns successfully. The file name has been removed from its
directory, so no other processes can open the old file and a new file with
the same name can be created, but the existing file data persists. Processes
that already have the file open can continue to read it and write it
normally. Once the file has been closed by all of the accessing processes,
its data is freed.</p> <p>The Unix approach defines away two different kinds of errors. First,
the delete operation no longer returns an error if the file is currently in
use; the delete succeeds, and the file will eventually be deleted. Second,
deleting a file that’s in use does not create exceptions for the processes
using the file. One possible approach to this problem would have been to
delete the file immediately and mark all of the opens of the file to disable
them; any attempts by other processes to read or write the deleted file
would fail. However, this approach would create new errors for those</p> <p>processes to handle. Instead, Unix allows them to keep accessing the file
normally; delaying the file deletion defines errors out of existence.</p> <p>It may seem strange that Unix allows a process to continue to read and
write a doomed file, but I have never encountered a situation where this
caused significant problems. The Unix definition of file deletion is much
simpler to work with, both for developers and users, than the Windows
definition.</p> <h2 id="_10-5-example-java-substring-method"><a href="#_10-5-example-java-substring-method" class="header-anchor">#</a> 10.5  Example: Java substring method</h2> <p>As a final example, consider the Java String class and its substring</p> <p>method. Given two indexes into a string, substring returns the substring
starting at the character given by the first index and ending with the
character just before the second index. However, if either index is outside
the range of the string, then substring throws IndexOutOfBoundsException.</p> <p>This exception is unnecessary and complicates the use of this method. I
often find myself in a situation where one or both of the indices may be
outside the range of the string, and I would like to extract all of the
characters in the string that overlap the specified range. Unfortunately, this
requires me to check each of the indices and round them up to zero or
down to the end of the string; a one-line method call now becomes 5–10
lines of code.</p> <p>The Java substring method would be easier to use if it performed this
adjustment automatically, so that it implemented the following API:
“returns the characters of the string (if any) with index greater than or
equal to beginIndex and less than endIndex.” This is a simple and natural</p> <p>API, and it defines the IndexOutOfBoundsException exception out of
existence. The method’s behavior is now well-defined even if one or both
of the indexes are negative, or if beginIndex is greater than endIndex. This</p> <p>approach simplifies the API for the method while increasing its
functionality, so it makes the method deeper. Many other languages have
taken the error-free approach; for example, Python returns an empty result
for out-of-range list slices.</p> <p>When I argue for defining errors out of existence, people sometimes
counter that throwing errors will catch bugs; if errors are defined out of</p> <p>existence, won’t that result in buggier software? Perhaps this is why the
Java developers decided that substring should throw exceptions. The</p> <p>error-ful approach may catch some bugs, but it also increases complexity,
which results in other bugs. In the error-ful approach, developers must
write additional code to avoid or ignore the errors, and this increases the
likelihood of bugs; or, they may forget to write the additional code, in
which case unexpected errors may be thrown at runtime. In contrast,
defining errors out of existence simplifies APIs and it reduces the amount
of code that must be written.</p> <div class="language- extra-class"><pre class="language-text"><code>Overall, the best way to reduce bugs is to make software simpler.
</code></pre></div><h2 id="_10-6-mask-exceptions"><a href="#_10-6-mask-exceptions" class="header-anchor">#</a> 10.6  Mask exceptions</h2> <p>The second technique for reducing the number of places where exceptions
must be handled is exception masking. With this approach, an exceptional
condition is detected and handled at a low level in the system, so that
higher levels of software need not be aware of the condition. Exception
masking is particularly common in distributed systems. For instance, in a
network transport protocol such as TCP, packets can be dropped for
various reasons such as corruption and congestion. TCP masks packet loss
by resending lost packets within its implementation, so all data eventually
gets through and clients are unaware of the dropped packets.</p> <p>A more controversial example of masking occurs in the NFS network
file system. If an NFS file server crashes or fails to respond for any
reason, clients reissue their requests to the server over and over again until
the problem is eventually resolved. The low-level file system code on the
client does not report any exceptions to the invoking application. The
operation in progress (and hence the application) just hangs until the
operation can complete successfully. If the hang lasts more than a short
time, the NFS client prints messages on the user’s console of the form
“NFS server xyzzy not responding still trying.”</p> <p>NFS users often complain about the fact that their applications hang
while waiting for an NFS server to resume normal operation. Many people
have suggested that NFS should abort operations with an exception rather
than hanging. However, reporting exceptions would make things worse, not</p> <p>better. There’s not much an application can do if it loses access to its files.
One possibility would be for the application to retry the file operation, but
this would still hang the application, and it’s easier to perform the retry in
one place in the NFS layer, rather than at every file system call in every
application (a compiler shouldn’t have to worry about this!). The other
alternative is for applications to abort and return errors to their callers. It’s
unlikely that the callers would know what to do either, so they would abort
as well, resulting in a collapse of the user’s working environment. Users
still wouldn’t be able to get any work done while the file server was down,
and they would have to restart all of their applications once the file server
came back to life.</p> <p>Thus, the best alternative is for NFS to mask the errors and hang
applications. With this approach, applications don’t need any code to deal
with server problems, and they can resume seamlessly once the server
comes back to life. If users get tired of waiting, they can always abort
applications manually.</p> <p>Exception masking doesn’t work in all situations, but it is a powerful
tool in the situations where it works. It results in deeper classes, since it
reduces the class’s interface (fewer exceptions for users to be aware of)
and adds functionality in the form of the code that masks the exception.
Exception masking is an example of pulling complexity downward.</p> <h2 id="_10-7-exception-aggregation"><a href="#_10-7-exception-aggregation" class="header-anchor">#</a> 10.7  Exception aggregation</h2> <p>The third technique for reducing complexity related to exceptions is
exception aggregation. The idea behind exception aggregation is to handle
many exceptions with a single piece of code; rather than writing distinct
handlers for many individual exceptions, handle them all in one place with
a single handler.</p> <p>Consider how to handle missing parameters in a Web server. A Web
server implements a collection of URLs. When the server receives an
incoming URL, it dispatches to a URL-specific service method to process
that URL and generate a response. The URL contains various parameters
that are used to generate the response. Each service method will call a
lower-level method (let’s call it getParameter) to extract the parameters</p> <p>that it needs from the URL. If the URL does not contain the desired
parameter, getParameter throws an exception.</p> <p>When students in a software design class implemented such a server,
many of them wrapped each distinct call to getParameter in a separate
exception handler to catch NoSuchParameter exceptions, as in Figure 10.1.</p> <p>This resulted in a large number of handlers, all of which did essentially the
same thing (generate an error response).</p> <p>Figure 10.1: The code at the top dispatches to one of several methods in a Web server, each of
which handles a particular URL. Each of those methods (bottom) uses parameters from the
incoming HTTP request. In this figure, there is a separate exception handler for each call to
getParameter; this results in duplicated code.</p> <p>A better approach is to aggregate the exceptions. Instead of catching
the exceptions in the individual service methods, let them propagate up to
the top-level dispatch method for the Web server, as in Figure 10.2. A
single handler in this method can catch all of the exceptions and generate
an appropriate error response for missing parameters.</p> <p>The aggregation approach can be taken even further in the Web
example. There are many other errors besides missing parameters that can
occur while processing a Web page; for example, a parameter might not
have the right syntax (the service method expected an integer, but the</p> <p>value was “xyz”), or the user might not have permission for the requested
operation. In each case, the error should result in an error response; the
errors differ only in the error message to include in the response
(“parameter 'quantity' not present in URL” or “bad value 'xyz' for</p> <p>'quantity' parameter; must be positive integer”). Thus, all conditions
resulting in an error response can be handled with a single top-level
exception handler. The error message can be generated at the time the
exception is thrown and included as a variable in the exception record; for
example, getParameter will generate the “parameter 'quantity' not</p> <p>present in URL” message. The top-level handler extracts the message from
the exception and incorporates it into the error response.</p> <p>Figure 10.2: This code is functionally equivalent to Figure 10.1, but exception handling has been
aggregated: a single exception handler in the dispatcher catches all of the NoSuchParameter
exceptions from all of the URL-specific methods.</p> <p>The aggregation described in the preceding paragraph has good
properties from the standpoint of encapsulation and information hiding.
The top-level exception handler encapsulates knowledge about how to
generate error responses, but it knows nothing about specific errors; it just
uses the error message provided in the exception. The getParameter
method encapsulates knowledge about how to extract a parameter from a
URL, and it also knows how to describe extraction errors in a human-
readable form. These two pieces of information are closely related, so it
makes sense for them to be in the same place. However, getParameter</p> <p>knows nothing about the syntax of an HTTP error response. As new</p> <p>functionality is added to the Web server, new methods like getParameter</p> <p>may be created with their own errors. If the new methods throw exceptions
in the same way as getParameter (by generating exceptions that inherit
from the same superclass and including an error message in each
exception), they can plug into the existing system with no other changes:
the top-level handler will automatically generate error responses for them.</p> <p>This example illustrates a generally-useful design pattern for exception
handling. If a system processes a series of requests, it’s useful to define an
exception that aborts the current request, cleans up the system’s state, and
continues with the next request. The exception is caught in a single place
near the top of the system’s request-handling loop. This exception can be
thrown at any point in the processing of a request to abort the request;
different subclasses of the exception can be defined for different
conditions. Exceptions of this type should be clearly distinguished from
exceptions that are fatal to the entire system.</p> <p>Exception aggregation works best if an exception propagates several
levels up the stack before it is handled; this allows more exceptions from
more methods to be handled in the same place. This is the opposite of
exception masking: masking usually works best if an exception is handled
in a low-level method. For masking, the low-level method is typically a
library method used by many other methods, so allowing the exception to
propagate would increase the number of places where it is handled.
Masking and aggregation are similar in that both approaches position an
exception handler where it can catch the most exceptions, eliminating
many handlers that would otherwise need to be created.</p> <p>Another example of exception aggregation occurs in the RAMCloud
storage system for crash recovery. A RAMCloud system consists of a
collection of storage servers that keep multiple copies of each object, so
the system can recover from a variety of failures. For example, if a server
crashes and loses all of its data, RAMCloud reconstructs the lost data
using copies stored on other servers. Errors can also happen on a smaller
scale; for example, a server may discover that an individual object is
corrupted.</p> <p>RAMCloud does not have separate recovery mechanisms for each
different kind of error. Instead, RAMCloud “promotes” many smaller</p> <p>errors into larger ones. RAMCloud could, in principle, handle a corrupted
object by restoring that one object from a backup copy. However, it doesn’t
do this. Instead, if it discovers a corrupted object it crashes the server
containing the object. RAMCloud uses this approach because crash
recovery is quite complex and this approach minimized the number of
different recovery mechanisms that had to be created. Creating a recovery
mechanism for crashed servers was unavoidable, so RAMCloud uses the
same mechanism for other kinds of recovery as well. This reduced the
amount of code that had to be written, and it also meant that server crash
recovery gets invoked more often. As a result, bugs in recovery are more
likely to be discovered and fixed.</p> <p>One disadvantage of promoting a corrupted object into a server crash
is that it increases the cost of recovery considerably. This is not a problem
in RAMCloud, since object corruption is quite rare. However, error
promotion may not make sense for errors that happen frequently. As one
example, it would not be practical to crash a server anytime one of its
network packets is lost.</p> <p>One way of thinking about exception aggregation is that it replaces
several special-purpose mechanisms, each tailored for a particular
situation, with a single general-purpose mechanism that can handle
multiple situations. This provides another illustration of the benefits of
general-purpose mechanisms.</p> <h2 id="_10-8-just-crash"><a href="#_10-8-just-crash" class="header-anchor">#</a> 10.8  Just crash?</h2> <p>The fourth technique for reducing complexity related to exception
handling is to crash the application. In most applications there will be
certain errors that it’s not worth trying to handle. Typically, these errors
are difficult or impossible to handle and don’t occur very often. The
simplest thing to do in response to these errors is to print diagnostic
information and then abort the application.</p> <p>One example is “out of memory” errors that occur during storage
allocation. Consider the malloc function in C, which returns NULL if it</p> <p>cannot allocate the desired block of memory. This is an unfortunate
behavior, because it assumes that every single caller of malloc will check</p> <p>the return value and take appropriate action if there is no memory.
Applications contain numerous calls to malloc, so checking the result after</p> <p>each call would add significant complexity. If a programmer forgets the
check (which is fairly likely), then the application will dereference a null
pointer if memory runs out, resulting in a crash that camouflages the real
problem.</p> <p>Furthermore, there isn’t much an application can do when it discovers
that memory is exhausted. In principle the application could look for
unneeded memory to free, but if the application had unneeded memory it
could already have freed it, which would have prevented the out-of-
memory error in the first place. Today’s systems have so much memory
that memory almost never runs out; if it does, it usually indicates a bug in
the application. Thus, it rarely make sense to try to handle out-of-memory
errors; this creates too much complexity for too little benefit.</p> <p>A better approach is to define a new method ckalloc, which calls
malloc, checks the result, and aborts the application with an error message</p> <p>if memory is exhausted. The application never invokes malloc directly; it
always invokes ckalloc.</p> <p>In newer languages such as C++ and Java, the new operator throws an
exception if memory is exhausted. There’s not much point in catching this
exception, since there’s a good chance that the exception handler will also
try to allocate memory, which will also fail. Dynamically allocated
memory is such a fundamental element of any modern application that it
doesn’t make sense for the application to continue if memory is exhausted;
it’s better to crash as soon as the error is detected.</p> <p>There are many other examples of errors where crashing the
application makes sense. For most programs, if an I/O error occurs while
reading or writing an open file (such as a disk hard error), or if a network
socket cannot be opened, there’s not much the application can do to
recover, so aborting with a clear error message is a sensible approach.
These errors are infrequent, so they are unlikely to affect the overall
usability of the application. Aborting with an error message is also
appropriate if an application encounters an internal error such as an</p> <p>inconsistent data structure. Conditions like this probably indicate bugs in
the program.</p> <p>Whether or not it is acceptable to crash on a particular error depends
on the application. For a replicated storage system, it isn’t appropriate to
abort on an I/O error. Instead, the system must use replicated data to
recover any information that was lost. The recovery mechanisms will add
considerable complexity to the program, but recovering lost data is an
essential part of the value the system provides to its users.</p> <h2 id="_10-9-design-special-cases-out-of-existence"><a href="#_10-9-design-special-cases-out-of-existence" class="header-anchor">#</a> 10.9  Design special cases out of existence</h2> <p>For the same reason that it makes sense to define errors out of existence, it
also makes sense to define other special cases out of existence. Special
cases can result in code that is riddled with if statements, which make the
code hard to understand and lead to bugs. Thus, special cases should be
eliminated wherever possible. The best way to do this is by designing the
normal case in a way that automatically handles the special cases without
any extra code.</p> <p>In the text editor project described in Chapter 6, students had to
implement a mechanism for selecting text and copying or deleting the
selection. Most students introduced a state variable in their selection
implementation to indicate whether or not the selection exists. They
probably chose this approach because there are times when no selection is
visible on the screen, so it seemed natural to represent this notion in the
implementation. However, this approach resulted in numerous checks to
detect the “no selection” condition and handle it specially.</p> <p>The selection handling code can be simplified by eliminating the “no
selection” special case, so that the selection always exists. When there is
no selection visible on the screen, it can be represented internally with an
empty selection, whose starting and ending positions are the same. With
this approach, the selection management code can be written without any
checks for “no selection”. When copying the selection, if the selection is
empty then 0 bytes will be inserted at the new location (if implemented
correctly, there will be no need to check for 0 bytes as a special case).
Similarly, it should be possible to design the code for deleting the</p> <p>selection so that the empty case is handled without any special-case
checks. Consider a selection all on a single line. To delete the selection,
extract the portion of the line preceding the selection and concatenate it
with the portion of the line following the selection to form the new line. If
the selection is empty, this approach will regenerate the original line.</p> <p>This example also illustrates the “different layer, different abstraction”
idea from Chapter 7. The notion of “no selection” makes sense in terms of
how the user thinks about the application’s interface, but that doesn’t mean
it has to be represented explicitly inside the application. Having a
selection that always exists, but is sometimes empty and thus invisible,
results in a simpler implementation.</p> <h2 id="_10-10-taking-it-too-far"><a href="#_10-10-taking-it-too-far" class="header-anchor">#</a> 10.10  Taking it too far</h2> <p>Defining away exceptions, or masking them inside a module, only makes
sense if the exception information isn’t needed outside the module. This
was true for the examples in this chapter, such the Tcl unset command and
the Java substring method; in the rare situations where a caller cares</p> <p>about the special cases detected by the exceptions, there are other ways for
it to get this information.</p> <p>However, it is possible to take this idea too far. In a module for
network communication, a student team masked all network exceptions: if
a network error occurred, the module caught it, discarded it, and continued
as if there were no problem. This meant that applications using the module
had no way to find out if messages were lost or a peer server failed;
without this information, it was impossible to build robust applications. In
this case, it is essential for the module to expose the exceptions, even
though they add complexity to the module’s interface.</p> <p>With exceptions, as with many other areas in software design, you
must determine what is important and what is not important. Things that
are not important should be hidden, and the more of them the better. But
when something is important, it must be exposed.</p> <h2 id="_10-11-conclusion"><a href="#_10-11-conclusion" class="header-anchor">#</a> 10.11  Conclusion</h2> <p>Special cases of any form make code harder to understand and increase the
likelihood of bugs. This chapter focused on exceptions, which are one of
the most significant sources of special-case code, and discussed how to
reduce the number of places where exceptions must be handled. The best
way to do this is by redefining semantics to eliminate error conditions. For
exceptions that can’t be defined away, you should look for opportunities to
mask them at a low level, so their impact is limited, or aggregate several
special-case handlers into a single more generic handler. Together, these
techniques can have a significant impact on overall system complexity.</p> <p>(^1) Ding Yuan et. al., “Simple Testing Can Prevent Most Critical Failures: An Analysis of
Production Failures in Distributed Data-Intensive Systems,” 2014 USENIX Conference on
Operating System Design and Implementation.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/philosophy/c9.html" class="prev">
        9.  Better Together Or Better Apart?
      </a></span> <span class="next"><a href="/docs/kungfu/philosophy/c11.html">
        11.  Design it Twice
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.feff3dbb.js" defer></script><script src="/docs/assets/js/2.aca46d71.js" defer></script><script src="/docs/assets/js/249.29294a64.js" defer></script><script src="/docs/assets/js/27.5ed2ce18.js" defer></script>
  </body>
</html>
