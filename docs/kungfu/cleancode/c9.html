<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>9. Unit Tests | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.de900540.css" as="style"><link rel="preload" href="/docs/assets/js/app.e6f4376b.js" as="script"><link rel="preload" href="/docs/assets/js/2.c567e596.js" as="script"><link rel="preload" href="/docs/assets/js/253.58bdeef4.js" as="script"><link rel="preload" href="/docs/assets/js/27.2fe5f85e.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e2dac1de.js"><link rel="prefetch" href="/docs/assets/js/100.1019c9aa.js"><link rel="prefetch" href="/docs/assets/js/101.47043ee7.js"><link rel="prefetch" href="/docs/assets/js/102.32e07b16.js"><link rel="prefetch" href="/docs/assets/js/103.b2be11d8.js"><link rel="prefetch" href="/docs/assets/js/104.530f44ee.js"><link rel="prefetch" href="/docs/assets/js/105.76e1e949.js"><link rel="prefetch" href="/docs/assets/js/106.09a8d8a3.js"><link rel="prefetch" href="/docs/assets/js/107.168e44fc.js"><link rel="prefetch" href="/docs/assets/js/108.01423084.js"><link rel="prefetch" href="/docs/assets/js/109.8990dd5a.js"><link rel="prefetch" href="/docs/assets/js/11.35e42eac.js"><link rel="prefetch" href="/docs/assets/js/110.82bba41b.js"><link rel="prefetch" href="/docs/assets/js/111.1125b628.js"><link rel="prefetch" href="/docs/assets/js/112.115f4593.js"><link rel="prefetch" href="/docs/assets/js/113.2fa3519c.js"><link rel="prefetch" href="/docs/assets/js/114.253d8cf7.js"><link rel="prefetch" href="/docs/assets/js/115.54bc1063.js"><link rel="prefetch" href="/docs/assets/js/116.f82b2df1.js"><link rel="prefetch" href="/docs/assets/js/117.d836bab6.js"><link rel="prefetch" href="/docs/assets/js/118.4cedf3cb.js"><link rel="prefetch" href="/docs/assets/js/119.03d1ba74.js"><link rel="prefetch" href="/docs/assets/js/12.77552012.js"><link rel="prefetch" href="/docs/assets/js/120.7ab1d0b2.js"><link rel="prefetch" href="/docs/assets/js/121.33129b96.js"><link rel="prefetch" href="/docs/assets/js/122.f84d349b.js"><link rel="prefetch" href="/docs/assets/js/123.23978418.js"><link rel="prefetch" href="/docs/assets/js/124.6153593b.js"><link rel="prefetch" href="/docs/assets/js/125.63b16fde.js"><link rel="prefetch" href="/docs/assets/js/126.874d667b.js"><link rel="prefetch" href="/docs/assets/js/127.a7bf043b.js"><link rel="prefetch" href="/docs/assets/js/128.b185e1cb.js"><link rel="prefetch" href="/docs/assets/js/129.7f66c467.js"><link rel="prefetch" href="/docs/assets/js/13.26895487.js"><link rel="prefetch" href="/docs/assets/js/130.1ebf00e6.js"><link rel="prefetch" href="/docs/assets/js/131.d38c7ac3.js"><link rel="prefetch" href="/docs/assets/js/132.ad677805.js"><link rel="prefetch" href="/docs/assets/js/133.7b777d9e.js"><link rel="prefetch" href="/docs/assets/js/134.54951f20.js"><link rel="prefetch" href="/docs/assets/js/135.53b7cfb9.js"><link rel="prefetch" href="/docs/assets/js/136.137895aa.js"><link rel="prefetch" href="/docs/assets/js/137.15a4b031.js"><link rel="prefetch" href="/docs/assets/js/138.a2312d73.js"><link rel="prefetch" href="/docs/assets/js/139.a57c61a5.js"><link rel="prefetch" href="/docs/assets/js/14.2edfcc03.js"><link rel="prefetch" href="/docs/assets/js/140.e9baf5b1.js"><link rel="prefetch" href="/docs/assets/js/141.11cc8c14.js"><link rel="prefetch" href="/docs/assets/js/142.bb0d37fd.js"><link rel="prefetch" href="/docs/assets/js/143.14196c06.js"><link rel="prefetch" href="/docs/assets/js/144.15932f50.js"><link rel="prefetch" href="/docs/assets/js/145.584774ba.js"><link rel="prefetch" href="/docs/assets/js/146.84d95b56.js"><link rel="prefetch" href="/docs/assets/js/147.be95fa3f.js"><link rel="prefetch" href="/docs/assets/js/148.c3701230.js"><link rel="prefetch" href="/docs/assets/js/149.98df8ee3.js"><link rel="prefetch" href="/docs/assets/js/15.35c82508.js"><link rel="prefetch" href="/docs/assets/js/150.2d40812e.js"><link rel="prefetch" href="/docs/assets/js/151.99e6c188.js"><link rel="prefetch" href="/docs/assets/js/152.eaa332f9.js"><link rel="prefetch" href="/docs/assets/js/153.270118b4.js"><link rel="prefetch" href="/docs/assets/js/154.7c030e9f.js"><link rel="prefetch" href="/docs/assets/js/155.b580d56a.js"><link rel="prefetch" href="/docs/assets/js/156.15bfb38b.js"><link rel="prefetch" href="/docs/assets/js/157.31ba83c8.js"><link rel="prefetch" href="/docs/assets/js/158.46c033c2.js"><link rel="prefetch" href="/docs/assets/js/159.cce2e6f4.js"><link rel="prefetch" href="/docs/assets/js/16.a02a3b6d.js"><link rel="prefetch" href="/docs/assets/js/160.49b5df32.js"><link rel="prefetch" href="/docs/assets/js/161.1d8cec93.js"><link rel="prefetch" href="/docs/assets/js/162.3f911dd3.js"><link rel="prefetch" href="/docs/assets/js/163.85e29973.js"><link rel="prefetch" href="/docs/assets/js/164.99cff7ee.js"><link rel="prefetch" href="/docs/assets/js/165.929c8a70.js"><link rel="prefetch" href="/docs/assets/js/166.dfedef39.js"><link rel="prefetch" href="/docs/assets/js/167.00aa19b1.js"><link rel="prefetch" href="/docs/assets/js/168.266fd220.js"><link rel="prefetch" href="/docs/assets/js/169.4cf018a7.js"><link rel="prefetch" href="/docs/assets/js/17.e91576e7.js"><link rel="prefetch" href="/docs/assets/js/170.13c9a11b.js"><link rel="prefetch" href="/docs/assets/js/171.b2917bd7.js"><link rel="prefetch" href="/docs/assets/js/172.e830f996.js"><link rel="prefetch" href="/docs/assets/js/173.cdaf83bd.js"><link rel="prefetch" href="/docs/assets/js/174.c44b53cd.js"><link rel="prefetch" href="/docs/assets/js/175.2c4b88dd.js"><link rel="prefetch" href="/docs/assets/js/176.5ec45030.js"><link rel="prefetch" href="/docs/assets/js/177.83c40c28.js"><link rel="prefetch" href="/docs/assets/js/178.e86d2522.js"><link rel="prefetch" href="/docs/assets/js/179.309921d8.js"><link rel="prefetch" href="/docs/assets/js/18.a01baf67.js"><link rel="prefetch" href="/docs/assets/js/180.7fd0d476.js"><link rel="prefetch" href="/docs/assets/js/181.8ad6c099.js"><link rel="prefetch" href="/docs/assets/js/182.258a6344.js"><link rel="prefetch" href="/docs/assets/js/183.9ad566ea.js"><link rel="prefetch" href="/docs/assets/js/184.e0b67032.js"><link rel="prefetch" href="/docs/assets/js/185.dbdd5484.js"><link rel="prefetch" href="/docs/assets/js/186.3b995a6b.js"><link rel="prefetch" href="/docs/assets/js/187.0a868cb3.js"><link rel="prefetch" href="/docs/assets/js/188.0e16793f.js"><link rel="prefetch" href="/docs/assets/js/189.878ad619.js"><link rel="prefetch" href="/docs/assets/js/19.8db2032b.js"><link rel="prefetch" href="/docs/assets/js/190.e75345de.js"><link rel="prefetch" href="/docs/assets/js/191.a1599633.js"><link rel="prefetch" href="/docs/assets/js/192.a58e056b.js"><link rel="prefetch" href="/docs/assets/js/193.0f5d4d83.js"><link rel="prefetch" href="/docs/assets/js/194.06ad7f97.js"><link rel="prefetch" href="/docs/assets/js/195.029fbf94.js"><link rel="prefetch" href="/docs/assets/js/196.b31f6821.js"><link rel="prefetch" href="/docs/assets/js/197.355b2253.js"><link rel="prefetch" href="/docs/assets/js/198.d0003627.js"><link rel="prefetch" href="/docs/assets/js/199.8e78e8ae.js"><link rel="prefetch" href="/docs/assets/js/20.42bff4eb.js"><link rel="prefetch" href="/docs/assets/js/200.fe435c8c.js"><link rel="prefetch" href="/docs/assets/js/201.918c2ec6.js"><link rel="prefetch" href="/docs/assets/js/202.e30c28f5.js"><link rel="prefetch" href="/docs/assets/js/203.f356d62f.js"><link rel="prefetch" href="/docs/assets/js/204.8c7c27ff.js"><link rel="prefetch" href="/docs/assets/js/205.eaed665e.js"><link rel="prefetch" href="/docs/assets/js/206.2ee34ac6.js"><link rel="prefetch" href="/docs/assets/js/207.a9872dbd.js"><link rel="prefetch" href="/docs/assets/js/208.c5e83026.js"><link rel="prefetch" href="/docs/assets/js/209.ebf4b5e2.js"><link rel="prefetch" href="/docs/assets/js/21.46ae6025.js"><link rel="prefetch" href="/docs/assets/js/210.cde9c61c.js"><link rel="prefetch" href="/docs/assets/js/211.b6e04985.js"><link rel="prefetch" href="/docs/assets/js/212.e9172623.js"><link rel="prefetch" href="/docs/assets/js/213.8798e458.js"><link rel="prefetch" href="/docs/assets/js/214.a6af472b.js"><link rel="prefetch" href="/docs/assets/js/215.bddab8fd.js"><link rel="prefetch" href="/docs/assets/js/216.8dc1d6f8.js"><link rel="prefetch" href="/docs/assets/js/217.eeefde38.js"><link rel="prefetch" href="/docs/assets/js/218.f7bef36c.js"><link rel="prefetch" href="/docs/assets/js/219.3a0a009c.js"><link rel="prefetch" href="/docs/assets/js/22.11947baf.js"><link rel="prefetch" href="/docs/assets/js/220.2cd82f28.js"><link rel="prefetch" href="/docs/assets/js/221.9b13b2f1.js"><link rel="prefetch" href="/docs/assets/js/222.41ee572e.js"><link rel="prefetch" href="/docs/assets/js/223.81251b78.js"><link rel="prefetch" href="/docs/assets/js/224.dd442ce1.js"><link rel="prefetch" href="/docs/assets/js/225.aa8d680a.js"><link rel="prefetch" href="/docs/assets/js/226.c00cf6fc.js"><link rel="prefetch" href="/docs/assets/js/227.9b84ce39.js"><link rel="prefetch" href="/docs/assets/js/228.82c38259.js"><link rel="prefetch" href="/docs/assets/js/229.9ef24570.js"><link rel="prefetch" href="/docs/assets/js/23.d16e46b2.js"><link rel="prefetch" href="/docs/assets/js/230.a3600074.js"><link rel="prefetch" href="/docs/assets/js/231.72f67ced.js"><link rel="prefetch" href="/docs/assets/js/232.39d541ac.js"><link rel="prefetch" href="/docs/assets/js/233.a6d5747c.js"><link rel="prefetch" href="/docs/assets/js/234.9ebc59e0.js"><link rel="prefetch" href="/docs/assets/js/235.fa876107.js"><link rel="prefetch" href="/docs/assets/js/236.48069f51.js"><link rel="prefetch" href="/docs/assets/js/237.efffb3b7.js"><link rel="prefetch" href="/docs/assets/js/238.26c3f5ba.js"><link rel="prefetch" href="/docs/assets/js/239.15aa141b.js"><link rel="prefetch" href="/docs/assets/js/24.33d7caa6.js"><link rel="prefetch" href="/docs/assets/js/240.a7287e74.js"><link rel="prefetch" href="/docs/assets/js/241.a342559e.js"><link rel="prefetch" href="/docs/assets/js/242.15c0b307.js"><link rel="prefetch" href="/docs/assets/js/243.7e2571ee.js"><link rel="prefetch" href="/docs/assets/js/244.3a3a15ec.js"><link rel="prefetch" href="/docs/assets/js/245.da27fbfe.js"><link rel="prefetch" href="/docs/assets/js/246.ce6c7a0e.js"><link rel="prefetch" href="/docs/assets/js/247.59d77890.js"><link rel="prefetch" href="/docs/assets/js/248.e1ce2d39.js"><link rel="prefetch" href="/docs/assets/js/249.a5b9105e.js"><link rel="prefetch" href="/docs/assets/js/25.b32d948e.js"><link rel="prefetch" href="/docs/assets/js/250.4b2838f5.js"><link rel="prefetch" href="/docs/assets/js/251.80b6e869.js"><link rel="prefetch" href="/docs/assets/js/252.a065684d.js"><link rel="prefetch" href="/docs/assets/js/254.002268e9.js"><link rel="prefetch" href="/docs/assets/js/255.565bb127.js"><link rel="prefetch" href="/docs/assets/js/256.7cadb9fb.js"><link rel="prefetch" href="/docs/assets/js/257.066db541.js"><link rel="prefetch" href="/docs/assets/js/258.21d9e4e1.js"><link rel="prefetch" href="/docs/assets/js/259.c7baf7c8.js"><link rel="prefetch" href="/docs/assets/js/26.16f7e1d9.js"><link rel="prefetch" href="/docs/assets/js/260.3f712e13.js"><link rel="prefetch" href="/docs/assets/js/261.6223d197.js"><link rel="prefetch" href="/docs/assets/js/262.20e5d820.js"><link rel="prefetch" href="/docs/assets/js/263.c2730e46.js"><link rel="prefetch" href="/docs/assets/js/264.fc5d9812.js"><link rel="prefetch" href="/docs/assets/js/265.ec2d1171.js"><link rel="prefetch" href="/docs/assets/js/266.d6e7b50d.js"><link rel="prefetch" href="/docs/assets/js/267.4e99b865.js"><link rel="prefetch" href="/docs/assets/js/268.aa9b8065.js"><link rel="prefetch" href="/docs/assets/js/269.dec0bb9e.js"><link rel="prefetch" href="/docs/assets/js/270.aed7b827.js"><link rel="prefetch" href="/docs/assets/js/271.9740fee8.js"><link rel="prefetch" href="/docs/assets/js/272.675fbf64.js"><link rel="prefetch" href="/docs/assets/js/273.d36c9c44.js"><link rel="prefetch" href="/docs/assets/js/274.4bb99079.js"><link rel="prefetch" href="/docs/assets/js/275.bd3c07a1.js"><link rel="prefetch" href="/docs/assets/js/276.a9419d5a.js"><link rel="prefetch" href="/docs/assets/js/277.b83b344f.js"><link rel="prefetch" href="/docs/assets/js/278.8d4996af.js"><link rel="prefetch" href="/docs/assets/js/279.a20d027e.js"><link rel="prefetch" href="/docs/assets/js/28.0c8cb4fc.js"><link rel="prefetch" href="/docs/assets/js/280.a178c440.js"><link rel="prefetch" href="/docs/assets/js/281.f095cd12.js"><link rel="prefetch" href="/docs/assets/js/282.3715e8b6.js"><link rel="prefetch" href="/docs/assets/js/283.9b9cebb7.js"><link rel="prefetch" href="/docs/assets/js/284.643270d2.js"><link rel="prefetch" href="/docs/assets/js/285.1108fddd.js"><link rel="prefetch" href="/docs/assets/js/286.905bd69c.js"><link rel="prefetch" href="/docs/assets/js/287.85973a71.js"><link rel="prefetch" href="/docs/assets/js/288.e784223a.js"><link rel="prefetch" href="/docs/assets/js/289.07dbef61.js"><link rel="prefetch" href="/docs/assets/js/29.245e1d18.js"><link rel="prefetch" href="/docs/assets/js/290.96e40344.js"><link rel="prefetch" href="/docs/assets/js/291.4ccedd4c.js"><link rel="prefetch" href="/docs/assets/js/292.dba173c6.js"><link rel="prefetch" href="/docs/assets/js/293.0d0f6849.js"><link rel="prefetch" href="/docs/assets/js/294.38521e8b.js"><link rel="prefetch" href="/docs/assets/js/295.fdcf3da4.js"><link rel="prefetch" href="/docs/assets/js/296.3e72bd72.js"><link rel="prefetch" href="/docs/assets/js/297.73a63c2e.js"><link rel="prefetch" href="/docs/assets/js/298.ddded5e7.js"><link rel="prefetch" href="/docs/assets/js/299.0a232d2d.js"><link rel="prefetch" href="/docs/assets/js/3.92cd7dc5.js"><link rel="prefetch" href="/docs/assets/js/30.8cfef6f2.js"><link rel="prefetch" href="/docs/assets/js/300.b57f7b7a.js"><link rel="prefetch" href="/docs/assets/js/301.9c733755.js"><link rel="prefetch" href="/docs/assets/js/302.9298ee48.js"><link rel="prefetch" href="/docs/assets/js/303.5d0a72f5.js"><link rel="prefetch" href="/docs/assets/js/304.72de365a.js"><link rel="prefetch" href="/docs/assets/js/305.bcd3028e.js"><link rel="prefetch" href="/docs/assets/js/306.57bf06c4.js"><link rel="prefetch" href="/docs/assets/js/307.6daa1741.js"><link rel="prefetch" href="/docs/assets/js/308.20017fc1.js"><link rel="prefetch" href="/docs/assets/js/309.3de02318.js"><link rel="prefetch" href="/docs/assets/js/31.e0497e17.js"><link rel="prefetch" href="/docs/assets/js/310.6cd5c12b.js"><link rel="prefetch" href="/docs/assets/js/311.6091a077.js"><link rel="prefetch" href="/docs/assets/js/312.00650623.js"><link rel="prefetch" href="/docs/assets/js/313.e366c3f3.js"><link rel="prefetch" href="/docs/assets/js/314.a123e472.js"><link rel="prefetch" href="/docs/assets/js/315.2209b379.js"><link rel="prefetch" href="/docs/assets/js/316.b7279580.js"><link rel="prefetch" href="/docs/assets/js/317.5f238fa1.js"><link rel="prefetch" href="/docs/assets/js/318.f421b7c7.js"><link rel="prefetch" href="/docs/assets/js/319.e6c79f12.js"><link rel="prefetch" href="/docs/assets/js/32.9505938f.js"><link rel="prefetch" href="/docs/assets/js/320.69026087.js"><link rel="prefetch" href="/docs/assets/js/321.d210e900.js"><link rel="prefetch" href="/docs/assets/js/322.445e187f.js"><link rel="prefetch" href="/docs/assets/js/323.d89fe500.js"><link rel="prefetch" href="/docs/assets/js/324.95675577.js"><link rel="prefetch" href="/docs/assets/js/325.55022001.js"><link rel="prefetch" href="/docs/assets/js/326.b9bbdf0a.js"><link rel="prefetch" href="/docs/assets/js/327.ca13cacf.js"><link rel="prefetch" href="/docs/assets/js/328.a26e3d2d.js"><link rel="prefetch" href="/docs/assets/js/329.442d1bc4.js"><link rel="prefetch" href="/docs/assets/js/33.0814aba0.js"><link rel="prefetch" href="/docs/assets/js/330.3edc4ce9.js"><link rel="prefetch" href="/docs/assets/js/331.5f9873cb.js"><link rel="prefetch" href="/docs/assets/js/332.c545ec60.js"><link rel="prefetch" href="/docs/assets/js/333.cee0ed0e.js"><link rel="prefetch" href="/docs/assets/js/334.1d41d54d.js"><link rel="prefetch" href="/docs/assets/js/335.30c765fb.js"><link rel="prefetch" href="/docs/assets/js/336.ec4a2a93.js"><link rel="prefetch" href="/docs/assets/js/337.3e7fe1c2.js"><link rel="prefetch" href="/docs/assets/js/338.1bcd25d1.js"><link rel="prefetch" href="/docs/assets/js/339.6dea15ab.js"><link rel="prefetch" href="/docs/assets/js/34.6443a99d.js"><link rel="prefetch" href="/docs/assets/js/340.2c40997d.js"><link rel="prefetch" href="/docs/assets/js/341.ab57a35d.js"><link rel="prefetch" href="/docs/assets/js/342.98a52991.js"><link rel="prefetch" href="/docs/assets/js/343.5b53d2b6.js"><link rel="prefetch" href="/docs/assets/js/344.9371fb5c.js"><link rel="prefetch" href="/docs/assets/js/345.9a8d8598.js"><link rel="prefetch" href="/docs/assets/js/346.eddaff9c.js"><link rel="prefetch" href="/docs/assets/js/347.8a3cf057.js"><link rel="prefetch" href="/docs/assets/js/348.c84f5dd0.js"><link rel="prefetch" href="/docs/assets/js/349.35fa8a22.js"><link rel="prefetch" href="/docs/assets/js/35.c8556e22.js"><link rel="prefetch" href="/docs/assets/js/36.61195c58.js"><link rel="prefetch" href="/docs/assets/js/37.0d45ea01.js"><link rel="prefetch" href="/docs/assets/js/38.38bdcade.js"><link rel="prefetch" href="/docs/assets/js/39.925af8d0.js"><link rel="prefetch" href="/docs/assets/js/4.3504f0f8.js"><link rel="prefetch" href="/docs/assets/js/40.3af3fc6e.js"><link rel="prefetch" href="/docs/assets/js/41.cdea6c63.js"><link rel="prefetch" href="/docs/assets/js/42.60b8cfa2.js"><link rel="prefetch" href="/docs/assets/js/43.da1dd629.js"><link rel="prefetch" href="/docs/assets/js/44.c849b66e.js"><link rel="prefetch" href="/docs/assets/js/45.433ad275.js"><link rel="prefetch" href="/docs/assets/js/46.92b1f70a.js"><link rel="prefetch" href="/docs/assets/js/47.3af9e1f3.js"><link rel="prefetch" href="/docs/assets/js/48.997bbc96.js"><link rel="prefetch" href="/docs/assets/js/49.0daadd89.js"><link rel="prefetch" href="/docs/assets/js/5.13d03ba2.js"><link rel="prefetch" href="/docs/assets/js/50.44eda61d.js"><link rel="prefetch" href="/docs/assets/js/51.607c4f4c.js"><link rel="prefetch" href="/docs/assets/js/52.e4d41961.js"><link rel="prefetch" href="/docs/assets/js/53.4bea1c1d.js"><link rel="prefetch" href="/docs/assets/js/54.7d2f0df8.js"><link rel="prefetch" href="/docs/assets/js/55.18290a6e.js"><link rel="prefetch" href="/docs/assets/js/56.64b22fa0.js"><link rel="prefetch" href="/docs/assets/js/57.73d473ab.js"><link rel="prefetch" href="/docs/assets/js/58.d83e0b8c.js"><link rel="prefetch" href="/docs/assets/js/59.8838744d.js"><link rel="prefetch" href="/docs/assets/js/6.f2cec5bc.js"><link rel="prefetch" href="/docs/assets/js/60.c2e4e4bd.js"><link rel="prefetch" href="/docs/assets/js/61.5d179331.js"><link rel="prefetch" href="/docs/assets/js/62.d9245d7d.js"><link rel="prefetch" href="/docs/assets/js/63.5f56d4df.js"><link rel="prefetch" href="/docs/assets/js/64.d8a046be.js"><link rel="prefetch" href="/docs/assets/js/65.d46d4429.js"><link rel="prefetch" href="/docs/assets/js/66.9c03315d.js"><link rel="prefetch" href="/docs/assets/js/67.aff12540.js"><link rel="prefetch" href="/docs/assets/js/68.b8076318.js"><link rel="prefetch" href="/docs/assets/js/69.e5a74f3a.js"><link rel="prefetch" href="/docs/assets/js/7.166309ba.js"><link rel="prefetch" href="/docs/assets/js/70.ef9cf664.js"><link rel="prefetch" href="/docs/assets/js/71.7ddcf23b.js"><link rel="prefetch" href="/docs/assets/js/72.9196e6de.js"><link rel="prefetch" href="/docs/assets/js/73.64a3adde.js"><link rel="prefetch" href="/docs/assets/js/74.4cefa041.js"><link rel="prefetch" href="/docs/assets/js/75.cf06ccaa.js"><link rel="prefetch" href="/docs/assets/js/76.ef05c0e1.js"><link rel="prefetch" href="/docs/assets/js/77.c9b7b08f.js"><link rel="prefetch" href="/docs/assets/js/78.33462563.js"><link rel="prefetch" href="/docs/assets/js/79.7f145459.js"><link rel="prefetch" href="/docs/assets/js/8.981df812.js"><link rel="prefetch" href="/docs/assets/js/80.6b39121a.js"><link rel="prefetch" href="/docs/assets/js/81.d9661906.js"><link rel="prefetch" href="/docs/assets/js/82.68d2358d.js"><link rel="prefetch" href="/docs/assets/js/83.83569bfc.js"><link rel="prefetch" href="/docs/assets/js/84.6217d48d.js"><link rel="prefetch" href="/docs/assets/js/85.b7e99308.js"><link rel="prefetch" href="/docs/assets/js/86.f308da1b.js"><link rel="prefetch" href="/docs/assets/js/87.84a0eb05.js"><link rel="prefetch" href="/docs/assets/js/88.34c0ff40.js"><link rel="prefetch" href="/docs/assets/js/89.b68b605f.js"><link rel="prefetch" href="/docs/assets/js/9.e6eb567e.js"><link rel="prefetch" href="/docs/assets/js/90.074bcbcb.js"><link rel="prefetch" href="/docs/assets/js/91.456a2ebe.js"><link rel="prefetch" href="/docs/assets/js/92.67ddc76c.js"><link rel="prefetch" href="/docs/assets/js/93.1a41f1e2.js"><link rel="prefetch" href="/docs/assets/js/94.7a5d7b40.js"><link rel="prefetch" href="/docs/assets/js/95.c002ced0.js"><link rel="prefetch" href="/docs/assets/js/96.025bbcc3.js"><link rel="prefetch" href="/docs/assets/js/97.20814bac.js"><link rel="prefetch" href="/docs/assets/js/98.9ea75561.js"><link rel="prefetch" href="/docs/assets/js/99.08af2fe6.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.de900540.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Clean Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/cleancode/c1.html" class="sidebar-link">1. Clean Code</a></li><li><a href="/docs/kungfu/cleancode/c2.html" class="sidebar-link">2. Meaningful Names</a></li><li><a href="/docs/kungfu/cleancode/c3.html" class="sidebar-link">3. Functions</a></li><li><a href="/docs/kungfu/cleancode/c4.html" class="sidebar-link">4. Comments</a></li><li><a href="/docs/kungfu/cleancode/c5.html" class="sidebar-link">5. Formatting</a></li><li><a href="/docs/kungfu/cleancode/c6.html" class="sidebar-link">6. Objects and Data Structures</a></li><li><a href="/docs/kungfu/cleancode/c7.html" class="sidebar-link">7. Error Handling</a></li><li><a href="/docs/kungfu/cleancode/c8.html" class="sidebar-link">8. Boundaries</a></li><li><a href="/docs/kungfu/cleancode/c9.html" aria-current="page" class="active sidebar-link">9. Unit Tests</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#the-three-laws-of-tdd" class="sidebar-link">The Three Laws of TDD ...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#keeping-tests-clean" class="sidebar-link">Keeping Tests Clean ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#tests-enable-the-ilities" class="sidebar-link">Tests Enable the -ilities...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#clean-tests" class="sidebar-link">Clean Tests .</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#domain-specific-testing-language" class="sidebar-link">Domain-Specific Testing Language</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#a-dual-standard" class="sidebar-link">A Dual Standard .</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#one-assert-per-test" class="sidebar-link">One Assert per Test ...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#single-concept-per-test" class="sidebar-link">Single Concept per Test ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#f-i-r-s-t" class="sidebar-link">F.I.R.S.T. .</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#conclusion" class="sidebar-link">Conclusion ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c9.html#bibliography" class="sidebar-link">Bibliography ...</a></li></ul></li><li><a href="/docs/kungfu/cleancode/c10.html" class="sidebar-link">10. Classes</a></li><li><a href="/docs/kungfu/cleancode/c11.html" class="sidebar-link">11. Systems</a></li><li><a href="/docs/kungfu/cleancode/c12.html" class="sidebar-link">12. Emergence</a></li><li><a href="/docs/kungfu/cleancode/c13.html" class="sidebar-link">13. Concurrency</a></li><li><a href="/docs/kungfu/cleancode/c14.html" class="sidebar-link">14. Successive Refinement</a></li><li><a href="/docs/kungfu/cleancode/c15.html" class="sidebar-link">15. JUnit Internals</a></li><li><a href="/docs/kungfu/cleancode/c16.html" class="sidebar-link">16. Refactoring SerialDate</a></li><li><a href="/docs/kungfu/cleancode/c17.html" class="sidebar-link">17. Smells and Heuristics</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_9-unit-tests"><a href="#_9-unit-tests" class="header-anchor">#</a> 9. Unit Tests</h1> <p>Our profession has come a long way in the last ten years. In 1997 no one had heard of
Test Driven Development. For the vast majority of us, unit tests were short bits of throw-
away code that we wrote to make sure our programs “worked.” We would painstakingly
write our classes and methods, and then we would concoct some ad hoc code to test
them. Typically this would involve some kind of simple driver program that would allow
us to manually interact with the program we had written.</p> <p>I remember writing a C++ program for an embedded real-time system back in the
mid-90s. The program was a simple timer with the following signature:</p> <p>void Timer::ScheduleCommand(Command* theCommand, int milliseconds)
The idea was simple; the executemethod of the Commandwould be executed in a new
thread after the specified number of milliseconds. The problem was, how to test it.</p> <p>122 <strong>Chapter 9: Unit Tests</strong></p> <p>I cobbled together a simple driver program that listened to the keyboard. Every time a
character was typed, it would schedule a command that would type the same character five
seconds later. Then I tapped out a rhythmic melody on the keyboard and waited for that
melody to replay on the screen five seconds later.</p> <p>“I... want-a-girl... just... like-the-girl-who-marr... ied... dear... old... dad.”
I actually sang that melody while typing the “.” key, and then I sang it again as the
dots appeared on the screen.</p> <p>That was my test! Once I saw it work and demonstrated it to my colleagues, I threw
the test code away.</p> <p>As I said, our profession has come a long way. Nowadays I would write a test that made
sure that every nook and cranny of that code worked as I expected it to. I would isolate my
code from the operating system rather than just calling the standard timing functions. I
would mock out those timing functions so that I had absolute control over the time. I would
schedule commands that set boolean flags, and then I would step the time forward, watching
those flags and ensuring that they went from false to true just as I changed the time to the
right value.</p> <p>Once I got a suite of tests to pass, I would make sure that those tests were convenient
to run for anyone else who needed to work with the code. I would ensure that the tests and
the code were checked in together into the same source package.</p> <p>Yes, we’ve come a long way; but we have farther to go. The Agile and TDD move-
ments have encouraged many programmers to write automated unit tests, and more are
joining their ranks every day. But in the mad rush to add testing to our discipline, many
programmers have missed some of the more subtle, and important, points of writing
good tests.</p> <h2 id="the-three-laws-of-tdd"><a href="#the-three-laws-of-tdd" class="header-anchor">#</a> The Three Laws of TDD ...</h2> <p>By now everyone knows that TDD asks us to write unit tests first, before we write produc-
tion code. But that rule is just the tip of the iceberg. Consider the following three laws:^1</p> <p><strong>First Law</strong> You may not write production code until you have written a failing unit test.</p> <p><strong>Second Law</strong> You may not write more of a unit test than is sufficient to fail, and not com-
piling is failing.</p> <p><strong>Third Law</strong> You may not write more production code than is sufficient to pass the cur-
rently failing test.</p> <ol><li><em>Professionalism and Test-Driven Development</em> , Robert C. Martin, Object Mentor, IEEE Software, May/June 2007 (Vol. 24,
No. 3) pp. 32–36
<a href="http://doi.ieeecomputersociety.org/10.1109/MS.2007.85" target="_blank" rel="noopener noreferrer">http://doi.ieeecomputersociety.org/10.1109/MS.2007.85<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <p><strong>Keeping Tests Clean</strong> 123</p> <p>These three laws lock you into a cycle that is perhaps thirty seconds long. The tests
and the production code are written <em>together,</em> with the tests just a few seconds ahead of the
production code.</p> <p>If we work this way, we will write dozens of tests every day, hundreds of tests every
month, and thousands of tests every year. If we work this way, those tests will cover virtu-
ally all of our production code. The sheer bulk of those tests, which can rival the size of the
production code itself, can present a daunting management problem.</p> <h2 id="keeping-tests-clean"><a href="#keeping-tests-clean" class="header-anchor">#</a> Keeping Tests Clean ..</h2> <p>Some years back I was asked to coach a team who had explicitly decided that their test
code <em>should not</em> be maintained to the same standards of quality as their production code.
They gave each other license to break the rules in their unit tests. “Quick and dirty” was
the watchword. Their variables did not have to be well named, their test functions did not
need to be short and descriptive. Their test code did not need to be well designed and
thoughtfully partitioned. So long as the test code worked, and so long as it covered the pro-
duction code, it was good enough.</p> <p>Some of you reading this might sympathize with that decision. Perhaps, long in the
past, you wrote tests of the kind that I wrote for that Timerclass. It’s a huge step from
writing that kind of throw-away test, to writing a suite of automated unit tests. So, like the
team I was coaching, you might decide that having dirty tests is better than having no
tests.</p> <p>What this team did not realize was that having dirty tests is equivalent to, if not worse
than, having no tests. The problem is that tests must change as the production code
evolves. The dirtier the tests, the harder they are to change. The more tangled the test code,
the more likely it is that you will spend more time cramming new tests into the suite than it
takes to write the new production code. As you modify the production code, old tests start
to fail, and the mess in the test code makes it hard to get those tests to pass again. So the
tests become viewed as an ever-increasing liability.</p> <p>From release to release the cost of maintaining my team’s test suite rose. Eventually it
became the single biggest complaint among the developers. When managers asked why
their estimates were getting so large, the developers blamed the tests. In the end they were
forced to discard the test suite entirely.</p> <p>But, without a test suite they lost the ability to make sure that changes to their code
base worked as expected. Without a test suite they could not ensure that changes to one
part of their system did not break other parts of their system. So their defect rate began to
rise. As the number of unintended defects rose, they started to fear making changes. They
stopped cleaning their production code because they feared the changes would do more
harm than good. Their production code began to rot. In the end they were left with no tests,
tangled and bug-riddled production code, frustrated customers, and the feeling that their
testing effort had failed them.</p> <p>124 <strong>Chapter 9: Unit Tests</strong></p> <p>In a way they were right. Their testing effort <em>had</em> failed them. But it was their decision
to allow the tests to be messy that was the seed of that failure. Had they kept their tests
clean, their testing effort would not have failed. I can say this with some certainty because
I have participated in, and coached, many teams who have been successful with <em>clean</em> unit
tests.</p> <p>The moral of the story is simple: <em>Test code is just as important as production code.</em> It
is not a second-class citizen. It requires thought, design, and care. It must be kept as clean
as production code.</p> <h2 id="tests-enable-the-ilities"><a href="#tests-enable-the-ilities" class="header-anchor">#</a> Tests Enable the -ilities...</h2> <p>If you don’t keep your tests clean, you will lose them. And without them, you lose the very
thing that keeps your production code flexible. Yes, you read that correctly. It is <em>unit tests</em>
that keep our code flexible, maintainable, and reusable. The reason is simple. If you have
tests, you do not fear making changes to the code! Without tests every change is a possible
bug. No matter how flexible your architecture is, no matter how nicely partitioned your
design, without tests you will be reluctant to make changes because of the fear that you
will introduce undetected bugs.</p> <p>But <em>with</em> tests that fear virtually disappears. The higher your test coverage, the less
your fear. You can make changes with near impunity to code that has a less than stellar
architecture and a tangled and opaque design. Indeed, you can <em>improve</em> that architecture
and design without fear!</p> <p>So having an automated suite of unit tests that cover the production code is the key to
keeping your design and architecture as clean as possible. Tests enable all the -ilities,
because tests enable <em>change</em>.</p> <p>So if your tests are dirty, then your ability to change your code is hampered, and you
begin to lose the ability to improve the structure of that code. The dirtier your tests, the
dirtier your code becomes. Eventually you lose the tests, and your code rots.</p> <h2 id="clean-tests"><a href="#clean-tests" class="header-anchor">#</a> Clean Tests .</h2> <p>What makes a clean test? Three things. Readability, readability, and readability. Read-
ability is perhaps even more important in unit tests than it is in production code. What
makes tests readable? The same thing that makes all code readable: clarity, simplicity,
and density of expression. In a test you want to say a lot with as few expressions as
possible.</p> <p>Consider the code from FitNesse in Listing 9-1. These three tests are difficult to
understand and can certainly be improved. First, there is a terrible amount of duplicate
code [G5] in the repeated calls to addPageandassertSubString. More importantly, this
code is just loaded with details that interfere with the expressiveness of the test.</p> <p><strong>Clean Tests</strong> 125</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-1
SerializedPageResponderTest.java
public void testGetPageHieratchyAsXml() throws Exception
{
crawler.addPage(root, PathParser.parse(&quot;PageOne&quot;));
crawler.addPage(root, PathParser.parse(&quot;PageOne.ChildOne&quot;));
crawler.addPage(root, PathParser.parse(&quot;PageTwo&quot;));
request.setResource(&quot;root&quot;);
request.addInput(&quot;type&quot;, &quot;pages&quot;);
Responder responder = new SerializedPageResponder();
SimpleResponse response =
(SimpleResponse) responder.makeResponse(
new FitNesseContext(root), request);
String xml = response.getContent();
assertEquals(&quot;text/xml&quot;, response.getContentType());
assertSubString(&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, xml);
assertSubString(&quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, xml);
assertSubString(&quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;, xml);
}
public void testGetPageHieratchyAsXmlDoesntContainSymbolicLinks()
throws Exception
{
WikiPage pageOne = crawler.addPage(root, PathParser.parse(&quot;PageOne&quot;));
crawler.addPage(root, PathParser.parse(&quot;PageOne.ChildOne&quot;));
crawler.addPage(root, PathParser.parse(&quot;PageTwo&quot;));
PageData data = pageOne.getData();
WikiPageProperties properties = data.getProperties();
WikiPageProperty symLinks = properties.set(SymbolicPage.PROPERTY_NAME);
symLinks.set(&quot;SymPage&quot;, &quot;PageTwo&quot;);
pageOne.commit(data);
request.setResource(&quot;root&quot;);
request.addInput(&quot;type&quot;, &quot;pages&quot;);
Responder responder = new SerializedPageResponder();
SimpleResponse response =
(SimpleResponse) responder.makeResponse(
new FitNesseContext(root), request);
String xml = response.getContent();
assertEquals(&quot;text/xml&quot;, response.getContentType());
assertSubString(&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, xml);
assertSubString(&quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, xml);
assertSubString(&quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;, xml);
assertNotSubString(&quot;SymPage&quot;, xml);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>public void testGetDataAsHtml() throws Exception
{
crawler.addPage(root, PathParser.parse(&quot;TestPageOne&quot;), &quot;test page&quot;);
request.setResource(&quot;TestPageOne&quot;);
request.addInput(&quot;type&quot;, &quot;data&quot;);
</code></pre></div><p>126 <strong>Chapter 9: Unit Tests</strong></p> <p>For example, look at the PathParsercalls. They transform strings into PagePath
instances used by the crawlers. This transformation is completely irrelevant to the test at
hand and serves only to obfuscate the intent. The details surrounding the creation of the
responderand the gathering and casting of the responseare also just noise. Then there’s the
ham-handed way that the request URL is built from a resource and an argument. (I helped
write this code, so I feel free to roundly criticize it.)</p> <p>In the end, this code was not designed to be read. The poor reader is inundated with a
swarm of details that must be understood before the tests make any real sense.</p> <p>Now consider the improved tests in Listing 9-2. These tests do the exact same thing,
but they have been refactored into a much cleaner and more explanatory form.</p> <div class="language- extra-class"><pre class="language-text"><code>Responder responder = new SerializedPageResponder();
SimpleResponse response =
(SimpleResponse) responder.makeResponse(
new FitNesseContext(root), request);
String xml = response.getContent();
assertEquals(&quot;text/xml&quot;, response.getContentType());
assertSubString(&quot;test page&quot;, xml);
assertSubString(&quot;&lt;Test&quot;, xml);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 9-2
SerializedPageResponderTest.java (refactored)
public void testGetPageHierarchyAsXml() throws Exception {
makePages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);
submitRequest(&quot;root&quot;, &quot;type:pages&quot;);
assertResponseIsXML();
assertResponseContains(
&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;
);
}
public void testSymbolicLinksAreNotInXmlPageHierarchy() throws Exception {
WikiPage page = makePage(&quot;PageOne&quot;);
makePages(&quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);
addLinkTo(page, &quot;PageTwo&quot;, &quot;SymPage&quot;);
submitRequest(&quot;root&quot;, &quot;type:pages&quot;);
assertResponseIsXML();
assertResponseContains(
&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;
);
assertResponseDoesNotContain(&quot;SymPage&quot;);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 9-1 (continued)
SerializedPageResponderTest.java
</code></pre></div><p><strong>Clean Tests</strong> 127</p> <p>The BUILD-OPERATE-CHECK^2 pattern is made obvious by the structure of these tests.
Each of the tests is clearly split into three parts. The first part builds up the test data, the
second part operates on that test data, and the third part checks that the operation yielded
the expected results.</p> <p>Notice that the vast majority of annoying detail has been eliminated. The tests get
right to the point and use only the data types and functions that they truly need. Anyone
who reads these tests should be able to work out what they do very quickly, without being
misled or overwhelmed by details.</p> <h2 id="domain-specific-testing-language"><a href="#domain-specific-testing-language" class="header-anchor">#</a> Domain-Specific Testing Language</h2> <p>The tests in Listing 9-2 demonstrate the technique of building a domain-specific language
for your tests. Rather than using the APIs that programmers use to manipulate the sys-
tem, we build up a set of functions and utilities that make use of those APIs and that
make the tests more convenient to write and easier to read. These functions and utilities
become a specialized API used by the tests. They are a testing <em>language</em> that program-
mers use to help themselves to write their tests and to help those who must read those
tests later on.</p> <p>This testing API is not designed up front; rather it evolves from the continued refac-
toring of test code that has gotten too tainted by obfuscating detail. Just as you saw me
refactor Listing 9-1 into Listing 9-2, so too will disciplined developers refactor their test
code into more succinct and expressive forms.</p> <h2 id="a-dual-standard"><a href="#a-dual-standard" class="header-anchor">#</a> A Dual Standard .</h2> <p>In one sense the team I mentioned at the beginning of this chapter had things right. The
code within the testing API <em>does</em> have a different set of engineering standards than produc-
tion code. It must still be simple, succinct, and expressive, but it need not be as efficient as
production code. After all, it runs in a test environment, not a production environment, and
those two environment have very different needs.</p> <div class="language- extra-class"><pre class="language-text"><code>public void testGetDataAsXml() throws Exception {
makePageWithContent(&quot;TestPageOne&quot;, &quot;test page&quot;);
submitRequest(&quot;TestPageOne&quot;, &quot;type:data&quot;);
assertResponseIsXML();
assertResponseContains(&quot;test page&quot;, &quot;&lt;Test&quot;);
}
</code></pre></div><ol start="2"><li><a href="http://fitnesse.org/FitNesse.AcceptanceTestPatterns" target="_blank" rel="noopener noreferrer">http://fitnesse.org/FitNesse.AcceptanceTestPatterns<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-2 (continued)
SerializedPageResponderTest.java (refactored)
</code></pre></div><p>128 <strong>Chapter 9: Unit Tests</strong></p> <p>Consider the test in Listing 9-3. I wrote this test as part of an environment control sys-
tem I was prototyping. Without going into the details you can tell that this test checks that
the low temperature alarm, the heater, and the blower are all turned on when the tempera-
ture is “way too cold.”</p> <p>There are, of course, lots of details here. For example, what is that ticfunction all
about? In fact, I’d rather you not worry about that while reading this test. I’d rather you just
worry about whether you agree that the end state of the system is consistent with the tem-
perature being “way too cold.”</p> <p>Notice, as you read the test, that your eye needs to bounce back and forth between
the name of the state being checked, and the <em>sense</em> of the state being checked. You see
heaterState, and then your eyes glissade left to assertTrue. You see coolerStateand your
eyes must track left to assertFalse. This is tedious and unreliable. It makes the test hard
to read.</p> <div class="language- extra-class"><pre class="language-text"><code>I improved the reading of this test greatly by transforming it into Listing 9-4.
</code></pre></div><p>Of course I hid the detail of the ticfunction by creating a wayTooColdfunction. But the
thing to note is the strange string in the assertEquals. Upper case means “on,” lower case
means “off,” and the letters are always in the following order: {heater, blower, cooler,
hi-temp-alarm, lo-temp-alarm}.</p> <p>Even though this is close to a violation of the rule about mental mapping,^3 it seems
appropriate in this case. Notice, once you know the meaning, your eyes glide across</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-3
EnvironmentControllerTest.java
@Test
public void turnOnLoTempAlarmAtThreashold() throws Exception {
hw.setTemp(WAY_TOO_COLD);
controller.tic();
assertTrue(hw.heaterState());
assertTrue(hw.blowerState());
assertFalse(hw.coolerState());
assertFalse(hw.hiTempAlarm());
assertTrue(hw.loTempAlarm());
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 9-4
EnvironmentControllerTest.java (refactored)
@Test
public void turnOnLoTempAlarmAtThreshold() throws Exception {
wayTooCold();
assertEquals(&quot;HBchL&quot;, hw.getState());
}
</code></pre></div><ol start="3"><li>“Avoid Mental Mapping” on page 25.</li></ol> <p><strong>Clean Tests</strong> 129</p> <p>that string and you can quickly interpret the results. Reading the test becomes almost a
pleasure. Just take a look at Listing 9-5 and see how easy it is to understand these tests.</p> <p>ThegetStatefunction is shown in Listing 9-6. Notice that this is not very efficient
code. To make it efficient, I probably should have used a StringBuffer.</p> <p>StringBuffers are a bit ugly. Even in production code I will avoid them if the cost is
small; and you could argue that the cost of the code in Listing 9-6 is very small. However,
this application is clearly an embedded real-time system, and it is likely that computer and
memory resources are very constrained. The <em>test</em> environment, however, is not likely to be
constrained at all.</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-5
EnvironmentControllerTest.java (bigger selection)
@Test
public void turnOnCoolerAndBlowerIfTooHot() throws Exception {
tooHot();
assertEquals(&quot;hBChl&quot;, hw.getState());
}
@Test
public void turnOnHeaterAndBlowerIfTooCold() throws Exception {
tooCold();
assertEquals(&quot;HBchl&quot;, hw.getState());
}
@Test
public void turnOnHiTempAlarmAtThreshold() throws Exception {
wayTooHot();
assertEquals(&quot;hBCHl&quot;, hw.getState());
}
@Test
public void turnOnLoTempAlarmAtThreshold() throws Exception {
wayTooCold();
assertEquals(&quot;HBchL&quot;, hw.getState());
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 9-6
MockControlHardware.java
public String getState() {
String state = &quot;&quot;;
state += heater? &quot;H&quot; : &quot;h&quot;;
state += blower? &quot;B&quot; : &quot;b&quot;;
state += cooler? &quot;C&quot; : &quot;c&quot;;
state += hiTempAlarm? &quot;H&quot; : &quot;h&quot;;
state += loTempAlarm? &quot;L&quot; : &quot;l&quot;;
return state;
}
</code></pre></div><p>130 <strong>Chapter 9: Unit Tests</strong></p> <p>That is the nature of the dual standard. There are things that you might never do in a
production environment that are perfectly fine in a test environment. Usually they involve
issues of memory or CPU efficiency. But they <em>never</em> involve issues of cleanliness.</p> <h2 id="one-assert-per-test"><a href="#one-assert-per-test" class="header-anchor">#</a> One Assert per Test ...</h2> <p>There is a school of thought^4 that says that every test function in a JUnit test should have one
and only one assert statement. This rule may seem draconian, but the advantage can be seen
in Listing 9-5. Those tests come to a single conclusion that is quick and easy to understand.</p> <p>But what about Listing 9-2? It seems unreasonable that we could somehow easily
merge the assertion that the output is XML and that it contains certain substrings. How-
ever, we can break the test into two separate tests, each with its own particular assertion, as
shown in Listing 9-7.</p> <p>Notice that I have changed the names of the functions to use the common given-when-
then^5 convention. This makes the tests even easier to read. Unfortunately, splitting the tests
as shown results in a lot of duplicate code.</p> <p>We can eliminate the duplication by using the TEMPLATE METHOD^6 pattern and putting
the <em>given/when</em> parts in the base class, and the <em>then</em> parts in different derivatives. Or we could
create a completely separate test class and put the <em>given</em> and <em>when</em> parts in the @Beforefunc-
tion, and the <em>when</em> parts in each @Test function. But this seems like too much mechanism for
such a minor issue. In the end, I prefer the multiple asserts in Listing 9-2.</p> <ol start="4"><li>See Dave Astel’s blog entry: <a href="http://www.artima.com/weblogs/viewpost.jsp?thread=35578" target="_blank" rel="noopener noreferrer">http://www.artima.com/weblogs/viewpost.jsp?thread=35578<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-7
SerializedPageResponderTest.java (Single Assert)
public void testGetPageHierarchyAsXml() throws Exception {
givenPages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);
whenRequestIsIssued(&quot;root&quot;, &quot;type:pages&quot;);
thenResponseShouldBeXML();
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>public void testGetPageHierarchyHasRightTags() throws Exception {
givenPages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);
whenRequestIsIssued(&quot;root&quot;, &quot;type:pages&quot;);
thenResponseShouldContain(
&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;
);
}
</code></pre></div><ol start="5"><li>[RSpec].</li> <li>[GOF].</li></ol> <p><strong>One Assert per Test</strong> 131</p> <p>I think the single assert rule is a good guideline.^7 I usually try to create a domain-
specific testing language that supports it, as in Listing 9-5. But I am not afraid to put
more than one assert in a test. I think the best thing we can say is that the number of
asserts in a test ought to be minimized.</p> <h2 id="single-concept-per-test"><a href="#single-concept-per-test" class="header-anchor">#</a> Single Concept per Test ..</h2> <p>Perhaps a better rule is that we want to test a single concept in each test function. We don’t
want long test functions that go testing one miscellaneous thing after another. Listing 9-8
is an example of such a test. This test should be split up into three independent tests
because it tests three independent things. Merging them all together into the same function
forces the reader to figure out why each section is there and what is being tested by that
section.</p> <div class="language- extra-class"><pre class="language-text"><code>The three test functions probably ought to be like this:
</code></pre></div><ul><li><em>Given</em> the last day of a month with 31 days (like May):
<strong>1.</strong> <em>When</em> you add one month, such that the last day of that month is the 30th
(like June), <em>then</em> the date should be the 30th of that month, not the 31st.
<strong>2.</strong> <em>When</em> you add two months to that date, such that the final month has 31 days,
<em>then</em> the date should be the 31st.</li></ul> <ol start="7"><li>“Keep to the code!”</li></ol> <div class="language- extra-class"><pre class="language-text"><code>Listing 9-8
/**
* Miscellaneous tests for the addMonths() method.
*/
public void testAddMonths() {
SerialDate d1 = SerialDate.createInstance(31, 5, 2004);
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>SerialDate d2 = SerialDate.addMonths(1, d1);
assertEquals(30, d2.getDayOfMonth());
assertEquals(6, d2.getMonth());
assertEquals(2004, d2.getYYYY());
SerialDate d3 = SerialDate.addMonths(2, d1);
assertEquals(31, d3.getDayOfMonth());
assertEquals(7, d3.getMonth());
assertEquals(2004, d3.getYYYY());
SerialDate d4 = SerialDate.addMonths(1, SerialDate.addMonths(1, d1));
assertEquals(30, d4.getDayOfMonth());
assertEquals(7, d4.getMonth());
assertEquals(2004, d4.getYYYY());
}
</code></pre></div><p>132 <strong>Chapter 9: Unit Tests</strong></p> <ul><li><em>Given</em> the last day of a month with 30 days in it (like June):
<strong>1.</strong> <em>When</em> you add one month such that the last day of that month has 31 days, <em>then</em> the
date should be the 30th, not the 31st.
Stated like this, you can see that there is a general rule hiding amidst the miscella-
neous tests. When you increment the month, the date can be no greater than the last day of
the month. This implies that incrementing the month on February 28th should yield March
28th. <em>That</em> test is missing and would be a useful test to write.</li></ul> <p>So it’s not the multiple asserts in each section of Listing 9-8 that causes the problem.
Rather it is the fact that there is more than one concept being tested. So probably the best
rule is that you should minimize the number of asserts per concept and test just one con-
cept per test function.</p> <h2 id="f-i-r-s-t"><a href="#f-i-r-s-t" class="header-anchor">#</a> F.I.R.S.T. .</h2> <div class="language- extra-class"><pre class="language-text"><code>8
</code></pre></div><p>Clean tests follow five other rules that form the above acronym:</p> <p><strong>Fast</strong> Tests should be fast. They should run quickly. When tests run slow, you won’t want
to run them frequently. If you don’t run them frequently, you won’t find problems early
enough to fix them easily. You won’t feel as free to clean up the code. Eventually the code
will begin to rot.</p> <p><strong>Independent</strong> Tests should not depend on each other. One test should not set up the condi-
tions for the next test. You should be able to run each test independently and run the tests in
any order you like. When tests depend on each other, then the first one to fail causes a cas-
cade of downstream failures, making diagnosis difficult and hiding downstream defects.</p> <p><strong>Repeatable</strong> Tests should be repeatable in any environment. You should be able to run the
tests in the production environment, in the QA environment, and on your laptop while
riding home on the train without a network. If your tests aren’t repeatable in any environ-
ment, then you’ll always have an excuse for why they fail. You’ll also find yourself unable
to run the tests when the environment isn’t available.</p> <p><strong>Self-Validating</strong> The tests should have a boolean output. Either they pass or fail. You
should not have to read through a log file to tell whether the tests pass. You should not have
to manually compare two different text files to see whether the tests pass. If the tests aren’t
self-validating, then failure can become subjective and running the tests can require a long
manual evaluation.</p> <ol start="8"><li>Object Mentor Training Materials.</li></ol> <p><strong>Bibliography</strong> 133</p> <p><strong>Timely</strong> The tests need to be written in a timely fashion. Unit tests should be written <em>just
before</em> the production code that makes them pass. If you write tests after the production
code, then you may find the production code to be hard to test. You may decide that some
production code is too hard to test. You may not design the production code to be testable.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion ..</h2> <p>We have barely scratched the surface of this topic. Indeed, I think an entire book could be
written about <em>clean tests</em>. Tests are as important to the health of a project as the production
code is. Perhaps they are even more important, because tests preserve and enhance the
flexibility, maintainability, and reusability of the production code. So keep your tests con-
stantly clean. Work to make them expressive and succinct. Invent testing APIs that act as
domain-specific language that helps you write the tests.</p> <div class="language- extra-class"><pre class="language-text"><code>If you let the tests rot, then your code will rot too. Keep your tests clean.
</code></pre></div><h2 id="bibliography"><a href="#bibliography" class="header-anchor">#</a> Bibliography ...</h2> <p><strong>[RSpec]:</strong> <em>RSpec: Behavior Driven Development for Ruby Programmers</em> ,
Aslak Hellesøy, David Chelimsky, Pragmatic Bookshelf, 2008.</p> <p><strong>[GOF]:</strong> <em>Design Patterns: Elements of Reusable Object Oriented Software</em> , Gamma et al.,
Addison-Wesley, 1996.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/cleancode/c8.html" class="prev">
        8. Boundaries
      </a></span> <span class="next"><a href="/docs/kungfu/cleancode/c10.html">
        10. Classes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.e6f4376b.js" defer></script><script src="/docs/assets/js/2.c567e596.js" defer></script><script src="/docs/assets/js/253.58bdeef4.js" defer></script><script src="/docs/assets/js/27.2fe5f85e.js" defer></script>
  </body>
</html>
