<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>15. JUnit Internals | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.a4bdeed3.css" as="style"><link rel="preload" href="/docs/assets/js/app.cefa8244.js" as="script"><link rel="preload" href="/docs/assets/js/2.f3f7dff4.js" as="script"><link rel="preload" href="/docs/assets/js/429.1f452db9.js" as="script"><link rel="preload" href="/docs/assets/js/90.0efc7950.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.22c4a3aa.js"><link rel="prefetch" href="/docs/assets/js/100.47ac1aa1.js"><link rel="prefetch" href="/docs/assets/js/101.bb180572.js"><link rel="prefetch" href="/docs/assets/js/102.d69f10aa.js"><link rel="prefetch" href="/docs/assets/js/103.2dedd51c.js"><link rel="prefetch" href="/docs/assets/js/104.21fa361c.js"><link rel="prefetch" href="/docs/assets/js/105.2bbe7ce7.js"><link rel="prefetch" href="/docs/assets/js/106.34894a9c.js"><link rel="prefetch" href="/docs/assets/js/107.e061585e.js"><link rel="prefetch" href="/docs/assets/js/108.e4cbaa1d.js"><link rel="prefetch" href="/docs/assets/js/109.a8fe0c90.js"><link rel="prefetch" href="/docs/assets/js/11.94fabd38.js"><link rel="prefetch" href="/docs/assets/js/110.33bc1316.js"><link rel="prefetch" href="/docs/assets/js/111.3c621334.js"><link rel="prefetch" href="/docs/assets/js/112.a888d074.js"><link rel="prefetch" href="/docs/assets/js/113.0ec3bd38.js"><link rel="prefetch" href="/docs/assets/js/114.fc000c2f.js"><link rel="prefetch" href="/docs/assets/js/115.efeccc5c.js"><link rel="prefetch" href="/docs/assets/js/116.94d70c05.js"><link rel="prefetch" href="/docs/assets/js/117.3ba913b9.js"><link rel="prefetch" href="/docs/assets/js/118.e00007a5.js"><link rel="prefetch" href="/docs/assets/js/119.098b20d6.js"><link rel="prefetch" href="/docs/assets/js/12.fb1023d2.js"><link rel="prefetch" href="/docs/assets/js/120.f4da1a79.js"><link rel="prefetch" href="/docs/assets/js/121.0c6aca64.js"><link rel="prefetch" href="/docs/assets/js/122.84c7b523.js"><link rel="prefetch" href="/docs/assets/js/123.6e6f26e6.js"><link rel="prefetch" href="/docs/assets/js/124.03788fff.js"><link rel="prefetch" href="/docs/assets/js/125.3101a837.js"><link rel="prefetch" href="/docs/assets/js/126.570765aa.js"><link rel="prefetch" href="/docs/assets/js/127.8ab37501.js"><link rel="prefetch" href="/docs/assets/js/128.fb619dfa.js"><link rel="prefetch" href="/docs/assets/js/129.91d0d190.js"><link rel="prefetch" href="/docs/assets/js/13.e95a504a.js"><link rel="prefetch" href="/docs/assets/js/130.997d00c5.js"><link rel="prefetch" href="/docs/assets/js/131.1e54c5ad.js"><link rel="prefetch" href="/docs/assets/js/132.90252ca1.js"><link rel="prefetch" href="/docs/assets/js/133.82b6e58c.js"><link rel="prefetch" href="/docs/assets/js/134.f30b7a6f.js"><link rel="prefetch" href="/docs/assets/js/135.c246a052.js"><link rel="prefetch" href="/docs/assets/js/136.6517a2b4.js"><link rel="prefetch" href="/docs/assets/js/137.b4623cc7.js"><link rel="prefetch" href="/docs/assets/js/138.a1a55361.js"><link rel="prefetch" href="/docs/assets/js/139.84d2beb4.js"><link rel="prefetch" href="/docs/assets/js/14.bf873213.js"><link rel="prefetch" href="/docs/assets/js/140.e283ad86.js"><link rel="prefetch" href="/docs/assets/js/141.9ca304bf.js"><link rel="prefetch" href="/docs/assets/js/142.4a668511.js"><link rel="prefetch" href="/docs/assets/js/143.bc330940.js"><link rel="prefetch" href="/docs/assets/js/144.9407782e.js"><link rel="prefetch" href="/docs/assets/js/145.9a600e62.js"><link rel="prefetch" href="/docs/assets/js/146.65ec5e1d.js"><link rel="prefetch" href="/docs/assets/js/147.810f810b.js"><link rel="prefetch" href="/docs/assets/js/148.1e55467d.js"><link rel="prefetch" href="/docs/assets/js/149.1303f526.js"><link rel="prefetch" href="/docs/assets/js/15.758857a6.js"><link rel="prefetch" href="/docs/assets/js/150.a643690f.js"><link rel="prefetch" href="/docs/assets/js/151.f7ce0945.js"><link rel="prefetch" href="/docs/assets/js/152.76247b1b.js"><link rel="prefetch" href="/docs/assets/js/153.63de4ddb.js"><link rel="prefetch" href="/docs/assets/js/154.fbaa3f0f.js"><link rel="prefetch" href="/docs/assets/js/155.18ebd7b6.js"><link rel="prefetch" href="/docs/assets/js/156.71380779.js"><link rel="prefetch" href="/docs/assets/js/157.31064779.js"><link rel="prefetch" href="/docs/assets/js/158.3d7001c3.js"><link rel="prefetch" href="/docs/assets/js/159.ccefa7df.js"><link rel="prefetch" href="/docs/assets/js/16.245b256a.js"><link rel="prefetch" href="/docs/assets/js/160.dbe10a1f.js"><link rel="prefetch" href="/docs/assets/js/161.7ee79654.js"><link rel="prefetch" href="/docs/assets/js/162.1e37fb93.js"><link rel="prefetch" href="/docs/assets/js/163.cb9c11a0.js"><link rel="prefetch" href="/docs/assets/js/164.fe86fa89.js"><link rel="prefetch" href="/docs/assets/js/165.cac49548.js"><link rel="prefetch" href="/docs/assets/js/166.61fae78c.js"><link rel="prefetch" href="/docs/assets/js/167.9189a5be.js"><link rel="prefetch" href="/docs/assets/js/168.a9a08235.js"><link rel="prefetch" href="/docs/assets/js/169.7ed23163.js"><link rel="prefetch" href="/docs/assets/js/17.8e968587.js"><link rel="prefetch" href="/docs/assets/js/170.ef034a90.js"><link rel="prefetch" href="/docs/assets/js/171.837c584c.js"><link rel="prefetch" href="/docs/assets/js/172.aca1c37d.js"><link rel="prefetch" href="/docs/assets/js/173.8c294bd6.js"><link rel="prefetch" href="/docs/assets/js/174.72f7cc4e.js"><link rel="prefetch" href="/docs/assets/js/175.5c8da563.js"><link rel="prefetch" href="/docs/assets/js/176.bb1e7799.js"><link rel="prefetch" href="/docs/assets/js/177.ff3b8173.js"><link rel="prefetch" href="/docs/assets/js/178.b7ba29ec.js"><link rel="prefetch" href="/docs/assets/js/179.15d365ee.js"><link rel="prefetch" href="/docs/assets/js/18.8bc19813.js"><link rel="prefetch" href="/docs/assets/js/180.d0786969.js"><link rel="prefetch" href="/docs/assets/js/181.8127b961.js"><link rel="prefetch" href="/docs/assets/js/182.42be7312.js"><link rel="prefetch" href="/docs/assets/js/183.b5aec108.js"><link rel="prefetch" href="/docs/assets/js/184.f686f0e9.js"><link rel="prefetch" href="/docs/assets/js/185.6cfcbd0e.js"><link rel="prefetch" href="/docs/assets/js/186.71ee4c9f.js"><link rel="prefetch" href="/docs/assets/js/187.c4e2c1c7.js"><link rel="prefetch" href="/docs/assets/js/188.5be1e340.js"><link rel="prefetch" href="/docs/assets/js/189.738030d4.js"><link rel="prefetch" href="/docs/assets/js/19.ddbdebfc.js"><link rel="prefetch" href="/docs/assets/js/190.0578e04b.js"><link rel="prefetch" href="/docs/assets/js/191.dc0fdf8c.js"><link rel="prefetch" href="/docs/assets/js/192.9956acfb.js"><link rel="prefetch" href="/docs/assets/js/193.3815bc8a.js"><link rel="prefetch" href="/docs/assets/js/194.ecaefba8.js"><link rel="prefetch" href="/docs/assets/js/195.51195266.js"><link rel="prefetch" href="/docs/assets/js/196.ded6eaa0.js"><link rel="prefetch" href="/docs/assets/js/197.613ba837.js"><link rel="prefetch" href="/docs/assets/js/198.b4ea3d07.js"><link rel="prefetch" href="/docs/assets/js/199.b7d8e45e.js"><link rel="prefetch" href="/docs/assets/js/20.12796ad5.js"><link rel="prefetch" href="/docs/assets/js/200.7de9db9f.js"><link rel="prefetch" href="/docs/assets/js/201.de63172f.js"><link rel="prefetch" href="/docs/assets/js/202.57eeb964.js"><link rel="prefetch" href="/docs/assets/js/203.47d5a587.js"><link rel="prefetch" href="/docs/assets/js/204.71b887a4.js"><link rel="prefetch" href="/docs/assets/js/205.cfe40b03.js"><link rel="prefetch" href="/docs/assets/js/206.fb4104aa.js"><link rel="prefetch" href="/docs/assets/js/207.37e7fe9c.js"><link rel="prefetch" href="/docs/assets/js/208.12a3b8b5.js"><link rel="prefetch" href="/docs/assets/js/209.67eb1cdd.js"><link rel="prefetch" href="/docs/assets/js/21.b71e27ff.js"><link rel="prefetch" href="/docs/assets/js/210.1bf0bde2.js"><link rel="prefetch" href="/docs/assets/js/211.7da8f6de.js"><link rel="prefetch" href="/docs/assets/js/212.24db9770.js"><link rel="prefetch" href="/docs/assets/js/213.09fda540.js"><link rel="prefetch" href="/docs/assets/js/214.23a965ce.js"><link rel="prefetch" href="/docs/assets/js/215.dfe7771d.js"><link rel="prefetch" href="/docs/assets/js/216.fece0f81.js"><link rel="prefetch" href="/docs/assets/js/217.456fcddf.js"><link rel="prefetch" href="/docs/assets/js/218.a57f44a2.js"><link rel="prefetch" href="/docs/assets/js/219.069741c5.js"><link rel="prefetch" href="/docs/assets/js/22.11aea4b8.js"><link rel="prefetch" href="/docs/assets/js/220.92afab4a.js"><link rel="prefetch" href="/docs/assets/js/221.72905933.js"><link rel="prefetch" href="/docs/assets/js/222.c7c2fa55.js"><link rel="prefetch" href="/docs/assets/js/223.cbf30f73.js"><link rel="prefetch" href="/docs/assets/js/224.ab04e120.js"><link rel="prefetch" href="/docs/assets/js/225.9b5e84f2.js"><link rel="prefetch" href="/docs/assets/js/226.680af707.js"><link rel="prefetch" href="/docs/assets/js/227.7537fbed.js"><link rel="prefetch" href="/docs/assets/js/228.d936df81.js"><link rel="prefetch" href="/docs/assets/js/229.78981ea7.js"><link rel="prefetch" href="/docs/assets/js/23.4be0735f.js"><link rel="prefetch" href="/docs/assets/js/230.467fa232.js"><link rel="prefetch" href="/docs/assets/js/231.d1231419.js"><link rel="prefetch" href="/docs/assets/js/232.5a90fb69.js"><link rel="prefetch" href="/docs/assets/js/233.34eb1fc7.js"><link rel="prefetch" href="/docs/assets/js/234.8ceadaeb.js"><link rel="prefetch" href="/docs/assets/js/235.5a651eef.js"><link rel="prefetch" href="/docs/assets/js/236.4afa5030.js"><link rel="prefetch" href="/docs/assets/js/237.eff93683.js"><link rel="prefetch" href="/docs/assets/js/238.6f5e7225.js"><link rel="prefetch" href="/docs/assets/js/239.f2a7caf0.js"><link rel="prefetch" href="/docs/assets/js/24.85b45a94.js"><link rel="prefetch" href="/docs/assets/js/240.083c10e0.js"><link rel="prefetch" href="/docs/assets/js/241.d502983a.js"><link rel="prefetch" href="/docs/assets/js/242.c271b35c.js"><link rel="prefetch" href="/docs/assets/js/243.130c9975.js"><link rel="prefetch" href="/docs/assets/js/244.31b27d9a.js"><link rel="prefetch" href="/docs/assets/js/245.e87c8737.js"><link rel="prefetch" href="/docs/assets/js/246.a5121994.js"><link rel="prefetch" href="/docs/assets/js/247.298de3e4.js"><link rel="prefetch" href="/docs/assets/js/248.4e69ee1f.js"><link rel="prefetch" href="/docs/assets/js/249.d8e0cd2a.js"><link rel="prefetch" href="/docs/assets/js/25.77f88618.js"><link rel="prefetch" href="/docs/assets/js/250.e5dbcafa.js"><link rel="prefetch" href="/docs/assets/js/251.ffbb1d78.js"><link rel="prefetch" href="/docs/assets/js/252.6c3474c5.js"><link rel="prefetch" href="/docs/assets/js/253.75dcfd77.js"><link rel="prefetch" href="/docs/assets/js/254.c44ece56.js"><link rel="prefetch" href="/docs/assets/js/255.183b3279.js"><link rel="prefetch" href="/docs/assets/js/256.8ca9b93f.js"><link rel="prefetch" href="/docs/assets/js/257.0d13a0ed.js"><link rel="prefetch" href="/docs/assets/js/258.b07e0bcd.js"><link rel="prefetch" href="/docs/assets/js/259.d58f9167.js"><link rel="prefetch" href="/docs/assets/js/26.d148dbc6.js"><link rel="prefetch" href="/docs/assets/js/260.2b07daaa.js"><link rel="prefetch" href="/docs/assets/js/261.4c31fa05.js"><link rel="prefetch" href="/docs/assets/js/262.71d33a18.js"><link rel="prefetch" href="/docs/assets/js/263.faa5b357.js"><link rel="prefetch" href="/docs/assets/js/264.cf502b3f.js"><link rel="prefetch" href="/docs/assets/js/265.19e81cb9.js"><link rel="prefetch" href="/docs/assets/js/266.36b9b4fb.js"><link rel="prefetch" href="/docs/assets/js/267.6b6b127f.js"><link rel="prefetch" href="/docs/assets/js/268.75ab5a44.js"><link rel="prefetch" href="/docs/assets/js/269.d2f94bb6.js"><link rel="prefetch" href="/docs/assets/js/27.bc1ba35a.js"><link rel="prefetch" href="/docs/assets/js/270.f4917406.js"><link rel="prefetch" href="/docs/assets/js/271.3134dbf2.js"><link rel="prefetch" href="/docs/assets/js/272.7bcbe915.js"><link rel="prefetch" href="/docs/assets/js/273.b8df354d.js"><link rel="prefetch" href="/docs/assets/js/274.a3e19012.js"><link rel="prefetch" href="/docs/assets/js/275.9de2f1e9.js"><link rel="prefetch" href="/docs/assets/js/276.a4355230.js"><link rel="prefetch" href="/docs/assets/js/277.83a36827.js"><link rel="prefetch" href="/docs/assets/js/278.42c65843.js"><link rel="prefetch" href="/docs/assets/js/279.2619bd53.js"><link rel="prefetch" href="/docs/assets/js/28.df60dfb1.js"><link rel="prefetch" href="/docs/assets/js/280.a90af1e5.js"><link rel="prefetch" href="/docs/assets/js/281.5a03904f.js"><link rel="prefetch" href="/docs/assets/js/282.d02ee1b0.js"><link rel="prefetch" href="/docs/assets/js/283.aee4a48b.js"><link rel="prefetch" href="/docs/assets/js/284.d09b87d0.js"><link rel="prefetch" href="/docs/assets/js/285.07377059.js"><link rel="prefetch" href="/docs/assets/js/286.5abcc907.js"><link rel="prefetch" href="/docs/assets/js/287.fdbe1218.js"><link rel="prefetch" href="/docs/assets/js/288.1900d04a.js"><link rel="prefetch" href="/docs/assets/js/289.e763fb78.js"><link rel="prefetch" href="/docs/assets/js/29.9eb313ea.js"><link rel="prefetch" href="/docs/assets/js/290.b1e8fd12.js"><link rel="prefetch" href="/docs/assets/js/291.df8a166e.js"><link rel="prefetch" href="/docs/assets/js/292.24807793.js"><link rel="prefetch" href="/docs/assets/js/293.9f8446cc.js"><link rel="prefetch" href="/docs/assets/js/294.678ea155.js"><link rel="prefetch" href="/docs/assets/js/295.35e2bc2b.js"><link rel="prefetch" href="/docs/assets/js/296.cd4bd615.js"><link rel="prefetch" href="/docs/assets/js/297.a5fd76d7.js"><link rel="prefetch" href="/docs/assets/js/298.ca38ac94.js"><link rel="prefetch" href="/docs/assets/js/299.1bd90e2f.js"><link rel="prefetch" href="/docs/assets/js/3.84a39cf1.js"><link rel="prefetch" href="/docs/assets/js/30.c24df7d9.js"><link rel="prefetch" href="/docs/assets/js/300.42bf5dcd.js"><link rel="prefetch" href="/docs/assets/js/301.00f89f83.js"><link rel="prefetch" href="/docs/assets/js/302.9592e13e.js"><link rel="prefetch" href="/docs/assets/js/303.68e9c2b4.js"><link rel="prefetch" href="/docs/assets/js/304.cd9f56c9.js"><link rel="prefetch" href="/docs/assets/js/305.b50c6073.js"><link rel="prefetch" href="/docs/assets/js/306.9839054e.js"><link rel="prefetch" href="/docs/assets/js/307.d430a42b.js"><link rel="prefetch" href="/docs/assets/js/308.2f646d91.js"><link rel="prefetch" href="/docs/assets/js/309.bfb80590.js"><link rel="prefetch" href="/docs/assets/js/31.9608dcf7.js"><link rel="prefetch" href="/docs/assets/js/310.233fa606.js"><link rel="prefetch" href="/docs/assets/js/311.232366c1.js"><link rel="prefetch" href="/docs/assets/js/312.d8824dbc.js"><link rel="prefetch" href="/docs/assets/js/313.d6c0c27e.js"><link rel="prefetch" href="/docs/assets/js/314.03c2375e.js"><link rel="prefetch" href="/docs/assets/js/315.04a38de9.js"><link rel="prefetch" href="/docs/assets/js/316.277c0616.js"><link rel="prefetch" href="/docs/assets/js/317.c1e2a130.js"><link rel="prefetch" href="/docs/assets/js/318.8b6a6006.js"><link rel="prefetch" href="/docs/assets/js/319.7ad9abc4.js"><link rel="prefetch" href="/docs/assets/js/32.b1d37b8a.js"><link rel="prefetch" href="/docs/assets/js/320.b02b4c06.js"><link rel="prefetch" href="/docs/assets/js/321.60b30032.js"><link rel="prefetch" href="/docs/assets/js/322.3e24fffd.js"><link rel="prefetch" href="/docs/assets/js/323.22462bf8.js"><link rel="prefetch" href="/docs/assets/js/324.300e16d7.js"><link rel="prefetch" href="/docs/assets/js/325.1217ad18.js"><link rel="prefetch" href="/docs/assets/js/326.ca03bd09.js"><link rel="prefetch" href="/docs/assets/js/327.171d1efa.js"><link rel="prefetch" href="/docs/assets/js/328.77c46924.js"><link rel="prefetch" href="/docs/assets/js/329.d4d74ef9.js"><link rel="prefetch" href="/docs/assets/js/33.59fe4070.js"><link rel="prefetch" href="/docs/assets/js/330.0d96c50d.js"><link rel="prefetch" href="/docs/assets/js/331.f245803f.js"><link rel="prefetch" href="/docs/assets/js/332.b28417c3.js"><link rel="prefetch" href="/docs/assets/js/333.a7c2120a.js"><link rel="prefetch" href="/docs/assets/js/334.b6e2524d.js"><link rel="prefetch" href="/docs/assets/js/335.e246c743.js"><link rel="prefetch" href="/docs/assets/js/336.471b78bf.js"><link rel="prefetch" href="/docs/assets/js/337.dfd68234.js"><link rel="prefetch" href="/docs/assets/js/338.9d9ec365.js"><link rel="prefetch" href="/docs/assets/js/339.61f313eb.js"><link rel="prefetch" href="/docs/assets/js/34.7be06ea1.js"><link rel="prefetch" href="/docs/assets/js/340.9e23105c.js"><link rel="prefetch" href="/docs/assets/js/341.d9a90e30.js"><link rel="prefetch" href="/docs/assets/js/342.aa746791.js"><link rel="prefetch" href="/docs/assets/js/343.c8a7f0de.js"><link rel="prefetch" href="/docs/assets/js/344.fc871bb1.js"><link rel="prefetch" href="/docs/assets/js/345.3a4b21d8.js"><link rel="prefetch" href="/docs/assets/js/346.f37799a5.js"><link rel="prefetch" href="/docs/assets/js/347.39fad765.js"><link rel="prefetch" href="/docs/assets/js/348.15e054e1.js"><link rel="prefetch" href="/docs/assets/js/349.af7be4c7.js"><link rel="prefetch" href="/docs/assets/js/35.2eee4aec.js"><link rel="prefetch" href="/docs/assets/js/350.8bf9a8b5.js"><link rel="prefetch" href="/docs/assets/js/351.4b7caf0b.js"><link rel="prefetch" href="/docs/assets/js/352.263430ff.js"><link rel="prefetch" href="/docs/assets/js/353.a08f7cd8.js"><link rel="prefetch" href="/docs/assets/js/354.c45cb6dc.js"><link rel="prefetch" href="/docs/assets/js/355.d60e01cd.js"><link rel="prefetch" href="/docs/assets/js/356.f3246c92.js"><link rel="prefetch" href="/docs/assets/js/357.26b06ced.js"><link rel="prefetch" href="/docs/assets/js/358.64e0dc2d.js"><link rel="prefetch" href="/docs/assets/js/359.a4024564.js"><link rel="prefetch" href="/docs/assets/js/36.19d48d77.js"><link rel="prefetch" href="/docs/assets/js/360.890c4aa2.js"><link rel="prefetch" href="/docs/assets/js/361.1d61f1e8.js"><link rel="prefetch" href="/docs/assets/js/362.8b9609f6.js"><link rel="prefetch" href="/docs/assets/js/363.07f669fb.js"><link rel="prefetch" href="/docs/assets/js/364.88bd6a4c.js"><link rel="prefetch" href="/docs/assets/js/365.45a51ff1.js"><link rel="prefetch" href="/docs/assets/js/366.2a0f1cf4.js"><link rel="prefetch" href="/docs/assets/js/367.bb5f2a36.js"><link rel="prefetch" href="/docs/assets/js/368.a408f4e8.js"><link rel="prefetch" href="/docs/assets/js/369.52181a9b.js"><link rel="prefetch" href="/docs/assets/js/37.c4fbde5c.js"><link rel="prefetch" href="/docs/assets/js/370.043c646b.js"><link rel="prefetch" href="/docs/assets/js/371.6340c030.js"><link rel="prefetch" href="/docs/assets/js/372.2a1dadbc.js"><link rel="prefetch" href="/docs/assets/js/373.d6419882.js"><link rel="prefetch" href="/docs/assets/js/374.1aac2989.js"><link rel="prefetch" href="/docs/assets/js/375.6ea6b496.js"><link rel="prefetch" href="/docs/assets/js/376.1fe015d3.js"><link rel="prefetch" href="/docs/assets/js/377.5c8cdc7f.js"><link rel="prefetch" href="/docs/assets/js/378.afc559c2.js"><link rel="prefetch" href="/docs/assets/js/379.ed8e4e39.js"><link rel="prefetch" href="/docs/assets/js/38.17c88529.js"><link rel="prefetch" href="/docs/assets/js/380.f7865fa7.js"><link rel="prefetch" href="/docs/assets/js/381.89cf8351.js"><link rel="prefetch" href="/docs/assets/js/382.fcc18db9.js"><link rel="prefetch" href="/docs/assets/js/383.89600921.js"><link rel="prefetch" href="/docs/assets/js/384.18b99458.js"><link rel="prefetch" href="/docs/assets/js/385.4d3c4006.js"><link rel="prefetch" href="/docs/assets/js/386.f48dbdc0.js"><link rel="prefetch" href="/docs/assets/js/387.32168da2.js"><link rel="prefetch" href="/docs/assets/js/388.0a26e644.js"><link rel="prefetch" href="/docs/assets/js/389.50bcae8d.js"><link rel="prefetch" href="/docs/assets/js/39.c382a490.js"><link rel="prefetch" href="/docs/assets/js/390.cfde22fe.js"><link rel="prefetch" href="/docs/assets/js/391.13a2294d.js"><link rel="prefetch" href="/docs/assets/js/392.53d627eb.js"><link rel="prefetch" href="/docs/assets/js/393.b482db33.js"><link rel="prefetch" href="/docs/assets/js/394.0f67059f.js"><link rel="prefetch" href="/docs/assets/js/395.c0181109.js"><link rel="prefetch" href="/docs/assets/js/396.3b3a5342.js"><link rel="prefetch" href="/docs/assets/js/397.4c5ec808.js"><link rel="prefetch" href="/docs/assets/js/398.151a1e85.js"><link rel="prefetch" href="/docs/assets/js/399.ffa57821.js"><link rel="prefetch" href="/docs/assets/js/4.68bcd38d.js"><link rel="prefetch" href="/docs/assets/js/40.aa0b7a40.js"><link rel="prefetch" href="/docs/assets/js/400.9f15d127.js"><link rel="prefetch" href="/docs/assets/js/401.416efdde.js"><link rel="prefetch" href="/docs/assets/js/402.605c2ef9.js"><link rel="prefetch" href="/docs/assets/js/403.60c8685d.js"><link rel="prefetch" href="/docs/assets/js/404.e831bead.js"><link rel="prefetch" href="/docs/assets/js/405.6addff9a.js"><link rel="prefetch" href="/docs/assets/js/406.bccadd48.js"><link rel="prefetch" href="/docs/assets/js/407.9fb4f49e.js"><link rel="prefetch" href="/docs/assets/js/408.af78f14f.js"><link rel="prefetch" href="/docs/assets/js/409.19ea1ec7.js"><link rel="prefetch" href="/docs/assets/js/41.f41c60bf.js"><link rel="prefetch" href="/docs/assets/js/410.230ae0e4.js"><link rel="prefetch" href="/docs/assets/js/411.57e5a14f.js"><link rel="prefetch" href="/docs/assets/js/412.2b079350.js"><link rel="prefetch" href="/docs/assets/js/413.20ac73c5.js"><link rel="prefetch" href="/docs/assets/js/414.e8c69861.js"><link rel="prefetch" href="/docs/assets/js/415.5cf3c636.js"><link rel="prefetch" href="/docs/assets/js/416.95666236.js"><link rel="prefetch" href="/docs/assets/js/417.97456324.js"><link rel="prefetch" href="/docs/assets/js/418.d234f8a7.js"><link rel="prefetch" href="/docs/assets/js/419.a5ba6e16.js"><link rel="prefetch" href="/docs/assets/js/42.a221ab0e.js"><link rel="prefetch" href="/docs/assets/js/420.507825f0.js"><link rel="prefetch" href="/docs/assets/js/421.c39590af.js"><link rel="prefetch" href="/docs/assets/js/422.6da4cc6b.js"><link rel="prefetch" href="/docs/assets/js/423.ee7bc789.js"><link rel="prefetch" href="/docs/assets/js/424.785320c4.js"><link rel="prefetch" href="/docs/assets/js/425.09884ea9.js"><link rel="prefetch" href="/docs/assets/js/426.146b5dbf.js"><link rel="prefetch" href="/docs/assets/js/427.8bc0086a.js"><link rel="prefetch" href="/docs/assets/js/428.3c5de22a.js"><link rel="prefetch" href="/docs/assets/js/43.63893cb1.js"><link rel="prefetch" href="/docs/assets/js/430.72b65a21.js"><link rel="prefetch" href="/docs/assets/js/431.7b421e54.js"><link rel="prefetch" href="/docs/assets/js/432.938be48d.js"><link rel="prefetch" href="/docs/assets/js/433.42da784b.js"><link rel="prefetch" href="/docs/assets/js/434.325b8806.js"><link rel="prefetch" href="/docs/assets/js/435.06693586.js"><link rel="prefetch" href="/docs/assets/js/436.c67a8822.js"><link rel="prefetch" href="/docs/assets/js/437.12fc8818.js"><link rel="prefetch" href="/docs/assets/js/438.8eff7442.js"><link rel="prefetch" href="/docs/assets/js/439.694f37c4.js"><link rel="prefetch" href="/docs/assets/js/44.f5a7c9ff.js"><link rel="prefetch" href="/docs/assets/js/440.dfaee6b3.js"><link rel="prefetch" href="/docs/assets/js/441.5aead6a0.js"><link rel="prefetch" href="/docs/assets/js/442.325f933f.js"><link rel="prefetch" href="/docs/assets/js/443.755a8219.js"><link rel="prefetch" href="/docs/assets/js/444.0fd91870.js"><link rel="prefetch" href="/docs/assets/js/445.3843471a.js"><link rel="prefetch" href="/docs/assets/js/446.5108660c.js"><link rel="prefetch" href="/docs/assets/js/447.2d40f0f2.js"><link rel="prefetch" href="/docs/assets/js/448.5c285819.js"><link rel="prefetch" href="/docs/assets/js/449.b7f115d7.js"><link rel="prefetch" href="/docs/assets/js/45.1506ea78.js"><link rel="prefetch" href="/docs/assets/js/450.30b8fd58.js"><link rel="prefetch" href="/docs/assets/js/451.08dac034.js"><link rel="prefetch" href="/docs/assets/js/452.112c1b9d.js"><link rel="prefetch" href="/docs/assets/js/453.2b2f7603.js"><link rel="prefetch" href="/docs/assets/js/454.825b61a7.js"><link rel="prefetch" href="/docs/assets/js/455.7aeac1ca.js"><link rel="prefetch" href="/docs/assets/js/456.a0b24a7b.js"><link rel="prefetch" href="/docs/assets/js/457.0cab1b2e.js"><link rel="prefetch" href="/docs/assets/js/458.a8d688cf.js"><link rel="prefetch" href="/docs/assets/js/459.af66fa46.js"><link rel="prefetch" href="/docs/assets/js/46.eb0b6c7d.js"><link rel="prefetch" href="/docs/assets/js/460.b1d9536c.js"><link rel="prefetch" href="/docs/assets/js/461.b877ff25.js"><link rel="prefetch" href="/docs/assets/js/462.7d72c58b.js"><link rel="prefetch" href="/docs/assets/js/463.e307ed93.js"><link rel="prefetch" href="/docs/assets/js/464.b596c129.js"><link rel="prefetch" href="/docs/assets/js/465.9962e6c5.js"><link rel="prefetch" href="/docs/assets/js/466.b9831491.js"><link rel="prefetch" href="/docs/assets/js/467.0bb0ccab.js"><link rel="prefetch" href="/docs/assets/js/468.3e8644e7.js"><link rel="prefetch" href="/docs/assets/js/469.94a694d6.js"><link rel="prefetch" href="/docs/assets/js/47.91eed71d.js"><link rel="prefetch" href="/docs/assets/js/470.c8a99264.js"><link rel="prefetch" href="/docs/assets/js/471.5c870b71.js"><link rel="prefetch" href="/docs/assets/js/472.e0336436.js"><link rel="prefetch" href="/docs/assets/js/473.649404a1.js"><link rel="prefetch" href="/docs/assets/js/474.22f0c7ce.js"><link rel="prefetch" href="/docs/assets/js/475.c8bafe2b.js"><link rel="prefetch" href="/docs/assets/js/476.039eff9a.js"><link rel="prefetch" href="/docs/assets/js/477.ccc0018c.js"><link rel="prefetch" href="/docs/assets/js/478.5f3882ea.js"><link rel="prefetch" href="/docs/assets/js/479.dbf1620f.js"><link rel="prefetch" href="/docs/assets/js/48.baababa7.js"><link rel="prefetch" href="/docs/assets/js/480.1cf35fb1.js"><link rel="prefetch" href="/docs/assets/js/481.3fb7f588.js"><link rel="prefetch" href="/docs/assets/js/482.ece1d28a.js"><link rel="prefetch" href="/docs/assets/js/483.aa166aa3.js"><link rel="prefetch" href="/docs/assets/js/484.750d5297.js"><link rel="prefetch" href="/docs/assets/js/485.75b82121.js"><link rel="prefetch" href="/docs/assets/js/486.2108e90e.js"><link rel="prefetch" href="/docs/assets/js/487.c5c06f08.js"><link rel="prefetch" href="/docs/assets/js/488.d63fb77b.js"><link rel="prefetch" href="/docs/assets/js/489.c80b7f0c.js"><link rel="prefetch" href="/docs/assets/js/49.f5071b4f.js"><link rel="prefetch" href="/docs/assets/js/490.e579c535.js"><link rel="prefetch" href="/docs/assets/js/491.178b087b.js"><link rel="prefetch" href="/docs/assets/js/492.e4c63c3f.js"><link rel="prefetch" href="/docs/assets/js/493.282ac840.js"><link rel="prefetch" href="/docs/assets/js/494.d3363537.js"><link rel="prefetch" href="/docs/assets/js/495.67ac534e.js"><link rel="prefetch" href="/docs/assets/js/496.d1384fff.js"><link rel="prefetch" href="/docs/assets/js/497.27a40b54.js"><link rel="prefetch" href="/docs/assets/js/498.c61746b8.js"><link rel="prefetch" href="/docs/assets/js/499.3f3c73bc.js"><link rel="prefetch" href="/docs/assets/js/5.849cd676.js"><link rel="prefetch" href="/docs/assets/js/50.dcf8bd8a.js"><link rel="prefetch" href="/docs/assets/js/500.5a0e4c18.js"><link rel="prefetch" href="/docs/assets/js/501.a3cfb6aa.js"><link rel="prefetch" href="/docs/assets/js/502.e9f5cc45.js"><link rel="prefetch" href="/docs/assets/js/503.99efa8c8.js"><link rel="prefetch" href="/docs/assets/js/504.61c47371.js"><link rel="prefetch" href="/docs/assets/js/505.f66862d5.js"><link rel="prefetch" href="/docs/assets/js/506.9b4ef684.js"><link rel="prefetch" href="/docs/assets/js/507.5747f1e5.js"><link rel="prefetch" href="/docs/assets/js/508.c04c9953.js"><link rel="prefetch" href="/docs/assets/js/509.a9c35475.js"><link rel="prefetch" href="/docs/assets/js/51.c7cef84b.js"><link rel="prefetch" href="/docs/assets/js/510.d8f67c85.js"><link rel="prefetch" href="/docs/assets/js/511.6456c5f3.js"><link rel="prefetch" href="/docs/assets/js/512.525a41e6.js"><link rel="prefetch" href="/docs/assets/js/513.721d82b4.js"><link rel="prefetch" href="/docs/assets/js/514.4bae17eb.js"><link rel="prefetch" href="/docs/assets/js/515.3019459b.js"><link rel="prefetch" href="/docs/assets/js/516.43dcc9c4.js"><link rel="prefetch" href="/docs/assets/js/517.6e5fcc59.js"><link rel="prefetch" href="/docs/assets/js/518.f723fca6.js"><link rel="prefetch" href="/docs/assets/js/519.912426c6.js"><link rel="prefetch" href="/docs/assets/js/52.c1e29456.js"><link rel="prefetch" href="/docs/assets/js/520.dc4b2c9e.js"><link rel="prefetch" href="/docs/assets/js/521.7b276ac3.js"><link rel="prefetch" href="/docs/assets/js/522.7a64b39e.js"><link rel="prefetch" href="/docs/assets/js/523.58b199e4.js"><link rel="prefetch" href="/docs/assets/js/524.ffe507c8.js"><link rel="prefetch" href="/docs/assets/js/525.9b17d0a0.js"><link rel="prefetch" href="/docs/assets/js/526.845ea578.js"><link rel="prefetch" href="/docs/assets/js/527.a04bbb4a.js"><link rel="prefetch" href="/docs/assets/js/528.3b9c4db6.js"><link rel="prefetch" href="/docs/assets/js/529.62a271e8.js"><link rel="prefetch" href="/docs/assets/js/53.60bce623.js"><link rel="prefetch" href="/docs/assets/js/530.79e344f2.js"><link rel="prefetch" href="/docs/assets/js/531.dca0f82f.js"><link rel="prefetch" href="/docs/assets/js/532.9f95c15e.js"><link rel="prefetch" href="/docs/assets/js/533.b666073a.js"><link rel="prefetch" href="/docs/assets/js/534.0a2dfe46.js"><link rel="prefetch" href="/docs/assets/js/535.0104bfce.js"><link rel="prefetch" href="/docs/assets/js/536.66a39223.js"><link rel="prefetch" href="/docs/assets/js/537.acd88604.js"><link rel="prefetch" href="/docs/assets/js/538.2646392b.js"><link rel="prefetch" href="/docs/assets/js/539.f643456a.js"><link rel="prefetch" href="/docs/assets/js/54.0ae72f1d.js"><link rel="prefetch" href="/docs/assets/js/540.ce1cb7a4.js"><link rel="prefetch" href="/docs/assets/js/541.a53ec78d.js"><link rel="prefetch" href="/docs/assets/js/542.ca79deb3.js"><link rel="prefetch" href="/docs/assets/js/543.90abb97e.js"><link rel="prefetch" href="/docs/assets/js/544.dee54c4d.js"><link rel="prefetch" href="/docs/assets/js/545.7eaee57e.js"><link rel="prefetch" href="/docs/assets/js/546.0aa4e9bf.js"><link rel="prefetch" href="/docs/assets/js/547.18e39086.js"><link rel="prefetch" href="/docs/assets/js/548.54c72490.js"><link rel="prefetch" href="/docs/assets/js/549.e890442b.js"><link rel="prefetch" href="/docs/assets/js/55.a0db9c50.js"><link rel="prefetch" href="/docs/assets/js/550.ec3c9d02.js"><link rel="prefetch" href="/docs/assets/js/551.59a59571.js"><link rel="prefetch" href="/docs/assets/js/552.0fb2b13b.js"><link rel="prefetch" href="/docs/assets/js/553.4bdf2362.js"><link rel="prefetch" href="/docs/assets/js/554.541b8547.js"><link rel="prefetch" href="/docs/assets/js/56.1e832eb8.js"><link rel="prefetch" href="/docs/assets/js/57.a39702d9.js"><link rel="prefetch" href="/docs/assets/js/58.7b426366.js"><link rel="prefetch" href="/docs/assets/js/59.99997ae6.js"><link rel="prefetch" href="/docs/assets/js/6.fbe43a45.js"><link rel="prefetch" href="/docs/assets/js/60.659f8f0a.js"><link rel="prefetch" href="/docs/assets/js/61.c113adea.js"><link rel="prefetch" href="/docs/assets/js/62.37859931.js"><link rel="prefetch" href="/docs/assets/js/63.4a5eefd0.js"><link rel="prefetch" href="/docs/assets/js/64.97fdb964.js"><link rel="prefetch" href="/docs/assets/js/65.eeed5fb5.js"><link rel="prefetch" href="/docs/assets/js/66.63731812.js"><link rel="prefetch" href="/docs/assets/js/67.3090589e.js"><link rel="prefetch" href="/docs/assets/js/68.123e1881.js"><link rel="prefetch" href="/docs/assets/js/69.37a0664f.js"><link rel="prefetch" href="/docs/assets/js/7.a19d763d.js"><link rel="prefetch" href="/docs/assets/js/70.a2e4749f.js"><link rel="prefetch" href="/docs/assets/js/71.449986ff.js"><link rel="prefetch" href="/docs/assets/js/72.56925af2.js"><link rel="prefetch" href="/docs/assets/js/73.8c08bb61.js"><link rel="prefetch" href="/docs/assets/js/74.b3ed8f80.js"><link rel="prefetch" href="/docs/assets/js/75.185b8b4e.js"><link rel="prefetch" href="/docs/assets/js/76.a900c1f5.js"><link rel="prefetch" href="/docs/assets/js/77.fc6f9c91.js"><link rel="prefetch" href="/docs/assets/js/78.bb62281b.js"><link rel="prefetch" href="/docs/assets/js/79.085432a6.js"><link rel="prefetch" href="/docs/assets/js/8.f24e3a83.js"><link rel="prefetch" href="/docs/assets/js/80.16bd559b.js"><link rel="prefetch" href="/docs/assets/js/81.78cde6c5.js"><link rel="prefetch" href="/docs/assets/js/82.d3bfdcf2.js"><link rel="prefetch" href="/docs/assets/js/83.c63d7f85.js"><link rel="prefetch" href="/docs/assets/js/84.e09b533d.js"><link rel="prefetch" href="/docs/assets/js/85.5b12ec32.js"><link rel="prefetch" href="/docs/assets/js/86.25767687.js"><link rel="prefetch" href="/docs/assets/js/87.398fe9e2.js"><link rel="prefetch" href="/docs/assets/js/88.766e612e.js"><link rel="prefetch" href="/docs/assets/js/89.4d5c1cfe.js"><link rel="prefetch" href="/docs/assets/js/9.0f4f51e4.js"><link rel="prefetch" href="/docs/assets/js/91.c0b40248.js"><link rel="prefetch" href="/docs/assets/js/92.32da7fc3.js"><link rel="prefetch" href="/docs/assets/js/93.e5b3f916.js"><link rel="prefetch" href="/docs/assets/js/94.77f6f2d1.js"><link rel="prefetch" href="/docs/assets/js/95.6fc48fb7.js"><link rel="prefetch" href="/docs/assets/js/96.479d131c.js"><link rel="prefetch" href="/docs/assets/js/97.bfb29f15.js"><link rel="prefetch" href="/docs/assets/js/98.143bae33.js"><link rel="prefetch" href="/docs/assets/js/99.d89c472d.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.a4bdeed3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>System Design Case Studies</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/notification/" class="sidebar-link">Design a notification system</a></li><li><a href="/docs/kungfu/case-study/metrics/" class="sidebar-link">Metrics Monitoring &amp; Alerting System</a></li><li><a href="/docs/kungfu/case-study/ad-click/" class="sidebar-link">Ad Click Event Aggregation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Data storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Online tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Booking System</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Social Network</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Location-based</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Video</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Chat system</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Building Microservices</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Go</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_15-junit-internals"><a href="#_15-junit-internals" class="header-anchor">#</a> 15. JUnit Internals</h1> <p>JUnit is one of the most famous of all Java frameworks. As frameworks go, it is simple in
conception, precise in definition, and elegant in implementation. But what does the code
look like? In this chapter we’ll critique an example drawn from the JUnit framework.</p> <p>252 <strong>Chapter 15: JUnit Internals</strong></p> <h2 id="the-junit-framework"><a href="#the-junit-framework" class="header-anchor">#</a> The JUnit Framework ...</h2> <p>JUnit has had many authors, but it began with Kent Beck and Eric Gamma together on a
plane to Atlanta. Kent wanted to learn Java, and Eric wanted to learn about Kent’s Small-
talk testing framework. “What could be more natural to a couple of geeks in cramped
quarters than to pull out our laptops and start coding?”^1 After three hours of high-altitude
work, they had written the basics of JUnit.</p> <p>The module we’ll look at is the clever bit of code that helps identify string compari-
son errors. This module is called ComparisonCompactor. Given two strings that differ,
such as ABCDEandABXDE,it will expose the difference by generating a string such as
&lt;...B[X]D...&gt;.</p> <p>I could explain it further, but the test cases do a better job. So take a look at Listing 15-1
and you will understand the requirements of this module in depth. While you are at it,
critique the structure of the tests. Could they be simpler or more obvious?</p> <ol><li><em>JUnit Pocket Guide</em> , Kent Beck, O’Reilly, 2004, p. 43.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>Listing 15-1
ComparisonCompactorTest.java
package junit.tests.framework;
import junit.framework.ComparisonCompactor;
import junit.framework.TestCase;
public class ComparisonCompactorTest extends TestCase {
public void testMessage() {
String failure= new ComparisonCompactor(0, &quot;b&quot;, &quot;c&quot;).compact(&quot;a&quot;);
assertTrue(&quot;a expected:&lt;[b]&gt; but was:&lt;[c]&gt;&quot;.equals(failure));
}
public void testStartSame() {
String failure= new ComparisonCompactor(1, &quot;ba&quot;, &quot;bc&quot;).compact(null);
assertEquals(&quot;expected:&lt;b[a]&gt; but was:&lt;b[c]&gt;&quot;, failure);
}
public void testEndSame() {
String failure= new ComparisonCompactor(1, &quot;ab&quot;, &quot;cb&quot;).compact(null);
assertEquals(&quot;expected:&lt;[a]b&gt; but was:&lt;[c]b&gt;&quot;, failure);
}
public void testSame() {
String failure= new ComparisonCompactor(1, &quot;ab&quot;, &quot;ab&quot;).compact(null);
assertEquals(&quot;expected:&lt;ab&gt; but was:&lt;ab&gt;&quot;, failure);
}
public void testNoContextStartAndEndSame() {
String failure= new ComparisonCompactor(0, &quot;abc&quot;, &quot;adc&quot;).compact(null);
assertEquals(&quot;expected:&lt;...[b]...&gt; but was:&lt;...[d]...&gt;&quot;, failure);
}
</code></pre></div><p><strong>The JUnit Framework</strong> 253</p> <div class="language- extra-class"><pre class="language-text"><code>public void testStartAndEndContext() {
String failure= new ComparisonCompactor(1, &quot;abc&quot;, &quot;adc&quot;).compact(null);
assertEquals(&quot;expected:&lt;a[b]c&gt; but was:&lt;a[d]c&gt;&quot;, failure);
}
public void testStartAndEndContextWithEllipses() {
String failure=
new ComparisonCompactor(1, &quot;abcde&quot;, &quot;abfde&quot;).compact(null);
assertEquals(&quot;expected:&lt;...b[c]d...&gt; but was:&lt;...b[f]d...&gt;&quot;, failure);
}
public void testComparisonErrorStartSameComplete() {
String failure= new ComparisonCompactor(2, &quot;ab&quot;, &quot;abc&quot;).compact(null);
assertEquals(&quot;expected:&lt;ab[]&gt; but was:&lt;ab[c]&gt;&quot;, failure);
}
public void testComparisonErrorEndSameComplete() {
String failure= new ComparisonCompactor(0, &quot;bc&quot;, &quot;abc&quot;).compact(null);
assertEquals(&quot;expected:&lt;[]...&gt; but was:&lt;[a]...&gt;&quot;, failure);
}
public void testComparisonErrorEndSameCompleteContext() {
String failure= new ComparisonCompactor(2, &quot;bc&quot;, &quot;abc&quot;).compact(null);
assertEquals(&quot;expected:&lt;[]bc&gt; but was:&lt;[a]bc&gt;&quot;, failure);
}
public void testComparisonErrorOverlapingMatches() {
String failure= new ComparisonCompactor(0, &quot;abc&quot;, &quot;abbc&quot;).compact(null);
assertEquals(&quot;expected:&lt;...[]...&gt; but was:&lt;...[b]...&gt;&quot;, failure);
}
public void testComparisonErrorOverlapingMatchesContext() {
String failure= new ComparisonCompactor(2, &quot;abc&quot;, &quot;abbc&quot;).compact(null);
assertEquals(&quot;expected:&lt;ab[]c&gt; but was:&lt;ab[b]c&gt;&quot;, failure);
}
public void testComparisonErrorOverlapingMatches2() {
String failure= new ComparisonCompactor(0, &quot;abcdde&quot;,
&quot;abcde&quot;).compact(null);
assertEquals(&quot;expected:&lt;...[d]...&gt; but was:&lt;...[]...&gt;&quot;, failure);
}
public void testComparisonErrorOverlapingMatches2Context() {
String failure=
new ComparisonCompactor(2, &quot;abcdde&quot;, &quot;abcde&quot;).compact(null);
assertEquals(&quot;expected:&lt;...cd[d]e&gt; but was:&lt;...cd[]e&gt;&quot;, failure);
}
public void testComparisonErrorWithActualNull() {
String failure= new ComparisonCompactor(0, &quot;a&quot;, null).compact(null);
assertEquals(&quot;expected:&lt;a&gt; but was:&lt;null&gt;&quot;, failure);
}
public void testComparisonErrorWithActualNullContext() {
String failure= new ComparisonCompactor(2, &quot;a&quot;, null).compact(null);
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-1 (continued)
ComparisonCompactorTest.java
</code></pre></div><p>254 <strong>Chapter 15: JUnit Internals</strong></p> <p>I ran a code coverage analysis on the ComparisonCompactorusing these tests. The code
is 100 percent covered. Every line of code, every ifstatement and forloop, is executed by
the tests. This gives me a high degree of confidence that the code works and a high degree
of respect for the craftsmanship of the authors.</p> <p>The code for ComparisonCompactoris in Listing 15-2. Take a moment to look over this
code. I think you’ll find it to be nicely partitioned, reasonably expressive, and simple in
structure. Once you are done, then we’ll pick the nits together.</p> <div class="language- extra-class"><pre class="language-text"><code>assertEquals(&quot;expected:&lt;a&gt; but was:&lt;null&gt;&quot;, failure);
}
public void testComparisonErrorWithExpectedNull() {
String failure= new ComparisonCompactor(0, null, &quot;a&quot;).compact(null);
assertEquals(&quot;expected:&lt;null&gt; but was:&lt;a&gt;&quot;, failure);
}
public void testComparisonErrorWithExpectedNullContext() {
String failure= new ComparisonCompactor(2, null, &quot;a&quot;).compact(null);
assertEquals(&quot;expected:&lt;null&gt; but was:&lt;a&gt;&quot;, failure);
}
public void testBug609972() {
String failure= new ComparisonCompactor(10, &quot;S&amp;P500&quot;, &quot;0&quot;).compact(null);
assertEquals(&quot;expected:&lt;[S&amp;P50]0&gt; but was:&lt;[]0&gt;&quot;, failure);
}
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-2
ComparisonCompactor.java (Original)
package junit.framework;
public class ComparisonCompactor {
private static final String ELLIPSIS = &quot;...&quot;;
private static final String DELTA_END = &quot;]&quot;;
private static final String DELTA_START = &quot;[&quot;;
private int fContextLength;
private String fExpected;
private String fActual;
private int fPrefix;
private int fSuffix;
public ComparisonCompactor(int contextLength,
String expected,
String actual) {
fContextLength = contextLength;
fExpected = expected;
fActual = actual;
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-1 (continued)
ComparisonCompactorTest.java
</code></pre></div><p><strong>The JUnit Framework</strong> 255</p> <div class="language- extra-class"><pre class="language-text"><code>public String compact(String message) {
if (fExpected == null || fActual == null || areStringsEqual())
return Assert.format(message, fExpected, fActual);
findCommonPrefix();
findCommonSuffix();
String expected = compactString(fExpected);
String actual = compactString(fActual);
return Assert.format(message, expected, actual);
}
private String compactString(String source) {
String result = DELTA_START +
source.substring(fPrefix, source.length() -
fSuffix + 1) + DELTA_END;
if (fPrefix &gt; 0)
result = computeCommonPrefix() + result;
if (fSuffix &gt; 0)
result = result + computeCommonSuffix();
return result;
}
private void findCommonPrefix() {
fPrefix = 0;
int end = Math.min(fExpected.length(), fActual.length());
for (; fPrefix &lt; end; fPrefix++) {
if (fExpected.charAt(fPrefix) != fActual.charAt(fPrefix))
break;
}
}
private void findCommonSuffix() {
int expectedSuffix = fExpected.length() - 1;
int actualSuffix = fActual.length() - 1;
for (;
actualSuffix &gt;= fPrefix &amp;&amp; expectedSuffix &gt;= fPrefix;
actualSuffix--, expectedSuffix--) {
if (fExpected.charAt(expectedSuffix) != fActual.charAt(actualSuffix))
break;
}
fSuffix = fExpected.length() - expectedSuffix;
}
private String computeCommonPrefix() {
return (fPrefix &gt; fContextLength? ELLIPSIS : &quot;&quot;) +
fExpected.substring(Math.max(0, fPrefix - fContextLength),
fPrefix);
}
private String computeCommonSuffix() {
int end = Math.min(fExpected.length() - fSuffix + 1 + fContextLength,
fExpected.length());
return fExpected.substring(fExpected.length() - fSuffix + 1, end) +
(fExpected.length() - fSuffix + 1 &lt; fExpected.length() -
fContextLength? ELLIPSIS : &quot;&quot;);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-2 (continued)
ComparisonCompactor.java (Original)
</code></pre></div><p>256 <strong>Chapter 15: JUnit Internals</strong></p> <p>You might have a few complaints about this module. There are some long expressions
and some strange +1s and so forth. But overall this module is pretty good. After all, it
might have looked like Listing 15-3.</p> <div class="language- extra-class"><pre class="language-text"><code>private boolean areStringsEqual() {
return fExpected.equals(fActual);
}
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-3
ComparisonCompator.java (defactored)
package junit.framework;
public class ComparisonCompactor {
private int ctxt;
private String s1;
private String s2;
private int pfx;
private int sfx;
public ComparisonCompactor(int ctxt, String s1, String s2) {
this.ctxt = ctxt;
this.s1 = s1;
this.s2 = s2;
}
public String compact(String msg) {
if (s1 == null || s2 == null || s1.equals(s2))
return Assert.format(msg, s1, s2);
pfx = 0;
for (; pfx &lt; Math.min(s1.length(), s2.length()); pfx++) {
if (s1.charAt(pfx) != s2.charAt(pfx))
break;
}
int sfx1 = s1.length() - 1;
int sfx2 = s2.length() - 1;
for (; sfx2 &gt;= pfx &amp;&amp; sfx1 &gt;= pfx; sfx2--, sfx1--) {
if (s1.charAt(sfx1) != s2.charAt(sfx2))
break;
}
sfx = s1.length() - sfx1;
String cmp1 = compactString(s1);
String cmp2 = compactString(s2);
return Assert.format(msg, cmp1, cmp2);
}
private String compactString(String s) {
String result =
&quot;[&quot; + s.substring(pfx, s.length() - sfx + 1) + &quot;]&quot;;
if (pfx &gt; 0)
result = (pfx &gt; ctxt? &quot;...&quot; : &quot;&quot;) +
s1.substring(Math.max(0, pfx - ctxt), pfx) + result;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-2 (continued)
ComparisonCompactor.java (Original)
</code></pre></div><p><strong>The JUnit Framework</strong> 257</p> <p>Even though the authors left this module in very good shape, the <em>Boy Scout Rule</em>^2 tells
us we should leave it cleaner than we found it. So, how can we improve on the original
code in Listing 15-2?</p> <p>The first thing I don’t care for is the fprefix for the member variables [N6]. Today’s
environments make this kind of scope encoding redundant. So let’s eliminate all the f’s.</p> <p>private int contextLength;
private String expected;
private String actual;
private int prefix;
private int suffix;
Next, we have an unencapsulated conditional at the beginning of the compactfunction
[G28].</p> <div class="language- extra-class"><pre class="language-text"><code>public String compact(String message) {
if (expected == null || actual == null || areStringsEqual())
return Assert.format(message, expected, actual);
findCommonPrefix();
findCommonSuffix();
String expected = compactString(this.expected);
String actual = compactString(this.actual);
return Assert.format(message, expected, actual);
}
</code></pre></div><p>This conditional should be encapsulated to make our intent clear. So let’s extract a method
that explains it.</p> <div class="language- extra-class"><pre class="language-text"><code>public String compact(String message) {
if ( shouldNotCompact() )
return Assert.format(message, expected, actual);
findCommonPrefix();
findCommonSuffix();
String expected = compactString(this.expected);
String actual = compactString(this.actual);
return Assert.format(message, expected, actual);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>if (sfx &gt; 0) {
int end = Math.min(s1.length() - sfx + 1 + ctxt, s1.length());
result = result + (s1.substring(s1.length() - sfx + 1, end) +
(s1.length() - sfx + 1 &lt; s1.length() - ctxt? &quot;...&quot; : &quot;&quot;));
}
return result;
}
}
</code></pre></div><ol start="2"><li>See “The Boy Scout Rule” on page 14.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>Listing 15-3 (continued)
ComparisonCompator.java (defactored)
</code></pre></div><p>258 <strong>Chapter 15: JUnit Internals</strong></p> <div class="language- extra-class"><pre class="language-text"><code>private boolean shouldNotCompact() {
return expected == null || actual == null || areStringsEqual();
}
I don’t much care for the this.expectedandthis.actualnotation in the compactfunc-
tion. This happened when we changed the name of fExpectedtoexpected. Why are there
variables in this function that have the same names as the member variables? Don’t they
represent something else [N4]? We should make the names unambiguous.
String compactExpected = compactString( expected );
String compactActual = compactString( actual );
Negatives are slightly harder to understand than positives [G29]. So let’s turn that if
statement on its head and invert the sense of the conditional.
public String compact(String message) {
if ( canBeCompacted ()) {
findCommonPrefix();
findCommonSuffix();
String compactExpected = compactString(expected);
String compactActual = compactString(actual);
return Assert.format(message, compactExpected, compactActual);
} else {
return Assert.format(message, expected, actual);
}
}
private boolean canBeCompacted () {
return expected != null &amp;&amp; actual != null &amp;&amp;! areStringsEqual();
}
The name of the function is strange [N7]. Although it does compact the strings, it
actually might not compact the strings if canBeCompactedreturns false. So naming this
functioncompacthides the side effect of the error check. Notice also that the function
returns a formatted message, not just the compacted strings. So the name of the function
should really be formatCompactedComparison. That makes it read a lot better when taken
with the function argument:
public String formatCompactedComparison(String message) {
The body of the ifstatement is where the true compacting of the expected and actual
strings is done. We should extract that as a method named compactExpectedAndActual. How-
ever, we want the formatCompactedComparisonfunction to do all the formatting. The
compact... function should do nothing but compacting [G30]. So let’s split it up as follows:
...
private String compactExpected;
private String compactActual;
...
public String formatCompactedComparison(String message) {
if (canBeCompacted()) {
compactExpectedAndActual();
return Assert.format(message, compactExpected, compactActual);
} else {
</code></pre></div><p><strong>The JUnit Framework</strong> 259</p> <p>return Assert.format(message, expected, actual);
}
}
private void <strong>compactExpectedAndActual</strong> () {
findCommonPrefix();
findCommonSuffix();
compactExpected = compactString(expected);
compactActual = compactString(actual);
}
Notice that this required us to promote compactExpectedandcompactActualto member
variables. I don’t like the way that the last two lines of the new function return variables,
but the first two don’t. They aren’t using consistent conventions [G11]. So we should
changefindCommonPrefix and findCommonSuffix to return the prefix and suffix values.</p> <p>private void compactExpectedAndActual() {
<strong>prefixIndex =</strong> findCommonPrefix();
<strong>suffixIndex =</strong> findCommonSuffix();
compactExpected = compactString(expected);
compactActual = compactString(actual);
}
private <strong>int</strong> findCommonPrefix() {
<strong>int</strong> prefix <strong>Index</strong> = 0;
int end = Math.min(expected.length(), actual.length());
for (; prefix <strong>Index</strong> &lt; end; prefix <strong>Index</strong> ++) {
if (expected.charAt(prefix <strong>Index</strong> ) != actual.charAt(prefix <strong>Index</strong> ))
break;
}
<strong>return prefixIndex;</strong>
}
private <strong>int</strong> findCommonSuffix() {
int expectedSuffix = expected.length() - 1;
int actualSuffix = actual.length() - 1;
for (; actualSuffix &gt;= prefix <strong>Index</strong> &amp;&amp; expectedSuffix &gt;= prefixIndex;
actualSuffix--, expectedSuffix--) {
if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))
break;
}
<strong>return</strong> expected.length() - expectedSuffix;
}
We should also change the names of the member variables to be a little more accurate
[N1]; after all, they are both indices.</p> <p>Careful inspection of findCommonSuffixexposes a <em>hidden temporal coupling</em> [G31]; it
depends on the fact that prefixIndexis calculated by findCommonPrefix. If these two func-
tions were called out of order, there would be a difficult debugging session ahead. So, to
expose this temporal coupling, let’s have findCommonSuffixtake the prefixIndexas an
argument.</p> <div class="language- extra-class"><pre class="language-text"><code>private void compactExpectedAndActual() {
prefixIndex = findCommonPrefix();
suffixIndex = findCommonSuffix( prefixIndex );
</code></pre></div><p>260 <strong>Chapter 15: JUnit Internals</strong></p> <div class="language- extra-class"><pre class="language-text"><code>compactExpected = compactString(expected);
compactActual = compactString(actual);
}
private int findCommonSuffix( int prefixIndex ) {
int expectedSuffix = expected.length() - 1;
int actualSuffix = actual.length() - 1;
for (; actualSuffix &gt;= prefixIndex &amp;&amp; expectedSuffix &gt;= prefixIndex;
actualSuffix--, expectedSuffix--) {
if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))
break;
}
return expected.length() - expectedSuffix;
}
</code></pre></div><p>I’m not really happy with this. The passing of the prefixIndexargument is a bit arbitrary
[G32]. It works to establish the ordering but does nothing to explain the need for that
ordering. Another programmer might undo what we have done because there’s no indica-
tion that the parameter is really needed. So let’s take a different tack.</p> <div class="language- extra-class"><pre class="language-text"><code>private void compactExpectedAndActual() {
findCommonPrefixAndSuffix ();
compactExpected = compactString(expected);
compactActual = compactString(actual);
}
private void findCommonPrefixAndSuffix () {
findCommonPrefix();
int expectedSuffix = expected.length() - 1;
int actualSuffix = actual.length() - 1;
for (;
actualSuffix &gt;= prefixIndex &amp;&amp; expectedSuffix &gt;= prefixIndex;
actualSuffix--, expectedSuffix--
) {
if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))
break;
}
suffixIndex = expected.length() - expectedSuffix;
}
private void findCommonPrefix() {
prefixIndex = 0;
int end = Math.min(expected.length(), actual.length());
for (; prefixIndex &lt; end; prefixIndex++)
if (expected.charAt(prefixIndex) != actual.charAt(prefixIndex))
break;
}
</code></pre></div><p>We putfindCommonPrefixandfindCommonSuffixback the way they were, changing the
name of findCommonSuffixtofindCommon <strong>PrefixAnd</strong> Suffixand having it call findCommon-
Prefixbefore doing anything else. That establishes the temporal nature of the two func-
tions in a much more dramatic way than the previous solution. It also points out how ugly
findCommonPrefixAndSuffix is. Let’s clean it up now.</p> <div class="language- extra-class"><pre class="language-text"><code>private void findCommonPrefixAndSuffix() {
findCommonPrefix();
int suffixLength = 1;
</code></pre></div><p><strong>The JUnit Framework</strong> 261</p> <p>for (; !suffixOverlapsPrefix(suffixLength); suffixLength++) {
if (charFromEnd(expected, suffixLength) !=
charFromEnd(actual, suffixLength))
break;
}
suffixIndex = suffixLength;
}
private char charFromEnd(String s, int i) {
return s.charAt(s.length()-i);}
private boolean suffixOverlapsPrefix(int suffixLength) {
return actual.length() - suffixLength &lt; prefixLength ||
expected.length() - suffixLength &lt; prefixLength;
}
This is much better. It exposes that the suffixIndexis really the length of the suffix
and is not well named. The same is true of the prefixIndex, though in that case “index” and
“length” are synonymous. Even so, it is more consistent to use “length.” The problem is
that the suffixIndexvariable is not zero based; it is 1 based and so is not a true length. This
is also the reason that there are all those +1s in computeCommonSuffix[G33]. So let’s fix that.
The result is in Listing 15-4.</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 15-4
ComparisonCompactor.java (interim)
public class ComparisonCompactor {
...
private int suffixLength ;
...
private void findCommonPrefixAndSuffix() {
findCommonPrefix();
suffixLength = 0;
for (; !suffixOverlapsPrefix(suffixLength); suffixLength++) {
if (charFromEnd(expected, suffixLength) !=
charFromEnd(actual, suffixLength))
break;
}
}
private char charFromEnd(String s, int i) {
return s.charAt(s.length() - i - 1 );
}
private boolean suffixOverlapsPrefix(int suffixLength) {
return actual.length() - suffixLength &lt;= prefixLength ||
expected.length() - suffixLength &lt;= prefixLength;
}
...
private String compactString(String source) {
String result =
DELTA_START +
source.substring(prefixLength, source.length() - suffixLength ) +
DELTA_END;
if (prefixLength &gt; 0)
result = computeCommonPrefix() + result;
</code></pre></div><p>262 <strong>Chapter 15: JUnit Internals</strong></p> <p>We replaced the +1s in computeCommonSuffixwith a -1incharFromEnd, where it makes
perfect sense, and two &lt;=operators in suffixOverlapsPrefix, where they also make perfect
sense. This allowed us to change the name of suffixIndextosuffixLength, greatly enhanc-
ing the readability of the code.</p> <p>There is a problem however. As I was eliminating the +1s, I noticed the following line
incompactString:</p> <div class="language- extra-class"><pre class="language-text"><code>if (suffixLength &gt; 0)
</code></pre></div><p>Take a look at it in Listing 15-4. By rights, because suffixLengthis now one less than it
used to be, I should change the &gt;operator to a &gt;=operator. But that makes no sense. It
makes sense <em>now!</em> This means that it didn’t use to make sense and was probably a bug.
Well, not quite a bug. Upon further analysis we see that the ifstatement now prevents a
zero length suffix from being appended. Before we made the change, the if statement was
nonfunctional because suffixIndex could never be less than one!</p> <p>This calls into question <em>both</em> ifstatements in compactString! It looks as though they
could both be eliminated. So let’s comment them out and run the tests. They passed! So
let’s restructure compactStringto eliminate the extraneous ifstatements and make the
function much simpler [G9].</p> <div class="language- extra-class"><pre class="language-text"><code>private String compactString(String source) {
return
computeCommonPrefix() +
DELTA_START +
source.substring(prefixLength, source.length() - suffixLength) +
DELTA_END +
computeCommonSuffix();
}
</code></pre></div><p>This is much better! Now we see that the compactStringfunction is simply composing the
fragments together. We can probably make this even clearer. Indeed, there are lots of little</p> <div class="language- extra-class"><pre class="language-text"><code>if ( suffixLength &gt; 0)
result = result + computeCommonSuffix();
return result;
}
...
private String computeCommonSuffix() {
int end = Math.min(expected.length() - suffixLength +
contextLength, expected.length()
);
return
expected.substring(expected.length() - suffixLength , end) +
(expected.length() - suffixLength &lt;
expected.length() - contextLength?
ELLIPSIS : &quot;&quot;);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-4 (continued)
ComparisonCompactor.java (interim)
</code></pre></div><p><strong>The JUnit Framework</strong> 263</p> <p>cleanups we could do. But rather than drag you through the rest of the changes, I’ll just
show you the result in Listing 15-5.</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 15-5
ComparisonCompactor.java (final)
package junit.framework;
public class ComparisonCompactor {
private static final String ELLIPSIS = &quot;...&quot;;
private static final String DELTA_END = &quot;]&quot;;
private static final String DELTA_START = &quot;[&quot;;
private int contextLength;
private String expected;
private String actual;
private int prefixLength;
private int suffixLength;
public ComparisonCompactor(
int contextLength, String expected, String actual
) {
this.contextLength = contextLength;
this.expected = expected;
this.actual = actual;
}
public String formatCompactedComparison(String message) {
String compactExpected = expected;
String compactActual = actual;
if (shouldBeCompacted()) {
findCommonPrefixAndSuffix();
compactExpected = compact(expected);
compactActual = compact(actual);
}
return Assert.format(message, compactExpected, compactActual);
}
private boolean shouldBeCompacted() {
return !shouldNotBeCompacted();
}
private boolean shouldNotBeCompacted() {
return expected == null ||
actual == null ||
expected.equals(actual);
}
private void findCommonPrefixAndSuffix() {
findCommonPrefix();
suffixLength = 0;
for (; !suffixOverlapsPrefix(); suffixLength++) {
if (charFromEnd(expected, suffixLength) !=
charFromEnd(actual, suffixLength)
)
</code></pre></div><p>264 <strong>Chapter 15: JUnit Internals</strong></p> <div class="language- extra-class"><pre class="language-text"><code>break;
}
}
private char charFromEnd(String s, int i) {
return s.charAt(s.length() - i - 1);
}
private boolean suffixOverlapsPrefix() {
return actual.length() - suffixLength &lt;= prefixLength ||
expected.length() - suffixLength &lt;= prefixLength;
}
private void findCommonPrefix() {
prefixLength = 0;
int end = Math.min(expected.length(), actual.length());
for (; prefixLength &lt; end; prefixLength++)
if (expected.charAt(prefixLength) != actual.charAt(prefixLength))
break;
}
private String compact(String s) {
return new StringBuilder()
.append(startingEllipsis())
.append(startingContext())
.append(DELTA_START)
.append(delta(s))
.append(DELTA_END)
.append(endingContext())
.append(endingEllipsis())
.toString();
}
private String startingEllipsis() {
return prefixLength &gt; contextLength? ELLIPSIS : &quot;&quot;;
}
private String startingContext() {
int contextStart = Math.max(0, prefixLength - contextLength);
int contextEnd = prefixLength;
return expected.substring(contextStart, contextEnd);
}
private String delta(String s) {
int deltaStart = prefixLength;
int deltaEnd = s.length() - suffixLength;
return s.substring(deltaStart, deltaEnd);
}
private String endingContext() {
int contextStart = expected.length() - suffixLength;
int contextEnd =
Math.min(contextStart + contextLength, expected.length());
return expected.substring(contextStart, contextEnd);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-5 (continued)
ComparisonCompactor.java (final)
</code></pre></div><p><strong>Conclusion</strong> 265</p> <p>This is actually quite pretty. The module is separated into a group of analysis func-
tions and another group of synthesis functions. They are topologically sorted so that the
definition of each function appears just after it is used. All the analysis functions appear
first, and all the synthesis functions appear last.</p> <p>If you look carefully, you will notice that I reversed several of the decisions I made
earlier in this chapter. For example, I inlined some extracted methods back into
formatCompactedComparison, and I changed the sense of the shouldNotBeCompactedexpres-
sion. This is typical. Often one refactoring leads to another that leads to the undoing of the
first. Refactoring is an iterative process full of trial and error, inevitably converging on
something that we feel is worthy of a professional.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion ..</h2> <p>And so we have satisfied the Boy Scout Rule. We have left this module a bit cleaner than
we found it. Not that it wasn’t clean already. The authors had done an excellent job with it.
But no module is immune from improvement, and each of us has the responsibility to
leave the code a little better than we found it.</p> <div class="language- extra-class"><pre class="language-text"><code>private String endingEllipsis() {
return (suffixLength &gt; contextLength? ELLIPSIS : &quot;&quot;);
}
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 15-5 (continued)
ComparisonCompactor.java (final)
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.cefa8244.js" defer></script><script src="/docs/assets/js/2.f3f7dff4.js" defer></script><script src="/docs/assets/js/429.1f452db9.js" defer></script><script src="/docs/assets/js/90.0efc7950.js" defer></script>
  </body>
</html>
