<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>7. Error Handling | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.de900540.css" as="style"><link rel="preload" href="/docs/assets/js/app.e6f4376b.js" as="script"><link rel="preload" href="/docs/assets/js/2.c567e596.js" as="script"><link rel="preload" href="/docs/assets/js/251.80b6e869.js" as="script"><link rel="preload" href="/docs/assets/js/27.2fe5f85e.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e2dac1de.js"><link rel="prefetch" href="/docs/assets/js/100.1019c9aa.js"><link rel="prefetch" href="/docs/assets/js/101.47043ee7.js"><link rel="prefetch" href="/docs/assets/js/102.32e07b16.js"><link rel="prefetch" href="/docs/assets/js/103.b2be11d8.js"><link rel="prefetch" href="/docs/assets/js/104.530f44ee.js"><link rel="prefetch" href="/docs/assets/js/105.76e1e949.js"><link rel="prefetch" href="/docs/assets/js/106.09a8d8a3.js"><link rel="prefetch" href="/docs/assets/js/107.168e44fc.js"><link rel="prefetch" href="/docs/assets/js/108.01423084.js"><link rel="prefetch" href="/docs/assets/js/109.8990dd5a.js"><link rel="prefetch" href="/docs/assets/js/11.35e42eac.js"><link rel="prefetch" href="/docs/assets/js/110.82bba41b.js"><link rel="prefetch" href="/docs/assets/js/111.1125b628.js"><link rel="prefetch" href="/docs/assets/js/112.115f4593.js"><link rel="prefetch" href="/docs/assets/js/113.2fa3519c.js"><link rel="prefetch" href="/docs/assets/js/114.253d8cf7.js"><link rel="prefetch" href="/docs/assets/js/115.54bc1063.js"><link rel="prefetch" href="/docs/assets/js/116.f82b2df1.js"><link rel="prefetch" href="/docs/assets/js/117.d836bab6.js"><link rel="prefetch" href="/docs/assets/js/118.4cedf3cb.js"><link rel="prefetch" href="/docs/assets/js/119.03d1ba74.js"><link rel="prefetch" href="/docs/assets/js/12.77552012.js"><link rel="prefetch" href="/docs/assets/js/120.7ab1d0b2.js"><link rel="prefetch" href="/docs/assets/js/121.33129b96.js"><link rel="prefetch" href="/docs/assets/js/122.f84d349b.js"><link rel="prefetch" href="/docs/assets/js/123.23978418.js"><link rel="prefetch" href="/docs/assets/js/124.6153593b.js"><link rel="prefetch" href="/docs/assets/js/125.63b16fde.js"><link rel="prefetch" href="/docs/assets/js/126.874d667b.js"><link rel="prefetch" href="/docs/assets/js/127.a7bf043b.js"><link rel="prefetch" href="/docs/assets/js/128.b185e1cb.js"><link rel="prefetch" href="/docs/assets/js/129.7f66c467.js"><link rel="prefetch" href="/docs/assets/js/13.26895487.js"><link rel="prefetch" href="/docs/assets/js/130.1ebf00e6.js"><link rel="prefetch" href="/docs/assets/js/131.d38c7ac3.js"><link rel="prefetch" href="/docs/assets/js/132.ad677805.js"><link rel="prefetch" href="/docs/assets/js/133.7b777d9e.js"><link rel="prefetch" href="/docs/assets/js/134.54951f20.js"><link rel="prefetch" href="/docs/assets/js/135.53b7cfb9.js"><link rel="prefetch" href="/docs/assets/js/136.137895aa.js"><link rel="prefetch" href="/docs/assets/js/137.15a4b031.js"><link rel="prefetch" href="/docs/assets/js/138.a2312d73.js"><link rel="prefetch" href="/docs/assets/js/139.a57c61a5.js"><link rel="prefetch" href="/docs/assets/js/14.2edfcc03.js"><link rel="prefetch" href="/docs/assets/js/140.e9baf5b1.js"><link rel="prefetch" href="/docs/assets/js/141.11cc8c14.js"><link rel="prefetch" href="/docs/assets/js/142.bb0d37fd.js"><link rel="prefetch" href="/docs/assets/js/143.14196c06.js"><link rel="prefetch" href="/docs/assets/js/144.15932f50.js"><link rel="prefetch" href="/docs/assets/js/145.584774ba.js"><link rel="prefetch" href="/docs/assets/js/146.84d95b56.js"><link rel="prefetch" href="/docs/assets/js/147.be95fa3f.js"><link rel="prefetch" href="/docs/assets/js/148.c3701230.js"><link rel="prefetch" href="/docs/assets/js/149.98df8ee3.js"><link rel="prefetch" href="/docs/assets/js/15.35c82508.js"><link rel="prefetch" href="/docs/assets/js/150.2d40812e.js"><link rel="prefetch" href="/docs/assets/js/151.99e6c188.js"><link rel="prefetch" href="/docs/assets/js/152.eaa332f9.js"><link rel="prefetch" href="/docs/assets/js/153.270118b4.js"><link rel="prefetch" href="/docs/assets/js/154.7c030e9f.js"><link rel="prefetch" href="/docs/assets/js/155.b580d56a.js"><link rel="prefetch" href="/docs/assets/js/156.15bfb38b.js"><link rel="prefetch" href="/docs/assets/js/157.31ba83c8.js"><link rel="prefetch" href="/docs/assets/js/158.46c033c2.js"><link rel="prefetch" href="/docs/assets/js/159.cce2e6f4.js"><link rel="prefetch" href="/docs/assets/js/16.a02a3b6d.js"><link rel="prefetch" href="/docs/assets/js/160.49b5df32.js"><link rel="prefetch" href="/docs/assets/js/161.1d8cec93.js"><link rel="prefetch" href="/docs/assets/js/162.3f911dd3.js"><link rel="prefetch" href="/docs/assets/js/163.85e29973.js"><link rel="prefetch" href="/docs/assets/js/164.99cff7ee.js"><link rel="prefetch" href="/docs/assets/js/165.929c8a70.js"><link rel="prefetch" href="/docs/assets/js/166.dfedef39.js"><link rel="prefetch" href="/docs/assets/js/167.00aa19b1.js"><link rel="prefetch" href="/docs/assets/js/168.266fd220.js"><link rel="prefetch" href="/docs/assets/js/169.4cf018a7.js"><link rel="prefetch" href="/docs/assets/js/17.e91576e7.js"><link rel="prefetch" href="/docs/assets/js/170.13c9a11b.js"><link rel="prefetch" href="/docs/assets/js/171.b2917bd7.js"><link rel="prefetch" href="/docs/assets/js/172.e830f996.js"><link rel="prefetch" href="/docs/assets/js/173.cdaf83bd.js"><link rel="prefetch" href="/docs/assets/js/174.c44b53cd.js"><link rel="prefetch" href="/docs/assets/js/175.2c4b88dd.js"><link rel="prefetch" href="/docs/assets/js/176.5ec45030.js"><link rel="prefetch" href="/docs/assets/js/177.83c40c28.js"><link rel="prefetch" href="/docs/assets/js/178.e86d2522.js"><link rel="prefetch" href="/docs/assets/js/179.309921d8.js"><link rel="prefetch" href="/docs/assets/js/18.a01baf67.js"><link rel="prefetch" href="/docs/assets/js/180.7fd0d476.js"><link rel="prefetch" href="/docs/assets/js/181.8ad6c099.js"><link rel="prefetch" href="/docs/assets/js/182.258a6344.js"><link rel="prefetch" href="/docs/assets/js/183.9ad566ea.js"><link rel="prefetch" href="/docs/assets/js/184.e0b67032.js"><link rel="prefetch" href="/docs/assets/js/185.dbdd5484.js"><link rel="prefetch" href="/docs/assets/js/186.3b995a6b.js"><link rel="prefetch" href="/docs/assets/js/187.0a868cb3.js"><link rel="prefetch" href="/docs/assets/js/188.0e16793f.js"><link rel="prefetch" href="/docs/assets/js/189.878ad619.js"><link rel="prefetch" href="/docs/assets/js/19.8db2032b.js"><link rel="prefetch" href="/docs/assets/js/190.e75345de.js"><link rel="prefetch" href="/docs/assets/js/191.a1599633.js"><link rel="prefetch" href="/docs/assets/js/192.a58e056b.js"><link rel="prefetch" href="/docs/assets/js/193.0f5d4d83.js"><link rel="prefetch" href="/docs/assets/js/194.06ad7f97.js"><link rel="prefetch" href="/docs/assets/js/195.029fbf94.js"><link rel="prefetch" href="/docs/assets/js/196.b31f6821.js"><link rel="prefetch" href="/docs/assets/js/197.355b2253.js"><link rel="prefetch" href="/docs/assets/js/198.d0003627.js"><link rel="prefetch" href="/docs/assets/js/199.8e78e8ae.js"><link rel="prefetch" href="/docs/assets/js/20.42bff4eb.js"><link rel="prefetch" href="/docs/assets/js/200.fe435c8c.js"><link rel="prefetch" href="/docs/assets/js/201.918c2ec6.js"><link rel="prefetch" href="/docs/assets/js/202.e30c28f5.js"><link rel="prefetch" href="/docs/assets/js/203.f356d62f.js"><link rel="prefetch" href="/docs/assets/js/204.8c7c27ff.js"><link rel="prefetch" href="/docs/assets/js/205.eaed665e.js"><link rel="prefetch" href="/docs/assets/js/206.2ee34ac6.js"><link rel="prefetch" href="/docs/assets/js/207.a9872dbd.js"><link rel="prefetch" href="/docs/assets/js/208.c5e83026.js"><link rel="prefetch" href="/docs/assets/js/209.ebf4b5e2.js"><link rel="prefetch" href="/docs/assets/js/21.46ae6025.js"><link rel="prefetch" href="/docs/assets/js/210.cde9c61c.js"><link rel="prefetch" href="/docs/assets/js/211.b6e04985.js"><link rel="prefetch" href="/docs/assets/js/212.e9172623.js"><link rel="prefetch" href="/docs/assets/js/213.8798e458.js"><link rel="prefetch" href="/docs/assets/js/214.a6af472b.js"><link rel="prefetch" href="/docs/assets/js/215.bddab8fd.js"><link rel="prefetch" href="/docs/assets/js/216.8dc1d6f8.js"><link rel="prefetch" href="/docs/assets/js/217.eeefde38.js"><link rel="prefetch" href="/docs/assets/js/218.f7bef36c.js"><link rel="prefetch" href="/docs/assets/js/219.3a0a009c.js"><link rel="prefetch" href="/docs/assets/js/22.11947baf.js"><link rel="prefetch" href="/docs/assets/js/220.2cd82f28.js"><link rel="prefetch" href="/docs/assets/js/221.9b13b2f1.js"><link rel="prefetch" href="/docs/assets/js/222.41ee572e.js"><link rel="prefetch" href="/docs/assets/js/223.81251b78.js"><link rel="prefetch" href="/docs/assets/js/224.dd442ce1.js"><link rel="prefetch" href="/docs/assets/js/225.aa8d680a.js"><link rel="prefetch" href="/docs/assets/js/226.c00cf6fc.js"><link rel="prefetch" href="/docs/assets/js/227.9b84ce39.js"><link rel="prefetch" href="/docs/assets/js/228.82c38259.js"><link rel="prefetch" href="/docs/assets/js/229.9ef24570.js"><link rel="prefetch" href="/docs/assets/js/23.d16e46b2.js"><link rel="prefetch" href="/docs/assets/js/230.a3600074.js"><link rel="prefetch" href="/docs/assets/js/231.72f67ced.js"><link rel="prefetch" href="/docs/assets/js/232.39d541ac.js"><link rel="prefetch" href="/docs/assets/js/233.a6d5747c.js"><link rel="prefetch" href="/docs/assets/js/234.9ebc59e0.js"><link rel="prefetch" href="/docs/assets/js/235.fa876107.js"><link rel="prefetch" href="/docs/assets/js/236.48069f51.js"><link rel="prefetch" href="/docs/assets/js/237.efffb3b7.js"><link rel="prefetch" href="/docs/assets/js/238.26c3f5ba.js"><link rel="prefetch" href="/docs/assets/js/239.15aa141b.js"><link rel="prefetch" href="/docs/assets/js/24.33d7caa6.js"><link rel="prefetch" href="/docs/assets/js/240.a7287e74.js"><link rel="prefetch" href="/docs/assets/js/241.a342559e.js"><link rel="prefetch" href="/docs/assets/js/242.15c0b307.js"><link rel="prefetch" href="/docs/assets/js/243.7e2571ee.js"><link rel="prefetch" href="/docs/assets/js/244.3a3a15ec.js"><link rel="prefetch" href="/docs/assets/js/245.da27fbfe.js"><link rel="prefetch" href="/docs/assets/js/246.ce6c7a0e.js"><link rel="prefetch" href="/docs/assets/js/247.59d77890.js"><link rel="prefetch" href="/docs/assets/js/248.e1ce2d39.js"><link rel="prefetch" href="/docs/assets/js/249.a5b9105e.js"><link rel="prefetch" href="/docs/assets/js/25.b32d948e.js"><link rel="prefetch" href="/docs/assets/js/250.4b2838f5.js"><link rel="prefetch" href="/docs/assets/js/252.a065684d.js"><link rel="prefetch" href="/docs/assets/js/253.58bdeef4.js"><link rel="prefetch" href="/docs/assets/js/254.002268e9.js"><link rel="prefetch" href="/docs/assets/js/255.565bb127.js"><link rel="prefetch" href="/docs/assets/js/256.7cadb9fb.js"><link rel="prefetch" href="/docs/assets/js/257.066db541.js"><link rel="prefetch" href="/docs/assets/js/258.21d9e4e1.js"><link rel="prefetch" href="/docs/assets/js/259.c7baf7c8.js"><link rel="prefetch" href="/docs/assets/js/26.16f7e1d9.js"><link rel="prefetch" href="/docs/assets/js/260.3f712e13.js"><link rel="prefetch" href="/docs/assets/js/261.6223d197.js"><link rel="prefetch" href="/docs/assets/js/262.20e5d820.js"><link rel="prefetch" href="/docs/assets/js/263.c2730e46.js"><link rel="prefetch" href="/docs/assets/js/264.fc5d9812.js"><link rel="prefetch" href="/docs/assets/js/265.ec2d1171.js"><link rel="prefetch" href="/docs/assets/js/266.d6e7b50d.js"><link rel="prefetch" href="/docs/assets/js/267.4e99b865.js"><link rel="prefetch" href="/docs/assets/js/268.aa9b8065.js"><link rel="prefetch" href="/docs/assets/js/269.dec0bb9e.js"><link rel="prefetch" href="/docs/assets/js/270.aed7b827.js"><link rel="prefetch" href="/docs/assets/js/271.9740fee8.js"><link rel="prefetch" href="/docs/assets/js/272.675fbf64.js"><link rel="prefetch" href="/docs/assets/js/273.d36c9c44.js"><link rel="prefetch" href="/docs/assets/js/274.4bb99079.js"><link rel="prefetch" href="/docs/assets/js/275.bd3c07a1.js"><link rel="prefetch" href="/docs/assets/js/276.a9419d5a.js"><link rel="prefetch" href="/docs/assets/js/277.b83b344f.js"><link rel="prefetch" href="/docs/assets/js/278.8d4996af.js"><link rel="prefetch" href="/docs/assets/js/279.a20d027e.js"><link rel="prefetch" href="/docs/assets/js/28.0c8cb4fc.js"><link rel="prefetch" href="/docs/assets/js/280.a178c440.js"><link rel="prefetch" href="/docs/assets/js/281.f095cd12.js"><link rel="prefetch" href="/docs/assets/js/282.3715e8b6.js"><link rel="prefetch" href="/docs/assets/js/283.9b9cebb7.js"><link rel="prefetch" href="/docs/assets/js/284.643270d2.js"><link rel="prefetch" href="/docs/assets/js/285.1108fddd.js"><link rel="prefetch" href="/docs/assets/js/286.905bd69c.js"><link rel="prefetch" href="/docs/assets/js/287.85973a71.js"><link rel="prefetch" href="/docs/assets/js/288.e784223a.js"><link rel="prefetch" href="/docs/assets/js/289.07dbef61.js"><link rel="prefetch" href="/docs/assets/js/29.245e1d18.js"><link rel="prefetch" href="/docs/assets/js/290.96e40344.js"><link rel="prefetch" href="/docs/assets/js/291.4ccedd4c.js"><link rel="prefetch" href="/docs/assets/js/292.dba173c6.js"><link rel="prefetch" href="/docs/assets/js/293.0d0f6849.js"><link rel="prefetch" href="/docs/assets/js/294.38521e8b.js"><link rel="prefetch" href="/docs/assets/js/295.fdcf3da4.js"><link rel="prefetch" href="/docs/assets/js/296.3e72bd72.js"><link rel="prefetch" href="/docs/assets/js/297.73a63c2e.js"><link rel="prefetch" href="/docs/assets/js/298.ddded5e7.js"><link rel="prefetch" href="/docs/assets/js/299.0a232d2d.js"><link rel="prefetch" href="/docs/assets/js/3.92cd7dc5.js"><link rel="prefetch" href="/docs/assets/js/30.8cfef6f2.js"><link rel="prefetch" href="/docs/assets/js/300.b57f7b7a.js"><link rel="prefetch" href="/docs/assets/js/301.9c733755.js"><link rel="prefetch" href="/docs/assets/js/302.9298ee48.js"><link rel="prefetch" href="/docs/assets/js/303.5d0a72f5.js"><link rel="prefetch" href="/docs/assets/js/304.72de365a.js"><link rel="prefetch" href="/docs/assets/js/305.bcd3028e.js"><link rel="prefetch" href="/docs/assets/js/306.57bf06c4.js"><link rel="prefetch" href="/docs/assets/js/307.6daa1741.js"><link rel="prefetch" href="/docs/assets/js/308.20017fc1.js"><link rel="prefetch" href="/docs/assets/js/309.3de02318.js"><link rel="prefetch" href="/docs/assets/js/31.e0497e17.js"><link rel="prefetch" href="/docs/assets/js/310.6cd5c12b.js"><link rel="prefetch" href="/docs/assets/js/311.6091a077.js"><link rel="prefetch" href="/docs/assets/js/312.00650623.js"><link rel="prefetch" href="/docs/assets/js/313.e366c3f3.js"><link rel="prefetch" href="/docs/assets/js/314.a123e472.js"><link rel="prefetch" href="/docs/assets/js/315.2209b379.js"><link rel="prefetch" href="/docs/assets/js/316.b7279580.js"><link rel="prefetch" href="/docs/assets/js/317.5f238fa1.js"><link rel="prefetch" href="/docs/assets/js/318.f421b7c7.js"><link rel="prefetch" href="/docs/assets/js/319.e6c79f12.js"><link rel="prefetch" href="/docs/assets/js/32.9505938f.js"><link rel="prefetch" href="/docs/assets/js/320.69026087.js"><link rel="prefetch" href="/docs/assets/js/321.d210e900.js"><link rel="prefetch" href="/docs/assets/js/322.445e187f.js"><link rel="prefetch" href="/docs/assets/js/323.d89fe500.js"><link rel="prefetch" href="/docs/assets/js/324.95675577.js"><link rel="prefetch" href="/docs/assets/js/325.55022001.js"><link rel="prefetch" href="/docs/assets/js/326.b9bbdf0a.js"><link rel="prefetch" href="/docs/assets/js/327.ca13cacf.js"><link rel="prefetch" href="/docs/assets/js/328.a26e3d2d.js"><link rel="prefetch" href="/docs/assets/js/329.442d1bc4.js"><link rel="prefetch" href="/docs/assets/js/33.0814aba0.js"><link rel="prefetch" href="/docs/assets/js/330.3edc4ce9.js"><link rel="prefetch" href="/docs/assets/js/331.5f9873cb.js"><link rel="prefetch" href="/docs/assets/js/332.c545ec60.js"><link rel="prefetch" href="/docs/assets/js/333.cee0ed0e.js"><link rel="prefetch" href="/docs/assets/js/334.1d41d54d.js"><link rel="prefetch" href="/docs/assets/js/335.30c765fb.js"><link rel="prefetch" href="/docs/assets/js/336.ec4a2a93.js"><link rel="prefetch" href="/docs/assets/js/337.3e7fe1c2.js"><link rel="prefetch" href="/docs/assets/js/338.1bcd25d1.js"><link rel="prefetch" href="/docs/assets/js/339.6dea15ab.js"><link rel="prefetch" href="/docs/assets/js/34.6443a99d.js"><link rel="prefetch" href="/docs/assets/js/340.2c40997d.js"><link rel="prefetch" href="/docs/assets/js/341.ab57a35d.js"><link rel="prefetch" href="/docs/assets/js/342.98a52991.js"><link rel="prefetch" href="/docs/assets/js/343.5b53d2b6.js"><link rel="prefetch" href="/docs/assets/js/344.9371fb5c.js"><link rel="prefetch" href="/docs/assets/js/345.9a8d8598.js"><link rel="prefetch" href="/docs/assets/js/346.eddaff9c.js"><link rel="prefetch" href="/docs/assets/js/347.8a3cf057.js"><link rel="prefetch" href="/docs/assets/js/348.c84f5dd0.js"><link rel="prefetch" href="/docs/assets/js/349.35fa8a22.js"><link rel="prefetch" href="/docs/assets/js/35.c8556e22.js"><link rel="prefetch" href="/docs/assets/js/36.61195c58.js"><link rel="prefetch" href="/docs/assets/js/37.0d45ea01.js"><link rel="prefetch" href="/docs/assets/js/38.38bdcade.js"><link rel="prefetch" href="/docs/assets/js/39.925af8d0.js"><link rel="prefetch" href="/docs/assets/js/4.3504f0f8.js"><link rel="prefetch" href="/docs/assets/js/40.3af3fc6e.js"><link rel="prefetch" href="/docs/assets/js/41.cdea6c63.js"><link rel="prefetch" href="/docs/assets/js/42.60b8cfa2.js"><link rel="prefetch" href="/docs/assets/js/43.da1dd629.js"><link rel="prefetch" href="/docs/assets/js/44.c849b66e.js"><link rel="prefetch" href="/docs/assets/js/45.433ad275.js"><link rel="prefetch" href="/docs/assets/js/46.92b1f70a.js"><link rel="prefetch" href="/docs/assets/js/47.3af9e1f3.js"><link rel="prefetch" href="/docs/assets/js/48.997bbc96.js"><link rel="prefetch" href="/docs/assets/js/49.0daadd89.js"><link rel="prefetch" href="/docs/assets/js/5.13d03ba2.js"><link rel="prefetch" href="/docs/assets/js/50.44eda61d.js"><link rel="prefetch" href="/docs/assets/js/51.607c4f4c.js"><link rel="prefetch" href="/docs/assets/js/52.e4d41961.js"><link rel="prefetch" href="/docs/assets/js/53.4bea1c1d.js"><link rel="prefetch" href="/docs/assets/js/54.7d2f0df8.js"><link rel="prefetch" href="/docs/assets/js/55.18290a6e.js"><link rel="prefetch" href="/docs/assets/js/56.64b22fa0.js"><link rel="prefetch" href="/docs/assets/js/57.73d473ab.js"><link rel="prefetch" href="/docs/assets/js/58.d83e0b8c.js"><link rel="prefetch" href="/docs/assets/js/59.8838744d.js"><link rel="prefetch" href="/docs/assets/js/6.f2cec5bc.js"><link rel="prefetch" href="/docs/assets/js/60.c2e4e4bd.js"><link rel="prefetch" href="/docs/assets/js/61.5d179331.js"><link rel="prefetch" href="/docs/assets/js/62.d9245d7d.js"><link rel="prefetch" href="/docs/assets/js/63.5f56d4df.js"><link rel="prefetch" href="/docs/assets/js/64.d8a046be.js"><link rel="prefetch" href="/docs/assets/js/65.d46d4429.js"><link rel="prefetch" href="/docs/assets/js/66.9c03315d.js"><link rel="prefetch" href="/docs/assets/js/67.aff12540.js"><link rel="prefetch" href="/docs/assets/js/68.b8076318.js"><link rel="prefetch" href="/docs/assets/js/69.e5a74f3a.js"><link rel="prefetch" href="/docs/assets/js/7.166309ba.js"><link rel="prefetch" href="/docs/assets/js/70.ef9cf664.js"><link rel="prefetch" href="/docs/assets/js/71.7ddcf23b.js"><link rel="prefetch" href="/docs/assets/js/72.9196e6de.js"><link rel="prefetch" href="/docs/assets/js/73.64a3adde.js"><link rel="prefetch" href="/docs/assets/js/74.4cefa041.js"><link rel="prefetch" href="/docs/assets/js/75.cf06ccaa.js"><link rel="prefetch" href="/docs/assets/js/76.ef05c0e1.js"><link rel="prefetch" href="/docs/assets/js/77.c9b7b08f.js"><link rel="prefetch" href="/docs/assets/js/78.33462563.js"><link rel="prefetch" href="/docs/assets/js/79.7f145459.js"><link rel="prefetch" href="/docs/assets/js/8.981df812.js"><link rel="prefetch" href="/docs/assets/js/80.6b39121a.js"><link rel="prefetch" href="/docs/assets/js/81.d9661906.js"><link rel="prefetch" href="/docs/assets/js/82.68d2358d.js"><link rel="prefetch" href="/docs/assets/js/83.83569bfc.js"><link rel="prefetch" href="/docs/assets/js/84.6217d48d.js"><link rel="prefetch" href="/docs/assets/js/85.b7e99308.js"><link rel="prefetch" href="/docs/assets/js/86.f308da1b.js"><link rel="prefetch" href="/docs/assets/js/87.84a0eb05.js"><link rel="prefetch" href="/docs/assets/js/88.34c0ff40.js"><link rel="prefetch" href="/docs/assets/js/89.b68b605f.js"><link rel="prefetch" href="/docs/assets/js/9.e6eb567e.js"><link rel="prefetch" href="/docs/assets/js/90.074bcbcb.js"><link rel="prefetch" href="/docs/assets/js/91.456a2ebe.js"><link rel="prefetch" href="/docs/assets/js/92.67ddc76c.js"><link rel="prefetch" href="/docs/assets/js/93.1a41f1e2.js"><link rel="prefetch" href="/docs/assets/js/94.7a5d7b40.js"><link rel="prefetch" href="/docs/assets/js/95.c002ced0.js"><link rel="prefetch" href="/docs/assets/js/96.025bbcc3.js"><link rel="prefetch" href="/docs/assets/js/97.20814bac.js"><link rel="prefetch" href="/docs/assets/js/98.9ea75561.js"><link rel="prefetch" href="/docs/assets/js/99.08af2fe6.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.de900540.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Clean Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/cleancode/c1.html" class="sidebar-link">1. Clean Code</a></li><li><a href="/docs/kungfu/cleancode/c2.html" class="sidebar-link">2. Meaningful Names</a></li><li><a href="/docs/kungfu/cleancode/c3.html" class="sidebar-link">3. Functions</a></li><li><a href="/docs/kungfu/cleancode/c4.html" class="sidebar-link">4. Comments</a></li><li><a href="/docs/kungfu/cleancode/c5.html" class="sidebar-link">5. Formatting</a></li><li><a href="/docs/kungfu/cleancode/c6.html" class="sidebar-link">6. Objects and Data Structures</a></li><li><a href="/docs/kungfu/cleancode/c7.html" aria-current="page" class="active sidebar-link">7. Error Handling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#use-exceptions-rather-than-return-codes" class="sidebar-link">Use Exceptions Rather Than Return Codes ...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#write-your-try-catch-finally-statement-first" class="sidebar-link">Write Your Try-Catch-Finally Statement First ...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#use-unchecked-exceptions" class="sidebar-link">Use Unchecked Exceptions ...</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#provide-context-with-exceptions" class="sidebar-link">Provide Context with Exceptions .</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#define-exception-classes-in-terms-of-a-caller-s-needs" class="sidebar-link">Define Exception Classes in Terms of a Caller’s Needs ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#define-the-normal-flow" class="sidebar-link">Define the Normal Flow</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#don-t-return-null" class="sidebar-link">Don’t Return Null ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#don-t-pass-null" class="sidebar-link">Don’t Pass Null ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#conclusion" class="sidebar-link">Conclusion ..</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/cleancode/c7.html#bibliography" class="sidebar-link">Bibliography ...</a></li></ul></li><li><a href="/docs/kungfu/cleancode/c8.html" class="sidebar-link">8. Boundaries</a></li><li><a href="/docs/kungfu/cleancode/c9.html" class="sidebar-link">9. Unit Tests</a></li><li><a href="/docs/kungfu/cleancode/c10.html" class="sidebar-link">10. Classes</a></li><li><a href="/docs/kungfu/cleancode/c11.html" class="sidebar-link">11. Systems</a></li><li><a href="/docs/kungfu/cleancode/c12.html" class="sidebar-link">12. Emergence</a></li><li><a href="/docs/kungfu/cleancode/c13.html" class="sidebar-link">13. Concurrency</a></li><li><a href="/docs/kungfu/cleancode/c14.html" class="sidebar-link">14. Successive Refinement</a></li><li><a href="/docs/kungfu/cleancode/c15.html" class="sidebar-link">15. JUnit Internals</a></li><li><a href="/docs/kungfu/cleancode/c16.html" class="sidebar-link">16. Refactoring SerialDate</a></li><li><a href="/docs/kungfu/cleancode/c17.html" class="sidebar-link">17. Smells and Heuristics</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_7-error-handling"><a href="#_7-error-handling" class="header-anchor">#</a> 7. Error Handling</h1> <p>It might seem odd to have a section about error handling in a book about clean code. Error
handling is just one of those things that we all have to do when we program. Input can be
abnormal and devices can fail. In short, things can go wrong, and when they do, we as pro-
grammers are responsible for making sure that our code does what it needs to do.</p> <p>The connection to clean code, however, should be clear. Many code bases are com-
pletely dominated by error handling. When I say dominated, I don’t mean that error han-
dling is all that they do. I mean that it is nearly impossible to see what the code does
because of all of the scattered error handling. Error handling is important, <em>but if it
obscures logic, it’s wrong</em>.</p> <p>In this chapter I’ll outline a number of techniques and considerations that you can use
to write code that is both clean and robust—code that handles errors with grace and style.</p> <p>104 <strong>Chapter 7: Error Handling</strong></p> <h2 id="use-exceptions-rather-than-return-codes"><a href="#use-exceptions-rather-than-return-codes" class="header-anchor">#</a> Use Exceptions Rather Than Return Codes ...</h2> <p>Back in the distant past there were many languages that didn’t have exceptions. In those
languages the techniques for handling and reporting errors were limited. You either set an
error flag or returned an error code that the caller could check. The code in Listing 7-1
illustrates these approaches.</p> <p>The problem with these approaches is that they clutter the caller. The caller must
check for errors immediately after the call. Unfortunately, it’s easy to forget. For this rea-
son it is better to throw an exception when you encounter an error. The calling code is
cleaner. Its logic is not obscured by error handling.</p> <p>Listing 7-2 shows the code after we’ve chosen to throw exceptions in methods that
can detect errors.</p> <div class="language- extra-class"><pre class="language-text"><code>Listing 7-1
DeviceController.java
public class DeviceController {
...
public void sendShutDown() {
DeviceHandle handle = getHandle(DEV1);
// Check the state of the device
if (handle != DeviceHandle.INVALID) {
// Save the device status to the record field
retrieveDeviceRecord(handle);
// If not suspended, shut down
if (record.getStatus() != DEVICE_SUSPENDED) {
pauseDevice(handle);
clearDeviceWorkQueue(handle);
closeDevice(handle);
} else {
logger.log(&quot;Device suspended. Unable to shut down&quot;);
}
} else {
logger.log(&quot;Invalid handle for: &quot; + DEV1.toString());
}
}
...
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 7-2
DeviceController.java (with exceptions)
public class DeviceController {
...
public void sendShutDown() {
try {
tryToShutDown();
} catch (DeviceShutDownError e) {
logger.log(e);
}
}
</code></pre></div><p><strong>Write Your Try-Catch-Finally Statement First</strong> 105</p> <p>Notice how much cleaner it is. This isn’t just a matter of aesthetics. The code is better
because two concerns that were tangled, the algorithm for device shutdown and error han-
dling, are now separated. You can look at each of those concerns and understand them
independently.</p> <h2 id="write-your-try-catch-finally-statement-first"><a href="#write-your-try-catch-finally-statement-first" class="header-anchor">#</a> Write Your Try-Catch-Finally Statement First ...</h2> <p>One of the most interesting things about exceptions is that they <em>define a scope</em> within your
program. When you execute code in the tryportion of a try-catch-finallystatement, you
are stating that execution can abort at any point and then resume at the catch.</p> <p>In a way, tryblocks are like transactions. Your catchhas to leave your program in a
consistent state, no matter what happens in the try. For this reason it is good practice to
start with a try-catch-finallystatement when you are writing code that could throw
exceptions. This helps you define what the user of that code should expect, no matter what
goes wrong with the code that is executed in the try.</p> <p>Let’s look at an example. We need to write some code that accesses a file and reads
some serialized objects.</p> <div class="language- extra-class"><pre class="language-text"><code>We start with a unit test that shows that we’ll get an exception when the file doesn’t exist:
@Test(expected = StorageException.class)
public void retrieveSectionShouldThrowOnInvalidFileName() {
sectionStore.retrieveSection(&quot;invalid - file&quot;);
}
The test drives us to create this stub:
public List&lt;RecordedGrip&gt; retrieveSection(String sectionName) {
// dummy return until we have a real implementation
return new ArrayList&lt;RecordedGrip&gt;();
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>private void tryToShutDown() throws DeviceShutDownError {
DeviceHandle handle = getHandle(DEV1);
DeviceRecord record = retrieveDeviceRecord(handle);
pauseDevice(handle);
clearDeviceWorkQueue(handle);
closeDevice(handle);
}
private DeviceHandle getHandle(DeviceID id) {
...
throw new DeviceShutDownError(&quot;Invalid handle for: &quot; + id.toString());
...
}
...
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Listing 7-2 (continued)
DeviceController.java (with exceptions)
</code></pre></div><p>106 <strong>Chapter 7: Error Handling</strong></p> <p>Our test fails because it doesn’t throw an exception. Next, we change our implementa-
tion so that it attempts to access an invalid file. This operation throws an exception:</p> <p>public List<RecordedGrip> retrieveSection(String sectionName) {
try {
FileInputStream stream = new FileInputStream(sectionName)
} catch (Exception e) {
throw new StorageException(&quot;retrieval error&quot;, e);
}
return new ArrayList<RecordedGrip>();
}
Our test passes now because we’ve caught the exception. At this point, we can refac-
tor. We can narrow the type of the exception we catch to match the type that is actually
thrown from the FileInputStream constructor: FileNotFoundException:</RecordedGrip></RecordedGrip></p> <p>public List<RecordedGrip> retrieveSection(String sectionName) {
try {
FileInputStream stream = new FileInputStream(sectionName);
stream.close();
} catch (FileNotFoundException e) {
throw new StorageException(&quot;retrieval error”, e);
}
return new ArrayList<RecordedGrip>();
}
Now that we’ve defined the scope with a try-catchstructure, we can use TDD to build
up the rest of the logic that we need. That logic will be added between the creation of the
FileInputStream and the close, and can pretend that nothing goes wrong.</RecordedGrip></RecordedGrip></p> <p>Try to write tests that force exceptions, and then add behavior to your handler to sat-
isfy your tests. This will cause you to build the transaction scope of the tryblock first and
will help you maintain the transaction nature of that scope.</p> <h2 id="use-unchecked-exceptions"><a href="#use-unchecked-exceptions" class="header-anchor">#</a> Use Unchecked Exceptions ...</h2> <p>The debate is over. For years Java programmers have debated over the benefits and liabili-
ties of checked exceptions. When checked exceptions were introduced in the first version
of Java, they seemed like a great idea. The signature of every method would list all of the
exceptions that it could pass to its caller. Moreover, these exceptions were part of the type
of the method. Your code literally wouldn’t compile if the signature didn’t match what your
code could do.</p> <p>At the time, we thought that checked exceptions were a great idea; and yes, they can
yield <em>some</em> benefit. However, it is clear now that they aren’t necessary for the production of
robust software. C# doesn’t have checked exceptions, and despite valiant attempts, C++
doesn’t either. Neither do Python or Ruby. Yet it is possible to write robust software in all
of these languages. Because that is the case, we have to decide—really—whether checked
exceptions are worth their price.</p> <p><strong>Define Exception Classes in Terms of a Caller’s Needs</strong> 107</p> <p>What price? The price of checked exceptions is an Open/Closed Principle^1 violation.
If you throw a checked exception from a method in your code and the catch is three levels
above, <em>you must declare that exception in the signature of each method between you and
thecatch</em>. This means that a change at a low level of the software can force signature
changes on many higher levels. The changed modules must be rebuilt and redeployed,
even though nothing they care about changed.</p> <p>Consider the calling hierarchy of a large system. Functions at the top call functions
below them, which call more functions below them, ad infinitum. Now let’s say one of the
lowest level functions is modified in such a way that it must throw an exception. If that
exception is checked, then the function signature must add a throwsclause. But this
means that every function that calls our modified function must also be modified either to
catch the new exception or to append the appropriate throwsclause to its signature. Ad
infinitum. The net result is a cascade of changes that work their way from the lowest levels
of the software to the highest! Encapsulation is broken because all functions in the path
of a throw must know about details of that low-level exception. Given that the purpose of
exceptions is to allow you to handle errors at a distance, it is a shame that checked excep-
tions break encapsulation in this way.</p> <p>Checked exceptions can sometimes be useful if you are writing a critical library: You
must catch them. But in general application development the dependency costs outweigh
the benefits.</p> <h2 id="provide-context-with-exceptions"><a href="#provide-context-with-exceptions" class="header-anchor">#</a> Provide Context with Exceptions .</h2> <p>Each exception that you throw should provide enough context to determine the source and
location of an error. In Java, you can get a stack trace from any exception; however, a stack
trace can’t tell you the intent of the operation that failed.</p> <p>Create informative error messages and pass them along with your exceptions. Men-
tion the operation that failed and the type of failure. If you are logging in your application,
pass along enough information to be able to log the error in your catch.</p> <h2 id="define-exception-classes-in-terms-of-a-caller-s-needs"><a href="#define-exception-classes-in-terms-of-a-caller-s-needs" class="header-anchor">#</a> Define Exception Classes in Terms of a Caller’s Needs ..</h2> <p>There are many ways to classify errors. We can classify them by their source: Did they
come from one component or another? Or their type: Are they device failures, network
failures, or programming errors? However, when we define exception classes in an appli-
cation, our most important concern should be <em>how they are caught</em>.</p> <ol><li>[Martin].</li></ol> <p>108 <strong>Chapter 7: Error Handling</strong></p> <p>Let’s look at an example of poor exception classification. Here is a try-catch-finally
statement for a third-party library call. It covers all of the exceptions that the calls can
throw:</p> <p>ACMEPort port = new ACMEPort(12);
try {
port.open();
} catch (DeviceResponseException e) {
reportPortError(e);
logger.log(&quot;Device response exception&quot;, e);
} catch (ATM1212UnlockedException e) {
reportPortError(e);
logger.log(&quot;Unlock exception&quot;, e);
} catch (GMXError e) {
reportPortError(e);
logger.log(&quot;Device response exception&quot;);
} finally {
...
}
That statement contains a lot of duplication, and we shouldn’t be surprised. In most
exception handling situations, the work that we do is relatively standard regardless of the
actual cause. We have to record an error and make sure that we can proceed.</p> <p>In this case, because we know that the work that we are doing is roughly the same
regardless of the exception, we can simplify our code considerably by wrapping the API
that we are calling and making sure that it returns a common exception type:</p> <p>LocalPort port = new LocalPort(12);
try {
port.open();
} catch (PortDeviceFailure e) {
reportError(e);
logger.log(e.getMessage(), e);
} finally {
...
}
OurLocalPortclass is just a simple wrapper that catches and translates exceptions
thrown by the ACMEPort class:</p> <div class="language- extra-class"><pre class="language-text"><code>public class LocalPort {
private ACMEPort innerPort;
public LocalPort(int portNumber) {
innerPort = new ACMEPort(portNumber);
}
public void open() {
try {
innerPort.open();
} catch (DeviceResponseException e) {
throw new PortDeviceFailure(e);
} catch (ATM1212UnlockedException e) {
throw new PortDeviceFailure(e);
} catch (GMXError e) {
</code></pre></div><p><strong>Define the Normal Flow</strong> 109</p> <p>throw new PortDeviceFailure(e);
}
}
}
Wrappers like the one we defined for ACMEPortcan be very useful. In fact, wrapping
third-party APIs is a best practice. When you wrap a third-party API, you minimize your
dependencies upon it: You can choose to move to a different library in the future without
much penalty. Wrapping also makes it easier to mock out third-party calls when you are
testing your own code.</p> <p>One final advantage of wrapping is that you aren’t tied to a particular vendor’s API
design choices. You can define an API that you feel comfortable with. In the preceding
example, we defined a single exception type for portdevice failure and found that we
could write much cleaner code.</p> <p>Often a single exception class is fine for a particular area of code. The information
sent with the exception can distinguish the errors. Use different classes only if there are
times when you want to catch one exception and allow the other one to pass through.</p> <h2 id="define-the-normal-flow"><a href="#define-the-normal-flow" class="header-anchor">#</a> Define the Normal Flow</h2> <p>If you follow the advice in the preceding
sections, you’ll end up with a good amount
of separation between your business logic
and your error handling. The bulk of your
code will start to look like a clean
unadorned algorithm. However, the pro-
cess of doing this pushes error detection
to the edges of your program. You wrap
external APIs so that you can throw your
own exceptions, and you define a handler above your code so that you can deal with any
aborted computation. Most of the time this is a great approach, but there are some times
when you may not want to abort.</p> <p>Let’s take a look at an example. Here is some awkward code that sums expenses in a
billing application:</p> <p>try {
MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());
m_total += expenses.getTotal();
} catch(MealExpensesNotFound e) {
m_total += getMealPerDiem();
}
In this business, if meals are expensed, they become part of the total. If they aren’t, the
employee gets a meal <em>per diem</em> amount for that day. The exception clutters the logic.
Wouldn’t it be better if we didn’t have to deal with the special case? If we didn’t, our code
would look much simpler. It would look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());
m_total += expenses.getTotal();
</code></pre></div><p>110 <strong>Chapter 7: Error Handling</strong></p> <p>Can we make the code that simple? It turns out that we can. We can change the
ExpenseReportDAOso that it always returns a MealExpenseobject. If there are no meal
expenses, it returns a MealExpense object that returns the <em>per diem</em> as its total:</p> <div class="language- extra-class"><pre class="language-text"><code>public class PerDiemMealExpenses implements MealExpenses {
public int getTotal() {
// return the per diem default
}
}
</code></pre></div><p>This is called the SPECIAL CASE PATTERN[Fowler]. You create a class or configure an
object so that it handles a special case for you. When you do, the client code doesn’t have
to deal with exceptional behavior. That behavior is encapsulated in the special case object.</p> <h2 id="don-t-return-null"><a href="#don-t-return-null" class="header-anchor">#</a> Don’t Return Null ..</h2> <p>I think that any discussion about error handling should include mention of the things we
do that invite errors. The first on the list is returning null. I can’t begin to count the number
of applications I’ve seen in which nearly every other line was a check for null. Here is
some example code:</p> <div class="language- extra-class"><pre class="language-text"><code>public void registerItem(Item item) {
if (item != null) {
ItemRegistry registry = peristentStore.getItemRegistry();
if (registry != null) {
Item existing = registry.getItem(item.getID());
if (existing.getBillingPeriod().hasRetailOwner()) {
existing.register(item);
}
}
}
}
</code></pre></div><p>If you work in a code base with code like this, it might not look all that bad to you, but it is
bad! When we return null, we are essentially creating work for ourselves and foisting
problems upon our callers. All it takes is one missing nullcheck to send an application
spinning out of control.</p> <p>Did you notice the fact that there wasn’t a null check in the second line of that nested
ifstatement? What would have happened at runtime if persistentStorewerenull? We
would have had a NullPointerExceptionat runtime, and either someone is catching
NullPointerExceptionat the top level or they are not. Either way it’s <em>bad</em>. What exactly
should you do in response to a NullPointerExceptionthrown from the depths of your appli-
cation?</p> <p>It’s easy to say that the problem with the code above is that it is missing a nullcheck,
but in actuality, the problem is that it has <em>too many</em>. If you are tempted to return nullfrom
a method, consider throwing an exception or returning a SPECIAL CASEobject instead. If
you are calling a null-returning method from a third-party API, consider wrapping that
method with a method that either throws an exception or returns a special case object.</p> <p><strong>Don’t Pass Null</strong> 111</p> <p>In many cases, special case objects are an easy remedy. Imagine that you have code
like this:</p> <div class="language- extra-class"><pre class="language-text"><code>List&lt;Employee&gt; employees = getEmployees();
if (employees != null) {
for(Employee e : employees) {
totalPay += e.getPay();
}
}
</code></pre></div><p>Right now, getEmployeescan return null, but does it have to? If we change getEmployeeso
that it returns an empty list, we can clean up the code:</p> <div class="language- extra-class"><pre class="language-text"><code>List&lt;Employee&gt; employees = getEmployees();
for(Employee e : employees) {
totalPay += e.getPay();
}
</code></pre></div><p>Fortunately, Java has Collections.emptyList(), and it returns a predefined immutable list
that we can use for this purpose:</p> <div class="language- extra-class"><pre class="language-text"><code>public List&lt;Employee&gt; getEmployees() {
if( .. there are no employees .. )
return Collections.emptyList();
}
</code></pre></div><p>If you code this way, you will minimize the chance of NullPointerExceptionsand your
code will be cleaner.</p> <h2 id="don-t-pass-null"><a href="#don-t-pass-null" class="header-anchor">#</a> Don’t Pass Null ..</h2> <p>Returning nullfrom methods is bad, but passing nullinto methods is worse. Unless you
are working with an API which expects you to pass null, you should avoid passing null in
your code whenever possible.</p> <p>Let’s look at an example to see why. Here is a simple method which calculates a met-
ric for two points:</p> <div class="language- extra-class"><pre class="language-text"><code>public class MetricsCalculator
{
public double xProjection(Point p1, Point p2) {
return (p2.x – p1.x) * 1.5;
}
...
}
What happens when someone passes null as an argument?
calculator.xProjection(null, new Point(12, 13));
We’ll get a NullPointerException, of course.
How can we fix it? We could create a new exception type and throw it:
public class MetricsCalculator
{
</code></pre></div><p>112 <strong>Chapter 7: Error Handling</strong></p> <div class="language- extra-class"><pre class="language-text"><code>public double xProjection(Point p1, Point p2) {
if (p1 == null || p2 == null) {
throw InvalidArgumentException(
&quot;Invalid argument for MetricsCalculator.xProjection&quot;);
}
return (p2.x – p1.x) * 1.5;
}
}
</code></pre></div><p>Is this better? It might be a little better than a nullpointer exception, but remember, we
have to define a handler for InvalidArgumentException. What should the handler do? Is
there any good course of action?</p> <div class="language- extra-class"><pre class="language-text"><code>There is another alternative. We could use a set of assertions:
public class MetricsCalculator
{
public double xProjection(Point p1, Point p2) {
assert p1 != null : &quot;p1 should not be null&quot;;
assert p2 != null : &quot;p2 should not be null&quot;;
return (p2.x – p1.x) * 1.5;
}
}
</code></pre></div><p>It’s good documentation, but it doesn’t solve the problem. If someone passes null, we’ll
still have a runtime error.</p> <p>In most programming languages there is no good way to deal with a nullthat is
passed by a caller accidentally. Because this is the case, the rational approach is to forbid
passingnullby default. When you do, you can code with the knowledge that a nullin an
argument list is an indication of a problem, and end up with far fewer careless mistakes.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion ..</h2> <p>Clean code is readable, but it must also be robust. These are not conflicting goals. We can
write robust clean code if we see error handling as a separate concern, something that is
viewable independently of our main logic. To the degree that we are able to do that, we can
reason about it independently, and we can make great strides in the maintainability of our
code.</p> <h2 id="bibliography"><a href="#bibliography" class="header-anchor">#</a> Bibliography ...</h2> <p><strong>[Martin]:</strong> <em>Agile Software Development: Principles, Patterns, and Practices,</em> Robert C.
Martin, Prentice Hall, 2002.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/cleancode/c6.html" class="prev">
        6. Objects and Data Structures
      </a></span> <span class="next"><a href="/docs/kungfu/cleancode/c8.html">
        8. Boundaries
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.e6f4376b.js" defer></script><script src="/docs/assets/js/2.c567e596.js" defer></script><script src="/docs/assets/js/251.80b6e869.js" defer></script><script src="/docs/assets/js/27.2fe5f85e.js" defer></script>
  </body>
</html>
