<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Design Instagram | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.416feb4e.css" as="style"><link rel="preload" href="/docs/assets/js/app.07ce28f7.js" as="script"><link rel="preload" href="/docs/assets/js/2.7043f65e.js" as="script"><link rel="preload" href="/docs/assets/js/19.1a9741f5.js" as="script"><link rel="preload" href="/docs/assets/js/62.f6b7c9d0.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.6a167f79.js"><link rel="prefetch" href="/docs/assets/js/100.8693f618.js"><link rel="prefetch" href="/docs/assets/js/101.35392573.js"><link rel="prefetch" href="/docs/assets/js/102.6c83e53c.js"><link rel="prefetch" href="/docs/assets/js/103.bcd0559b.js"><link rel="prefetch" href="/docs/assets/js/104.26b0d2e0.js"><link rel="prefetch" href="/docs/assets/js/105.e63ca99c.js"><link rel="prefetch" href="/docs/assets/js/106.219aac84.js"><link rel="prefetch" href="/docs/assets/js/107.04f4241a.js"><link rel="prefetch" href="/docs/assets/js/108.d945406e.js"><link rel="prefetch" href="/docs/assets/js/109.2350b0f2.js"><link rel="prefetch" href="/docs/assets/js/11.3db7cb23.js"><link rel="prefetch" href="/docs/assets/js/110.10f9936c.js"><link rel="prefetch" href="/docs/assets/js/111.88b8aaec.js"><link rel="prefetch" href="/docs/assets/js/112.51887f63.js"><link rel="prefetch" href="/docs/assets/js/113.84991831.js"><link rel="prefetch" href="/docs/assets/js/114.a911a763.js"><link rel="prefetch" href="/docs/assets/js/115.d10b14ba.js"><link rel="prefetch" href="/docs/assets/js/116.ce9b1847.js"><link rel="prefetch" href="/docs/assets/js/117.71b75386.js"><link rel="prefetch" href="/docs/assets/js/118.5aa6cf38.js"><link rel="prefetch" href="/docs/assets/js/119.05b25762.js"><link rel="prefetch" href="/docs/assets/js/12.8ca5c6ed.js"><link rel="prefetch" href="/docs/assets/js/120.4d8fe299.js"><link rel="prefetch" href="/docs/assets/js/121.5791fba9.js"><link rel="prefetch" href="/docs/assets/js/122.125fa051.js"><link rel="prefetch" href="/docs/assets/js/123.651bda93.js"><link rel="prefetch" href="/docs/assets/js/124.1d195a16.js"><link rel="prefetch" href="/docs/assets/js/125.e039c9fe.js"><link rel="prefetch" href="/docs/assets/js/126.73d8870d.js"><link rel="prefetch" href="/docs/assets/js/127.ab404e81.js"><link rel="prefetch" href="/docs/assets/js/128.c67e1edc.js"><link rel="prefetch" href="/docs/assets/js/129.2c811f17.js"><link rel="prefetch" href="/docs/assets/js/13.19ccd11d.js"><link rel="prefetch" href="/docs/assets/js/130.47aba3e4.js"><link rel="prefetch" href="/docs/assets/js/131.e456c9bd.js"><link rel="prefetch" href="/docs/assets/js/132.710f589c.js"><link rel="prefetch" href="/docs/assets/js/133.d3b980ab.js"><link rel="prefetch" href="/docs/assets/js/134.03046422.js"><link rel="prefetch" href="/docs/assets/js/135.fabc3d9d.js"><link rel="prefetch" href="/docs/assets/js/136.7874bde7.js"><link rel="prefetch" href="/docs/assets/js/137.a9531c72.js"><link rel="prefetch" href="/docs/assets/js/138.d91571bf.js"><link rel="prefetch" href="/docs/assets/js/139.47f74986.js"><link rel="prefetch" href="/docs/assets/js/14.57909cb3.js"><link rel="prefetch" href="/docs/assets/js/140.6a482c12.js"><link rel="prefetch" href="/docs/assets/js/141.d421f88b.js"><link rel="prefetch" href="/docs/assets/js/142.5697f219.js"><link rel="prefetch" href="/docs/assets/js/143.ea8170e6.js"><link rel="prefetch" href="/docs/assets/js/144.b0ecebef.js"><link rel="prefetch" href="/docs/assets/js/145.b365de15.js"><link rel="prefetch" href="/docs/assets/js/146.3d9708c5.js"><link rel="prefetch" href="/docs/assets/js/147.b25ca6d5.js"><link rel="prefetch" href="/docs/assets/js/148.5d52f5cb.js"><link rel="prefetch" href="/docs/assets/js/149.b4e663ab.js"><link rel="prefetch" href="/docs/assets/js/15.c58aea51.js"><link rel="prefetch" href="/docs/assets/js/150.38524a75.js"><link rel="prefetch" href="/docs/assets/js/151.3c2c5102.js"><link rel="prefetch" href="/docs/assets/js/152.6e27a1b3.js"><link rel="prefetch" href="/docs/assets/js/153.8fce2295.js"><link rel="prefetch" href="/docs/assets/js/154.94c675a2.js"><link rel="prefetch" href="/docs/assets/js/155.6c8d5344.js"><link rel="prefetch" href="/docs/assets/js/156.1181db79.js"><link rel="prefetch" href="/docs/assets/js/157.bf450ed6.js"><link rel="prefetch" href="/docs/assets/js/158.11890968.js"><link rel="prefetch" href="/docs/assets/js/159.b81be76d.js"><link rel="prefetch" href="/docs/assets/js/16.059cf3f3.js"><link rel="prefetch" href="/docs/assets/js/160.a6728dd8.js"><link rel="prefetch" href="/docs/assets/js/161.b1ddf72c.js"><link rel="prefetch" href="/docs/assets/js/162.20bd4d78.js"><link rel="prefetch" href="/docs/assets/js/163.f8e98454.js"><link rel="prefetch" href="/docs/assets/js/164.77b4d344.js"><link rel="prefetch" href="/docs/assets/js/165.40ada88f.js"><link rel="prefetch" href="/docs/assets/js/166.4ee31628.js"><link rel="prefetch" href="/docs/assets/js/167.bdb6aff3.js"><link rel="prefetch" href="/docs/assets/js/168.53b4defc.js"><link rel="prefetch" href="/docs/assets/js/169.7fb64d0b.js"><link rel="prefetch" href="/docs/assets/js/17.f5a5794f.js"><link rel="prefetch" href="/docs/assets/js/170.74e40aac.js"><link rel="prefetch" href="/docs/assets/js/171.c5621b42.js"><link rel="prefetch" href="/docs/assets/js/172.660587fd.js"><link rel="prefetch" href="/docs/assets/js/173.ee149e42.js"><link rel="prefetch" href="/docs/assets/js/174.1217dafb.js"><link rel="prefetch" href="/docs/assets/js/175.1bd0f874.js"><link rel="prefetch" href="/docs/assets/js/176.b7e44d6c.js"><link rel="prefetch" href="/docs/assets/js/177.11950f97.js"><link rel="prefetch" href="/docs/assets/js/178.ca4e0dac.js"><link rel="prefetch" href="/docs/assets/js/179.2a10ece3.js"><link rel="prefetch" href="/docs/assets/js/18.bf3cf187.js"><link rel="prefetch" href="/docs/assets/js/180.cdfde743.js"><link rel="prefetch" href="/docs/assets/js/181.05ca3b1d.js"><link rel="prefetch" href="/docs/assets/js/182.2864b1da.js"><link rel="prefetch" href="/docs/assets/js/183.7783b3e8.js"><link rel="prefetch" href="/docs/assets/js/184.446ae479.js"><link rel="prefetch" href="/docs/assets/js/185.4935248e.js"><link rel="prefetch" href="/docs/assets/js/186.9a191a98.js"><link rel="prefetch" href="/docs/assets/js/187.45767eef.js"><link rel="prefetch" href="/docs/assets/js/188.23e093da.js"><link rel="prefetch" href="/docs/assets/js/189.f5360d23.js"><link rel="prefetch" href="/docs/assets/js/190.41bb9a3c.js"><link rel="prefetch" href="/docs/assets/js/191.0c1fe78d.js"><link rel="prefetch" href="/docs/assets/js/192.da3217b8.js"><link rel="prefetch" href="/docs/assets/js/193.e70b2bbb.js"><link rel="prefetch" href="/docs/assets/js/194.076d8552.js"><link rel="prefetch" href="/docs/assets/js/195.c8abec01.js"><link rel="prefetch" href="/docs/assets/js/196.5557121b.js"><link rel="prefetch" href="/docs/assets/js/197.320c6ff5.js"><link rel="prefetch" href="/docs/assets/js/198.7fab5636.js"><link rel="prefetch" href="/docs/assets/js/199.a96004c7.js"><link rel="prefetch" href="/docs/assets/js/20.7ca5438c.js"><link rel="prefetch" href="/docs/assets/js/200.21aeba0b.js"><link rel="prefetch" href="/docs/assets/js/201.fec424b1.js"><link rel="prefetch" href="/docs/assets/js/202.8cee2a2e.js"><link rel="prefetch" href="/docs/assets/js/203.dda2e56a.js"><link rel="prefetch" href="/docs/assets/js/204.27c198cb.js"><link rel="prefetch" href="/docs/assets/js/205.b49cf646.js"><link rel="prefetch" href="/docs/assets/js/206.d73160f0.js"><link rel="prefetch" href="/docs/assets/js/207.da488add.js"><link rel="prefetch" href="/docs/assets/js/208.2f0762df.js"><link rel="prefetch" href="/docs/assets/js/209.343e7e4c.js"><link rel="prefetch" href="/docs/assets/js/21.cb6e0060.js"><link rel="prefetch" href="/docs/assets/js/210.11a7faf4.js"><link rel="prefetch" href="/docs/assets/js/211.3aa3f335.js"><link rel="prefetch" href="/docs/assets/js/212.64e4dbc3.js"><link rel="prefetch" href="/docs/assets/js/213.c7d33125.js"><link rel="prefetch" href="/docs/assets/js/214.40d465f1.js"><link rel="prefetch" href="/docs/assets/js/215.101d75c9.js"><link rel="prefetch" href="/docs/assets/js/216.53d138ca.js"><link rel="prefetch" href="/docs/assets/js/217.488bd589.js"><link rel="prefetch" href="/docs/assets/js/218.a5c6cebd.js"><link rel="prefetch" href="/docs/assets/js/219.0c4530b2.js"><link rel="prefetch" href="/docs/assets/js/22.68439d4e.js"><link rel="prefetch" href="/docs/assets/js/220.d374c5be.js"><link rel="prefetch" href="/docs/assets/js/221.01e0ec60.js"><link rel="prefetch" href="/docs/assets/js/222.b670d74a.js"><link rel="prefetch" href="/docs/assets/js/223.045509fb.js"><link rel="prefetch" href="/docs/assets/js/224.4d248a3c.js"><link rel="prefetch" href="/docs/assets/js/225.1e1661c5.js"><link rel="prefetch" href="/docs/assets/js/226.8dc7068b.js"><link rel="prefetch" href="/docs/assets/js/227.13baf896.js"><link rel="prefetch" href="/docs/assets/js/228.fecd17a3.js"><link rel="prefetch" href="/docs/assets/js/229.41563852.js"><link rel="prefetch" href="/docs/assets/js/23.e0386d5e.js"><link rel="prefetch" href="/docs/assets/js/230.09e99bc4.js"><link rel="prefetch" href="/docs/assets/js/231.9d58338c.js"><link rel="prefetch" href="/docs/assets/js/232.47b6c0fa.js"><link rel="prefetch" href="/docs/assets/js/233.f6adc69e.js"><link rel="prefetch" href="/docs/assets/js/234.00e11c8e.js"><link rel="prefetch" href="/docs/assets/js/235.042b3468.js"><link rel="prefetch" href="/docs/assets/js/236.80f78afe.js"><link rel="prefetch" href="/docs/assets/js/237.cdffecaf.js"><link rel="prefetch" href="/docs/assets/js/238.2c66f303.js"><link rel="prefetch" href="/docs/assets/js/239.be113196.js"><link rel="prefetch" href="/docs/assets/js/24.91dd9d45.js"><link rel="prefetch" href="/docs/assets/js/240.fa385a32.js"><link rel="prefetch" href="/docs/assets/js/241.94b6d1d4.js"><link rel="prefetch" href="/docs/assets/js/242.f1641f49.js"><link rel="prefetch" href="/docs/assets/js/243.78861b30.js"><link rel="prefetch" href="/docs/assets/js/244.efe5b027.js"><link rel="prefetch" href="/docs/assets/js/245.09a2b97b.js"><link rel="prefetch" href="/docs/assets/js/246.ba3d4d62.js"><link rel="prefetch" href="/docs/assets/js/247.f9c4ea40.js"><link rel="prefetch" href="/docs/assets/js/248.610b2cce.js"><link rel="prefetch" href="/docs/assets/js/249.470efe3f.js"><link rel="prefetch" href="/docs/assets/js/25.15a620c7.js"><link rel="prefetch" href="/docs/assets/js/250.ce88d038.js"><link rel="prefetch" href="/docs/assets/js/251.1616b1f7.js"><link rel="prefetch" href="/docs/assets/js/252.3bb27e79.js"><link rel="prefetch" href="/docs/assets/js/253.6ce4277d.js"><link rel="prefetch" href="/docs/assets/js/254.a9c047e8.js"><link rel="prefetch" href="/docs/assets/js/255.80009a30.js"><link rel="prefetch" href="/docs/assets/js/256.7c0934f1.js"><link rel="prefetch" href="/docs/assets/js/257.cd9cec91.js"><link rel="prefetch" href="/docs/assets/js/258.db123425.js"><link rel="prefetch" href="/docs/assets/js/259.b52dc88e.js"><link rel="prefetch" href="/docs/assets/js/26.512dfda9.js"><link rel="prefetch" href="/docs/assets/js/260.6cfd8e07.js"><link rel="prefetch" href="/docs/assets/js/261.acbf34f4.js"><link rel="prefetch" href="/docs/assets/js/262.0b8437f1.js"><link rel="prefetch" href="/docs/assets/js/263.776619e9.js"><link rel="prefetch" href="/docs/assets/js/264.bb38ef4e.js"><link rel="prefetch" href="/docs/assets/js/265.ef56411a.js"><link rel="prefetch" href="/docs/assets/js/266.95ea5300.js"><link rel="prefetch" href="/docs/assets/js/267.a90f05c2.js"><link rel="prefetch" href="/docs/assets/js/268.4eeb0d63.js"><link rel="prefetch" href="/docs/assets/js/269.6d0f6d9d.js"><link rel="prefetch" href="/docs/assets/js/27.702fcc60.js"><link rel="prefetch" href="/docs/assets/js/270.be2efb92.js"><link rel="prefetch" href="/docs/assets/js/271.66cb6dbb.js"><link rel="prefetch" href="/docs/assets/js/272.b26f78e1.js"><link rel="prefetch" href="/docs/assets/js/273.01e381f9.js"><link rel="prefetch" href="/docs/assets/js/274.54647d8c.js"><link rel="prefetch" href="/docs/assets/js/275.b273f4bf.js"><link rel="prefetch" href="/docs/assets/js/276.66e96dd4.js"><link rel="prefetch" href="/docs/assets/js/277.f5b75806.js"><link rel="prefetch" href="/docs/assets/js/278.aa2bd3d6.js"><link rel="prefetch" href="/docs/assets/js/279.519f5353.js"><link rel="prefetch" href="/docs/assets/js/28.386872b9.js"><link rel="prefetch" href="/docs/assets/js/280.76ff7d45.js"><link rel="prefetch" href="/docs/assets/js/281.ad124871.js"><link rel="prefetch" href="/docs/assets/js/282.f2718428.js"><link rel="prefetch" href="/docs/assets/js/283.39fde988.js"><link rel="prefetch" href="/docs/assets/js/284.db1dc128.js"><link rel="prefetch" href="/docs/assets/js/285.c0784fd9.js"><link rel="prefetch" href="/docs/assets/js/286.49062aa3.js"><link rel="prefetch" href="/docs/assets/js/287.0d2e525d.js"><link rel="prefetch" href="/docs/assets/js/288.b061e959.js"><link rel="prefetch" href="/docs/assets/js/289.8b8fc437.js"><link rel="prefetch" href="/docs/assets/js/29.d33da70a.js"><link rel="prefetch" href="/docs/assets/js/290.95360302.js"><link rel="prefetch" href="/docs/assets/js/291.314ebb62.js"><link rel="prefetch" href="/docs/assets/js/292.dbe413f6.js"><link rel="prefetch" href="/docs/assets/js/293.1525ce64.js"><link rel="prefetch" href="/docs/assets/js/294.be644ab1.js"><link rel="prefetch" href="/docs/assets/js/295.d75fc5db.js"><link rel="prefetch" href="/docs/assets/js/296.fa54de84.js"><link rel="prefetch" href="/docs/assets/js/297.5d110761.js"><link rel="prefetch" href="/docs/assets/js/298.a5f16b8c.js"><link rel="prefetch" href="/docs/assets/js/299.a85f1590.js"><link rel="prefetch" href="/docs/assets/js/3.a81ef745.js"><link rel="prefetch" href="/docs/assets/js/30.bfbcf1ea.js"><link rel="prefetch" href="/docs/assets/js/300.24d1e063.js"><link rel="prefetch" href="/docs/assets/js/301.e5ff7878.js"><link rel="prefetch" href="/docs/assets/js/302.937a24bf.js"><link rel="prefetch" href="/docs/assets/js/303.fa856256.js"><link rel="prefetch" href="/docs/assets/js/304.15319443.js"><link rel="prefetch" href="/docs/assets/js/305.ddf47a9d.js"><link rel="prefetch" href="/docs/assets/js/306.23817332.js"><link rel="prefetch" href="/docs/assets/js/307.ce264408.js"><link rel="prefetch" href="/docs/assets/js/308.03bbe7b3.js"><link rel="prefetch" href="/docs/assets/js/309.5bccee70.js"><link rel="prefetch" href="/docs/assets/js/31.d05caf22.js"><link rel="prefetch" href="/docs/assets/js/310.29852778.js"><link rel="prefetch" href="/docs/assets/js/311.f2adcb73.js"><link rel="prefetch" href="/docs/assets/js/312.8be43331.js"><link rel="prefetch" href="/docs/assets/js/313.378b814e.js"><link rel="prefetch" href="/docs/assets/js/314.9fcdcab3.js"><link rel="prefetch" href="/docs/assets/js/315.3692e2ad.js"><link rel="prefetch" href="/docs/assets/js/316.83911c5c.js"><link rel="prefetch" href="/docs/assets/js/317.98710ce2.js"><link rel="prefetch" href="/docs/assets/js/318.249ef3c7.js"><link rel="prefetch" href="/docs/assets/js/319.b53aeaa4.js"><link rel="prefetch" href="/docs/assets/js/32.f352abd6.js"><link rel="prefetch" href="/docs/assets/js/320.20fe6139.js"><link rel="prefetch" href="/docs/assets/js/321.0664ecec.js"><link rel="prefetch" href="/docs/assets/js/322.17092d52.js"><link rel="prefetch" href="/docs/assets/js/323.cf11b8ba.js"><link rel="prefetch" href="/docs/assets/js/324.37384f10.js"><link rel="prefetch" href="/docs/assets/js/325.e9039021.js"><link rel="prefetch" href="/docs/assets/js/326.db4d7007.js"><link rel="prefetch" href="/docs/assets/js/327.1282f4b0.js"><link rel="prefetch" href="/docs/assets/js/328.17d1f5fb.js"><link rel="prefetch" href="/docs/assets/js/329.0c4dab89.js"><link rel="prefetch" href="/docs/assets/js/33.fa112cfe.js"><link rel="prefetch" href="/docs/assets/js/330.a0ea5ef6.js"><link rel="prefetch" href="/docs/assets/js/331.5ea12ecd.js"><link rel="prefetch" href="/docs/assets/js/332.062ada53.js"><link rel="prefetch" href="/docs/assets/js/333.1122e9ff.js"><link rel="prefetch" href="/docs/assets/js/334.ba39045f.js"><link rel="prefetch" href="/docs/assets/js/335.feaf3d9f.js"><link rel="prefetch" href="/docs/assets/js/336.e2f5ed9b.js"><link rel="prefetch" href="/docs/assets/js/337.12353bd6.js"><link rel="prefetch" href="/docs/assets/js/338.72da6520.js"><link rel="prefetch" href="/docs/assets/js/339.fe59cdca.js"><link rel="prefetch" href="/docs/assets/js/34.96a03e73.js"><link rel="prefetch" href="/docs/assets/js/340.b88fc7d8.js"><link rel="prefetch" href="/docs/assets/js/341.02eadcc4.js"><link rel="prefetch" href="/docs/assets/js/342.98745c99.js"><link rel="prefetch" href="/docs/assets/js/343.1cbcc224.js"><link rel="prefetch" href="/docs/assets/js/344.057e5075.js"><link rel="prefetch" href="/docs/assets/js/345.eb65f8ca.js"><link rel="prefetch" href="/docs/assets/js/346.8adec150.js"><link rel="prefetch" href="/docs/assets/js/347.7f719df7.js"><link rel="prefetch" href="/docs/assets/js/348.48893f5d.js"><link rel="prefetch" href="/docs/assets/js/349.a54e5ff5.js"><link rel="prefetch" href="/docs/assets/js/35.476137a9.js"><link rel="prefetch" href="/docs/assets/js/350.2b9d48f1.js"><link rel="prefetch" href="/docs/assets/js/351.d74fd6d3.js"><link rel="prefetch" href="/docs/assets/js/352.d58c75f5.js"><link rel="prefetch" href="/docs/assets/js/353.73fceb0a.js"><link rel="prefetch" href="/docs/assets/js/354.7a9bae1b.js"><link rel="prefetch" href="/docs/assets/js/355.e62ec36b.js"><link rel="prefetch" href="/docs/assets/js/356.84dd768a.js"><link rel="prefetch" href="/docs/assets/js/357.f72f29f4.js"><link rel="prefetch" href="/docs/assets/js/358.c596dca5.js"><link rel="prefetch" href="/docs/assets/js/359.441b8449.js"><link rel="prefetch" href="/docs/assets/js/36.a5007c58.js"><link rel="prefetch" href="/docs/assets/js/360.88d69fa1.js"><link rel="prefetch" href="/docs/assets/js/361.7c4c5c4b.js"><link rel="prefetch" href="/docs/assets/js/362.78ce9b06.js"><link rel="prefetch" href="/docs/assets/js/363.c3832318.js"><link rel="prefetch" href="/docs/assets/js/364.7fced81e.js"><link rel="prefetch" href="/docs/assets/js/365.68ad61a9.js"><link rel="prefetch" href="/docs/assets/js/366.4a04a2b6.js"><link rel="prefetch" href="/docs/assets/js/367.c1688fdc.js"><link rel="prefetch" href="/docs/assets/js/368.262c6aea.js"><link rel="prefetch" href="/docs/assets/js/369.5dc8495c.js"><link rel="prefetch" href="/docs/assets/js/37.3c69e2e9.js"><link rel="prefetch" href="/docs/assets/js/370.7c7bc5a3.js"><link rel="prefetch" href="/docs/assets/js/371.4c24b81b.js"><link rel="prefetch" href="/docs/assets/js/372.8569d71d.js"><link rel="prefetch" href="/docs/assets/js/373.ec7ed293.js"><link rel="prefetch" href="/docs/assets/js/374.a5859306.js"><link rel="prefetch" href="/docs/assets/js/375.9ed5b772.js"><link rel="prefetch" href="/docs/assets/js/376.e8728f72.js"><link rel="prefetch" href="/docs/assets/js/377.fed5344b.js"><link rel="prefetch" href="/docs/assets/js/378.07a53cec.js"><link rel="prefetch" href="/docs/assets/js/379.8b863638.js"><link rel="prefetch" href="/docs/assets/js/38.4e054230.js"><link rel="prefetch" href="/docs/assets/js/380.7127a11d.js"><link rel="prefetch" href="/docs/assets/js/381.5eef5fa8.js"><link rel="prefetch" href="/docs/assets/js/382.e1110317.js"><link rel="prefetch" href="/docs/assets/js/383.bf0b3ea9.js"><link rel="prefetch" href="/docs/assets/js/384.22705b9d.js"><link rel="prefetch" href="/docs/assets/js/385.3fe07c88.js"><link rel="prefetch" href="/docs/assets/js/386.3935950f.js"><link rel="prefetch" href="/docs/assets/js/387.f7324028.js"><link rel="prefetch" href="/docs/assets/js/388.1fadf896.js"><link rel="prefetch" href="/docs/assets/js/389.0337b6ea.js"><link rel="prefetch" href="/docs/assets/js/39.4d74fa2c.js"><link rel="prefetch" href="/docs/assets/js/390.d94c541a.js"><link rel="prefetch" href="/docs/assets/js/391.8ae34079.js"><link rel="prefetch" href="/docs/assets/js/392.f228e8b4.js"><link rel="prefetch" href="/docs/assets/js/393.bc0f3aa4.js"><link rel="prefetch" href="/docs/assets/js/394.7a1157e0.js"><link rel="prefetch" href="/docs/assets/js/395.0d5da83e.js"><link rel="prefetch" href="/docs/assets/js/396.fb369401.js"><link rel="prefetch" href="/docs/assets/js/397.cad29c58.js"><link rel="prefetch" href="/docs/assets/js/398.eb30f354.js"><link rel="prefetch" href="/docs/assets/js/399.b2b81a35.js"><link rel="prefetch" href="/docs/assets/js/4.a23c4d63.js"><link rel="prefetch" href="/docs/assets/js/40.f66c9c16.js"><link rel="prefetch" href="/docs/assets/js/400.22387e48.js"><link rel="prefetch" href="/docs/assets/js/401.1fde8549.js"><link rel="prefetch" href="/docs/assets/js/402.bb5d0eaf.js"><link rel="prefetch" href="/docs/assets/js/403.8c6d72cb.js"><link rel="prefetch" href="/docs/assets/js/404.70e7ba9b.js"><link rel="prefetch" href="/docs/assets/js/405.3876cf76.js"><link rel="prefetch" href="/docs/assets/js/406.fa2e4f1e.js"><link rel="prefetch" href="/docs/assets/js/407.28a7c369.js"><link rel="prefetch" href="/docs/assets/js/408.b905e669.js"><link rel="prefetch" href="/docs/assets/js/409.b77b95cc.js"><link rel="prefetch" href="/docs/assets/js/41.b6e7caf1.js"><link rel="prefetch" href="/docs/assets/js/410.2218d269.js"><link rel="prefetch" href="/docs/assets/js/411.2ef80405.js"><link rel="prefetch" href="/docs/assets/js/412.024ff11c.js"><link rel="prefetch" href="/docs/assets/js/413.fab1431b.js"><link rel="prefetch" href="/docs/assets/js/414.97b32817.js"><link rel="prefetch" href="/docs/assets/js/415.87ed289d.js"><link rel="prefetch" href="/docs/assets/js/416.e5125261.js"><link rel="prefetch" href="/docs/assets/js/417.993b8da6.js"><link rel="prefetch" href="/docs/assets/js/418.fd96f8f1.js"><link rel="prefetch" href="/docs/assets/js/419.155a572a.js"><link rel="prefetch" href="/docs/assets/js/42.e6b5fae1.js"><link rel="prefetch" href="/docs/assets/js/420.bcadc73f.js"><link rel="prefetch" href="/docs/assets/js/421.77f294fd.js"><link rel="prefetch" href="/docs/assets/js/422.4948b3c3.js"><link rel="prefetch" href="/docs/assets/js/423.3c213a21.js"><link rel="prefetch" href="/docs/assets/js/424.e0c08bd4.js"><link rel="prefetch" href="/docs/assets/js/425.66b6ea41.js"><link rel="prefetch" href="/docs/assets/js/426.5defc546.js"><link rel="prefetch" href="/docs/assets/js/427.fe33728b.js"><link rel="prefetch" href="/docs/assets/js/428.3feb3454.js"><link rel="prefetch" href="/docs/assets/js/429.d53937bf.js"><link rel="prefetch" href="/docs/assets/js/43.91200d17.js"><link rel="prefetch" href="/docs/assets/js/430.131831d7.js"><link rel="prefetch" href="/docs/assets/js/431.757a9133.js"><link rel="prefetch" href="/docs/assets/js/432.2f1970b3.js"><link rel="prefetch" href="/docs/assets/js/433.e49ee8dc.js"><link rel="prefetch" href="/docs/assets/js/434.bd16572c.js"><link rel="prefetch" href="/docs/assets/js/435.8fb86c64.js"><link rel="prefetch" href="/docs/assets/js/436.4111b978.js"><link rel="prefetch" href="/docs/assets/js/437.489023bf.js"><link rel="prefetch" href="/docs/assets/js/438.2f2637fa.js"><link rel="prefetch" href="/docs/assets/js/439.2fd9dad5.js"><link rel="prefetch" href="/docs/assets/js/44.4c799529.js"><link rel="prefetch" href="/docs/assets/js/440.1aae130e.js"><link rel="prefetch" href="/docs/assets/js/441.277d548c.js"><link rel="prefetch" href="/docs/assets/js/442.a3ad141d.js"><link rel="prefetch" href="/docs/assets/js/443.8b0daa76.js"><link rel="prefetch" href="/docs/assets/js/444.0334cc5f.js"><link rel="prefetch" href="/docs/assets/js/445.c6d99eb8.js"><link rel="prefetch" href="/docs/assets/js/446.510e7848.js"><link rel="prefetch" href="/docs/assets/js/447.162a1096.js"><link rel="prefetch" href="/docs/assets/js/448.d0573026.js"><link rel="prefetch" href="/docs/assets/js/449.f4917dbd.js"><link rel="prefetch" href="/docs/assets/js/45.de739fdc.js"><link rel="prefetch" href="/docs/assets/js/450.71a7a3b1.js"><link rel="prefetch" href="/docs/assets/js/451.af80f1a5.js"><link rel="prefetch" href="/docs/assets/js/452.70ae553a.js"><link rel="prefetch" href="/docs/assets/js/453.efdc7cff.js"><link rel="prefetch" href="/docs/assets/js/454.80ba5b00.js"><link rel="prefetch" href="/docs/assets/js/455.fa8290fb.js"><link rel="prefetch" href="/docs/assets/js/456.9d49a014.js"><link rel="prefetch" href="/docs/assets/js/457.44279f1e.js"><link rel="prefetch" href="/docs/assets/js/458.b1c041d1.js"><link rel="prefetch" href="/docs/assets/js/459.1ffcdcd4.js"><link rel="prefetch" href="/docs/assets/js/46.163d7862.js"><link rel="prefetch" href="/docs/assets/js/460.e62aceb8.js"><link rel="prefetch" href="/docs/assets/js/461.1c7353d1.js"><link rel="prefetch" href="/docs/assets/js/462.459d98d9.js"><link rel="prefetch" href="/docs/assets/js/463.45f62226.js"><link rel="prefetch" href="/docs/assets/js/464.103e8484.js"><link rel="prefetch" href="/docs/assets/js/465.5d9ba160.js"><link rel="prefetch" href="/docs/assets/js/466.209e5235.js"><link rel="prefetch" href="/docs/assets/js/467.edee28c1.js"><link rel="prefetch" href="/docs/assets/js/468.45237c76.js"><link rel="prefetch" href="/docs/assets/js/469.af4ea3ac.js"><link rel="prefetch" href="/docs/assets/js/47.8ad959f0.js"><link rel="prefetch" href="/docs/assets/js/470.dd8f242c.js"><link rel="prefetch" href="/docs/assets/js/471.cf12b40b.js"><link rel="prefetch" href="/docs/assets/js/472.2cf76396.js"><link rel="prefetch" href="/docs/assets/js/473.b9f75429.js"><link rel="prefetch" href="/docs/assets/js/474.8148b08c.js"><link rel="prefetch" href="/docs/assets/js/475.5bf13403.js"><link rel="prefetch" href="/docs/assets/js/476.f5b31431.js"><link rel="prefetch" href="/docs/assets/js/477.92c50b9f.js"><link rel="prefetch" href="/docs/assets/js/478.e8fc095f.js"><link rel="prefetch" href="/docs/assets/js/479.28618728.js"><link rel="prefetch" href="/docs/assets/js/48.4bd5fde5.js"><link rel="prefetch" href="/docs/assets/js/480.6304e698.js"><link rel="prefetch" href="/docs/assets/js/481.0d0ccd01.js"><link rel="prefetch" href="/docs/assets/js/482.06bb163e.js"><link rel="prefetch" href="/docs/assets/js/483.78acb04a.js"><link rel="prefetch" href="/docs/assets/js/484.6e500346.js"><link rel="prefetch" href="/docs/assets/js/485.9b4468b0.js"><link rel="prefetch" href="/docs/assets/js/486.b17f25ae.js"><link rel="prefetch" href="/docs/assets/js/487.1a945d9e.js"><link rel="prefetch" href="/docs/assets/js/488.2e50009d.js"><link rel="prefetch" href="/docs/assets/js/489.2846538e.js"><link rel="prefetch" href="/docs/assets/js/49.e3f2de93.js"><link rel="prefetch" href="/docs/assets/js/490.093fa044.js"><link rel="prefetch" href="/docs/assets/js/5.282d2475.js"><link rel="prefetch" href="/docs/assets/js/50.78f12e8e.js"><link rel="prefetch" href="/docs/assets/js/51.0c7e5d5e.js"><link rel="prefetch" href="/docs/assets/js/52.617f1de2.js"><link rel="prefetch" href="/docs/assets/js/53.db716122.js"><link rel="prefetch" href="/docs/assets/js/54.1a102517.js"><link rel="prefetch" href="/docs/assets/js/55.79f8337e.js"><link rel="prefetch" href="/docs/assets/js/56.3fe32f97.js"><link rel="prefetch" href="/docs/assets/js/57.3bd0343a.js"><link rel="prefetch" href="/docs/assets/js/58.8cb31859.js"><link rel="prefetch" href="/docs/assets/js/59.0197747d.js"><link rel="prefetch" href="/docs/assets/js/6.2fca5e73.js"><link rel="prefetch" href="/docs/assets/js/60.a01526a1.js"><link rel="prefetch" href="/docs/assets/js/61.cc42097a.js"><link rel="prefetch" href="/docs/assets/js/63.a57053cf.js"><link rel="prefetch" href="/docs/assets/js/64.14aae56d.js"><link rel="prefetch" href="/docs/assets/js/65.cd69cf54.js"><link rel="prefetch" href="/docs/assets/js/66.bf9d181e.js"><link rel="prefetch" href="/docs/assets/js/67.ba12511c.js"><link rel="prefetch" href="/docs/assets/js/68.76d7e8c1.js"><link rel="prefetch" href="/docs/assets/js/69.82306c1c.js"><link rel="prefetch" href="/docs/assets/js/7.d0020771.js"><link rel="prefetch" href="/docs/assets/js/70.895fcb62.js"><link rel="prefetch" href="/docs/assets/js/71.9937f231.js"><link rel="prefetch" href="/docs/assets/js/72.816a83d3.js"><link rel="prefetch" href="/docs/assets/js/73.15fed538.js"><link rel="prefetch" href="/docs/assets/js/74.9e627c55.js"><link rel="prefetch" href="/docs/assets/js/75.60a8b6f5.js"><link rel="prefetch" href="/docs/assets/js/76.80ebc590.js"><link rel="prefetch" href="/docs/assets/js/77.6c1e2410.js"><link rel="prefetch" href="/docs/assets/js/78.f3b234b3.js"><link rel="prefetch" href="/docs/assets/js/79.449c8868.js"><link rel="prefetch" href="/docs/assets/js/8.1e462b0b.js"><link rel="prefetch" href="/docs/assets/js/80.f3c51b62.js"><link rel="prefetch" href="/docs/assets/js/81.687db13a.js"><link rel="prefetch" href="/docs/assets/js/82.0b9d765e.js"><link rel="prefetch" href="/docs/assets/js/83.2ee05393.js"><link rel="prefetch" href="/docs/assets/js/84.7057dbec.js"><link rel="prefetch" href="/docs/assets/js/85.9b392255.js"><link rel="prefetch" href="/docs/assets/js/86.8a46d0db.js"><link rel="prefetch" href="/docs/assets/js/87.c43d85ba.js"><link rel="prefetch" href="/docs/assets/js/88.588bf9f6.js"><link rel="prefetch" href="/docs/assets/js/89.9fa189a4.js"><link rel="prefetch" href="/docs/assets/js/9.2675819b.js"><link rel="prefetch" href="/docs/assets/js/90.ae33f0f4.js"><link rel="prefetch" href="/docs/assets/js/91.dee9ec95.js"><link rel="prefetch" href="/docs/assets/js/92.6a1bee15.js"><link rel="prefetch" href="/docs/assets/js/93.28794c50.js"><link rel="prefetch" href="/docs/assets/js/94.f22eb6b1.js"><link rel="prefetch" href="/docs/assets/js/95.6c98da77.js"><link rel="prefetch" href="/docs/assets/js/96.d0958499.js"><link rel="prefetch" href="/docs/assets/js/97.616cafa7.js"><link rel="prefetch" href="/docs/assets/js/98.818fec6b.js"><link rel="prefetch" href="/docs/assets/js/99.5a75e34b.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.416feb4e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>System Design Case Studies</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/notification/" class="sidebar-link">Design a notification system</a></li><li><a href="/docs/kungfu/case-study/metrics/" class="sidebar-link">Metrics Monitoring &amp; Alerting System</a></li><li><a href="/docs/kungfu/case-study/url-shorter/" class="sidebar-link">Design URL Shorter</a></li><li><a href="/docs/kungfu/case-study/payment/" class="sidebar-link">Design Payment System</a></li><li><a href="/docs/kungfu/case-study/digital-wallet/" class="sidebar-link">Digital Wallet</a></li><li><a href="/docs/kungfu/case-study/youtube/" class="sidebar-link">Design YouTube</a></li><li><a href="/docs/kungfu/case-study/web-crawler/" class="sidebar-link">Design a Web Crawler</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Chat system</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Instagram</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/instagram/" aria-current="page" class="active sidebar-link">Design Instagram</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/instagram/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/instagram/#detailed-design" class="sidebar-link">Detailed design</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/instagram/#component-design" class="sidebar-link">Component Design</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/instagram/#data-models" class="sidebar-link">Data Models</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/instagram/#optimization" class="sidebar-link">Optimization</a></li></ul></li><li><a href="/docs/kungfu/case-study/instagram/part2/" class="sidebar-link">Design Instagram</a></li></ul></section></li><li><a href="/docs/kungfu/case-study/new-feed/" class="sidebar-link">Design new feed system</a></li><li><a href="/docs/kungfu/case-study/google-drive/" class="sidebar-link">Design Google Drive</a></li><li><a href="/docs/kungfu/case-study/search-autocomplete/" class="sidebar-link">Design a search autocomplete system</a></li><li><a href="/docs/kungfu/case-study/uber/" class="sidebar-link">Design Uber</a></li><li><a href="/docs/kungfu/case-study/google-maps/" class="sidebar-link">Design Google Maps</a></li><li><a href="/docs/kungfu/case-study/proximity-service/" class="sidebar-link">Proximity Service</a></li><li><a href="/docs/kungfu/case-study/nearby-friends/" class="sidebar-link">Nearby Friends</a></li><li><a href="/docs/kungfu/case-study/tinder/" class="sidebar-link">Design Tinder</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Building Microservices</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Go</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="design-instagram"><a href="#design-instagram" class="header-anchor">#</a> Design Instagram</h1> <p><em>Note</em>: This is our prototype on designing a photo-sharing system such as Instagram for
users to upload and share media files. We have created this design based on our research
going through Instagram Engineering tech-talks. These talks are quite informative and
detailed, and for the same reason, we have taken inspiration from those talks. We have
provided the list of the tech talks we have referenced here</p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <h3 id="problem-statement"><a href="#problem-statement" class="header-anchor">#</a> Problem statement</h3> <p>In this chapter we will be designing a photo-sharing platform similar to Instagram where
users can upload their photos and share it with their followers. Subsequently, the users
will be able to view personalized feeds containing posts from all the other users that they
follow.</p> <h3 id="gathering-requirements"><a href="#gathering-requirements" class="header-anchor">#</a> Gathering Requirements</h3> <p><strong>In scope</strong> The application should be able to support the following requirements.</p> <ul><li>Users should be able to upload photos and view the photos they have uploaded.</li> <li>Users should be able to follow other users.</li> <li>Users can view feeds containing posts from the users they follow.</li> <li>Users should be able to like and comment the posts.</li></ul> <p><strong>Out of scope</strong></p> <ul><li>Sending and receiving messages from other users. We have covered it in our article on designing WhatsApp.</li> <li>Generating machine learning based personalized recommendations to discover new people, photos, videos, and stories relevant one’s interest.</li></ul> <h2 id="detailed-design"><a href="#detailed-design" class="header-anchor">#</a> Detailed design</h2> <h3 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h3> <p>The high-level design consists of two important functions; one is to upload photos and
other is to view or search photos. Our service will need storage to store the photos and
some database servers to store metadata information about the photos</p> <p><img src="/docs/assets/img/28.fa3db067.png" alt="img"><br> <em>Figure 6.1: Architecture of photo sharing application</em></p> <p>Therefore, when the server receives a request for an action (post, like etc.) from a client
it performs two parallel operations:</p> <ol><li>Persisting the action in the data store</li> <li>Publishes the action in a streaming data store for a pub-sub model.</li></ol> <p>It is followed by, the various services (such as, User Feed Service, Media Counter Service) read the actions from the streaming data store and performs their specific tasks. The streaming data store makes the system extensible to support other use-cases (e.g. media search index, locations search index, and so forth) in future.</p> <div class="custom-block tip"><p class="custom-block-title">FUN FACTS</p> <p>In this talk, Rodrigo Schmidt, director of engineering at Instagram talks
about the different challenges they have faced in scaling the data infrastructure at Instagram</p></div> <h3 id="system-components"><a href="#system-components" class="header-anchor">#</a> System components</h3> <p>The system will comprise of several micro-services each performing a separate task. We
will use a graph database such as Neo4j to store the information. The reason we have
chosen a graph data-model is that our data will contain complex relationships between
data entities such as users, posts, and comments as nodes of the graph. After that, we will
use edges of the graph to store relationships such as follows, likes, comments, and so forth.
Additionally, we can use columnar databases like Cassandra to store information like user
feeds, activities, and counters.</p> <p><img src="/docs/assets/img/29.dd7c4880.png" alt="img"><br> <em>Figure 6.2: High level system components</em></p> <h2 id="component-design"><a href="#component-design" class="header-anchor">#</a> Component Design</h2> <h3 id="posting-on-instagram"><a href="#posting-on-instagram" class="header-anchor">#</a> Posting on Instagram</h3> <p><img src="/docs/assets/img/30.c4291e71.png" alt="img"><br> <em>Figure 6.3: Synchronous and Asynchronous process for posting on Instagram</em></p> <p>There are two major processes which gets executed when a user posts a photo on Instagram. The synchronous process is the first step, which is responsible for uploading image content on file storage, persisting the media metadata in graph data-storage, returning the confirmation message to the user and triggering the process to update the user activity. The second process occurs asynchronously by persisting user activity in a columnar
data-storage (Cassandra) and triggering the process to pre-compute the feed of followers
of non-celebrity users (having few thousand followers). We don’t pre-compute feeds for
celebrity users (have 1M+ followers) as the process to fan-out the feeds to all the followers
will be extremely compute and I/O intensive</p> <h4 id="api-design"><a href="#api-design" class="header-anchor">#</a> API Design</h4> <p>We have provided the API design of posting an image on Instagram below. We will send
the file and data over in one request using the multipart/form-data content type. The
MultiPart/Form-Data contains a series of parts. Each part is expected to contain a content-disposition header [RFC 2183] where the disposition type is &quot;form-data”.</p> <div class="language- extra-class"><pre class="language-text"><code>POST /users/&lt;user_id&gt;/posts
</code></pre></div><p><strong>Sample Request Body:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>Content-Type: multipart/form-data; boundary=ExampleFormBoundary
--ExampleFormBoundary
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.png&quot;
Content-Type: image/png
{image file data bytes}
--ExampleFormBoundary--
</code></pre></div><p><strong>Sample Response:</strong></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ImageFile&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;667&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1466623229&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test.png&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1466623230&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updatedBy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fullImageUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://mybucket.s3.amazonaws.com/myfolder/test.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Size&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token string">&quot;316&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token string">&quot;316&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="precompute-feeds"><a href="#precompute-feeds" class="header-anchor">#</a> Precompute Feeds</h3> <p><img src="/docs/assets/img/31.164d1469.png" alt="img"><br> <em>Figure 6.4: Precompute feeds from non celebrity users</em></p> <p>This process gets executed when non-celebrity users make a post on Instagram. It is
triggered when a message is added in the User Feed Service Queue. Once the message is
added in the queue, the User Feed Service makes a call to the Followers Service to fetch the
list of followers of the user. After that, the post gets added to the feed of all the followers
in the columnar data storage.</p> <h3 id="fetching-user-feed"><a href="#fetching-user-feed" class="header-anchor">#</a> Fetching User Feed</h3> <p><img src="/docs/assets/img/32.0774ff6c.png" alt="img"><br> <em>Figure 6.5: Sequence of operations involved in fetching user feed</em></p> <p>When a user requests for feed then there will be two parallel threads involved in fetching the user feeds to optimize for latency. The first thread will fetch the feeds from noncelebrity users which the user follow. These feeds are populated by the fan-out mechanism
described in the PreCompute Feeds section above. The second thread is responsible for
fetching the feeds of celebrity users whom the user follow. After that, the User Feed Service will merge the feeds from celebrity and non-celebrity users and return the merged
feeds to the user who requested the feed.</p> <h4 id="api-design-2"><a href="#api-design-2" class="header-anchor">#</a> API Design</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/&lt;user_id&gt;/feeds
</code></pre></div><p><strong>Sample Response</strong>: The response below can be mapped directly to the graph data model
mentioned in the next section.</p> <div class="language- extra-class"><pre class="language-text"><code>{
/// ...
“feeds”: [
    {
        “postId”: “post001”,
        “postOwnerId” : “user001”,
        “postOwnerName” : “Bill Gates”,
        “mediaURL” : “https://mybucket.s3.amazonaws.com/myfolder/test.jpg”,
        “numberOfLikes” : 400000
        “numberOfComments” : 19789
        “comments”: [
            {
                “commenterUserId” : “user004”,
                “commenterName” : “JeffBezos”
                “comment” : “Amazing!”
                “likes” : [
                    {
                    “likerId” : “user003”,
                    “likerUserName” : “Bob”
                    }
                ]
            }
        ]
    }
]
}
</code></pre></div><h2 id="data-models"><a href="#data-models" class="header-anchor">#</a> Data Models</h2> <h3 id="graph-data-model"><a href="#graph-data-model" class="header-anchor">#</a> Graph Data Model</h3> <p><img src="/docs/assets/img/33.729a982e.png" alt="img"><br> <em>Figure 6.6: Graph representation of users, posts and comments</em></p> <p>We can use a graph database such as Neo4j which stores data-entities such as user
information, posts, comments, and so forth as nodes in the graph. The edges between
the nodes are used to store the relationship between data entities such as followers, posts,
comments, likes, and replies. All the nodes are added to an index called nodeIndex for
faster lookups. We have chosen this NoSQL based solution over relational databases as it
provides the scalability to have hierarchies which go beyond two levels and extensibility
due to the schema-less behavior of NoSQL data storage.</p> <h4 id="sample-queries-supported-by-graph-database"><a href="#sample-queries-supported-by-graph-database" class="header-anchor">#</a> Sample Queries supported by Graph Database</h4> <p><strong>Fetch all the followers of Jeff Bezos</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Node</span> jeffBezos <span class="token operator">=</span> nodeIndex<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“userId”<span class="token punctuation">,</span> “user004”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosFollowers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> jeffBezos<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>INGOING<span class="token punctuation">,</span> FOLLOWS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    jeffBezosFollowers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getStartNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Fetch all the posts of Bill Gates</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Node</span> billGates <span class="token operator">=</span> nodeIndex<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“userId”<span class="token punctuation">,</span> “user001”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> billGatesPosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> billGates<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>OUTGOING<span class="token punctuation">,</span> POSTS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    billGatesPosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getEndNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Fetch all the posts of Bill Gates on which Jeff Bezos has commented</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> commentsOnBillGatesPosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Node</span> billGatesPost <span class="token operator">:</span> billGatesPosts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> billGates<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>INGOING<span class="token punctuation">,</span> COMMENTED_ON<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        commentsOnBillGatesPosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getStartNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosComments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> jeffBezos<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>OUTGOING<span class="token punctuation">,</span> COMMENTS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    jeffBezosComments<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getEndNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosCommentsOnBillGatesPosts <span class="token operator">=</span>
commentsOnBillGatesPosts<span class="token punctuation">.</span><span class="token function">intersect</span><span class="token punctuation">(</span>jeffBezosComments<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="columnar-data-models"><a href="#columnar-data-models" class="header-anchor">#</a> Columnar Data Models</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWkAAABHCAYAAADFqra8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAch0lEQVR42u3dCbCcRREHcA65RIEIKBQIQglyioDIaXGKoKAEUA6J0cghoiAgaEBFRPDEG4VIECRKNCRgFGMSkChXFOTwQkSRwwM8EOVWYKxfV01qfe7u210eyXtv+1+1lZfd75ie7v5/PT3z9SxWEn2BRx55pPz9738vf/jDH8odd9xRfvnLX5af/vSn5ZprrilXXHFF+d73vldmzJhRLrroonL++eeXc845p3z+858vn/rUp8rpp59eTjnllDJx4sRy/PHHl3e9613liCOOKBMmTCiHHHJIOeCAA8q+++5b9t5777LHHnuU3Xbbrey4445l++23L1tvvXXZcssty2abbVY23njjssEGG5T11luvrLPOOmWttdYqa6yxRllttdXK85///LLyyiuXMWPGlBVXXLE897nPLcsvv3xZbrnlyjLLLFOWXnrpstRSS5Ull1yyLLHEEvFZfPHFy2KLLRYffw/8NP5Wz3G+67ie67q++7if+7q/dmiPdmmfdmqvdms/OchDLvKRk7zkJr9+0B/6Rf/oJ/2l3/SfftSf+lX/6mf9rd/1Pz3QB73QDz3RF73RHz3SZ6I/sFh2wfDBE088Ue6///5y1113lV/84hfluuuuK3PmzCnTp08vF1xwQTnrrLPKxz/+8fKBD3ygHHfcceH4SGDs2LFl9913LzvssEPZYostgkgQyyqrrBIEhJwQ0korrVRWX331IJwNN9ywbL755mXbbbctO++8c9lzzz3LPvvsUw488MAyfvz4cvjhhy8glZNOOql86EMfKmecccYCUjn77LPL5MmTy4UXXlimTp0abZw5c2aZNWtWmTt3bpk3b165+uqry/z588sNN9xQbr755pDp1ltvLbfffnsQDjmRzp///Ody3333lb/97W8h/wMPPFD+9a9/lYceeijI6LHHHiuPP/54+c9//hN99OSTT5annnqqq751vPOc7zqu57qu7z7u577urx3ao13ap53aq93aTw7ykIt85CQvucmvH/SHftE/+kl/1YeeftSf+rU+9PS3ftf/9EAf9EI/9ERf9EZ/9Eif9Eq/9Ezf9E7/7IA9sAv2wU7YC7thP+yIPWkj+2JnZCIn+fVRIkl61OIf//hH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" alt="img"><br> <em>Figure 6.7: Columnar Data Model for user feed and activities</em></p> <p>We will use columnar data storage such as Cassandra to store data entities like user feed
and activities. Each row will contain feed/activity information of the user. We can also have
a TTL based functionality to evict older posts. The data model will look something similar
to:</p> <p><code>User_id -&gt; List&lt;post_id&gt;</code></p> <div class="custom-block tip"><p class="custom-block-title">FUN FACT</p> <p>In this talk, Dikang Gu, a software engineer at Instagram core infra team
has mentioned about how they use Cassandra to serve critical usecases, high scalability
requirements, and some pain points.</p></div> <h3 id="streaming-data-model"><a href="#streaming-data-model" class="header-anchor">#</a> Streaming Data Model</h3> <p>We can use cloud technologies such as Amazon Kinesis or Azure Stream Analytics for
collecting, processing, and analyzing real-time, streaming data to get timely insights and
react quickly to new information(e.g. a new like, comment, etc.). We have listed below the
de-normalized form of some major streaming data entities and action.</p> <p><img src="/docs/assets/img/35.d01c4b65.png" alt="img"><br> <em>Figure 6.8: De-normalized major data-entities and actions</em></p> <p>The data entities A and B above show the containers which contain denormalized information about the Users and their Posts. Subsequently, the data entities C and D denote
the different actions which users may take. The entity C denotes the event where a user
likes a post and entity D denotes the action when a user follows another user. These actions
are read by the related micro-services from the stream and processed accordingly. For instance, the <em>LikeEvent</em> can be read by the <em>Media Counter Service</em> and is used to update the
media count in the data storage.</p> <h2 id="optimization"><a href="#optimization" class="header-anchor">#</a> Optimization</h2> <p>We will use a cache having an LRU based eviction policy for caching user feeds of active
users. This will not only reduce the overall latency in displaying the user-feeds to users but will also prevent re-computation of user-feeds</p> <p><img src="/docs/assets/img/36.0802659d.png" alt="img"><br> <em>Figure 6.9: LRU bases cache for storing user feeds of active users</em></p> <p>There is a room for optimization in providing the best content in the user feeds. We
can do this by ranking the new feeds (the ones generated after users last login) from those
who the user follows. We can apply machine learning techniques to rank the user feeds
by assigning scores to the individual feeds which would indicate the probability of click,
like, comment and so forth. We can do this by representing each feed by a feature vector
which contains information about the user, the feed and the interactions which the user has
had with the people in the feed (e.g. whether the user had clicked/liked/commented on the
previous feeds by the people in the story). It’s apparent that the most important features for
feed ranking will be related to social network. Some of the keys of understanding the user
network are listed below.</p> <ul><li>Who is the user a close follower of? For example, one user is a close follower of Elon Musk while another user can be a close follower of Gordon Ramsay.</li> <li>Whose photos the user always like?</li> <li>Whose links are most interesting to the user?</li></ul> <p>We can use deep neural networks which would take the several features (&gt; 100K dense
features) which we require for training the model. Those features will be passed through
the n-fold layers, and will be used for predicting the probability of the different events
(likes, comments, shares, etc.).</p> <div class="custom-block tip"><p class="custom-block-title">FUN FACT</p> <p>In this talk, Lars Backstrom, VP of Engineering @ Facebook talks about
the machine learning done to create personalized news feeds for users. He talks about
the classical machine learning approach they used in the initial phases for personalizing
News Feeds by using decision trees and logistic regression. He then goes to talk about the
improvements they have observed in using neural networks.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/case-study/chat-system/telegram/" class="prev">
        Telegram System
      </a></span> <span class="next"><a href="/docs/kungfu/case-study/instagram/part2/">
        Design Instagram
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.07ce28f7.js" defer></script><script src="/docs/assets/js/2.7043f65e.js" defer></script><script src="/docs/assets/js/19.1a9741f5.js" defer></script><script src="/docs/assets/js/62.f6b7c9d0.js" defer></script>
  </body>
</html>
