<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Designing Yelp or Nearby Friends | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.6292c5a4.css" as="style"><link rel="preload" href="/docs/assets/js/app.f6cd25ab.js" as="script"><link rel="preload" href="/docs/assets/js/2.1680c3d7.js" as="script"><link rel="preload" href="/docs/assets/js/69.4f7f34ff.js" as="script"><link rel="preload" href="/docs/assets/js/76.fcb20251.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.ab4e6af2.js"><link rel="prefetch" href="/docs/assets/js/100.934b3b2a.js"><link rel="prefetch" href="/docs/assets/js/101.1f4b2067.js"><link rel="prefetch" href="/docs/assets/js/102.3e54a57a.js"><link rel="prefetch" href="/docs/assets/js/103.add6f2b4.js"><link rel="prefetch" href="/docs/assets/js/104.9f7aee43.js"><link rel="prefetch" href="/docs/assets/js/105.f083cc0a.js"><link rel="prefetch" href="/docs/assets/js/106.14c21fa6.js"><link rel="prefetch" href="/docs/assets/js/107.0d1592cc.js"><link rel="prefetch" href="/docs/assets/js/108.0460b897.js"><link rel="prefetch" href="/docs/assets/js/109.f5ed2be4.js"><link rel="prefetch" href="/docs/assets/js/11.f19f398c.js"><link rel="prefetch" href="/docs/assets/js/110.2537fc2d.js"><link rel="prefetch" href="/docs/assets/js/111.8dfa7e42.js"><link rel="prefetch" href="/docs/assets/js/112.4b4d0888.js"><link rel="prefetch" href="/docs/assets/js/113.b7a17623.js"><link rel="prefetch" href="/docs/assets/js/114.a095d6e4.js"><link rel="prefetch" href="/docs/assets/js/115.edf268cd.js"><link rel="prefetch" href="/docs/assets/js/116.92a6aee6.js"><link rel="prefetch" href="/docs/assets/js/117.a584efa9.js"><link rel="prefetch" href="/docs/assets/js/118.e4a9a7df.js"><link rel="prefetch" href="/docs/assets/js/119.76e403fc.js"><link rel="prefetch" href="/docs/assets/js/12.8e4cf44e.js"><link rel="prefetch" href="/docs/assets/js/120.56e6c529.js"><link rel="prefetch" href="/docs/assets/js/121.5483b7cc.js"><link rel="prefetch" href="/docs/assets/js/122.d59f075a.js"><link rel="prefetch" href="/docs/assets/js/123.e37f1498.js"><link rel="prefetch" href="/docs/assets/js/124.6399536f.js"><link rel="prefetch" href="/docs/assets/js/125.3dd1b21e.js"><link rel="prefetch" href="/docs/assets/js/126.bac5b1a9.js"><link rel="prefetch" href="/docs/assets/js/127.ca0b98d6.js"><link rel="prefetch" href="/docs/assets/js/128.e27cd810.js"><link rel="prefetch" href="/docs/assets/js/129.ea163ad4.js"><link rel="prefetch" href="/docs/assets/js/13.8b9a71d6.js"><link rel="prefetch" href="/docs/assets/js/130.b0f6d331.js"><link rel="prefetch" href="/docs/assets/js/131.4d7e7f27.js"><link rel="prefetch" href="/docs/assets/js/132.fa52eaf8.js"><link rel="prefetch" href="/docs/assets/js/133.f4b31c36.js"><link rel="prefetch" href="/docs/assets/js/134.d3f4c22c.js"><link rel="prefetch" href="/docs/assets/js/135.c04cbfc1.js"><link rel="prefetch" href="/docs/assets/js/136.38c54ec8.js"><link rel="prefetch" href="/docs/assets/js/137.ea709dba.js"><link rel="prefetch" href="/docs/assets/js/138.1a30b9a5.js"><link rel="prefetch" href="/docs/assets/js/139.206f723d.js"><link rel="prefetch" href="/docs/assets/js/14.83e91728.js"><link rel="prefetch" href="/docs/assets/js/140.7d48afd4.js"><link rel="prefetch" href="/docs/assets/js/141.4b131bb1.js"><link rel="prefetch" href="/docs/assets/js/142.e36a8e32.js"><link rel="prefetch" href="/docs/assets/js/143.b30d24d0.js"><link rel="prefetch" href="/docs/assets/js/144.89b6bd7a.js"><link rel="prefetch" href="/docs/assets/js/145.fbeab0e6.js"><link rel="prefetch" href="/docs/assets/js/146.9b668e22.js"><link rel="prefetch" href="/docs/assets/js/147.9c2f4299.js"><link rel="prefetch" href="/docs/assets/js/148.d654db25.js"><link rel="prefetch" href="/docs/assets/js/149.d0d971b1.js"><link rel="prefetch" href="/docs/assets/js/15.4dbf7ded.js"><link rel="prefetch" href="/docs/assets/js/150.de6537ae.js"><link rel="prefetch" href="/docs/assets/js/151.c8902105.js"><link rel="prefetch" href="/docs/assets/js/152.06cf963d.js"><link rel="prefetch" href="/docs/assets/js/153.29c2d314.js"><link rel="prefetch" href="/docs/assets/js/154.3667c485.js"><link rel="prefetch" href="/docs/assets/js/155.714e38da.js"><link rel="prefetch" href="/docs/assets/js/156.ce226a23.js"><link rel="prefetch" href="/docs/assets/js/157.8618e6d0.js"><link rel="prefetch" href="/docs/assets/js/158.71651ca5.js"><link rel="prefetch" href="/docs/assets/js/159.8b8c4da0.js"><link rel="prefetch" href="/docs/assets/js/16.8c300213.js"><link rel="prefetch" href="/docs/assets/js/160.05c0d7a1.js"><link rel="prefetch" href="/docs/assets/js/161.a0205d2f.js"><link rel="prefetch" href="/docs/assets/js/162.1c0657ee.js"><link rel="prefetch" href="/docs/assets/js/163.25847939.js"><link rel="prefetch" href="/docs/assets/js/164.8eee1579.js"><link rel="prefetch" href="/docs/assets/js/165.2761ab3d.js"><link rel="prefetch" href="/docs/assets/js/166.a3c337e8.js"><link rel="prefetch" href="/docs/assets/js/167.aa689b5f.js"><link rel="prefetch" href="/docs/assets/js/168.07bd0053.js"><link rel="prefetch" href="/docs/assets/js/169.f64aa882.js"><link rel="prefetch" href="/docs/assets/js/17.f86928ac.js"><link rel="prefetch" href="/docs/assets/js/170.e6db7072.js"><link rel="prefetch" href="/docs/assets/js/171.16117c3f.js"><link rel="prefetch" href="/docs/assets/js/172.b436ec04.js"><link rel="prefetch" href="/docs/assets/js/173.71f97f73.js"><link rel="prefetch" href="/docs/assets/js/174.63878e1b.js"><link rel="prefetch" href="/docs/assets/js/175.45c4a848.js"><link rel="prefetch" href="/docs/assets/js/176.461fa334.js"><link rel="prefetch" href="/docs/assets/js/177.8993bdb1.js"><link rel="prefetch" href="/docs/assets/js/178.4923b33d.js"><link rel="prefetch" href="/docs/assets/js/179.db3a5416.js"><link rel="prefetch" href="/docs/assets/js/18.a567e570.js"><link rel="prefetch" href="/docs/assets/js/180.7490e2c1.js"><link rel="prefetch" href="/docs/assets/js/181.da4fd091.js"><link rel="prefetch" href="/docs/assets/js/182.4c7c7596.js"><link rel="prefetch" href="/docs/assets/js/183.2ad0c177.js"><link rel="prefetch" href="/docs/assets/js/184.9fdb2b3f.js"><link rel="prefetch" href="/docs/assets/js/185.73d825e6.js"><link rel="prefetch" href="/docs/assets/js/186.39847372.js"><link rel="prefetch" href="/docs/assets/js/187.d96b4a4d.js"><link rel="prefetch" href="/docs/assets/js/188.39bc319b.js"><link rel="prefetch" href="/docs/assets/js/189.cd754d89.js"><link rel="prefetch" href="/docs/assets/js/19.32080456.js"><link rel="prefetch" href="/docs/assets/js/190.da9786e6.js"><link rel="prefetch" href="/docs/assets/js/191.ef07ebb8.js"><link rel="prefetch" href="/docs/assets/js/192.11981087.js"><link rel="prefetch" href="/docs/assets/js/193.ad95e2f7.js"><link rel="prefetch" href="/docs/assets/js/194.acfe8d04.js"><link rel="prefetch" href="/docs/assets/js/195.c56ab22e.js"><link rel="prefetch" href="/docs/assets/js/196.c73fdf05.js"><link rel="prefetch" href="/docs/assets/js/197.dc80aa9b.js"><link rel="prefetch" href="/docs/assets/js/198.d54525c1.js"><link rel="prefetch" href="/docs/assets/js/199.c6d37435.js"><link rel="prefetch" href="/docs/assets/js/20.f792103e.js"><link rel="prefetch" href="/docs/assets/js/200.a88ed139.js"><link rel="prefetch" href="/docs/assets/js/201.27bbbdbb.js"><link rel="prefetch" href="/docs/assets/js/202.58e5d85a.js"><link rel="prefetch" href="/docs/assets/js/203.20ce8eda.js"><link rel="prefetch" href="/docs/assets/js/204.d86f297e.js"><link rel="prefetch" href="/docs/assets/js/205.dc649b51.js"><link rel="prefetch" href="/docs/assets/js/206.6569abbb.js"><link rel="prefetch" href="/docs/assets/js/207.d0f550fa.js"><link rel="prefetch" href="/docs/assets/js/208.f4a16b61.js"><link rel="prefetch" href="/docs/assets/js/209.1bb79268.js"><link rel="prefetch" href="/docs/assets/js/21.18a56820.js"><link rel="prefetch" href="/docs/assets/js/210.7e18bbfb.js"><link rel="prefetch" href="/docs/assets/js/211.b7fa08f6.js"><link rel="prefetch" href="/docs/assets/js/212.10a086f9.js"><link rel="prefetch" href="/docs/assets/js/213.5bd4c397.js"><link rel="prefetch" href="/docs/assets/js/214.a2c756fc.js"><link rel="prefetch" href="/docs/assets/js/215.8e2fce77.js"><link rel="prefetch" href="/docs/assets/js/216.08487a19.js"><link rel="prefetch" href="/docs/assets/js/217.07f5edca.js"><link rel="prefetch" href="/docs/assets/js/218.b2e835ad.js"><link rel="prefetch" href="/docs/assets/js/219.c39ba344.js"><link rel="prefetch" href="/docs/assets/js/22.d895b2fe.js"><link rel="prefetch" href="/docs/assets/js/220.a6efab5b.js"><link rel="prefetch" href="/docs/assets/js/221.6279f674.js"><link rel="prefetch" href="/docs/assets/js/222.64aa23d9.js"><link rel="prefetch" href="/docs/assets/js/223.6419c554.js"><link rel="prefetch" href="/docs/assets/js/224.2b11a798.js"><link rel="prefetch" href="/docs/assets/js/225.b991618a.js"><link rel="prefetch" href="/docs/assets/js/226.e31dd6e7.js"><link rel="prefetch" href="/docs/assets/js/227.a6c2b8cb.js"><link rel="prefetch" href="/docs/assets/js/228.e84edeef.js"><link rel="prefetch" href="/docs/assets/js/229.a724ab19.js"><link rel="prefetch" href="/docs/assets/js/23.ac13b33e.js"><link rel="prefetch" href="/docs/assets/js/230.e4c39a5a.js"><link rel="prefetch" href="/docs/assets/js/231.bbd7889e.js"><link rel="prefetch" href="/docs/assets/js/232.9e383168.js"><link rel="prefetch" href="/docs/assets/js/233.ad1a7602.js"><link rel="prefetch" href="/docs/assets/js/234.48c223e5.js"><link rel="prefetch" href="/docs/assets/js/235.4b756cd3.js"><link rel="prefetch" href="/docs/assets/js/236.76bc6dab.js"><link rel="prefetch" href="/docs/assets/js/237.c5306c63.js"><link rel="prefetch" href="/docs/assets/js/238.3c84a385.js"><link rel="prefetch" href="/docs/assets/js/239.859617a3.js"><link rel="prefetch" href="/docs/assets/js/24.a22d6f57.js"><link rel="prefetch" href="/docs/assets/js/240.bb8adc71.js"><link rel="prefetch" href="/docs/assets/js/241.51778eb0.js"><link rel="prefetch" href="/docs/assets/js/242.954ff44a.js"><link rel="prefetch" href="/docs/assets/js/243.b79314d6.js"><link rel="prefetch" href="/docs/assets/js/244.6952f686.js"><link rel="prefetch" href="/docs/assets/js/245.5081a9f6.js"><link rel="prefetch" href="/docs/assets/js/246.de4a3666.js"><link rel="prefetch" href="/docs/assets/js/247.84bc7419.js"><link rel="prefetch" href="/docs/assets/js/248.64504c91.js"><link rel="prefetch" href="/docs/assets/js/249.4fd4491d.js"><link rel="prefetch" href="/docs/assets/js/25.47e37125.js"><link rel="prefetch" href="/docs/assets/js/250.3fd90be1.js"><link rel="prefetch" href="/docs/assets/js/251.87a40c86.js"><link rel="prefetch" href="/docs/assets/js/252.c420fd22.js"><link rel="prefetch" href="/docs/assets/js/253.2d3ecd7b.js"><link rel="prefetch" href="/docs/assets/js/254.9cf19b98.js"><link rel="prefetch" href="/docs/assets/js/255.428f1f99.js"><link rel="prefetch" href="/docs/assets/js/256.ca492094.js"><link rel="prefetch" href="/docs/assets/js/257.0b4e1e7a.js"><link rel="prefetch" href="/docs/assets/js/258.6772dc3a.js"><link rel="prefetch" href="/docs/assets/js/259.4aaca4d9.js"><link rel="prefetch" href="/docs/assets/js/26.89d2bc41.js"><link rel="prefetch" href="/docs/assets/js/260.1a2cf0f2.js"><link rel="prefetch" href="/docs/assets/js/261.7269beb1.js"><link rel="prefetch" href="/docs/assets/js/262.43a91a0f.js"><link rel="prefetch" href="/docs/assets/js/263.d03ade38.js"><link rel="prefetch" href="/docs/assets/js/264.3ee8c5ad.js"><link rel="prefetch" href="/docs/assets/js/265.d200b4b4.js"><link rel="prefetch" href="/docs/assets/js/266.40f356ba.js"><link rel="prefetch" href="/docs/assets/js/267.585911fb.js"><link rel="prefetch" href="/docs/assets/js/268.09c36242.js"><link rel="prefetch" href="/docs/assets/js/269.4a9bae98.js"><link rel="prefetch" href="/docs/assets/js/27.5a2b885c.js"><link rel="prefetch" href="/docs/assets/js/270.a42b9720.js"><link rel="prefetch" href="/docs/assets/js/271.10825d2b.js"><link rel="prefetch" href="/docs/assets/js/272.cd8ba290.js"><link rel="prefetch" href="/docs/assets/js/273.a6efcac2.js"><link rel="prefetch" href="/docs/assets/js/274.3b02c905.js"><link rel="prefetch" href="/docs/assets/js/275.31003c5a.js"><link rel="prefetch" href="/docs/assets/js/276.e8ca6fc7.js"><link rel="prefetch" href="/docs/assets/js/277.8178821c.js"><link rel="prefetch" href="/docs/assets/js/278.83cf72f4.js"><link rel="prefetch" href="/docs/assets/js/279.4ff1d084.js"><link rel="prefetch" href="/docs/assets/js/28.e81a3332.js"><link rel="prefetch" href="/docs/assets/js/280.6c651274.js"><link rel="prefetch" href="/docs/assets/js/281.1eca8148.js"><link rel="prefetch" href="/docs/assets/js/282.9deee1be.js"><link rel="prefetch" href="/docs/assets/js/283.5bb18313.js"><link rel="prefetch" href="/docs/assets/js/284.c72af108.js"><link rel="prefetch" href="/docs/assets/js/285.d0c9e46a.js"><link rel="prefetch" href="/docs/assets/js/286.9292cbed.js"><link rel="prefetch" href="/docs/assets/js/287.8d587359.js"><link rel="prefetch" href="/docs/assets/js/288.e66c688c.js"><link rel="prefetch" href="/docs/assets/js/289.cd694450.js"><link rel="prefetch" href="/docs/assets/js/29.b3efce48.js"><link rel="prefetch" href="/docs/assets/js/290.d031a454.js"><link rel="prefetch" href="/docs/assets/js/291.a433052e.js"><link rel="prefetch" href="/docs/assets/js/292.512bb9ae.js"><link rel="prefetch" href="/docs/assets/js/293.15f31854.js"><link rel="prefetch" href="/docs/assets/js/294.63c059af.js"><link rel="prefetch" href="/docs/assets/js/295.711bd755.js"><link rel="prefetch" href="/docs/assets/js/296.5f2803d2.js"><link rel="prefetch" href="/docs/assets/js/297.a5e4c6f3.js"><link rel="prefetch" href="/docs/assets/js/298.48ea186e.js"><link rel="prefetch" href="/docs/assets/js/299.36ca897c.js"><link rel="prefetch" href="/docs/assets/js/3.c84c186c.js"><link rel="prefetch" href="/docs/assets/js/30.9cf23044.js"><link rel="prefetch" href="/docs/assets/js/300.edd400b4.js"><link rel="prefetch" href="/docs/assets/js/301.d4498ee2.js"><link rel="prefetch" href="/docs/assets/js/302.93d3703b.js"><link rel="prefetch" href="/docs/assets/js/303.497ec76e.js"><link rel="prefetch" href="/docs/assets/js/304.c38d737a.js"><link rel="prefetch" href="/docs/assets/js/305.c6f98160.js"><link rel="prefetch" href="/docs/assets/js/306.3ede5d20.js"><link rel="prefetch" href="/docs/assets/js/307.3a9e1c6c.js"><link rel="prefetch" href="/docs/assets/js/308.c3a90653.js"><link rel="prefetch" href="/docs/assets/js/309.86278055.js"><link rel="prefetch" href="/docs/assets/js/31.ded3bf81.js"><link rel="prefetch" href="/docs/assets/js/310.43f7ad22.js"><link rel="prefetch" href="/docs/assets/js/311.818e16a5.js"><link rel="prefetch" href="/docs/assets/js/312.8ce82a95.js"><link rel="prefetch" href="/docs/assets/js/313.8797f12a.js"><link rel="prefetch" href="/docs/assets/js/314.7680a152.js"><link rel="prefetch" href="/docs/assets/js/315.2431f65b.js"><link rel="prefetch" href="/docs/assets/js/316.f9c0780b.js"><link rel="prefetch" href="/docs/assets/js/317.0753f9d4.js"><link rel="prefetch" href="/docs/assets/js/318.0d6283d8.js"><link rel="prefetch" href="/docs/assets/js/319.b3fba826.js"><link rel="prefetch" href="/docs/assets/js/32.eb07b049.js"><link rel="prefetch" href="/docs/assets/js/320.c42a4d63.js"><link rel="prefetch" href="/docs/assets/js/321.3ee09706.js"><link rel="prefetch" href="/docs/assets/js/322.945ea232.js"><link rel="prefetch" href="/docs/assets/js/323.64a6d759.js"><link rel="prefetch" href="/docs/assets/js/324.fc6a1c8a.js"><link rel="prefetch" href="/docs/assets/js/325.9f4c2b89.js"><link rel="prefetch" href="/docs/assets/js/326.208b530e.js"><link rel="prefetch" href="/docs/assets/js/327.bab78ebb.js"><link rel="prefetch" href="/docs/assets/js/328.cec6d52d.js"><link rel="prefetch" href="/docs/assets/js/329.78bf1913.js"><link rel="prefetch" href="/docs/assets/js/33.d729d7d7.js"><link rel="prefetch" href="/docs/assets/js/330.0ba5fcdb.js"><link rel="prefetch" href="/docs/assets/js/331.7f1b33f8.js"><link rel="prefetch" href="/docs/assets/js/332.b4f4d011.js"><link rel="prefetch" href="/docs/assets/js/333.75aa3f4b.js"><link rel="prefetch" href="/docs/assets/js/334.27c8e955.js"><link rel="prefetch" href="/docs/assets/js/335.5c66cf0d.js"><link rel="prefetch" href="/docs/assets/js/336.e3ea0593.js"><link rel="prefetch" href="/docs/assets/js/337.f385161e.js"><link rel="prefetch" href="/docs/assets/js/338.a0b09a9f.js"><link rel="prefetch" href="/docs/assets/js/339.ef4efe90.js"><link rel="prefetch" href="/docs/assets/js/34.192fb937.js"><link rel="prefetch" href="/docs/assets/js/340.e9e69e1e.js"><link rel="prefetch" href="/docs/assets/js/341.c6b48e3f.js"><link rel="prefetch" href="/docs/assets/js/342.1a8bcea9.js"><link rel="prefetch" href="/docs/assets/js/343.43fc85b7.js"><link rel="prefetch" href="/docs/assets/js/344.239967f8.js"><link rel="prefetch" href="/docs/assets/js/345.eff90202.js"><link rel="prefetch" href="/docs/assets/js/346.0e970470.js"><link rel="prefetch" href="/docs/assets/js/347.ecdbf370.js"><link rel="prefetch" href="/docs/assets/js/348.5cb58a84.js"><link rel="prefetch" href="/docs/assets/js/349.e838b9a2.js"><link rel="prefetch" href="/docs/assets/js/35.36ca9d2a.js"><link rel="prefetch" href="/docs/assets/js/350.b9699c24.js"><link rel="prefetch" href="/docs/assets/js/351.e7ed0704.js"><link rel="prefetch" href="/docs/assets/js/352.4e10e00e.js"><link rel="prefetch" href="/docs/assets/js/353.72756098.js"><link rel="prefetch" href="/docs/assets/js/354.cb174118.js"><link rel="prefetch" href="/docs/assets/js/355.e2f54886.js"><link rel="prefetch" href="/docs/assets/js/356.fb6621f5.js"><link rel="prefetch" href="/docs/assets/js/357.8ca3bd26.js"><link rel="prefetch" href="/docs/assets/js/358.e8a397ef.js"><link rel="prefetch" href="/docs/assets/js/359.d724daff.js"><link rel="prefetch" href="/docs/assets/js/36.239e7e0e.js"><link rel="prefetch" href="/docs/assets/js/360.76854f81.js"><link rel="prefetch" href="/docs/assets/js/361.fa954f86.js"><link rel="prefetch" href="/docs/assets/js/362.62a7e7a9.js"><link rel="prefetch" href="/docs/assets/js/363.159efd9f.js"><link rel="prefetch" href="/docs/assets/js/364.52ff2b6f.js"><link rel="prefetch" href="/docs/assets/js/365.e6d8fa09.js"><link rel="prefetch" href="/docs/assets/js/366.bf868ed9.js"><link rel="prefetch" href="/docs/assets/js/367.17fb9689.js"><link rel="prefetch" href="/docs/assets/js/368.8446de5b.js"><link rel="prefetch" href="/docs/assets/js/369.2b8c5810.js"><link rel="prefetch" href="/docs/assets/js/37.d9ff0f03.js"><link rel="prefetch" href="/docs/assets/js/370.979fac1d.js"><link rel="prefetch" href="/docs/assets/js/371.8753fcfd.js"><link rel="prefetch" href="/docs/assets/js/372.29676929.js"><link rel="prefetch" href="/docs/assets/js/373.fba1275c.js"><link rel="prefetch" href="/docs/assets/js/374.db27db66.js"><link rel="prefetch" href="/docs/assets/js/375.8f439fcb.js"><link rel="prefetch" href="/docs/assets/js/376.1a134802.js"><link rel="prefetch" href="/docs/assets/js/377.57da785f.js"><link rel="prefetch" href="/docs/assets/js/378.6e594432.js"><link rel="prefetch" href="/docs/assets/js/379.7b9614c7.js"><link rel="prefetch" href="/docs/assets/js/38.91865d67.js"><link rel="prefetch" href="/docs/assets/js/380.f5aa8233.js"><link rel="prefetch" href="/docs/assets/js/381.eb32e254.js"><link rel="prefetch" href="/docs/assets/js/382.abd5714b.js"><link rel="prefetch" href="/docs/assets/js/383.f6c224bc.js"><link rel="prefetch" href="/docs/assets/js/384.3e314c09.js"><link rel="prefetch" href="/docs/assets/js/385.9793d419.js"><link rel="prefetch" href="/docs/assets/js/386.c100d8bf.js"><link rel="prefetch" href="/docs/assets/js/387.896d5316.js"><link rel="prefetch" href="/docs/assets/js/388.90a686d2.js"><link rel="prefetch" href="/docs/assets/js/389.e0c3f946.js"><link rel="prefetch" href="/docs/assets/js/39.3da874c6.js"><link rel="prefetch" href="/docs/assets/js/390.bdfdd65b.js"><link rel="prefetch" href="/docs/assets/js/391.80ac185f.js"><link rel="prefetch" href="/docs/assets/js/392.2d6f2220.js"><link rel="prefetch" href="/docs/assets/js/393.0506776c.js"><link rel="prefetch" href="/docs/assets/js/394.aceb0069.js"><link rel="prefetch" href="/docs/assets/js/395.cc2150e4.js"><link rel="prefetch" href="/docs/assets/js/396.4c68311f.js"><link rel="prefetch" href="/docs/assets/js/397.311ee8f4.js"><link rel="prefetch" href="/docs/assets/js/398.ad1bda1e.js"><link rel="prefetch" href="/docs/assets/js/399.98904623.js"><link rel="prefetch" href="/docs/assets/js/4.cdf4c6b0.js"><link rel="prefetch" href="/docs/assets/js/40.201c5fd0.js"><link rel="prefetch" href="/docs/assets/js/400.8178741e.js"><link rel="prefetch" href="/docs/assets/js/401.81e92e25.js"><link rel="prefetch" href="/docs/assets/js/402.260618b5.js"><link rel="prefetch" href="/docs/assets/js/403.652d3204.js"><link rel="prefetch" href="/docs/assets/js/404.71b21885.js"><link rel="prefetch" href="/docs/assets/js/405.97b0cd63.js"><link rel="prefetch" href="/docs/assets/js/406.68bb2b4b.js"><link rel="prefetch" href="/docs/assets/js/407.7b5af9b2.js"><link rel="prefetch" href="/docs/assets/js/408.4c29ba77.js"><link rel="prefetch" href="/docs/assets/js/409.5b2d3410.js"><link rel="prefetch" href="/docs/assets/js/41.eed9a4f9.js"><link rel="prefetch" href="/docs/assets/js/410.9d3f2b70.js"><link rel="prefetch" href="/docs/assets/js/411.7b2db68c.js"><link rel="prefetch" href="/docs/assets/js/412.d93030fe.js"><link rel="prefetch" href="/docs/assets/js/413.acd39562.js"><link rel="prefetch" href="/docs/assets/js/414.fcd10c31.js"><link rel="prefetch" href="/docs/assets/js/415.90adeef3.js"><link rel="prefetch" href="/docs/assets/js/416.df40d9ab.js"><link rel="prefetch" href="/docs/assets/js/417.5dd116e9.js"><link rel="prefetch" href="/docs/assets/js/418.be92f3bf.js"><link rel="prefetch" href="/docs/assets/js/419.0952649b.js"><link rel="prefetch" href="/docs/assets/js/42.2a30262c.js"><link rel="prefetch" href="/docs/assets/js/420.ea081aef.js"><link rel="prefetch" href="/docs/assets/js/421.a6187441.js"><link rel="prefetch" href="/docs/assets/js/422.5db06a1b.js"><link rel="prefetch" href="/docs/assets/js/423.bc919b0b.js"><link rel="prefetch" href="/docs/assets/js/424.e79f8a73.js"><link rel="prefetch" href="/docs/assets/js/425.18f92822.js"><link rel="prefetch" href="/docs/assets/js/426.84a4e14f.js"><link rel="prefetch" href="/docs/assets/js/427.9793eee6.js"><link rel="prefetch" href="/docs/assets/js/428.19c74252.js"><link rel="prefetch" href="/docs/assets/js/429.da63d7bc.js"><link rel="prefetch" href="/docs/assets/js/43.1f73b497.js"><link rel="prefetch" href="/docs/assets/js/430.4a2a53a0.js"><link rel="prefetch" href="/docs/assets/js/431.b7d9c83e.js"><link rel="prefetch" href="/docs/assets/js/432.da196c85.js"><link rel="prefetch" href="/docs/assets/js/433.3bb5c3e5.js"><link rel="prefetch" href="/docs/assets/js/434.6f287391.js"><link rel="prefetch" href="/docs/assets/js/435.ea8a361a.js"><link rel="prefetch" href="/docs/assets/js/436.e929a50a.js"><link rel="prefetch" href="/docs/assets/js/437.1eb7eb83.js"><link rel="prefetch" href="/docs/assets/js/438.c57f5980.js"><link rel="prefetch" href="/docs/assets/js/439.98d73286.js"><link rel="prefetch" href="/docs/assets/js/44.0f5f9473.js"><link rel="prefetch" href="/docs/assets/js/440.75769d76.js"><link rel="prefetch" href="/docs/assets/js/441.c75ad46d.js"><link rel="prefetch" href="/docs/assets/js/442.e3c61bf0.js"><link rel="prefetch" href="/docs/assets/js/443.f0d4ebaf.js"><link rel="prefetch" href="/docs/assets/js/444.5480538e.js"><link rel="prefetch" href="/docs/assets/js/445.2edc5bd8.js"><link rel="prefetch" href="/docs/assets/js/446.33195bf6.js"><link rel="prefetch" href="/docs/assets/js/447.0bb15059.js"><link rel="prefetch" href="/docs/assets/js/448.bd79862a.js"><link rel="prefetch" href="/docs/assets/js/449.6539ce41.js"><link rel="prefetch" href="/docs/assets/js/45.87792bf8.js"><link rel="prefetch" href="/docs/assets/js/450.451f3e43.js"><link rel="prefetch" href="/docs/assets/js/451.e3268a5d.js"><link rel="prefetch" href="/docs/assets/js/452.e0d4ebbb.js"><link rel="prefetch" href="/docs/assets/js/453.6d9bcd1c.js"><link rel="prefetch" href="/docs/assets/js/454.c3f7b3a8.js"><link rel="prefetch" href="/docs/assets/js/455.de224c3f.js"><link rel="prefetch" href="/docs/assets/js/456.be04f107.js"><link rel="prefetch" href="/docs/assets/js/457.6dd11a5e.js"><link rel="prefetch" href="/docs/assets/js/458.3dfd7bb9.js"><link rel="prefetch" href="/docs/assets/js/459.ee620072.js"><link rel="prefetch" href="/docs/assets/js/46.df4d3f86.js"><link rel="prefetch" href="/docs/assets/js/460.e037bf69.js"><link rel="prefetch" href="/docs/assets/js/461.758a1985.js"><link rel="prefetch" href="/docs/assets/js/462.1ca4a46b.js"><link rel="prefetch" href="/docs/assets/js/463.6865a66d.js"><link rel="prefetch" href="/docs/assets/js/464.6ee4cc8c.js"><link rel="prefetch" href="/docs/assets/js/465.4950caac.js"><link rel="prefetch" href="/docs/assets/js/466.a54d7a11.js"><link rel="prefetch" href="/docs/assets/js/467.5eb079bf.js"><link rel="prefetch" href="/docs/assets/js/468.4b8a35a8.js"><link rel="prefetch" href="/docs/assets/js/469.c8104a66.js"><link rel="prefetch" href="/docs/assets/js/47.a234216e.js"><link rel="prefetch" href="/docs/assets/js/470.4ae322cd.js"><link rel="prefetch" href="/docs/assets/js/471.712a1520.js"><link rel="prefetch" href="/docs/assets/js/472.4c19b1a8.js"><link rel="prefetch" href="/docs/assets/js/473.e4eac5e9.js"><link rel="prefetch" href="/docs/assets/js/474.dffc70a9.js"><link rel="prefetch" href="/docs/assets/js/475.831a95f0.js"><link rel="prefetch" href="/docs/assets/js/476.8e909fff.js"><link rel="prefetch" href="/docs/assets/js/477.ddbb702b.js"><link rel="prefetch" href="/docs/assets/js/478.b2f05527.js"><link rel="prefetch" href="/docs/assets/js/479.1ff75abb.js"><link rel="prefetch" href="/docs/assets/js/48.2c00a94a.js"><link rel="prefetch" href="/docs/assets/js/480.9df2852a.js"><link rel="prefetch" href="/docs/assets/js/481.0eda6e8d.js"><link rel="prefetch" href="/docs/assets/js/482.28965df2.js"><link rel="prefetch" href="/docs/assets/js/483.4a4aa2ee.js"><link rel="prefetch" href="/docs/assets/js/484.e45ca90d.js"><link rel="prefetch" href="/docs/assets/js/485.94b7958f.js"><link rel="prefetch" href="/docs/assets/js/486.da64d8a5.js"><link rel="prefetch" href="/docs/assets/js/487.5fc64593.js"><link rel="prefetch" href="/docs/assets/js/488.f3d0ee7b.js"><link rel="prefetch" href="/docs/assets/js/489.2ea7038e.js"><link rel="prefetch" href="/docs/assets/js/49.5bad77b6.js"><link rel="prefetch" href="/docs/assets/js/490.f25078a0.js"><link rel="prefetch" href="/docs/assets/js/491.cf87b1c6.js"><link rel="prefetch" href="/docs/assets/js/492.6e0d93fb.js"><link rel="prefetch" href="/docs/assets/js/493.f5df4999.js"><link rel="prefetch" href="/docs/assets/js/494.93646b48.js"><link rel="prefetch" href="/docs/assets/js/495.d2005128.js"><link rel="prefetch" href="/docs/assets/js/496.6e4bdd12.js"><link rel="prefetch" href="/docs/assets/js/497.65590470.js"><link rel="prefetch" href="/docs/assets/js/498.9944dfbc.js"><link rel="prefetch" href="/docs/assets/js/5.61d14c9e.js"><link rel="prefetch" href="/docs/assets/js/50.9b4823b1.js"><link rel="prefetch" href="/docs/assets/js/51.019f560a.js"><link rel="prefetch" href="/docs/assets/js/52.e2d8070c.js"><link rel="prefetch" href="/docs/assets/js/53.fbe8be6a.js"><link rel="prefetch" href="/docs/assets/js/54.86706acd.js"><link rel="prefetch" href="/docs/assets/js/55.971f0a66.js"><link rel="prefetch" href="/docs/assets/js/56.a87f60a1.js"><link rel="prefetch" href="/docs/assets/js/57.eca2964c.js"><link rel="prefetch" href="/docs/assets/js/58.79fb9819.js"><link rel="prefetch" href="/docs/assets/js/59.d7c20bee.js"><link rel="prefetch" href="/docs/assets/js/6.e78c4b18.js"><link rel="prefetch" href="/docs/assets/js/60.408ffa4a.js"><link rel="prefetch" href="/docs/assets/js/61.e5bc5b2c.js"><link rel="prefetch" href="/docs/assets/js/62.5d386e65.js"><link rel="prefetch" href="/docs/assets/js/63.6d88e27a.js"><link rel="prefetch" href="/docs/assets/js/64.40a323b9.js"><link rel="prefetch" href="/docs/assets/js/65.bfab9546.js"><link rel="prefetch" href="/docs/assets/js/66.6775401a.js"><link rel="prefetch" href="/docs/assets/js/67.fb9c10c1.js"><link rel="prefetch" href="/docs/assets/js/68.e06920eb.js"><link rel="prefetch" href="/docs/assets/js/7.8375f159.js"><link rel="prefetch" href="/docs/assets/js/70.d6a73f92.js"><link rel="prefetch" href="/docs/assets/js/71.6ebf31b6.js"><link rel="prefetch" href="/docs/assets/js/72.7c79570d.js"><link rel="prefetch" href="/docs/assets/js/73.2e51be73.js"><link rel="prefetch" href="/docs/assets/js/74.8e14d4b5.js"><link rel="prefetch" href="/docs/assets/js/75.1297d3f5.js"><link rel="prefetch" href="/docs/assets/js/77.f06c8903.js"><link rel="prefetch" href="/docs/assets/js/78.346b4198.js"><link rel="prefetch" href="/docs/assets/js/79.af811145.js"><link rel="prefetch" href="/docs/assets/js/8.30138092.js"><link rel="prefetch" href="/docs/assets/js/80.018eca04.js"><link rel="prefetch" href="/docs/assets/js/81.471f2bbf.js"><link rel="prefetch" href="/docs/assets/js/82.2e6524d9.js"><link rel="prefetch" href="/docs/assets/js/83.e14ce0dc.js"><link rel="prefetch" href="/docs/assets/js/84.66ce611f.js"><link rel="prefetch" href="/docs/assets/js/85.1b98f1c5.js"><link rel="prefetch" href="/docs/assets/js/86.891336fe.js"><link rel="prefetch" href="/docs/assets/js/87.05a63d7d.js"><link rel="prefetch" href="/docs/assets/js/88.c080bbc4.js"><link rel="prefetch" href="/docs/assets/js/89.2dc8c05f.js"><link rel="prefetch" href="/docs/assets/js/9.9465e8f3.js"><link rel="prefetch" href="/docs/assets/js/90.bf42ee14.js"><link rel="prefetch" href="/docs/assets/js/91.cb0cf1eb.js"><link rel="prefetch" href="/docs/assets/js/92.8ef7b25f.js"><link rel="prefetch" href="/docs/assets/js/93.5271594d.js"><link rel="prefetch" href="/docs/assets/js/94.d8f3e343.js"><link rel="prefetch" href="/docs/assets/js/95.d32b9fbc.js"><link rel="prefetch" href="/docs/assets/js/96.20dacdff.js"><link rel="prefetch" href="/docs/assets/js/97.332632d9.js"><link rel="prefetch" href="/docs/assets/js/98.71dd7d47.js"><link rel="prefetch" href="/docs/assets/js/99.89c0c496.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.6292c5a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>System Design Case Studies</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/notification/" class="sidebar-link">Design a notification system</a></li><li><a href="/docs/kungfu/case-study/metrics/" class="sidebar-link">Metrics Monitoring &amp; Alerting System</a></li><li><a href="/docs/kungfu/case-study/ad-click/" class="sidebar-link">Ad Click Event Aggregation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Data storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Online tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Booking System</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Social Network</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Location-based</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/proximity-service/" aria-current="page" class="sidebar-link">Proximity Service</a></li><li><a href="/docs/kungfu/case-study/proximity-service/part2/" aria-current="page" class="active sidebar-link">Designing Yelp or Nearby Friends</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_1-why-yelp-or-proximity-server" class="sidebar-link">1. Why Yelp or Proximity Server?</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_2-requirements-and-goals-of-the-system" class="sidebar-link">2. Requirements and Goals of the System</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_3-scale-estimation" class="sidebar-link">3. Scale Estimation</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_4-database-schema" class="sidebar-link">4. Database Schema</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_5-system-apis" class="sidebar-link">5. System APIs</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_6-basic-system-design-and-algorithm" class="sidebar-link">6. Basic System Design and Algorithm</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_7-data-partitioning" class="sidebar-link">7. Data Partitioning</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_8-replication-and-fault-tolerance" class="sidebar-link">8. Replication and Fault Tolerance</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_9-cache" class="sidebar-link">9. Cache</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_10-load-balancing-lb" class="sidebar-link">10. Load Balancing (LB)</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/proximity-service/part2/#_11-ranking" class="sidebar-link">11. Ranking</a></li></ul></li><li><a href="/docs/kungfu/case-study/nearby-friends/" class="sidebar-link">Nearby Friends</a></li><li><a href="/docs/kungfu/case-study/google-maps/" class="sidebar-link">Design Google Maps</a></li><li><a href="/docs/kungfu/case-study/uber/" class="sidebar-link">Design Uber</a></li><li><a href="/docs/kungfu/case-study/uber/part2/" class="sidebar-link">Design Uber (2nd)</a></li><li><a href="/docs/kungfu/case-study/grab-nearby-drivers/" class="sidebar-link">Pharos - Searching Nearby Drivers on Road Network at Scale</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Video</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Chat system</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Go</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="designing-yelp-or-nearby-friends"><a href="#designing-yelp-or-nearby-friends" class="header-anchor">#</a> Designing Yelp or Nearby Friends</h1> <p>Let's design a Yelp like service, where users can search for nearby places like restaurants, theaters, or
shopping malls, etc., and can also add/view reviews of places. Similar Services: Proximity server.
Difficulty Level: Hard</p> <h2 id="_1-why-yelp-or-proximity-server"><a href="#_1-why-yelp-or-proximity-server" class="header-anchor">#</a> 1. Why Yelp or Proximity Server?</h2> <p>Proximity servers are used to discover nearby attractions like places, events, etc. If you haven’t used
yelp.com before, please try it before proceeding (you can search for nearby restaurants, theaters, etc.)
and spend some time understanding different options that the website offers. This will help you a lot in
understanding this chapter better.</p> <h2 id="_2-requirements-and-goals-of-the-system"><a href="#_2-requirements-and-goals-of-the-system" class="header-anchor">#</a> 2. Requirements and Goals of the System</h2> <p>What do we wish to achieve from a Yelp like service? Our service will be storing information about
different places so that users can perform a search on them. Upon querying, our service will return a list
of places around the user.</p> <p>Our Yelp-like service should meet the following requirements:</p> <h3 id="functional-requirements"><a href="#functional-requirements" class="header-anchor">#</a> Functional Requirements:</h3> <ol><li>Users should be able to add/delete/update Places.</li> <li>Given their location (longitude/latitude), users should be able to find all nearby places within a
given radius.</li> <li>Users should be able to add feedback/review about a place. The feedback can have pictures,
text, and a rating.</li></ol> <h3 id="non-functional-requirements"><a href="#non-functional-requirements" class="header-anchor">#</a> Non-functional Requirements:</h3> <ol><li>Users should have a real-time search experience with minimum latency.</li> <li>Our service should support a heavy search load. There will be a lot of search requests compared
to adding a new place.</li></ol> <h2 id="_3-scale-estimation"><a href="#_3-scale-estimation" class="header-anchor">#</a> 3. Scale Estimation</h2> <p>Let’s build our system assuming that we have 500M places and 100K queries per second (QPS). Let’s
also assume a 20% growth in the number of places and QPS each year.</p> <h2 id="_4-database-schema"><a href="#_4-database-schema" class="header-anchor">#</a> 4. Database Schema</h2> <p>Each location can have the following fields:</p> <ol><li>LocationID (8 bytes): Uniquely identifies a location.</li> <li>Name (256 bytes)</li> <li>Latitude (8 bytes)</li> <li>Longitude (8 bytes)</li> <li>Description (512 bytes)</li> <li>Category (1 byte): E.g., coffee shop, restaurant, theater, etc.</li></ol> <p>Although a four bytes number can uniquely identify 500M locations, with future growth in mind, we
will go with 8 bytes for LocationID.</p> <p>Total size: 8 + 256 + 8 + 8 + 512 + 1 =&gt; 793 bytes</p> <p>We also need to store reviews, photos, and ratings of a Place. We can have a separate table to store
reviews for Places:</p> <ol><li>LocationID (8 bytes)</li> <li>ReviewID (4 bytes): Uniquely identifies a review, assuming any location will not have more than 2^32 reviews.</li> <li>ReviewText (512 bytes)</li> <li>Rating (1 byte): how many stars a place gets out of ten.</li></ol> <p>Similarly, we can have a separate table to store photos for Places and Reviews.</p> <h2 id="_5-system-apis"><a href="#_5-system-apis" class="header-anchor">#</a> 5. System APIs</h2> <p>We can have SOAP or REST APIs to expose the functionality of our service. The following could be
the definition of the API for searching:</p> <p><code>search(api_dev_key, search_terms, user_location, radius_filter, maximum_results_to_return, category_filter, sort, page_token)</code></p> <p><strong>Parameters</strong>:</p> <ul><li>api_dev_key (string): The API developer key of a registered account. This will be used to, among other things, throttle users based on their allocated quota.</li> <li>search_terms (string): A string containing the search terms.</li> <li>user_location (string): Location of the user performing the search.</li> <li>radius_filter (number): Optional search radius in meters.</li> <li>maximum_results_to_return (number): Number of business results to return.</li> <li>category_filter (string): Optional category to filter search results, e.g., Restaurants, Shopping Centers, etc.</li> <li>sort (number): Optional sort mode:
<ul><li>Best matched (0 - default)</li> <li>Minimum distance (1)</li> <li>Highest rated (2).</li></ul></li> <li>page_token (string): This token will specify a page in the result set that should be returned.</li></ul> <p><strong>Returns</strong>: (JSON)<br>
A JSON containing information about a list of businesses matching the search query. Each result entry
will have the business name, address, category, rating, and thumbnail.</p> <h2 id="_6-basic-system-design-and-algorithm"><a href="#_6-basic-system-design-and-algorithm" class="header-anchor">#</a> 6. Basic System Design and Algorithm</h2> <p>At a high level, we need to store and index each dataset described above (places, reviews, etc.). For
users to query this massive database, the indexing should be read efficient, since while searching for
the nearby places users expect to see the results in real-time.</p> <p>Given that the location of a place doesn’t change that often, we don’t need to worry about frequent
updates of the data. As a contrast, if we intend to build a service where objects do change their location
frequently, e.g., people or taxis, then we might come up with a very different design.</p> <p>Let’s see what are different ways to store this data and also find out which method will suit best for our
use cases:</p> <h3 id="a-sql-solution"><a href="#a-sql-solution" class="header-anchor">#</a> a. SQL solution</h3> <p>One simple solution could be to store all the data in a database like MySQL. Each place will be stored
in a separate row, uniquely identified by LocationID. Each place will have its longitude and latitude
stored separately in two different columns, and to perform a fast search; we should have indexes on
both these fields.</p> <p>To find all the nearby places of a given location (X, Y) within a radius ‘D’, we can query like this:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Places 
<span class="token keyword">where</span> Latitude <span class="token operator">between</span> X<span class="token operator">-</span>D <span class="token operator">and</span> X<span class="token operator">+</span>D <span class="token operator">and</span> Longitude <span class="token operator">between</span> Y<span class="token operator">-</span>D <span class="token operator">and</span> Y<span class="token operator">+</span>D
</code></pre></div><p>The above query is not completely accurate, as we know that to find the distance between two points
we have to use the distance formula (Pythagorean theorem), but for simplicity let’s take this.</p> <p><strong>How efficient would this query be?</strong> We have estimated 500M places to be stored in our service. Since
we have two separate indexes, each index can return a huge list of places and performing an
intersection on those two lists won’t be efficient. Another way to look at this problem is that there could
be too many locations between ‘X-D’ and ‘X+D’, and similarly between ‘Y-D’ and ‘Y+D’. If we can
somehow shorten these lists, it can improve the performance of our query.</p> <h3 id="b-grids"><a href="#b-grids" class="header-anchor">#</a> b. Grids</h3> <p>We can divide the whole map into smaller grids to group locations into smaller sets. Each grid will
store all the Places residing within a specific range of longitude and latitude. This scheme would enable
us to query only a few grids to find nearby places. Based on a given location and radius, we can find all
the neighboring grids and then query these grids to find nearby places.</p> <p><img src="/docs/assets/img/26.8a9d590d.png" alt="img"></p> <p>Let’s assume that GridID (a four bytes number) would uniquely identify grids in our system.</p> <p><strong>What could be a reasonable grid size?</strong> Grid size could be equal to the distance we would like to
query since we also want to reduce the number of grids. If the grid size is equal to the distance we want
to query, then we only need to search within the grid which contains the given location and neighboring
eight grids. Since our grids would be statically defined (from the fixed grid size), we can easily find the
grid number of any location (lat, long) and its neighboring grids.</p> <p>In the database, we can store the GridID with each location and have an index on it, too, for faster
searching. Now, our query will look like:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Places 
<span class="token keyword">where</span> Latitude <span class="token operator">between</span> X<span class="token operator">-</span>D <span class="token operator">and</span> X<span class="token operator">+</span>D <span class="token operator">and</span> Longitude <span class="token operator">between</span> Y<span class="token operator">-</span>D <span class="token operator">and</span> Y<span class="token operator">+</span>D <span class="token operator">and</span>
    GridID <span class="token operator">in</span> <span class="token punctuation">(</span>GridID<span class="token punctuation">,</span> GridID1<span class="token punctuation">,</span> GridID2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> GridID8<span class="token punctuation">)</span>
</code></pre></div><p>This will undoubtedly improve the runtime of our query.</p> <p><strong>Should we keep our index in memory?</strong> Maintaining the index in memory will improve the
performance of our service. We can keep our index in a hash table where ‘key’ is the grid number and
‘value’ is the list of places contained in that grid.</p> <p><strong>How much memory will we need to store the index?</strong> Let’s assume our search radius is 10 miles;
given that the total area of the earth is around 200 million square miles, we will have 20 million grids.
We would need a four bytes number to uniquely identify each grid and, since LocationID is 8 bytes, we
would need 4GB of memory (ignoring hash table overhead) to store the index.</p> <div class="language- extra-class"><pre class="language-text"><code>(4 * 20M) + (8 * 500M) ~= 4 GB
</code></pre></div><p>This solution can still run slow for those grids that have a lot of places since our places are not
uniformly distributed among grids. We can have a thickly dense area with a lot of places, and on the
other hand, we can have areas which are sparsely populated.</p> <p>This problem can be solved if we can dynamically adjust our grid size such that whenever we have a
grid with a lot of places we break it down to create smaller grids. A couple of challenges with this
approach could be:</p> <ol><li>how to map these grids to locations and</li> <li>how to find all the neighboring grids of a grid.</li></ol> <h3 id="c-dynamic-size-grids"><a href="#c-dynamic-size-grids" class="header-anchor">#</a> c. Dynamic size grids</h3> <p>Let’s assume we don’t want to have more than 500 places in a grid so that we can have a faster
searching. So, whenever a grid reaches this limit, we break it down into four grids of equal size and
distribute places among them. This means thickly populated areas like downtown San Francisco will
have a lot of grids, and sparsely populated area like the Pacific Ocean will have large grids with places
only around the coastal lines.</p> <p><strong>What data-structure can hold this information?</strong> A tree in which each node has four children can
serve our purpose. Each node will represent a grid and will contain information about all the places in
that grid. If a node reaches our limit of 500 places, we will break it down to create four child nodes
under it and distribute places among them. In this way, all the leaf nodes will represent the grids that
cannot be further broken down. So leaf nodes will keep a list of places with them. This tree structure in
which each node can have four children is called a <a href="https://en.wikipedia.org/wiki/Quadtree" target="_blank" rel="noopener noreferrer">QuadTree<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/docs/assets/img/27.d32c3002.png" alt="img"></p> <p><strong>How will we build a QuadTree?</strong> We will start with one node that will represent the whole world in
one grid. Since it will have more than 500 locations, we will break it down into four nodes and
distribute locations among them. We will keep repeating this process with each child node until there
are no nodes left with more than 500 locations.</p> <p><strong>How will we find the grid for a given location?</strong> We will start with the root node and search
downward to find our required node/grid. At each step, we will see if the current node we are visiting
has children. If it has, we will move to the child node that contains our desired location and repeat this
process. If the node does not have any children, then that is our desired node.</p> <p><strong>How will we find neighboring grids of a given grid?</strong> Since only leaf nodes contain a list of locations,
we can connect all leaf nodes with a doubly linked list. This way we can iterate forward or backward
among the neighboring leaf nodes to find out our desired locations. Another approach for finding
adjacent grids would be through parent nodes. We can keep a pointer in each node to access its parent,
and since each parent node has pointers to all of its children, we can easily find siblings of a node. We
can keep expanding our search for neighboring grids by going up through the parent pointers.</p> <p>Once we have nearby LocationIDs, we can query the backend database to find details about those
places.</p> <p><strong>What will be the search workflow?</strong> We will first find the node that contains the user’s location. If that
node has enough desired places, we can return them to the user. If not, we will keep expanding to the
neighboring nodes (either through the parent pointers or doubly linked list) until either we find the
required number of places or exhaust our search based on the maximum radius.</p> <p><strong>How much memory will be needed to store the QuadTree?</strong> For each Place, if we cache only
LocationID and Lat/Long, we would need 12GB to store all places.</p> <div class="language- extra-class"><pre class="language-text"><code>24 * 500M =&gt; 12 GB 
</code></pre></div><p>Since each grid can have a maximum of 500 places, and we have 500M locations, how many total grids
we will have?</p> <div class="language- extra-class"><pre class="language-text"><code>500M / 500 =&gt; 1M grids
</code></pre></div><p>Which means we will have 1M leaf nodes and they will be holding 12GB of location data. A QuadTree
with 1M leaf nodes will have approximately 1/3rd internal nodes, and each internal node will have 4
pointers (for its children). If each pointer is 8 bytes, then the memory we need to store all internal
nodes would be:</p> <div class="language- extra-class"><pre class="language-text"><code>1M * 1/3 * 4 * 8 = 10 MB
</code></pre></div><p>So, total memory required to hold the whole QuadTree would be 12.01GB. This can easily fit into a
modern-day server.</p> <p><strong>How would we insert a new Place into our system?</strong> Whenever a new Place is added by a user, we
need to insert it into the databases as well as in the QuadTree. If our tree resides on one server, it is easy
to add a new Place, but if the QuadTree is distributed among different servers, first we need to find the
grid/server of the new Place and then add it there (discussed in the next section).</p> <h2 id="_7-data-partitioning"><a href="#_7-data-partitioning" class="header-anchor">#</a> 7. Data Partitioning</h2> <p>What if we have a huge number of places such that our index does not fit into a single machine’s
memory? With 20% growth each year we will reach the memory limit of the server in the future. Also,
what if one server cannot serve the desired read traffic? To resolve these issues, we must partition our
QuadTree!</p> <p>We will explore two solutions here (both of these partitioning schemes can be applied to databases, too):</p> <p><strong>a. Sharding based on regions</strong>: We can divide our places into regions (like zip codes), such that all
places belonging to a region will be stored on a fixed node. To store a place we will find the server
through its region and, similarly, while querying for nearby places we will ask the region server that
contains user’s location. This approach has a couple of issues:</p> <ol><li>What if a region becomes hot? There would be a lot of queries on the server holding that region,
making it perform slow. This will affect the performance of our service.</li> <li>Over time, some regions can end up storing a lot of places compared to others. Hence,
maintaining a uniform distribution of places, while regions are growing is quite difficult.
To recover from these situations, either we have to repartition our data or use consistent hashing.</li></ol> <p><strong>b. Sharding based on LocationID:</strong> Our hash function will map each LocationID to a server where we
will store that place. While building our QuadTree, we will iterate through all the places and calculate
the hash of each LocationID to find a server where it would be stored. To find places near a location, we have to query all servers and each server will return a set of nearby places. A centralized server will
aggregate these results to return them to the user.</p> <p><strong>Will we have different QuadTree structure on different partitions?</strong> Yes, this can happen since it is
not guaranteed that we will have an equal number of places in any given grid on all partitions.
However, we do make sure that all servers have approximately an equal number of Places. This
different tree structure on different servers will not cause any issue though, as we will be searching all
the neighboring grids within the given radius on all partitions.</p> <p>The remaining part of this chapter assumes that we have partitioned our data based on LocationID.
<img src="/docs/assets/img/28.f2dc312d.png" alt="img"></p> <h2 id="_8-replication-and-fault-tolerance"><a href="#_8-replication-and-fault-tolerance" class="header-anchor">#</a> 8. Replication and Fault Tolerance</h2> <p>Having replicas of QuadTree servers can provide an alternate to data partitioning. To distribute read
traffic, we can have replicas of each QuadTree server. We can have a master-slave configuration where
replicas (slaves) will only serve read traffic; all write traffic will first go to the master and then applied
to slaves. Slaves might not have some recently inserted places (a few milliseconds delay will be there),
but this could be acceptable.</p> <p>What will happen when a QuadTree server dies? We can have a secondary replica of each server and, if
primary dies, it can take control after the failover. Both primary and secondary servers will have the
same QuadTree structure.</p> <p><strong>What if both primary and secondary servers die at the same time?</strong> We have to allocate a new
server and rebuild the same QuadTree on it. How can we do that, since we don’t know what places
were kept on this server? The brute-force solution would be to iterate through the whole database and
filter LocationIDs using our hash function to figure out all the required places that will be stored on this
server. This would be inefficient and slow; also, during the time when the server is being rebuilt, we
will not be able to serve any query from it, thus missing some places that should have been seen by
users.</p> <p><strong>How can we efficiently retrieve a mapping between Places and QuadTree server?</strong> We have to build
a reverse index that will map all the Places to their QuadTree server. We can have a separate QuadTree
Index server that will hold this information. We will need to build a HashMap where the ‘key’ is the
QuadTree server number and the ‘value’ is a HashSet containing all the Places being kept on that
QuadTree server. We need to store LocationID and Lat/Long with each place because information
servers can build their QuadTrees through this. Notice that we are keeping Places’ data in a HashSet,
this will enable us to add/remove Places from our index quickly. So now, whenever a QuadTree server
needs to rebuild itself, it can simply ask the QuadTree Index server for all the Places it needs to store.
This approach will surely be quite fast. We should also have a replica of the QuadTree Index server for
fault tolerance. If a QuadTree Index server dies, it can always rebuild its index from iterating through
the database.</p> <h2 id="_9-cache"><a href="#_9-cache" class="header-anchor">#</a> 9. Cache</h2> <p>To deal with hot Places, we can introduce a cache in front of our database. We can use an off-the-shelf
solution like Memcache, which can store all data about hot places. Application servers, before hitting
the backend database, can quickly check if the cache has that Place. Based on clients’ usage pattern, we
can adjust how many cache servers we need. For cache eviction policy, Least Recently Used (LRU)
seems suitable for our system.</p> <h2 id="_10-load-balancing-lb"><a href="#_10-load-balancing-lb" class="header-anchor">#</a> 10. Load Balancing (LB)</h2> <p>We can add LB layer at two places in our system 1) Between Clients and Application servers and 2)
Between Application servers and Backend server. Initially, a simple Round Robin approach can be
adopted; that will distribute all incoming requests equally among backend servers. This LB is simple to
implement and does not introduce any overhead. Another benefit of this approach is if a server is dead
the load balancer will take it out of the rotation and will stop sending any traffic to it.
A problem with Round Robin LB is, it won’t take server load into consideration. If a server is
overloaded or slow, the load balancer will not stop sending new requests to that server. To handle this, a
more intelligent LB solution would be needed that periodically queries backend server about their load
and adjusts traffic based on that.</p> <h2 id="_11-ranking"><a href="#_11-ranking" class="header-anchor">#</a> 11. Ranking</h2> <p>How about if we want to rank the search results not just by proximity but also by popularity or relevance?</p> <p><strong>How can we return most popular places within a given radius?</strong> Let’s assume we keep track of the
overall popularity of each place. An aggregated number can represent this popularity in our system,
e.g., how many stars a place gets out of ten (this would be an average of different rankings given by
users)? We will store this number in the database as well as in the QuadTree. While searching for the
top 100 places within a given radius, we can ask each partition of the QuadTree to return the top 100 places with maximum popularity. Then the aggregator server can determine the top 100 places among
all the places returned by different partitions.</p> <p>Remember that we didn’t build our system to update place’s data frequently. With this design, how can
we modify the popularity of a place in our QuadTree? Although we can search a place and update its
popularity in the QuadTree, it would take a lot of resources and can affect search requests and system
throughput. Assuming the popularity of a place is not expected to reflect in the system within a few
hours, we can decide to update it once or twice a day, especially when the load on the system is
minimum.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/case-study/proximity-service/" class="prev router-link-active">
        Proximity Service
      </a></span> <span class="next"><a href="/docs/kungfu/case-study/nearby-friends/">
        Nearby Friends
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.f6cd25ab.js" defer></script><script src="/docs/assets/js/2.1680c3d7.js" defer></script><script src="/docs/assets/js/69.4f7f34ff.js" defer></script><script src="/docs/assets/js/76.fcb20251.js" defer></script>
  </body>
</html>
