<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Design Twitter | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.6292c5a4.css" as="style"><link rel="preload" href="/docs/assets/js/app.f6cd25ab.js" as="script"><link rel="preload" href="/docs/assets/js/2.1680c3d7.js" as="script"><link rel="preload" href="/docs/assets/js/32.eb07b049.js" as="script"><link rel="preload" href="/docs/assets/js/76.fcb20251.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.ab4e6af2.js"><link rel="prefetch" href="/docs/assets/js/100.934b3b2a.js"><link rel="prefetch" href="/docs/assets/js/101.1f4b2067.js"><link rel="prefetch" href="/docs/assets/js/102.3e54a57a.js"><link rel="prefetch" href="/docs/assets/js/103.add6f2b4.js"><link rel="prefetch" href="/docs/assets/js/104.9f7aee43.js"><link rel="prefetch" href="/docs/assets/js/105.f083cc0a.js"><link rel="prefetch" href="/docs/assets/js/106.14c21fa6.js"><link rel="prefetch" href="/docs/assets/js/107.0d1592cc.js"><link rel="prefetch" href="/docs/assets/js/108.0460b897.js"><link rel="prefetch" href="/docs/assets/js/109.f5ed2be4.js"><link rel="prefetch" href="/docs/assets/js/11.f19f398c.js"><link rel="prefetch" href="/docs/assets/js/110.2537fc2d.js"><link rel="prefetch" href="/docs/assets/js/111.8dfa7e42.js"><link rel="prefetch" href="/docs/assets/js/112.4b4d0888.js"><link rel="prefetch" href="/docs/assets/js/113.b7a17623.js"><link rel="prefetch" href="/docs/assets/js/114.a095d6e4.js"><link rel="prefetch" href="/docs/assets/js/115.edf268cd.js"><link rel="prefetch" href="/docs/assets/js/116.92a6aee6.js"><link rel="prefetch" href="/docs/assets/js/117.a584efa9.js"><link rel="prefetch" href="/docs/assets/js/118.e4a9a7df.js"><link rel="prefetch" href="/docs/assets/js/119.76e403fc.js"><link rel="prefetch" href="/docs/assets/js/12.8e4cf44e.js"><link rel="prefetch" href="/docs/assets/js/120.56e6c529.js"><link rel="prefetch" href="/docs/assets/js/121.5483b7cc.js"><link rel="prefetch" href="/docs/assets/js/122.d59f075a.js"><link rel="prefetch" href="/docs/assets/js/123.e37f1498.js"><link rel="prefetch" href="/docs/assets/js/124.6399536f.js"><link rel="prefetch" href="/docs/assets/js/125.3dd1b21e.js"><link rel="prefetch" href="/docs/assets/js/126.bac5b1a9.js"><link rel="prefetch" href="/docs/assets/js/127.ca0b98d6.js"><link rel="prefetch" href="/docs/assets/js/128.e27cd810.js"><link rel="prefetch" href="/docs/assets/js/129.ea163ad4.js"><link rel="prefetch" href="/docs/assets/js/13.8b9a71d6.js"><link rel="prefetch" href="/docs/assets/js/130.b0f6d331.js"><link rel="prefetch" href="/docs/assets/js/131.4d7e7f27.js"><link rel="prefetch" href="/docs/assets/js/132.fa52eaf8.js"><link rel="prefetch" href="/docs/assets/js/133.f4b31c36.js"><link rel="prefetch" href="/docs/assets/js/134.d3f4c22c.js"><link rel="prefetch" href="/docs/assets/js/135.c04cbfc1.js"><link rel="prefetch" href="/docs/assets/js/136.38c54ec8.js"><link rel="prefetch" href="/docs/assets/js/137.ea709dba.js"><link rel="prefetch" href="/docs/assets/js/138.1a30b9a5.js"><link rel="prefetch" href="/docs/assets/js/139.206f723d.js"><link rel="prefetch" href="/docs/assets/js/14.83e91728.js"><link rel="prefetch" href="/docs/assets/js/140.7d48afd4.js"><link rel="prefetch" href="/docs/assets/js/141.4b131bb1.js"><link rel="prefetch" href="/docs/assets/js/142.e36a8e32.js"><link rel="prefetch" href="/docs/assets/js/143.b30d24d0.js"><link rel="prefetch" href="/docs/assets/js/144.89b6bd7a.js"><link rel="prefetch" href="/docs/assets/js/145.fbeab0e6.js"><link rel="prefetch" href="/docs/assets/js/146.9b668e22.js"><link rel="prefetch" href="/docs/assets/js/147.9c2f4299.js"><link rel="prefetch" href="/docs/assets/js/148.d654db25.js"><link rel="prefetch" href="/docs/assets/js/149.d0d971b1.js"><link rel="prefetch" href="/docs/assets/js/15.4dbf7ded.js"><link rel="prefetch" href="/docs/assets/js/150.de6537ae.js"><link rel="prefetch" href="/docs/assets/js/151.c8902105.js"><link rel="prefetch" href="/docs/assets/js/152.06cf963d.js"><link rel="prefetch" href="/docs/assets/js/153.29c2d314.js"><link rel="prefetch" href="/docs/assets/js/154.3667c485.js"><link rel="prefetch" href="/docs/assets/js/155.714e38da.js"><link rel="prefetch" href="/docs/assets/js/156.ce226a23.js"><link rel="prefetch" href="/docs/assets/js/157.8618e6d0.js"><link rel="prefetch" href="/docs/assets/js/158.71651ca5.js"><link rel="prefetch" href="/docs/assets/js/159.8b8c4da0.js"><link rel="prefetch" href="/docs/assets/js/16.8c300213.js"><link rel="prefetch" href="/docs/assets/js/160.05c0d7a1.js"><link rel="prefetch" href="/docs/assets/js/161.a0205d2f.js"><link rel="prefetch" href="/docs/assets/js/162.1c0657ee.js"><link rel="prefetch" href="/docs/assets/js/163.25847939.js"><link rel="prefetch" href="/docs/assets/js/164.8eee1579.js"><link rel="prefetch" href="/docs/assets/js/165.2761ab3d.js"><link rel="prefetch" href="/docs/assets/js/166.a3c337e8.js"><link rel="prefetch" href="/docs/assets/js/167.aa689b5f.js"><link rel="prefetch" href="/docs/assets/js/168.07bd0053.js"><link rel="prefetch" href="/docs/assets/js/169.f64aa882.js"><link rel="prefetch" href="/docs/assets/js/17.f86928ac.js"><link rel="prefetch" href="/docs/assets/js/170.e6db7072.js"><link rel="prefetch" href="/docs/assets/js/171.16117c3f.js"><link rel="prefetch" href="/docs/assets/js/172.b436ec04.js"><link rel="prefetch" href="/docs/assets/js/173.71f97f73.js"><link rel="prefetch" href="/docs/assets/js/174.63878e1b.js"><link rel="prefetch" href="/docs/assets/js/175.45c4a848.js"><link rel="prefetch" href="/docs/assets/js/176.461fa334.js"><link rel="prefetch" href="/docs/assets/js/177.8993bdb1.js"><link rel="prefetch" href="/docs/assets/js/178.4923b33d.js"><link rel="prefetch" href="/docs/assets/js/179.db3a5416.js"><link rel="prefetch" href="/docs/assets/js/18.a567e570.js"><link rel="prefetch" href="/docs/assets/js/180.7490e2c1.js"><link rel="prefetch" href="/docs/assets/js/181.da4fd091.js"><link rel="prefetch" href="/docs/assets/js/182.4c7c7596.js"><link rel="prefetch" href="/docs/assets/js/183.2ad0c177.js"><link rel="prefetch" href="/docs/assets/js/184.9fdb2b3f.js"><link rel="prefetch" href="/docs/assets/js/185.73d825e6.js"><link rel="prefetch" href="/docs/assets/js/186.39847372.js"><link rel="prefetch" href="/docs/assets/js/187.d96b4a4d.js"><link rel="prefetch" href="/docs/assets/js/188.39bc319b.js"><link rel="prefetch" href="/docs/assets/js/189.cd754d89.js"><link rel="prefetch" href="/docs/assets/js/19.32080456.js"><link rel="prefetch" href="/docs/assets/js/190.da9786e6.js"><link rel="prefetch" href="/docs/assets/js/191.ef07ebb8.js"><link rel="prefetch" href="/docs/assets/js/192.11981087.js"><link rel="prefetch" href="/docs/assets/js/193.ad95e2f7.js"><link rel="prefetch" href="/docs/assets/js/194.acfe8d04.js"><link rel="prefetch" href="/docs/assets/js/195.c56ab22e.js"><link rel="prefetch" href="/docs/assets/js/196.c73fdf05.js"><link rel="prefetch" href="/docs/assets/js/197.dc80aa9b.js"><link rel="prefetch" href="/docs/assets/js/198.d54525c1.js"><link rel="prefetch" href="/docs/assets/js/199.c6d37435.js"><link rel="prefetch" href="/docs/assets/js/20.f792103e.js"><link rel="prefetch" href="/docs/assets/js/200.a88ed139.js"><link rel="prefetch" href="/docs/assets/js/201.27bbbdbb.js"><link rel="prefetch" href="/docs/assets/js/202.58e5d85a.js"><link rel="prefetch" href="/docs/assets/js/203.20ce8eda.js"><link rel="prefetch" href="/docs/assets/js/204.d86f297e.js"><link rel="prefetch" href="/docs/assets/js/205.dc649b51.js"><link rel="prefetch" href="/docs/assets/js/206.6569abbb.js"><link rel="prefetch" href="/docs/assets/js/207.d0f550fa.js"><link rel="prefetch" href="/docs/assets/js/208.f4a16b61.js"><link rel="prefetch" href="/docs/assets/js/209.1bb79268.js"><link rel="prefetch" href="/docs/assets/js/21.18a56820.js"><link rel="prefetch" href="/docs/assets/js/210.7e18bbfb.js"><link rel="prefetch" href="/docs/assets/js/211.b7fa08f6.js"><link rel="prefetch" href="/docs/assets/js/212.10a086f9.js"><link rel="prefetch" href="/docs/assets/js/213.5bd4c397.js"><link rel="prefetch" href="/docs/assets/js/214.a2c756fc.js"><link rel="prefetch" href="/docs/assets/js/215.8e2fce77.js"><link rel="prefetch" href="/docs/assets/js/216.08487a19.js"><link rel="prefetch" href="/docs/assets/js/217.07f5edca.js"><link rel="prefetch" href="/docs/assets/js/218.b2e835ad.js"><link rel="prefetch" href="/docs/assets/js/219.c39ba344.js"><link rel="prefetch" href="/docs/assets/js/22.d895b2fe.js"><link rel="prefetch" href="/docs/assets/js/220.a6efab5b.js"><link rel="prefetch" href="/docs/assets/js/221.6279f674.js"><link rel="prefetch" href="/docs/assets/js/222.64aa23d9.js"><link rel="prefetch" href="/docs/assets/js/223.6419c554.js"><link rel="prefetch" href="/docs/assets/js/224.2b11a798.js"><link rel="prefetch" href="/docs/assets/js/225.b991618a.js"><link rel="prefetch" href="/docs/assets/js/226.e31dd6e7.js"><link rel="prefetch" href="/docs/assets/js/227.a6c2b8cb.js"><link rel="prefetch" href="/docs/assets/js/228.e84edeef.js"><link rel="prefetch" href="/docs/assets/js/229.a724ab19.js"><link rel="prefetch" href="/docs/assets/js/23.ac13b33e.js"><link rel="prefetch" href="/docs/assets/js/230.e4c39a5a.js"><link rel="prefetch" href="/docs/assets/js/231.bbd7889e.js"><link rel="prefetch" href="/docs/assets/js/232.9e383168.js"><link rel="prefetch" href="/docs/assets/js/233.ad1a7602.js"><link rel="prefetch" href="/docs/assets/js/234.48c223e5.js"><link rel="prefetch" href="/docs/assets/js/235.4b756cd3.js"><link rel="prefetch" href="/docs/assets/js/236.76bc6dab.js"><link rel="prefetch" href="/docs/assets/js/237.c5306c63.js"><link rel="prefetch" href="/docs/assets/js/238.3c84a385.js"><link rel="prefetch" href="/docs/assets/js/239.859617a3.js"><link rel="prefetch" href="/docs/assets/js/24.a22d6f57.js"><link rel="prefetch" href="/docs/assets/js/240.bb8adc71.js"><link rel="prefetch" href="/docs/assets/js/241.51778eb0.js"><link rel="prefetch" href="/docs/assets/js/242.954ff44a.js"><link rel="prefetch" href="/docs/assets/js/243.b79314d6.js"><link rel="prefetch" href="/docs/assets/js/244.6952f686.js"><link rel="prefetch" href="/docs/assets/js/245.5081a9f6.js"><link rel="prefetch" href="/docs/assets/js/246.de4a3666.js"><link rel="prefetch" href="/docs/assets/js/247.84bc7419.js"><link rel="prefetch" href="/docs/assets/js/248.64504c91.js"><link rel="prefetch" href="/docs/assets/js/249.4fd4491d.js"><link rel="prefetch" href="/docs/assets/js/25.47e37125.js"><link rel="prefetch" href="/docs/assets/js/250.3fd90be1.js"><link rel="prefetch" href="/docs/assets/js/251.87a40c86.js"><link rel="prefetch" href="/docs/assets/js/252.c420fd22.js"><link rel="prefetch" href="/docs/assets/js/253.2d3ecd7b.js"><link rel="prefetch" href="/docs/assets/js/254.9cf19b98.js"><link rel="prefetch" href="/docs/assets/js/255.428f1f99.js"><link rel="prefetch" href="/docs/assets/js/256.ca492094.js"><link rel="prefetch" href="/docs/assets/js/257.0b4e1e7a.js"><link rel="prefetch" href="/docs/assets/js/258.6772dc3a.js"><link rel="prefetch" href="/docs/assets/js/259.4aaca4d9.js"><link rel="prefetch" href="/docs/assets/js/26.89d2bc41.js"><link rel="prefetch" href="/docs/assets/js/260.1a2cf0f2.js"><link rel="prefetch" href="/docs/assets/js/261.7269beb1.js"><link rel="prefetch" href="/docs/assets/js/262.43a91a0f.js"><link rel="prefetch" href="/docs/assets/js/263.d03ade38.js"><link rel="prefetch" href="/docs/assets/js/264.3ee8c5ad.js"><link rel="prefetch" href="/docs/assets/js/265.d200b4b4.js"><link rel="prefetch" href="/docs/assets/js/266.40f356ba.js"><link rel="prefetch" href="/docs/assets/js/267.585911fb.js"><link rel="prefetch" href="/docs/assets/js/268.09c36242.js"><link rel="prefetch" href="/docs/assets/js/269.4a9bae98.js"><link rel="prefetch" href="/docs/assets/js/27.5a2b885c.js"><link rel="prefetch" href="/docs/assets/js/270.a42b9720.js"><link rel="prefetch" href="/docs/assets/js/271.10825d2b.js"><link rel="prefetch" href="/docs/assets/js/272.cd8ba290.js"><link rel="prefetch" href="/docs/assets/js/273.a6efcac2.js"><link rel="prefetch" href="/docs/assets/js/274.3b02c905.js"><link rel="prefetch" href="/docs/assets/js/275.31003c5a.js"><link rel="prefetch" href="/docs/assets/js/276.e8ca6fc7.js"><link rel="prefetch" href="/docs/assets/js/277.8178821c.js"><link rel="prefetch" href="/docs/assets/js/278.83cf72f4.js"><link rel="prefetch" href="/docs/assets/js/279.4ff1d084.js"><link rel="prefetch" href="/docs/assets/js/28.e81a3332.js"><link rel="prefetch" href="/docs/assets/js/280.6c651274.js"><link rel="prefetch" href="/docs/assets/js/281.1eca8148.js"><link rel="prefetch" href="/docs/assets/js/282.9deee1be.js"><link rel="prefetch" href="/docs/assets/js/283.5bb18313.js"><link rel="prefetch" href="/docs/assets/js/284.c72af108.js"><link rel="prefetch" href="/docs/assets/js/285.d0c9e46a.js"><link rel="prefetch" href="/docs/assets/js/286.9292cbed.js"><link rel="prefetch" href="/docs/assets/js/287.8d587359.js"><link rel="prefetch" href="/docs/assets/js/288.e66c688c.js"><link rel="prefetch" href="/docs/assets/js/289.cd694450.js"><link rel="prefetch" href="/docs/assets/js/29.b3efce48.js"><link rel="prefetch" href="/docs/assets/js/290.d031a454.js"><link rel="prefetch" href="/docs/assets/js/291.a433052e.js"><link rel="prefetch" href="/docs/assets/js/292.512bb9ae.js"><link rel="prefetch" href="/docs/assets/js/293.15f31854.js"><link rel="prefetch" href="/docs/assets/js/294.63c059af.js"><link rel="prefetch" href="/docs/assets/js/295.711bd755.js"><link rel="prefetch" href="/docs/assets/js/296.5f2803d2.js"><link rel="prefetch" href="/docs/assets/js/297.a5e4c6f3.js"><link rel="prefetch" href="/docs/assets/js/298.48ea186e.js"><link rel="prefetch" href="/docs/assets/js/299.36ca897c.js"><link rel="prefetch" href="/docs/assets/js/3.c84c186c.js"><link rel="prefetch" href="/docs/assets/js/30.9cf23044.js"><link rel="prefetch" href="/docs/assets/js/300.edd400b4.js"><link rel="prefetch" href="/docs/assets/js/301.d4498ee2.js"><link rel="prefetch" href="/docs/assets/js/302.93d3703b.js"><link rel="prefetch" href="/docs/assets/js/303.497ec76e.js"><link rel="prefetch" href="/docs/assets/js/304.c38d737a.js"><link rel="prefetch" href="/docs/assets/js/305.c6f98160.js"><link rel="prefetch" href="/docs/assets/js/306.3ede5d20.js"><link rel="prefetch" href="/docs/assets/js/307.3a9e1c6c.js"><link rel="prefetch" href="/docs/assets/js/308.c3a90653.js"><link rel="prefetch" href="/docs/assets/js/309.86278055.js"><link rel="prefetch" href="/docs/assets/js/31.ded3bf81.js"><link rel="prefetch" href="/docs/assets/js/310.43f7ad22.js"><link rel="prefetch" href="/docs/assets/js/311.818e16a5.js"><link rel="prefetch" href="/docs/assets/js/312.8ce82a95.js"><link rel="prefetch" href="/docs/assets/js/313.8797f12a.js"><link rel="prefetch" href="/docs/assets/js/314.7680a152.js"><link rel="prefetch" href="/docs/assets/js/315.2431f65b.js"><link rel="prefetch" href="/docs/assets/js/316.f9c0780b.js"><link rel="prefetch" href="/docs/assets/js/317.0753f9d4.js"><link rel="prefetch" href="/docs/assets/js/318.0d6283d8.js"><link rel="prefetch" href="/docs/assets/js/319.b3fba826.js"><link rel="prefetch" href="/docs/assets/js/320.c42a4d63.js"><link rel="prefetch" href="/docs/assets/js/321.3ee09706.js"><link rel="prefetch" href="/docs/assets/js/322.945ea232.js"><link rel="prefetch" href="/docs/assets/js/323.64a6d759.js"><link rel="prefetch" href="/docs/assets/js/324.fc6a1c8a.js"><link rel="prefetch" href="/docs/assets/js/325.9f4c2b89.js"><link rel="prefetch" href="/docs/assets/js/326.208b530e.js"><link rel="prefetch" href="/docs/assets/js/327.bab78ebb.js"><link rel="prefetch" href="/docs/assets/js/328.cec6d52d.js"><link rel="prefetch" href="/docs/assets/js/329.78bf1913.js"><link rel="prefetch" href="/docs/assets/js/33.d729d7d7.js"><link rel="prefetch" href="/docs/assets/js/330.0ba5fcdb.js"><link rel="prefetch" href="/docs/assets/js/331.7f1b33f8.js"><link rel="prefetch" href="/docs/assets/js/332.b4f4d011.js"><link rel="prefetch" href="/docs/assets/js/333.75aa3f4b.js"><link rel="prefetch" href="/docs/assets/js/334.27c8e955.js"><link rel="prefetch" href="/docs/assets/js/335.5c66cf0d.js"><link rel="prefetch" href="/docs/assets/js/336.e3ea0593.js"><link rel="prefetch" href="/docs/assets/js/337.f385161e.js"><link rel="prefetch" href="/docs/assets/js/338.a0b09a9f.js"><link rel="prefetch" href="/docs/assets/js/339.ef4efe90.js"><link rel="prefetch" href="/docs/assets/js/34.192fb937.js"><link rel="prefetch" href="/docs/assets/js/340.e9e69e1e.js"><link rel="prefetch" href="/docs/assets/js/341.c6b48e3f.js"><link rel="prefetch" href="/docs/assets/js/342.1a8bcea9.js"><link rel="prefetch" href="/docs/assets/js/343.43fc85b7.js"><link rel="prefetch" href="/docs/assets/js/344.239967f8.js"><link rel="prefetch" href="/docs/assets/js/345.eff90202.js"><link rel="prefetch" href="/docs/assets/js/346.0e970470.js"><link rel="prefetch" href="/docs/assets/js/347.ecdbf370.js"><link rel="prefetch" href="/docs/assets/js/348.5cb58a84.js"><link rel="prefetch" href="/docs/assets/js/349.e838b9a2.js"><link rel="prefetch" href="/docs/assets/js/35.36ca9d2a.js"><link rel="prefetch" href="/docs/assets/js/350.b9699c24.js"><link rel="prefetch" href="/docs/assets/js/351.e7ed0704.js"><link rel="prefetch" href="/docs/assets/js/352.4e10e00e.js"><link rel="prefetch" href="/docs/assets/js/353.72756098.js"><link rel="prefetch" href="/docs/assets/js/354.cb174118.js"><link rel="prefetch" href="/docs/assets/js/355.e2f54886.js"><link rel="prefetch" href="/docs/assets/js/356.fb6621f5.js"><link rel="prefetch" href="/docs/assets/js/357.8ca3bd26.js"><link rel="prefetch" href="/docs/assets/js/358.e8a397ef.js"><link rel="prefetch" href="/docs/assets/js/359.d724daff.js"><link rel="prefetch" href="/docs/assets/js/36.239e7e0e.js"><link rel="prefetch" href="/docs/assets/js/360.76854f81.js"><link rel="prefetch" href="/docs/assets/js/361.fa954f86.js"><link rel="prefetch" href="/docs/assets/js/362.62a7e7a9.js"><link rel="prefetch" href="/docs/assets/js/363.159efd9f.js"><link rel="prefetch" href="/docs/assets/js/364.52ff2b6f.js"><link rel="prefetch" href="/docs/assets/js/365.e6d8fa09.js"><link rel="prefetch" href="/docs/assets/js/366.bf868ed9.js"><link rel="prefetch" href="/docs/assets/js/367.17fb9689.js"><link rel="prefetch" href="/docs/assets/js/368.8446de5b.js"><link rel="prefetch" href="/docs/assets/js/369.2b8c5810.js"><link rel="prefetch" href="/docs/assets/js/37.d9ff0f03.js"><link rel="prefetch" href="/docs/assets/js/370.979fac1d.js"><link rel="prefetch" href="/docs/assets/js/371.8753fcfd.js"><link rel="prefetch" href="/docs/assets/js/372.29676929.js"><link rel="prefetch" href="/docs/assets/js/373.fba1275c.js"><link rel="prefetch" href="/docs/assets/js/374.db27db66.js"><link rel="prefetch" href="/docs/assets/js/375.8f439fcb.js"><link rel="prefetch" href="/docs/assets/js/376.1a134802.js"><link rel="prefetch" href="/docs/assets/js/377.57da785f.js"><link rel="prefetch" href="/docs/assets/js/378.6e594432.js"><link rel="prefetch" href="/docs/assets/js/379.7b9614c7.js"><link rel="prefetch" href="/docs/assets/js/38.91865d67.js"><link rel="prefetch" href="/docs/assets/js/380.f5aa8233.js"><link rel="prefetch" href="/docs/assets/js/381.eb32e254.js"><link rel="prefetch" href="/docs/assets/js/382.abd5714b.js"><link rel="prefetch" href="/docs/assets/js/383.f6c224bc.js"><link rel="prefetch" href="/docs/assets/js/384.3e314c09.js"><link rel="prefetch" href="/docs/assets/js/385.9793d419.js"><link rel="prefetch" href="/docs/assets/js/386.c100d8bf.js"><link rel="prefetch" href="/docs/assets/js/387.896d5316.js"><link rel="prefetch" href="/docs/assets/js/388.90a686d2.js"><link rel="prefetch" href="/docs/assets/js/389.e0c3f946.js"><link rel="prefetch" href="/docs/assets/js/39.3da874c6.js"><link rel="prefetch" href="/docs/assets/js/390.bdfdd65b.js"><link rel="prefetch" href="/docs/assets/js/391.80ac185f.js"><link rel="prefetch" href="/docs/assets/js/392.2d6f2220.js"><link rel="prefetch" href="/docs/assets/js/393.0506776c.js"><link rel="prefetch" href="/docs/assets/js/394.aceb0069.js"><link rel="prefetch" href="/docs/assets/js/395.cc2150e4.js"><link rel="prefetch" href="/docs/assets/js/396.4c68311f.js"><link rel="prefetch" href="/docs/assets/js/397.311ee8f4.js"><link rel="prefetch" href="/docs/assets/js/398.ad1bda1e.js"><link rel="prefetch" href="/docs/assets/js/399.98904623.js"><link rel="prefetch" href="/docs/assets/js/4.cdf4c6b0.js"><link rel="prefetch" href="/docs/assets/js/40.201c5fd0.js"><link rel="prefetch" href="/docs/assets/js/400.8178741e.js"><link rel="prefetch" href="/docs/assets/js/401.81e92e25.js"><link rel="prefetch" href="/docs/assets/js/402.260618b5.js"><link rel="prefetch" href="/docs/assets/js/403.652d3204.js"><link rel="prefetch" href="/docs/assets/js/404.71b21885.js"><link rel="prefetch" href="/docs/assets/js/405.97b0cd63.js"><link rel="prefetch" href="/docs/assets/js/406.68bb2b4b.js"><link rel="prefetch" href="/docs/assets/js/407.7b5af9b2.js"><link rel="prefetch" href="/docs/assets/js/408.4c29ba77.js"><link rel="prefetch" href="/docs/assets/js/409.5b2d3410.js"><link rel="prefetch" href="/docs/assets/js/41.eed9a4f9.js"><link rel="prefetch" href="/docs/assets/js/410.9d3f2b70.js"><link rel="prefetch" href="/docs/assets/js/411.7b2db68c.js"><link rel="prefetch" href="/docs/assets/js/412.d93030fe.js"><link rel="prefetch" href="/docs/assets/js/413.acd39562.js"><link rel="prefetch" href="/docs/assets/js/414.fcd10c31.js"><link rel="prefetch" href="/docs/assets/js/415.90adeef3.js"><link rel="prefetch" href="/docs/assets/js/416.df40d9ab.js"><link rel="prefetch" href="/docs/assets/js/417.5dd116e9.js"><link rel="prefetch" href="/docs/assets/js/418.be92f3bf.js"><link rel="prefetch" href="/docs/assets/js/419.0952649b.js"><link rel="prefetch" href="/docs/assets/js/42.2a30262c.js"><link rel="prefetch" href="/docs/assets/js/420.ea081aef.js"><link rel="prefetch" href="/docs/assets/js/421.a6187441.js"><link rel="prefetch" href="/docs/assets/js/422.5db06a1b.js"><link rel="prefetch" href="/docs/assets/js/423.bc919b0b.js"><link rel="prefetch" href="/docs/assets/js/424.e79f8a73.js"><link rel="prefetch" href="/docs/assets/js/425.18f92822.js"><link rel="prefetch" href="/docs/assets/js/426.84a4e14f.js"><link rel="prefetch" href="/docs/assets/js/427.9793eee6.js"><link rel="prefetch" href="/docs/assets/js/428.19c74252.js"><link rel="prefetch" href="/docs/assets/js/429.da63d7bc.js"><link rel="prefetch" href="/docs/assets/js/43.1f73b497.js"><link rel="prefetch" href="/docs/assets/js/430.4a2a53a0.js"><link rel="prefetch" href="/docs/assets/js/431.b7d9c83e.js"><link rel="prefetch" href="/docs/assets/js/432.da196c85.js"><link rel="prefetch" href="/docs/assets/js/433.3bb5c3e5.js"><link rel="prefetch" href="/docs/assets/js/434.6f287391.js"><link rel="prefetch" href="/docs/assets/js/435.ea8a361a.js"><link rel="prefetch" href="/docs/assets/js/436.e929a50a.js"><link rel="prefetch" href="/docs/assets/js/437.1eb7eb83.js"><link rel="prefetch" href="/docs/assets/js/438.c57f5980.js"><link rel="prefetch" href="/docs/assets/js/439.98d73286.js"><link rel="prefetch" href="/docs/assets/js/44.0f5f9473.js"><link rel="prefetch" href="/docs/assets/js/440.75769d76.js"><link rel="prefetch" href="/docs/assets/js/441.c75ad46d.js"><link rel="prefetch" href="/docs/assets/js/442.e3c61bf0.js"><link rel="prefetch" href="/docs/assets/js/443.f0d4ebaf.js"><link rel="prefetch" href="/docs/assets/js/444.5480538e.js"><link rel="prefetch" href="/docs/assets/js/445.2edc5bd8.js"><link rel="prefetch" href="/docs/assets/js/446.33195bf6.js"><link rel="prefetch" href="/docs/assets/js/447.0bb15059.js"><link rel="prefetch" href="/docs/assets/js/448.bd79862a.js"><link rel="prefetch" href="/docs/assets/js/449.6539ce41.js"><link rel="prefetch" href="/docs/assets/js/45.87792bf8.js"><link rel="prefetch" href="/docs/assets/js/450.451f3e43.js"><link rel="prefetch" href="/docs/assets/js/451.e3268a5d.js"><link rel="prefetch" href="/docs/assets/js/452.e0d4ebbb.js"><link rel="prefetch" href="/docs/assets/js/453.6d9bcd1c.js"><link rel="prefetch" href="/docs/assets/js/454.c3f7b3a8.js"><link rel="prefetch" href="/docs/assets/js/455.de224c3f.js"><link rel="prefetch" href="/docs/assets/js/456.be04f107.js"><link rel="prefetch" href="/docs/assets/js/457.6dd11a5e.js"><link rel="prefetch" href="/docs/assets/js/458.3dfd7bb9.js"><link rel="prefetch" href="/docs/assets/js/459.ee620072.js"><link rel="prefetch" href="/docs/assets/js/46.df4d3f86.js"><link rel="prefetch" href="/docs/assets/js/460.e037bf69.js"><link rel="prefetch" href="/docs/assets/js/461.758a1985.js"><link rel="prefetch" href="/docs/assets/js/462.1ca4a46b.js"><link rel="prefetch" href="/docs/assets/js/463.6865a66d.js"><link rel="prefetch" href="/docs/assets/js/464.6ee4cc8c.js"><link rel="prefetch" href="/docs/assets/js/465.4950caac.js"><link rel="prefetch" href="/docs/assets/js/466.a54d7a11.js"><link rel="prefetch" href="/docs/assets/js/467.5eb079bf.js"><link rel="prefetch" href="/docs/assets/js/468.4b8a35a8.js"><link rel="prefetch" href="/docs/assets/js/469.c8104a66.js"><link rel="prefetch" href="/docs/assets/js/47.a234216e.js"><link rel="prefetch" href="/docs/assets/js/470.4ae322cd.js"><link rel="prefetch" href="/docs/assets/js/471.712a1520.js"><link rel="prefetch" href="/docs/assets/js/472.4c19b1a8.js"><link rel="prefetch" href="/docs/assets/js/473.e4eac5e9.js"><link rel="prefetch" href="/docs/assets/js/474.dffc70a9.js"><link rel="prefetch" href="/docs/assets/js/475.831a95f0.js"><link rel="prefetch" href="/docs/assets/js/476.8e909fff.js"><link rel="prefetch" href="/docs/assets/js/477.ddbb702b.js"><link rel="prefetch" href="/docs/assets/js/478.b2f05527.js"><link rel="prefetch" href="/docs/assets/js/479.1ff75abb.js"><link rel="prefetch" href="/docs/assets/js/48.2c00a94a.js"><link rel="prefetch" href="/docs/assets/js/480.9df2852a.js"><link rel="prefetch" href="/docs/assets/js/481.0eda6e8d.js"><link rel="prefetch" href="/docs/assets/js/482.28965df2.js"><link rel="prefetch" href="/docs/assets/js/483.4a4aa2ee.js"><link rel="prefetch" href="/docs/assets/js/484.e45ca90d.js"><link rel="prefetch" href="/docs/assets/js/485.94b7958f.js"><link rel="prefetch" href="/docs/assets/js/486.da64d8a5.js"><link rel="prefetch" href="/docs/assets/js/487.5fc64593.js"><link rel="prefetch" href="/docs/assets/js/488.f3d0ee7b.js"><link rel="prefetch" href="/docs/assets/js/489.2ea7038e.js"><link rel="prefetch" href="/docs/assets/js/49.5bad77b6.js"><link rel="prefetch" href="/docs/assets/js/490.f25078a0.js"><link rel="prefetch" href="/docs/assets/js/491.cf87b1c6.js"><link rel="prefetch" href="/docs/assets/js/492.6e0d93fb.js"><link rel="prefetch" href="/docs/assets/js/493.f5df4999.js"><link rel="prefetch" href="/docs/assets/js/494.93646b48.js"><link rel="prefetch" href="/docs/assets/js/495.d2005128.js"><link rel="prefetch" href="/docs/assets/js/496.6e4bdd12.js"><link rel="prefetch" href="/docs/assets/js/497.65590470.js"><link rel="prefetch" href="/docs/assets/js/498.9944dfbc.js"><link rel="prefetch" href="/docs/assets/js/5.61d14c9e.js"><link rel="prefetch" href="/docs/assets/js/50.9b4823b1.js"><link rel="prefetch" href="/docs/assets/js/51.019f560a.js"><link rel="prefetch" href="/docs/assets/js/52.e2d8070c.js"><link rel="prefetch" href="/docs/assets/js/53.fbe8be6a.js"><link rel="prefetch" href="/docs/assets/js/54.86706acd.js"><link rel="prefetch" href="/docs/assets/js/55.971f0a66.js"><link rel="prefetch" href="/docs/assets/js/56.a87f60a1.js"><link rel="prefetch" href="/docs/assets/js/57.eca2964c.js"><link rel="prefetch" href="/docs/assets/js/58.79fb9819.js"><link rel="prefetch" href="/docs/assets/js/59.d7c20bee.js"><link rel="prefetch" href="/docs/assets/js/6.e78c4b18.js"><link rel="prefetch" href="/docs/assets/js/60.408ffa4a.js"><link rel="prefetch" href="/docs/assets/js/61.e5bc5b2c.js"><link rel="prefetch" href="/docs/assets/js/62.5d386e65.js"><link rel="prefetch" href="/docs/assets/js/63.6d88e27a.js"><link rel="prefetch" href="/docs/assets/js/64.40a323b9.js"><link rel="prefetch" href="/docs/assets/js/65.bfab9546.js"><link rel="prefetch" href="/docs/assets/js/66.6775401a.js"><link rel="prefetch" href="/docs/assets/js/67.fb9c10c1.js"><link rel="prefetch" href="/docs/assets/js/68.e06920eb.js"><link rel="prefetch" href="/docs/assets/js/69.4f7f34ff.js"><link rel="prefetch" href="/docs/assets/js/7.8375f159.js"><link rel="prefetch" href="/docs/assets/js/70.d6a73f92.js"><link rel="prefetch" href="/docs/assets/js/71.6ebf31b6.js"><link rel="prefetch" href="/docs/assets/js/72.7c79570d.js"><link rel="prefetch" href="/docs/assets/js/73.2e51be73.js"><link rel="prefetch" href="/docs/assets/js/74.8e14d4b5.js"><link rel="prefetch" href="/docs/assets/js/75.1297d3f5.js"><link rel="prefetch" href="/docs/assets/js/77.f06c8903.js"><link rel="prefetch" href="/docs/assets/js/78.346b4198.js"><link rel="prefetch" href="/docs/assets/js/79.af811145.js"><link rel="prefetch" href="/docs/assets/js/8.30138092.js"><link rel="prefetch" href="/docs/assets/js/80.018eca04.js"><link rel="prefetch" href="/docs/assets/js/81.471f2bbf.js"><link rel="prefetch" href="/docs/assets/js/82.2e6524d9.js"><link rel="prefetch" href="/docs/assets/js/83.e14ce0dc.js"><link rel="prefetch" href="/docs/assets/js/84.66ce611f.js"><link rel="prefetch" href="/docs/assets/js/85.1b98f1c5.js"><link rel="prefetch" href="/docs/assets/js/86.891336fe.js"><link rel="prefetch" href="/docs/assets/js/87.05a63d7d.js"><link rel="prefetch" href="/docs/assets/js/88.c080bbc4.js"><link rel="prefetch" href="/docs/assets/js/89.2dc8c05f.js"><link rel="prefetch" href="/docs/assets/js/9.9465e8f3.js"><link rel="prefetch" href="/docs/assets/js/90.bf42ee14.js"><link rel="prefetch" href="/docs/assets/js/91.cb0cf1eb.js"><link rel="prefetch" href="/docs/assets/js/92.8ef7b25f.js"><link rel="prefetch" href="/docs/assets/js/93.5271594d.js"><link rel="prefetch" href="/docs/assets/js/94.d8f3e343.js"><link rel="prefetch" href="/docs/assets/js/95.d32b9fbc.js"><link rel="prefetch" href="/docs/assets/js/96.20dacdff.js"><link rel="prefetch" href="/docs/assets/js/97.332632d9.js"><link rel="prefetch" href="/docs/assets/js/98.71dd7d47.js"><link rel="prefetch" href="/docs/assets/js/99.89c0c496.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.6292c5a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>System Design Case Studies</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/notification/" class="sidebar-link">Design a notification system</a></li><li><a href="/docs/kungfu/case-study/metrics/" class="sidebar-link">Metrics Monitoring &amp; Alerting System</a></li><li><a href="/docs/kungfu/case-study/ad-click/" class="sidebar-link">Ad Click Event Aggregation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Data storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Online tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Booking System</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Social Network</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/case-study/instagram/" class="sidebar-link">Design Instagram</a></li><li><a href="/docs/kungfu/case-study/instagram/part2/" class="sidebar-link">Design Instagram (2nd)</a></li><li><a href="/docs/kungfu/case-study/instagram/part3/" class="sidebar-link">Design Instagram (3rd)</a></li><li><a href="/docs/kungfu/case-study/tinder/" class="sidebar-link">Design Tinder</a></li><li><a href="/docs/kungfu/case-study/twitter/" aria-current="page" class="active sidebar-link">Design Twitter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/twitter/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/twitter/#detailed-design" class="sidebar-link">Detailed Design</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/twitter/#component-design" class="sidebar-link">Component Design</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/twitter/#data-models" class="sidebar-link">Data Models</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/case-study/twitter/#optimization" class="sidebar-link">Optimization</a></li></ul></li><li><a href="/docs/kungfu/case-study/new-feed/" class="sidebar-link">Design new feed system</a></li><li><a href="/docs/kungfu/case-study/new-feed/part2/" class="sidebar-link">Design Fb Newsfeed (2nd)</a></li><li><a href="/docs/kungfu/case-study/twitter/twitter-search/" class="sidebar-link">Designing Twitter Search</a></li><li><a href="/docs/kungfu/case-study/search-autocomplete/" class="sidebar-link">Design a search autocomplete system</a></li><li><a href="/docs/kungfu/case-study/search-autocomplete/part2/" class="sidebar-link">Design Typeahead Suggestion</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Location-based</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Video</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Chat system</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Art of Readable Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Go</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="design-twitter"><a href="#design-twitter" class="header-anchor">#</a> Design Twitter</h1> <p>Note: This is our prototype on designing a microblogging and social networking platform on which users interact with each other using messages known as “tweets”. Users can post, like, and retweet tweets for which notifications will be sent to the all the partaking users. We have created this design based on our research going through Twitter and Instagram Engineering tech-talks. These talks are quite informative and detailed, and for the same reason, we have taken inspiration from those talks.</p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <h3 id="problem-statement"><a href="#problem-statement" class="header-anchor">#</a> Problem Statement</h3> <p>In this chapter, we will design a microblogging platform similar to Twitter where users can post a tweet and it will be shared it with the user followers. Subsequently, the users will be able to view personalized feeds containing posts from all the other users that they follow.</p> <h3 id="gathering-requirements"><a href="#gathering-requirements" class="header-anchor">#</a> Gathering Requirements</h3> <p><strong>In Scope</strong> The application</p> <ul><li>Users should be able to post and view their tweets. • Users should be able to follow other users.</li> <li>Users can view feeds containing tweets from the users they follow. • Users should be able to like and comment on tweets.</li></ul> <p><strong>Out of Scope</strong></p> <ul><li>Sending and receiving messages from other users. We have covered it in our article on designing WhatsApp.</li> <li>Providing personalized notifications to users.</li></ul> <h2 id="detailed-design"><a href="#detailed-design" class="header-anchor">#</a> Detailed Design</h2> <h3 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h3> <p>An application like twitter requires a high-level design but before jumping into the details it can be modeled into block such as:</p> <ol><li>Data Modeling: In this block the database will be stored. The database such as username, id, content from the user, request etc. The detailed database used are given in the further system components.</li> <li>Server feeds: This will collect all the feeds from the people user follows and arrange them in chronological order.</li></ol> <p>Therefore, when the server receives a request for an action (tweet, like etc.) from a client it performs two parallel operations:</p> <ol><li>it persists the action in the data store</li> <li>publishes the action in a streaming data store for a pub-sub model. It is followed by the various services (e.g. User Feed Service, Media Counter Service) reading the actions from the streaming data store and performs their specific tasks. The streaming data store makes the system extensible to support other use-cases (e.g. media search index, locations search index, and so forth) in future.</li></ol> <h3 id="system-components"><a href="#system-components" class="header-anchor">#</a> System Components</h3> <p>The system will comprise of several micro-services each performing a separate task. We will use a graph database such as Neo4j to store the information. The reason we have chosen a graph data-model is that our data will contain complex relationships between data entities such as users, tweets, and comments as nodes of the graph. We will then use edges of the graph to store relationships such as follows, likes, comments, and so forth. Additionally, we can use columnar databases like Cassandra to store information like user feeds, activities, and counters.</p> <p><img src="/docs/assets/img/38.6113b487.png" alt="img"> <em>Figure 7.1: High level System components</em></p> <h2 id="component-design"><a href="#component-design" class="header-anchor">#</a> Component Design</h2> <h3 id="tweeting-a-post"><a href="#tweeting-a-post" class="header-anchor">#</a> Tweeting a post</h3> <p><img src="/docs/assets/img/30.c4291e71.png" alt="img"> <em>Figure 7.2: Synchronous and Asynchronous process for posting on Twitter</em></p> <p>There are two major processes which are executed when a user posts a tweet. Firstly, the synchronous process which is responsible for uploading any media content on file storage, persisting the media metadata in graph data-storage, returning the confirmation message to the user and triggering the process to update the user activity. The second process occurs asynchronously by persisting user activity in a columnar data-storage(Cassandra) and trig- gering the process to pre-compute the feed of followers of non-celebrity users (having few thousand followers). We don’t pre-compute feeds for celebrity users (have 1M+ followers) as the process to fan-out the feeds to all the followers will be extremely compute and I/O intensive.</p> <h3 id="api-design-create-a-tweet"><a href="#api-design-create-a-tweet" class="header-anchor">#</a> API Design - Create a tweet</h3> <p>We have provided the API design of posting an image on Instagram below. We will send the file and data over in one request using the multipart/form-data content type. The MultiPart/Form-Data contains a series of parts. Each part is expected to contain a content- disposition header [RFC 2183] where the disposition type is &quot;form-data”.</p> <p><strong>URL</strong></p> <div class="language- extra-class"><pre class="language-text"><code>POST /users/&lt;user_id&gt;/posts
</code></pre></div><p><strong>Sample Request Body</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>Content-Type: multipart/form-data ; boundary=ExampleFormBoundary
--ExampleFormBoundary
Content-Disposition:
form-data; name=&quot;file&quot;; filename=&quot;test.png&quot;
Content-Type: image/png
{image file data bytes}
--ExampleFormBoundary--
</code></pre></div><p><strong>Sample response</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;type&quot;: &quot;ImageFile&quot;,
    &quot;id&quot;: &quot;667&quot;,
    &quot;createdAt&quot;: &quot;1466623229&quot;,
    &quot;createdBy&quot;: &quot;9&quot;,
    &quot;name&quot;: &quot;test.png&quot;,
    &quot;updatedAt&quot;: &quot;1466623230&quot;,
    &quot;updatedBy&quot;: &quot;9&quot;,
    &quot;fullImageUrl&quot;:
    “https://mybucket.s3.amazonaws.com/myfolder/test.jpg&quot;,
    &quot;size&quot;: {
            &quot;type&quot;: &quot;Size&quot;,
            &quot;width&quot;: &quot;316&quot;,
            &quot;height&quot;: &quot;316&quot;
    }, 
}
</code></pre></div><h3 id="precompute-feeds"><a href="#precompute-feeds" class="header-anchor">#</a> Precompute feeds</h3> <p>This process starts executing when non-celebrity users make a post on Instagram. It is triggered when a message is added in the User Feed Service Queue. Once the message is added in the queue, the User Feed Service makes a call to the Followers Service to fetch the list of followers of the user. After that, the post gets added to the feed of all the followers in the columnar data storage.</p> <p><img src="/docs/assets/img/31.164d1469.png" alt="img"> <em>Figure 7.3: Pre-compute feeds from non celebrity users</em></p> <h3 id="fetching-user-feed"><a href="#fetching-user-feed" class="header-anchor">#</a> Fetching User Feed</h3> <p>When a user requests for feed then there will be two parallel threads involved in fetching the user feeds to optimize for latency. The first thread will fetch the feeds from non- celebrity users which the user follows. These feeds are populated by the fan-out mecha- nism described in the PreCompute Feeds section above. The second thread is responsible for fetching the feeds of celebrity users whom the user follow. After that, the User Feed Service will merge the feeds from celebrity and non-celebrity users and return the merged feeds to the user who requested the feed.</p> <p><img src="/docs/assets/img/32.0774ff6c.png" alt="img"> <em>Figure 7.4: Sequence of operations involved in fetching user feed</em></p> <h3 id="api-design-get-feeds"><a href="#api-design-get-feeds" class="header-anchor">#</a> API Design - get feeds</h3> <p><strong>URL:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>GET /users/me/feeds
</code></pre></div><p><strong>Sample Response</strong>
The response below can be mapped directly to the graph data model mentioned in the next section.</p> <div class="language- extra-class"><pre class="language-text"><code>{
    “feeds”: [
        {
            “postId”: “post001”,
            “postOwnerId” : “user001”,
            “postOwnerName” : “Bill Gates”,
            “mediaURL” : “https://mybucket.s3.amazonaws.com/myfolder/test.jpg”,
            “numberOfLikes” : 400000
            “numberOfComments” : 19789
            “comments”: [{
                “commenterUserId” : “user004”,
                “commenterName” : “JeffBezos”
                “comment” : “Amazing!”
                “likes” : [
                    {
                        “likerId” : “user003”,
                        “likerUserName” : “Bob”
                    }
                ]
            }]
        }
    ]
}

</code></pre></div><h2 id="data-models"><a href="#data-models" class="header-anchor">#</a> Data Models</h2> <h3 id="graph-data-models"><a href="#graph-data-models" class="header-anchor">#</a> Graph Data Models</h3> <p>We can use a graph database such as Neo4j which stores data-entities such as user infor- mation, posts, comments, and so forth as nodes in the graph. The edges between the nodes are used to store the relationship between data entities such as followers, posts, comments, likes, and replies. All the nodes are added to an index called nodeIndex for faster lookups. We have chosen this NoSQL based solution over relational databases as it provides the scalability to have hierarchies which go beyond two levels and extensibility due to the schema-less behavior of NoSQL data storage.</p> <p><img src="/docs/assets/img/33.729a982e.png" alt="img"> <em>Figure 7.5: Graph representation of users, posts and comments</em></p> <h4 id="sample-queries-supported-by-graph-databases"><a href="#sample-queries-supported-by-graph-databases" class="header-anchor">#</a> Sample Queries supported by Graph Databases</h4> <p><strong>Fetch all the followers of Jeff Bezos</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Node</span> jeffBezos <span class="token operator">=</span> nodeIndex<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“userId”<span class="token punctuation">,</span> “user004”<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosFollowers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> jeffBezos<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>INGOING<span class="token punctuation">,</span> FOLLOWS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   jeffBezosFollowers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getStartNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Fetch all the posts of Bill Gates</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Node</span> billGates <span class="token operator">=</span> nodeIndex<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“userId”<span class="token punctuation">,</span> “user001”<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> billGatesPosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> billGates<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>OUTGOING<span class="token punctuation">,</span> POSTS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    billGatesPosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getEndNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Fetch all the posts of Bill Gates on which Jeff Bezos has commented</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> commentsOnBillGatesPosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Node</span> billGatesPost <span class="token operator">:</span> billGatesPosts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> billGates<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>INGOING<span class="token punctuation">,</span> COMMENTED_ON<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        commentsOnBillGatesPosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getStartNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosComments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Relationship</span> relationship<span class="token operator">:</span> jeffBezos<span class="token punctuation">.</span><span class="token function">getRelationships</span><span class="token punctuation">(</span>OUTGOING<span class="token punctuation">,</span> COMMENTS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    jeffBezosComments<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>relationship<span class="token punctuation">.</span><span class="token function">getEndNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> jeffBezosCommentsOnBillGatesPosts <span class="token operator">=</span>
                                commentsOnBillGatesPosts<span class="token punctuation">.</span><span class="token function">intersect</span><span class="token punctuation">(</span>jeffBezosComments<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="columnar-data-model"><a href="#columnar-data-model" class="header-anchor">#</a> Columnar Data Model</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWkAAABHCAYAAADFqra8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAch0lEQVR42u3dCbCcRREHcA65RIEIKBQIQglyioDIaXGKoKAEUA6J0cghoiAgaEBFRPDEG4VIECRKNCRgFGMSkChXFOTwQkSRwwM8EOVWYKxfV01qfe7u210eyXtv+1+1lZfd75ie7v5/PT3z9SxWEn2BRx55pPz9738vf/jDH8odd9xRfvnLX5af/vSn5ZprrilXXHFF+d73vldmzJhRLrroonL++eeXc845p3z+858vn/rUp8rpp59eTjnllDJx4sRy/PHHl3e9613liCOOKBMmTCiHHHJIOeCAA8q+++5b9t5777LHHnuU3Xbbrey4445l++23L1tvvXXZcssty2abbVY23njjssEGG5T11luvrLPOOmWttdYqa6yxRllttdXK85///LLyyiuXMWPGlBVXXLE897nPLcsvv3xZbrnlyjLLLFOWXnrpstRSS5Ull1yyLLHEEvFZfPHFy2KLLRYffw/8NP5Wz3G+67ie67q++7if+7q/dmiPdmmfdmqvdms/OchDLvKRk7zkJr9+0B/6Rf/oJ/2l3/SfftSf+lX/6mf9rd/1Pz3QB73QDz3RF73RHz3SZ6I/sFh2wfDBE088Ue6///5y1113lV/84hfluuuuK3PmzCnTp08vF1xwQTnrrLPKxz/+8fKBD3ygHHfcceH4SGDs2LFl9913LzvssEPZYostgkgQyyqrrBIEhJwQ0korrVRWX331IJwNN9ywbL755mXbbbctO++8c9lzzz3LPvvsUw488MAyfvz4cvjhhy8glZNOOql86EMfKmecccYCUjn77LPL5MmTy4UXXlimTp0abZw5c2aZNWtWmTt3bpk3b165+uqry/z588sNN9xQbr755pDp1ltvLbfffnsQDjmRzp///Ody3333lb/97W8h/wMPPFD+9a9/lYceeijI6LHHHiuPP/54+c9//hN99OSTT5annnqqq751vPOc7zqu57qu7z7u577urx3ao13ap53aq93aTw7ykIt85CQvucmvH/SHftE/+kl/1YeeftSf+rU+9PS3ftf/9EAf9EI/9ERf9EZ/9Eif9Eq/9Ezf9E7/7IA9sAv2wU7YC7thP+yIPWkj+2JnZCIn+fVRIkl61OIf//hH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" alt="img"><br> <em>Figure 7.6: Columnar Data Model for user feed and activities</em></p> <p>We will use columnar data storage such as Cassandra to store data entities like user feed and activities. Each row will contain feed/activity information of the user. We can also have a TTL based functionality to evict older posts. The data model will look something similar to:</p> <p><code>User_id -&gt; List&lt;post_id&gt;</code></p> <div class="custom-block tip"><p class="custom-block-title">FUN FACT</p> <p>In this talk, Dikang Gu, a software engineer at Instagram core infra team has mentioned about how they use Cassandra to serve critical use cases, high scalability requirements, and some pain points.</p></div> <h3 id="streaming-data-model"><a href="#streaming-data-model" class="header-anchor">#</a> Streaming Data Model</h3> <p>We can use cloud technologies such as Amazon Kinesis or Azure Stream Analytics for collecting, processing, and analyzing real-time, streaming data to get timely insights and react quickly to new information(e.g. a new like, comment, etc.). We have listed below the de-normalized form of some major streaming data entities and action.</p> <p><img src="/docs/assets/img/35.d01c4b65.png" alt="img"><br> <em>Figure 7.7: De normalised major data-entities and actions</em></p> <p>The data entities <strong>A</strong> and <strong>B</strong> above show the containers which contain denormalized in- formation about the Users and their Posts. Subsequently, the data entities <strong>C</strong> and <strong>D</strong> denote the different actions which users may take. The entity C denotes the event where a user likes a post and entity D denotes the action when a user follows another user. These actions are read by the related micro-services from the stream and processed accordingly. For in- stance, the LikeEvent can be read by the Media Counter Service and is used to update the media count in the data storage.</p> <h2 id="optimization"><a href="#optimization" class="header-anchor">#</a> Optimization</h2> <p>We will use a cache having an LRU based eviction policy for caching user feeds of active users. This will not only reduce the overall latency in displaying the user-feeds to users but will also prevent re-computation of user-feeds.</p> <p><img src="/docs/assets/img/36.0802659d.png" alt="img"><br> <em>Figure 7.8: LRU bases cache for storing user feeds of active users</em></p> <p>The scope of optimization lies in providing the best content in the user feeds. We can do this by ranking the new feeds (the ones generated after users last login) from those who the user follows. We can apply machine learning techniques to rank the user feeds by assigning scores to the individual feeds which would indicate the probability of click, like, comment and so forth. We can do this by representing each feed by a feature vector which contains information about the user, the feed and the interactions which the user has had with the people in the feed (e.g. whether the user had clicked/liked/commented on the previous feeds by the people in the story). It’s apparent that the most important features for feed ranking will be related to social network. Some of the keys of understanding the user network are listed below.</p> <ul><li>Who is the user a close follower of? For example, one user is a close follower of Elon Musk while another user can be a close follower of Gordon Ramsay.</li> <li>Whose photos the user always like?</li> <li>Whose links are most interesting to the user?</li></ul> <p>We can use deep neural networks which would take the several features (&gt; 100K dense features) which we require for training the model. Those features will be passed through the n-fold layers, and will be used for predicting the probability of the different events (likes, comments, shares, etc.).</p> <p><img src="/docs/assets/img/37.99dd4e7b.png" alt="img"><br> <em>Figure 7.9: Block diagram of deep neural networks</em></p> <p>::: FUN FACT
In this talk, Lars Backstrom, VP of Engineering @ Facebook talks about the machine learning done to create personalized news feeds for users. He talks about the classical machine learning approach they used in the initial phases for personalizing News Feeds by using decision trees and logistic regression. He then goes to talk about the improvements they have observed in using neural networks.
:::</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/case-study/tinder/" class="prev">
        Design Tinder
      </a></span> <span class="next"><a href="/docs/kungfu/case-study/new-feed/">
        Design new feed system
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.f6cd25ab.js" defer></script><script src="/docs/assets/js/2.1680c3d7.js" defer></script><script src="/docs/assets/js/32.eb07b049.js" defer></script><script src="/docs/assets/js/76.fcb20251.js" defer></script>
  </body>
</html>
