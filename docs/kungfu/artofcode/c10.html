<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>10. Extracting Unrelated Subproblems | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.5d974432.css" as="style"><link rel="preload" href="/docs/assets/js/app.e28ba3f8.js" as="script"><link rel="preload" href="/docs/assets/js/2.77a4f111.js" as="script"><link rel="preload" href="/docs/assets/js/221.f53b37dc.js" as="script"><link rel="preload" href="/docs/assets/js/28.0ed72f23.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.2d2fa643.js"><link rel="prefetch" href="/docs/assets/js/100.ba9cff16.js"><link rel="prefetch" href="/docs/assets/js/101.d72e3765.js"><link rel="prefetch" href="/docs/assets/js/102.1aa133ab.js"><link rel="prefetch" href="/docs/assets/js/103.c3186f9c.js"><link rel="prefetch" href="/docs/assets/js/104.012e6c38.js"><link rel="prefetch" href="/docs/assets/js/105.bc46bfa3.js"><link rel="prefetch" href="/docs/assets/js/106.f89949e1.js"><link rel="prefetch" href="/docs/assets/js/107.6ddac154.js"><link rel="prefetch" href="/docs/assets/js/108.6d159ab3.js"><link rel="prefetch" href="/docs/assets/js/109.804f3fb9.js"><link rel="prefetch" href="/docs/assets/js/11.6660841c.js"><link rel="prefetch" href="/docs/assets/js/110.f53c1951.js"><link rel="prefetch" href="/docs/assets/js/111.b42ef8bd.js"><link rel="prefetch" href="/docs/assets/js/112.4b489247.js"><link rel="prefetch" href="/docs/assets/js/113.dea46f00.js"><link rel="prefetch" href="/docs/assets/js/114.2e48a074.js"><link rel="prefetch" href="/docs/assets/js/115.9c7684eb.js"><link rel="prefetch" href="/docs/assets/js/116.874abd2c.js"><link rel="prefetch" href="/docs/assets/js/117.a49efee5.js"><link rel="prefetch" href="/docs/assets/js/118.9f38af9e.js"><link rel="prefetch" href="/docs/assets/js/119.20abe876.js"><link rel="prefetch" href="/docs/assets/js/12.b0a7194b.js"><link rel="prefetch" href="/docs/assets/js/120.f2bbaf68.js"><link rel="prefetch" href="/docs/assets/js/121.70d353c2.js"><link rel="prefetch" href="/docs/assets/js/122.502723f1.js"><link rel="prefetch" href="/docs/assets/js/123.a5a516b2.js"><link rel="prefetch" href="/docs/assets/js/124.dada419b.js"><link rel="prefetch" href="/docs/assets/js/125.2f8d4fd6.js"><link rel="prefetch" href="/docs/assets/js/126.88780a5d.js"><link rel="prefetch" href="/docs/assets/js/127.d48a77f8.js"><link rel="prefetch" href="/docs/assets/js/128.b67bc329.js"><link rel="prefetch" href="/docs/assets/js/129.bd39561a.js"><link rel="prefetch" href="/docs/assets/js/13.06dce828.js"><link rel="prefetch" href="/docs/assets/js/130.05d18c96.js"><link rel="prefetch" href="/docs/assets/js/131.56c087dc.js"><link rel="prefetch" href="/docs/assets/js/132.4f8c1351.js"><link rel="prefetch" href="/docs/assets/js/133.5e197b7e.js"><link rel="prefetch" href="/docs/assets/js/134.62cb07c4.js"><link rel="prefetch" href="/docs/assets/js/135.10b660c0.js"><link rel="prefetch" href="/docs/assets/js/136.b5df89a8.js"><link rel="prefetch" href="/docs/assets/js/137.b8300fa6.js"><link rel="prefetch" href="/docs/assets/js/138.bdbc78f5.js"><link rel="prefetch" href="/docs/assets/js/139.11f63e5e.js"><link rel="prefetch" href="/docs/assets/js/14.3b673cd7.js"><link rel="prefetch" href="/docs/assets/js/140.c1b81e6b.js"><link rel="prefetch" href="/docs/assets/js/141.ef540561.js"><link rel="prefetch" href="/docs/assets/js/142.5698602e.js"><link rel="prefetch" href="/docs/assets/js/143.2799d66b.js"><link rel="prefetch" href="/docs/assets/js/144.9be05ec2.js"><link rel="prefetch" href="/docs/assets/js/145.e60da528.js"><link rel="prefetch" href="/docs/assets/js/146.054688dc.js"><link rel="prefetch" href="/docs/assets/js/147.1ec69770.js"><link rel="prefetch" href="/docs/assets/js/148.d9f96b13.js"><link rel="prefetch" href="/docs/assets/js/149.882742ae.js"><link rel="prefetch" href="/docs/assets/js/15.dbfdd9a8.js"><link rel="prefetch" href="/docs/assets/js/150.1791c4d4.js"><link rel="prefetch" href="/docs/assets/js/151.d2ee3036.js"><link rel="prefetch" href="/docs/assets/js/152.13511b49.js"><link rel="prefetch" href="/docs/assets/js/153.0e9955fe.js"><link rel="prefetch" href="/docs/assets/js/154.843656ed.js"><link rel="prefetch" href="/docs/assets/js/155.ee6750d6.js"><link rel="prefetch" href="/docs/assets/js/156.4f6465f0.js"><link rel="prefetch" href="/docs/assets/js/157.50fa0fbd.js"><link rel="prefetch" href="/docs/assets/js/158.9b8889cb.js"><link rel="prefetch" href="/docs/assets/js/159.dee495ad.js"><link rel="prefetch" href="/docs/assets/js/16.983f63ec.js"><link rel="prefetch" href="/docs/assets/js/160.dd412a1c.js"><link rel="prefetch" href="/docs/assets/js/161.660ded74.js"><link rel="prefetch" href="/docs/assets/js/162.3a9685f9.js"><link rel="prefetch" href="/docs/assets/js/163.8173cc2f.js"><link rel="prefetch" href="/docs/assets/js/164.68fb5979.js"><link rel="prefetch" href="/docs/assets/js/165.da726cc9.js"><link rel="prefetch" href="/docs/assets/js/166.aca9b1db.js"><link rel="prefetch" href="/docs/assets/js/167.2785cc10.js"><link rel="prefetch" href="/docs/assets/js/168.80c8ebae.js"><link rel="prefetch" href="/docs/assets/js/169.9f9f1ec7.js"><link rel="prefetch" href="/docs/assets/js/17.1511a0ab.js"><link rel="prefetch" href="/docs/assets/js/170.4b5c57db.js"><link rel="prefetch" href="/docs/assets/js/171.2eea4817.js"><link rel="prefetch" href="/docs/assets/js/172.f2c2fc77.js"><link rel="prefetch" href="/docs/assets/js/173.598e3379.js"><link rel="prefetch" href="/docs/assets/js/174.c90a66e4.js"><link rel="prefetch" href="/docs/assets/js/175.3c6e2a39.js"><link rel="prefetch" href="/docs/assets/js/176.b7d730df.js"><link rel="prefetch" href="/docs/assets/js/177.d9e03569.js"><link rel="prefetch" href="/docs/assets/js/178.5b8184f6.js"><link rel="prefetch" href="/docs/assets/js/179.9e57897f.js"><link rel="prefetch" href="/docs/assets/js/18.c19e5978.js"><link rel="prefetch" href="/docs/assets/js/180.d7e197af.js"><link rel="prefetch" href="/docs/assets/js/181.d98e5ff7.js"><link rel="prefetch" href="/docs/assets/js/182.1d616545.js"><link rel="prefetch" href="/docs/assets/js/183.56c967b1.js"><link rel="prefetch" href="/docs/assets/js/184.d9e5f909.js"><link rel="prefetch" href="/docs/assets/js/185.a6dae740.js"><link rel="prefetch" href="/docs/assets/js/186.10ec19f5.js"><link rel="prefetch" href="/docs/assets/js/187.300320d4.js"><link rel="prefetch" href="/docs/assets/js/188.b2c15856.js"><link rel="prefetch" href="/docs/assets/js/189.51e76e74.js"><link rel="prefetch" href="/docs/assets/js/19.5b2d56da.js"><link rel="prefetch" href="/docs/assets/js/190.337a5a38.js"><link rel="prefetch" href="/docs/assets/js/191.a428d61a.js"><link rel="prefetch" href="/docs/assets/js/192.11247a08.js"><link rel="prefetch" href="/docs/assets/js/193.fe69c79f.js"><link rel="prefetch" href="/docs/assets/js/194.7bbe737d.js"><link rel="prefetch" href="/docs/assets/js/195.91355206.js"><link rel="prefetch" href="/docs/assets/js/196.c97e7ca6.js"><link rel="prefetch" href="/docs/assets/js/197.e0a9b0f5.js"><link rel="prefetch" href="/docs/assets/js/198.44c806e2.js"><link rel="prefetch" href="/docs/assets/js/199.810e115e.js"><link rel="prefetch" href="/docs/assets/js/20.dbe7bc73.js"><link rel="prefetch" href="/docs/assets/js/200.b1078f53.js"><link rel="prefetch" href="/docs/assets/js/201.f4bff529.js"><link rel="prefetch" href="/docs/assets/js/202.53a7e788.js"><link rel="prefetch" href="/docs/assets/js/203.fac7af70.js"><link rel="prefetch" href="/docs/assets/js/204.54839409.js"><link rel="prefetch" href="/docs/assets/js/205.8f1d01c0.js"><link rel="prefetch" href="/docs/assets/js/206.3a62cc4f.js"><link rel="prefetch" href="/docs/assets/js/207.dbb75dca.js"><link rel="prefetch" href="/docs/assets/js/208.3437c5ba.js"><link rel="prefetch" href="/docs/assets/js/209.1c5789c4.js"><link rel="prefetch" href="/docs/assets/js/21.2f832169.js"><link rel="prefetch" href="/docs/assets/js/210.d699133c.js"><link rel="prefetch" href="/docs/assets/js/211.16aa2168.js"><link rel="prefetch" href="/docs/assets/js/212.2724b46a.js"><link rel="prefetch" href="/docs/assets/js/213.a1ea93c6.js"><link rel="prefetch" href="/docs/assets/js/214.eb295de2.js"><link rel="prefetch" href="/docs/assets/js/215.6d0a1d2c.js"><link rel="prefetch" href="/docs/assets/js/216.99c397dc.js"><link rel="prefetch" href="/docs/assets/js/217.7398e7a7.js"><link rel="prefetch" href="/docs/assets/js/218.5bb1e317.js"><link rel="prefetch" href="/docs/assets/js/219.e78cbcfa.js"><link rel="prefetch" href="/docs/assets/js/22.c1901d06.js"><link rel="prefetch" href="/docs/assets/js/220.084e4a5e.js"><link rel="prefetch" href="/docs/assets/js/222.04a5a38b.js"><link rel="prefetch" href="/docs/assets/js/223.f8f1403d.js"><link rel="prefetch" href="/docs/assets/js/224.0248f6bb.js"><link rel="prefetch" href="/docs/assets/js/225.4d558ac6.js"><link rel="prefetch" href="/docs/assets/js/226.36959233.js"><link rel="prefetch" href="/docs/assets/js/227.41439635.js"><link rel="prefetch" href="/docs/assets/js/228.705667c2.js"><link rel="prefetch" href="/docs/assets/js/229.24a32f44.js"><link rel="prefetch" href="/docs/assets/js/23.0a89a9d3.js"><link rel="prefetch" href="/docs/assets/js/230.215c6ed1.js"><link rel="prefetch" href="/docs/assets/js/231.8102c077.js"><link rel="prefetch" href="/docs/assets/js/232.e10f0f8e.js"><link rel="prefetch" href="/docs/assets/js/233.bc794254.js"><link rel="prefetch" href="/docs/assets/js/234.072d2681.js"><link rel="prefetch" href="/docs/assets/js/235.db59cd63.js"><link rel="prefetch" href="/docs/assets/js/236.71cb7c9e.js"><link rel="prefetch" href="/docs/assets/js/237.027283c3.js"><link rel="prefetch" href="/docs/assets/js/238.94ef1c7b.js"><link rel="prefetch" href="/docs/assets/js/239.8636929b.js"><link rel="prefetch" href="/docs/assets/js/24.d39dcd82.js"><link rel="prefetch" href="/docs/assets/js/240.32287feb.js"><link rel="prefetch" href="/docs/assets/js/241.fb0bbdba.js"><link rel="prefetch" href="/docs/assets/js/242.05ab6e1b.js"><link rel="prefetch" href="/docs/assets/js/243.fc126baf.js"><link rel="prefetch" href="/docs/assets/js/244.41d4619a.js"><link rel="prefetch" href="/docs/assets/js/245.b19b0123.js"><link rel="prefetch" href="/docs/assets/js/246.ce39d602.js"><link rel="prefetch" href="/docs/assets/js/247.2beae1af.js"><link rel="prefetch" href="/docs/assets/js/248.a88bc23a.js"><link rel="prefetch" href="/docs/assets/js/249.a30d584f.js"><link rel="prefetch" href="/docs/assets/js/25.cd1b0080.js"><link rel="prefetch" href="/docs/assets/js/250.ef956287.js"><link rel="prefetch" href="/docs/assets/js/251.0f69c7cb.js"><link rel="prefetch" href="/docs/assets/js/252.06fa8ad2.js"><link rel="prefetch" href="/docs/assets/js/253.1462c68a.js"><link rel="prefetch" href="/docs/assets/js/254.f6eba056.js"><link rel="prefetch" href="/docs/assets/js/255.b0baac97.js"><link rel="prefetch" href="/docs/assets/js/256.dacbda57.js"><link rel="prefetch" href="/docs/assets/js/257.db2543dd.js"><link rel="prefetch" href="/docs/assets/js/258.38cb3135.js"><link rel="prefetch" href="/docs/assets/js/259.66ded8f0.js"><link rel="prefetch" href="/docs/assets/js/26.adbf2979.js"><link rel="prefetch" href="/docs/assets/js/260.6209b250.js"><link rel="prefetch" href="/docs/assets/js/261.048bd1c2.js"><link rel="prefetch" href="/docs/assets/js/262.58cbb486.js"><link rel="prefetch" href="/docs/assets/js/263.cb5ee6d9.js"><link rel="prefetch" href="/docs/assets/js/264.a19c9f9e.js"><link rel="prefetch" href="/docs/assets/js/265.9a4ccd23.js"><link rel="prefetch" href="/docs/assets/js/266.dd873d42.js"><link rel="prefetch" href="/docs/assets/js/267.19aaf8a0.js"><link rel="prefetch" href="/docs/assets/js/268.094581ab.js"><link rel="prefetch" href="/docs/assets/js/269.59210295.js"><link rel="prefetch" href="/docs/assets/js/27.e99d675e.js"><link rel="prefetch" href="/docs/assets/js/270.5e1d5b66.js"><link rel="prefetch" href="/docs/assets/js/271.3a823a21.js"><link rel="prefetch" href="/docs/assets/js/272.af153686.js"><link rel="prefetch" href="/docs/assets/js/273.0546d934.js"><link rel="prefetch" href="/docs/assets/js/274.a0233fc9.js"><link rel="prefetch" href="/docs/assets/js/275.3855b0af.js"><link rel="prefetch" href="/docs/assets/js/276.65cfd64d.js"><link rel="prefetch" href="/docs/assets/js/277.b87358eb.js"><link rel="prefetch" href="/docs/assets/js/278.20ffbc28.js"><link rel="prefetch" href="/docs/assets/js/279.d5f94530.js"><link rel="prefetch" href="/docs/assets/js/280.09d68e6f.js"><link rel="prefetch" href="/docs/assets/js/281.64da3c66.js"><link rel="prefetch" href="/docs/assets/js/282.237e66dc.js"><link rel="prefetch" href="/docs/assets/js/283.08919e47.js"><link rel="prefetch" href="/docs/assets/js/284.a1df32ac.js"><link rel="prefetch" href="/docs/assets/js/285.3df8865d.js"><link rel="prefetch" href="/docs/assets/js/286.c8abf84b.js"><link rel="prefetch" href="/docs/assets/js/287.0bdbb15e.js"><link rel="prefetch" href="/docs/assets/js/288.55f6e57a.js"><link rel="prefetch" href="/docs/assets/js/289.7d23b308.js"><link rel="prefetch" href="/docs/assets/js/29.19b3d651.js"><link rel="prefetch" href="/docs/assets/js/290.46cceb86.js"><link rel="prefetch" href="/docs/assets/js/291.d90bdf3b.js"><link rel="prefetch" href="/docs/assets/js/292.e332d636.js"><link rel="prefetch" href="/docs/assets/js/293.81a246a8.js"><link rel="prefetch" href="/docs/assets/js/294.1a277f0b.js"><link rel="prefetch" href="/docs/assets/js/295.47067cc8.js"><link rel="prefetch" href="/docs/assets/js/296.b229b380.js"><link rel="prefetch" href="/docs/assets/js/297.6d533979.js"><link rel="prefetch" href="/docs/assets/js/298.ec55887c.js"><link rel="prefetch" href="/docs/assets/js/299.0f0c448e.js"><link rel="prefetch" href="/docs/assets/js/3.f0fecc1b.js"><link rel="prefetch" href="/docs/assets/js/30.c3585074.js"><link rel="prefetch" href="/docs/assets/js/300.162bbb48.js"><link rel="prefetch" href="/docs/assets/js/301.3e4df8a1.js"><link rel="prefetch" href="/docs/assets/js/302.a36142b5.js"><link rel="prefetch" href="/docs/assets/js/303.2e8b2b87.js"><link rel="prefetch" href="/docs/assets/js/304.3ae8ce9d.js"><link rel="prefetch" href="/docs/assets/js/305.8032e3ce.js"><link rel="prefetch" href="/docs/assets/js/306.ded5a2e3.js"><link rel="prefetch" href="/docs/assets/js/307.4e1ae8b1.js"><link rel="prefetch" href="/docs/assets/js/308.b193d391.js"><link rel="prefetch" href="/docs/assets/js/309.0767ff99.js"><link rel="prefetch" href="/docs/assets/js/31.a94e58c5.js"><link rel="prefetch" href="/docs/assets/js/310.0df4524d.js"><link rel="prefetch" href="/docs/assets/js/311.5a485450.js"><link rel="prefetch" href="/docs/assets/js/312.4804eb18.js"><link rel="prefetch" href="/docs/assets/js/313.ae7e1665.js"><link rel="prefetch" href="/docs/assets/js/314.8e0f9727.js"><link rel="prefetch" href="/docs/assets/js/315.9a842946.js"><link rel="prefetch" href="/docs/assets/js/316.7212b0b4.js"><link rel="prefetch" href="/docs/assets/js/317.4371b07d.js"><link rel="prefetch" href="/docs/assets/js/318.e9d5ca7c.js"><link rel="prefetch" href="/docs/assets/js/319.192e8fd5.js"><link rel="prefetch" href="/docs/assets/js/32.d4842f2e.js"><link rel="prefetch" href="/docs/assets/js/320.742de287.js"><link rel="prefetch" href="/docs/assets/js/321.9ff394e3.js"><link rel="prefetch" href="/docs/assets/js/322.7e5cd098.js"><link rel="prefetch" href="/docs/assets/js/323.182e3b36.js"><link rel="prefetch" href="/docs/assets/js/324.d394f163.js"><link rel="prefetch" href="/docs/assets/js/325.4948679f.js"><link rel="prefetch" href="/docs/assets/js/326.9f46a628.js"><link rel="prefetch" href="/docs/assets/js/327.c2783569.js"><link rel="prefetch" href="/docs/assets/js/328.6a991c84.js"><link rel="prefetch" href="/docs/assets/js/329.97025b52.js"><link rel="prefetch" href="/docs/assets/js/33.a0c8c6cb.js"><link rel="prefetch" href="/docs/assets/js/330.55400e6e.js"><link rel="prefetch" href="/docs/assets/js/331.32ad1505.js"><link rel="prefetch" href="/docs/assets/js/332.94441856.js"><link rel="prefetch" href="/docs/assets/js/333.a0b0d673.js"><link rel="prefetch" href="/docs/assets/js/334.e311c360.js"><link rel="prefetch" href="/docs/assets/js/335.ad5ecfc7.js"><link rel="prefetch" href="/docs/assets/js/336.e3d47e73.js"><link rel="prefetch" href="/docs/assets/js/337.d9832f3c.js"><link rel="prefetch" href="/docs/assets/js/338.037b454e.js"><link rel="prefetch" href="/docs/assets/js/339.45a117eb.js"><link rel="prefetch" href="/docs/assets/js/34.f3a51617.js"><link rel="prefetch" href="/docs/assets/js/340.2ceb84aa.js"><link rel="prefetch" href="/docs/assets/js/341.f63a247c.js"><link rel="prefetch" href="/docs/assets/js/342.4dbbc7aa.js"><link rel="prefetch" href="/docs/assets/js/343.7e397a0a.js"><link rel="prefetch" href="/docs/assets/js/344.73ea6936.js"><link rel="prefetch" href="/docs/assets/js/345.c24f5692.js"><link rel="prefetch" href="/docs/assets/js/346.81233004.js"><link rel="prefetch" href="/docs/assets/js/347.decdbdca.js"><link rel="prefetch" href="/docs/assets/js/348.1fff1d3c.js"><link rel="prefetch" href="/docs/assets/js/349.909a2624.js"><link rel="prefetch" href="/docs/assets/js/35.e273d6d0.js"><link rel="prefetch" href="/docs/assets/js/36.ea0f125b.js"><link rel="prefetch" href="/docs/assets/js/37.25113cb5.js"><link rel="prefetch" href="/docs/assets/js/38.3e622ebc.js"><link rel="prefetch" href="/docs/assets/js/39.1b9f950b.js"><link rel="prefetch" href="/docs/assets/js/4.c2ed7203.js"><link rel="prefetch" href="/docs/assets/js/40.1b467222.js"><link rel="prefetch" href="/docs/assets/js/41.cd6fa45a.js"><link rel="prefetch" href="/docs/assets/js/42.330150a8.js"><link rel="prefetch" href="/docs/assets/js/43.f3c937a7.js"><link rel="prefetch" href="/docs/assets/js/44.09d8cfc1.js"><link rel="prefetch" href="/docs/assets/js/45.4d4ba22f.js"><link rel="prefetch" href="/docs/assets/js/46.d3d33dcd.js"><link rel="prefetch" href="/docs/assets/js/47.4645c71e.js"><link rel="prefetch" href="/docs/assets/js/48.b3fc605f.js"><link rel="prefetch" href="/docs/assets/js/49.fe7f1b10.js"><link rel="prefetch" href="/docs/assets/js/5.32731d51.js"><link rel="prefetch" href="/docs/assets/js/50.a69a03f5.js"><link rel="prefetch" href="/docs/assets/js/51.2247a239.js"><link rel="prefetch" href="/docs/assets/js/52.7748c4eb.js"><link rel="prefetch" href="/docs/assets/js/53.cd98f33f.js"><link rel="prefetch" href="/docs/assets/js/54.ed80cbc1.js"><link rel="prefetch" href="/docs/assets/js/55.29fc7133.js"><link rel="prefetch" href="/docs/assets/js/56.53ce817b.js"><link rel="prefetch" href="/docs/assets/js/57.2565e13f.js"><link rel="prefetch" href="/docs/assets/js/58.dc9eb9d8.js"><link rel="prefetch" href="/docs/assets/js/59.ff141678.js"><link rel="prefetch" href="/docs/assets/js/6.3b3bc4f7.js"><link rel="prefetch" href="/docs/assets/js/60.0b13f161.js"><link rel="prefetch" href="/docs/assets/js/61.3f85f2c5.js"><link rel="prefetch" href="/docs/assets/js/62.c5991070.js"><link rel="prefetch" href="/docs/assets/js/63.5ae731ec.js"><link rel="prefetch" href="/docs/assets/js/64.a235a635.js"><link rel="prefetch" href="/docs/assets/js/65.1b68e14c.js"><link rel="prefetch" href="/docs/assets/js/66.80d5aea4.js"><link rel="prefetch" href="/docs/assets/js/67.fa930da7.js"><link rel="prefetch" href="/docs/assets/js/68.8d890f22.js"><link rel="prefetch" href="/docs/assets/js/69.4515d55a.js"><link rel="prefetch" href="/docs/assets/js/7.33c89092.js"><link rel="prefetch" href="/docs/assets/js/70.8cd5e9af.js"><link rel="prefetch" href="/docs/assets/js/71.2825c3c8.js"><link rel="prefetch" href="/docs/assets/js/72.b7f96f51.js"><link rel="prefetch" href="/docs/assets/js/73.2fc2d624.js"><link rel="prefetch" href="/docs/assets/js/74.60133a53.js"><link rel="prefetch" href="/docs/assets/js/75.fa95c617.js"><link rel="prefetch" href="/docs/assets/js/76.52cc39db.js"><link rel="prefetch" href="/docs/assets/js/77.923c6894.js"><link rel="prefetch" href="/docs/assets/js/78.2517578e.js"><link rel="prefetch" href="/docs/assets/js/79.ca89577f.js"><link rel="prefetch" href="/docs/assets/js/8.e6a856b2.js"><link rel="prefetch" href="/docs/assets/js/80.ef4c891c.js"><link rel="prefetch" href="/docs/assets/js/81.a21b0d92.js"><link rel="prefetch" href="/docs/assets/js/82.eaed8897.js"><link rel="prefetch" href="/docs/assets/js/83.5d4b6b98.js"><link rel="prefetch" href="/docs/assets/js/84.70f4c1dc.js"><link rel="prefetch" href="/docs/assets/js/85.cea09840.js"><link rel="prefetch" href="/docs/assets/js/86.a2520a77.js"><link rel="prefetch" href="/docs/assets/js/87.d829c523.js"><link rel="prefetch" href="/docs/assets/js/88.581dfced.js"><link rel="prefetch" href="/docs/assets/js/89.094e79fa.js"><link rel="prefetch" href="/docs/assets/js/9.7bf5745b.js"><link rel="prefetch" href="/docs/assets/js/90.25088aeb.js"><link rel="prefetch" href="/docs/assets/js/91.2c1ec0b0.js"><link rel="prefetch" href="/docs/assets/js/92.59b0ecaf.js"><link rel="prefetch" href="/docs/assets/js/93.eb2a0307.js"><link rel="prefetch" href="/docs/assets/js/94.c5168b67.js"><link rel="prefetch" href="/docs/assets/js/95.42c6f3fb.js"><link rel="prefetch" href="/docs/assets/js/96.c3a9b392.js"><link rel="prefetch" href="/docs/assets/js/97.4a0c488e.js"><link rel="prefetch" href="/docs/assets/js/98.5cdaea7a.js"><link rel="prefetch" href="/docs/assets/js/99.01d6d721.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.5d974432.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>The Art of Readable Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/artofcode/c1.html" class="sidebar-link">1. Code Should Be Easy to Understand</a></li><li><a href="/docs/kungfu/artofcode/c2.html" class="sidebar-link">2. Packing Information into Names</a></li><li><a href="/docs/kungfu/artofcode/c3.html" class="sidebar-link">3. Names That Can’t Be Misconstrued</a></li><li><a href="/docs/kungfu/artofcode/c4.html" class="sidebar-link">4. Aesthetics</a></li><li><a href="/docs/kungfu/artofcode/c5.html" class="sidebar-link">5. Knowing What to Comment</a></li><li><a href="/docs/kungfu/artofcode/c6.html" class="sidebar-link">6. Making Comments Precise and Compact</a></li><li><a href="/docs/kungfu/artofcode/c7.html" class="sidebar-link">7. Making Control Flow Easy to Read</a></li><li><a href="/docs/kungfu/artofcode/c8.html" class="sidebar-link">8. Breaking Down Giant Expressions</a></li><li><a href="/docs/kungfu/artofcode/c9.html" class="sidebar-link">9. Variables and Readability</a></li><li><a href="/docs/kungfu/artofcode/c10.html" aria-current="page" class="active sidebar-link">10. Extracting Unrelated Subproblems</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#introductory" class="sidebar-link">Introductory</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#pure-utility-code" class="sidebar-link">Pure Utility Code</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#other-general-purpose-code" class="sidebar-link">Other General-Purpose Code</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#create-a-lot-of-general-purpose-code" class="sidebar-link">Create a Lot of General-Purpose Code</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#project-specific-functionality" class="sidebar-link">Project-Specific Functionality</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#simplifying-an-existing-interface" class="sidebar-link">Simplifying an Existing Interface</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#reshaping-an-interface-to-your-needs" class="sidebar-link">Reshaping an Interface to Your Needs</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#taking-things-too-far" class="sidebar-link">Taking Things Too Far</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c10.html#summary" class="sidebar-link">Summary</a></li></ul></li><li><a href="/docs/kungfu/artofcode/c11.html" class="sidebar-link">11. One Task at a Time</a></li><li><a href="/docs/kungfu/artofcode/c12.html" class="sidebar-link">12. Turning Thoughts into Code</a></li><li><a href="/docs/kungfu/artofcode/c13.html" class="sidebar-link">13. Writing Less Code</a></li><li><a href="/docs/kungfu/artofcode/c14.html" class="sidebar-link">14. Testing and Readability</a></li><li><a href="/docs/kungfu/artofcode/c15.html" class="sidebar-link">15. Designing and Implementing a “Minute/Hour Counter”</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Clean Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_10-extracting-unrelated-subproblems"><a href="#_10-extracting-unrelated-subproblems" class="header-anchor">#</a> 10. Extracting Unrelated Subproblems</h1> <p>Engineering is all about breaking down big problems into smaller ones and putting the solutions for those problems back together. Applying this principle to code makes it more robust and easier to read.</p> <p>The advice for this chapter is to <strong>aggressively identify and extract unrelated subproblems.</strong> Here’s what we mean:</p> <ol><li>Look at a given function or block of code, and ask yourself, “What is the high-level goal of this code?”</li> <li>For each line of code, ask, “Is it working <em>directly</em> to that goal? Or is it solving an <em>unrelated subproblem</em> needed to meet it?”</li> <li>If enough lines are solving an unrelated subproblem, extract that code into a separate function.</li></ol> <p>Extracting code into separate functions is something you probably do every day. But for this chapter, we decided to focus on the specific case of extracting <em>unrelated subproblems</em> , where the extracted code is blissfully unaware of why it’s being called.</p> <p>As you’ll see, it’s an easy technique to apply but can improve your code substantially. Yet for some reason, many programmers don’t use this technique enough. The trick is to actively look for these unrelated subproblems.</p> <p>In this chapter, we will go through a variety of examples that illustrate this technique for different situations you might run into.</p> <h2 id="introductory"><a href="#introductory" class="header-anchor">#</a> Introductory</h2> <p>Example: <code>findClosestLocation()</code></p> <p>The high-level goal of the following JavaScript code is, <em>find the location that’s closest to a given point</em> (don’t get bogged down by the advanced geometry, which we’ve italicized):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Return which element of 'array' is closest to the given latitude/longitude.</span>
<span class="token comment">// Models the Earth as a perfect sphere.</span>
<span class="token keyword">var</span> <span class="token function-variable function">findClosestLocation</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lat<span class="token punctuation">,</span> lng<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> closest<span class="token punctuation">;</span>
    <span class="token keyword">var</span> closest_dist <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Convert both points to radians.</span>
        <span class="token keyword">var</span> lat_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> lng_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lng<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> lat2_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> lng2_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Use the &quot;Spherical Law of Cosines&quot; formula.</span>
        <span class="token keyword">var</span> dist <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat_rad<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat2_rad<span class="token punctuation">)</span> <span class="token operator">+</span>
        Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat_rad<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat2_rad<span class="token punctuation">)</span> <span class="token operator">*</span>
        Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lng2_rad <span class="token operator">-</span> lng_rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> closest_dist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            closest <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            closest_dist <span class="token operator">=</span> dist<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> closest<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Most of the code inside the loop is working on an unrelated subproblem: <em>Compute the spherical distance between two lat/long points.</em> Because there is so much of that code, it makes sense to extract it into a separate <code>spherical_distance()</code> function:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">spherical_distance</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lat1<span class="token punctuation">,</span> lng1<span class="token punctuation">,</span> lat2<span class="token punctuation">,</span> lng2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> lat1_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lat1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> lng1_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lng1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> lat2_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lat2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> lng2_rad <span class="token operator">=</span> <span class="token function">radians</span><span class="token punctuation">(</span>lng2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Use the &quot;Spherical Law of Cosines&quot; formula.</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat1_rad<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat2_rad<span class="token punctuation">)</span> <span class="token operator">+</span> 
            Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat1_rad<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat2_rad<span class="token punctuation">)</span> <span class="token operator">*</span>
            Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lng2_rad <span class="token operator">-</span> lng1_rad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Now the remaining code becomes:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">findClosestLocation</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">lat<span class="token punctuation">,</span> lng<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> closest<span class="token punctuation">;</span>
    <span class="token keyword">var</span> closest_dist <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> dist <span class="token operator">=</span> <span class="token function">spherical_distance</span><span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lng<span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> closest_dist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            closest <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            closest_dist <span class="token operator">=</span> dist<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> closest<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This code is far more readable because the reader can focus on the high-level goal without getting distracted by intense geometry equations.</p> <p>As an added bonus, <code>spherical_distance()</code> will be easier to test in isolation. And <code>spherical_distance()</code> is the type of function that could be reused in the future. This is why it’s an “unrelated” subproblem—it’s completely self-contained and unaware of how applications are using it.</p> <h2 id="pure-utility-code"><a href="#pure-utility-code" class="header-anchor">#</a> Pure Utility Code</h2> <p>There is a core set of basic tasks that most programs do, such as manipulating strings, using hash tables, and reading/writing files.</p> <p>Often, these “basic utilities” are implemented by the built-in libraries in your programming language. For instance, if you want to read the entire contents of a file, in PHP you can call <code>file_get_contents(&quot;filename&quot;)</code>, or in Python, you can do <code>open(&quot;filename&quot;).read()</code>.</p> <p>But sometimes you have to fill in the gaps yourself. In C++, for instance, there is no succinct way to read an entire file. Instead, you inevitably end up writing code like this:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>ifstream <span class="token function">file</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Calculate the file's size, and allocate a buffer of that size.</span>
file<span class="token punctuation">.</span><span class="token function">seekg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ios<span class="token operator">::</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> file_size <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">tellg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span><span class="token operator">*</span> file_buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span> <span class="token punctuation">[</span>file_size<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Read the entire file into the buffer.</span>
file<span class="token punctuation">.</span><span class="token function">seekg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ios<span class="token operator">::</span>beg<span class="token punctuation">)</span><span class="token punctuation">;</span>
file<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file_buf<span class="token punctuation">,</span> file_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is a classic example of an unrelated subproblem that should be extracted into a new function like <code>ReadFileToString()</code>. Now, the rest of your codebase can act as if C++ <em>did</em> have a <code>ReadFileToString()</code> function.</p> <p>In general, if you find yourself thinking, “I wish our library had an XYZ() function,” go ahead and write it! (Assuming it doesn’t already exist.) Over time, you’ll build up a nice collection of utility code that can be used across projects.</p> <h2 id="other-general-purpose-code"><a href="#other-general-purpose-code" class="header-anchor">#</a> Other General-Purpose Code</h2> <p>When debugging JavaScript, programmers often use <code>alert()</code> to pop up a message box that displays some information to the programmer, the Web’s version of “printf() debugging.” For example, the following function call submits data to the server using Ajax and then displays the dictionary returned from the server:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax_post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token string">'http://example.com/submit'</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> data<span class="token punctuation">,</span>
    <span class="token function-variable function">on_success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response_data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> response_data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            str <span class="token operator">+=</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> response_data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>str <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Continue handling 'response_data' ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The high-level goal of this code is, <em>Make an Ajax call to the server, and handle the response.</em> But a lot of the code is solving the unrelated subproblem, <em>Pretty-print a dictionary.</em> It’s easy to extract that code into a function like format_pretty(obj):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">format_pretty</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        str <span class="token operator">+=</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> str <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="unexpected-benefits"><a href="#unexpected-benefits" class="header-anchor">#</a> <strong>Unexpected Benefits</strong></h3> <p>There are a lot of reasons why extracting <code>format_pretty()</code> is a good idea. It makes the calling code simpler, and <code>format_pretty()</code> is a handy function to have around.</p> <p>But there’s another great reason that’s not as obvious: <strong>it’s easier to improve</strong> <code>format_pretty()</code> <strong>when the code is by itself.</strong> When you’re working on a smaller function in isolation, it feels easier to add features, improve reliability, take care of edge cases, and so on.</p> <p>Here are some cases <code>format_pretty(obj)</code> doesn’t handle:</p> <ul><li>It expects obj to be an object. If instead it’s a plain string (or undefined), the current code will throw an exception.</li> <li>It expects each value of obj to be a simple type. If instead it contains nested objects, the current code will display them as <code>[object Object]</code>, which isn’t very pretty.</li></ul> <p>Before we separated <code>format_pretty()</code> into its own function, it would have felt like a lot of work to make all these improvements. (In fact, recursively printing nested objects is very difficult without a separate function.)</p> <p>But now, adding this functionality is easy. Here’s what the improved code looks like:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">format_pretty</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> indent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle null, undefined, strings, and non-objects.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;null&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'&quot;'</span> <span class="token operator">+</span> obj <span class="token operator">+</span> <span class="token string">'&quot;'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>indent <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> indent <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// Handle (non-null) objects.</span>
    <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        str <span class="token operator">+=</span> indent <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span><span class="token punctuation">;</span>
        str <span class="token operator">+=</span> <span class="token function">format_pretty</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> indent <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> str <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This covers the shortcomings listed previously and produces output like this:</p> <div class="language- extra-class"><pre class="language-text"><code>{
    key1 = 1
    key2 = true
    key3 = undefined
    key4 = null
    key5 = {
        key5a = {
            key5a1 = &quot;hello world&quot;
        }
    }
}
</code></pre></div><h2 id="create-a-lot-of-general-purpose-code"><a href="#create-a-lot-of-general-purpose-code" class="header-anchor">#</a> Create a Lot of General-Purpose Code</h2> <p>The functions <code>ReadFileToString()</code> and <code>format_pretty()</code> are great examples of unrelated subproblems. They’re so basic and widely applicable that they are likely to be reused across projects. Codebases often have a special directory for code like this (e.g., <code>util/</code>) so that it can be easily shared.</p> <p>General-purpose code is great because <strong>it’s completely decoupled from the rest of your project.</strong> Code like this is easier to develop, easier to test, and easier to understand. If only all of your code could be like this!</p> <p>Think about many of the powerful libraries and systems that you use, such as SQL databases, JavaScript libraries, and HTML templating systems. You don’t have to worry about their internals—those codebases are completely isolated from your project. As a result, your project’s codebase remains small.</p> <p>The more of your project you can break away as isolated libraries, the better, because the rest of your code will be smaller and easier to think about.</p> <div class="custom-block tip"><p class="custom-block-title">IS THIS TOP-DOWN OR BOTTOM-UP PROGRAMMING?</p> <p><strong>Top-down programming</strong> is a style where the highest-level modules and functions are designed first
and the lower-level functions are implemented as needed to support them.</p> <p><strong>Bottom-up programming</strong> tries to anticipate and solve all the subproblems first and then build the
higher-level components using these pieces.</p> <p>This chapter isn’t advocating one method over the other. Most programming involves a combination
of both. What’s important is the end result: subproblems are removed and tackled separately.</p></div> <h2 id="project-specific-functionality"><a href="#project-specific-functionality" class="header-anchor">#</a> Project-Specific Functionality</h2> <p>Ideally, the subproblems you extract would be completely project-agnostic. But even if they’re not, that’s okay. Breaking off subproblems still works wonders.</p> <p>Here is an example from a business reviews website. This Python code creates a new <code>Business</code> object and sets its <code>name</code>, <code>url</code>, and <code>date_created</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>business <span class="token operator">=</span> <span class="token function">Business</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
business<span class="token punctuation">.</span> name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>

url_path_name <span class="token operator">=</span> business<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">lower</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
url_path_name <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>r<span class="token string">&quot;['\.]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> url_path_name<span class="token punctuation">)</span>
url_path_name <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>r<span class="token string">&quot;[^a-z0-9]+&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> url_path_name<span class="token punctuation">)</span>
url_path_name <span class="token operator">=</span> url_path_name<span class="token punctuation">.</span><span class="token function">strip</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
business<span class="token punctuation">.</span> url <span class="token operator">=</span> <span class="token string">&quot;/biz/&quot;</span> <span class="token operator">+</span> url_path_name

business<span class="token punctuation">.</span> date_created <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">utcnow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
business<span class="token punctuation">.</span><span class="token function">save_to_database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>The <code>url</code> is supposed to be a “clean” version of the name. For example, if the name is “A.C. Joe’sTire &amp; Smog, Inc.,” the url will be &quot;/biz/ac-joes-tire-smog-inc&quot;.</p> <p>The unrelated subproblem in this code is: <em>Turn a name into a valid URL.</em> We can extract this code quite easily. While we’re at it, we can also precompile the regular expressions (and give them readable names):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">CHARS_TO_REMOVE</span> <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>r<span class="token string">&quot;['\.]+&quot;</span><span class="token punctuation">)</span>
<span class="token constant">CHARS_TO_DASH</span> <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>r<span class="token string">&quot;[^a-z0-9]+&quot;</span><span class="token punctuation">)</span>

def <span class="token function">make_url_friendly</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token operator">:</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">lower</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> <span class="token constant">CHARS_TO_REMOVE</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>
text <span class="token operator">=</span> <span class="token constant">CHARS_TO_DASH</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>
<span class="token keyword">return</span> text<span class="token punctuation">.</span><span class="token function">strip</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>Now the original code has a much more “regular” pattern:</p> <div class="language-js extra-class"><pre class="language-js"><code>business <span class="token operator">=</span> <span class="token function">Business</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
business<span class="token punctuation">.</span> name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>
business<span class="token punctuation">.</span> url <span class="token operator">=</span> <span class="token string">&quot;/biz/&quot;</span> <span class="token operator">+</span> <span class="token function">make_url_friendly</span> <span class="token punctuation">(</span>business<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
business<span class="token punctuation">.</span> date_created <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">utcnow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
business<span class="token punctuation">.</span><span class="token function">save_to_database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>This code requires far less effort to read because you aren’t distracted by the regular expressions and deep string manipulation.</p> <p>Where should you put the code for <code>make_url_friendly()</code>? It seems like a fairly general function, so it might make sense to put it in a separate <code>util/</code> directory. On the other hand, those regular expressions were designed with U.S. business names in mind, so perhaps the code should stay in the same file where it’s used. It actually doesn’t matter that much, and you can easily move the definition later on. What’s more important is that <code>make_url_friendly()</code> was extracted at all.</p> <h2 id="simplifying-an-existing-interface"><a href="#simplifying-an-existing-interface" class="header-anchor">#</a> Simplifying an Existing Interface</h2> <p>Everybody loves when a library offers a clean interface—one that takes few arguments, doesn’t need much setup, and generally requires little effort to use. It makes your code look elegant: simple and powerful at the same time.</p> <p>But if an interface you’re using isn’t clean, you can still make your own “wrapper” functions that are.</p> <p>For example, dealing with browser cookies in JavaScript is far from ideal. Conceptually, cookies are a set of name/value pairs. But the interface the browser provides presents a single document.cookie string whose syntax is:</p> <div class="language- extra-class"><pre class="language-text"><code>name1=value1; name2=value2; ...
</code></pre></div><p>To find the cookie you want, you’re forced to parse this giant string yourself. Here’s an example of code that reads the value for the cookie named &quot;<code>max_results</code>&quot;:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> max_results<span class="token punctuation">;</span>
<span class="token keyword">var</span> cookies <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cookies<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> cookies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    c <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[ ]+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// remove leading spaces</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;max_results=&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>
        max_results <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Wow, that’s some ugly code. Clearly, there’s a <code>get_cookie()</code> function waiting to be made so that we can just write:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> max_results <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span> <span class="token function">get_cookie</span> <span class="token punctuation">(</span><span class="token string">&quot;max_results&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creating or changing a cookie value is even stranger. You have to set document.cookie to a value with an exact syntax:</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">&quot; max_results=50 ; expires=Wed, 1 Jan 2020 20:53:47 UTC; path=/&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>That statement looks like it would overwrite all other existing cookies, but (magically) itdoesn’t!</p> <p>A more ideal interface to setting a cookie would be something like:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">set_cookie</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> days_to_expire<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Erasing a cookie is also unintuitive: you have to set the cookie to expire in the past. Instead, an ideal interface would be simply:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">delete_cookie</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The lesson here is that <strong>you should never have to settle for an interface that’s less than ideal.</strong> You can always create your own wrapper functions to hide the ugly details of an interface you’re stuck with.</p> <h2 id="reshaping-an-interface-to-your-needs"><a href="#reshaping-an-interface-to-your-needs" class="header-anchor">#</a> Reshaping an Interface to Your Needs</h2> <p>A lot of code in a program is there just to support other code—for example, setting up inputs to a function or postprocessing the output. This “glue” code often has nothing to do with the real logic of your program. Mundane code like this is a great candidate to be pulled out into separate functions.</p> <p>For example, let’s say you have a Python dictionary containing sensitive user information like
<code>{ &quot;username&quot;: &quot;...&quot;, &quot;password&quot;: &quot;...&quot; }</code> and you need to put all that information into a URL.</p> <p>Because it’s sensitive, you decide to encrypt the dictionary first, using a <code>Cipher</code> class.</p> <p>But <code>Cipher</code> expects a string of bytes as input, not a dictionary. And <code>Cipher</code> returns a string of bytes, but we need something that’s URL-safe. Cipher also takes a number of extra parameters and is pretty cumbersome to use.</p> <p>What started as a simple task turns into a lot of glue code:</p> <div class="language-js extra-class"><pre class="language-js"><code>user_info <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span>
user_str <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">dumps</span><span class="token punctuation">(</span>user_info<span class="token punctuation">)</span>
cipher <span class="token operator">=</span> <span class="token function">Cipher</span> <span class="token punctuation">(</span><span class="token string">&quot;aes_128_cbc&quot;</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token constant">PRIVATE_KEY</span><span class="token punctuation">,</span> init_vector<span class="token operator">=</span><span class="token constant">INIT_VECTOR</span><span class="token punctuation">,</span> op<span class="token operator">=</span><span class="token constant">ENCODE</span><span class="token punctuation">)</span>
encrypted_bytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">update</span> <span class="token punctuation">(</span>user_str<span class="token punctuation">)</span>
encrypted_bytes <span class="token operator">+=</span> cipher<span class="token punctuation">.</span><span class="token function">final</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> # flush out the current <span class="token number">128</span> bit block
url <span class="token operator">=</span> <span class="token string">&quot;http://example.com/?user_info=&quot;</span> <span class="token operator">+</span> base64<span class="token punctuation">.</span><span class="token function">urlsafe_b64encode</span><span class="token punctuation">(</span>encrypted_bytes<span class="token punctuation">)</span>
</code></pre></div><p>Even though the problem we’re tackling is <em>Encrypt the user’s information into a URL,</em> the majority of this code is just doing <em>Encrypt this Python object into a URL-friendly string.</em> It’s easy to extract that subproblem:</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">url_safe_encrypt</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    obj_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span><span class="token string">&quot;aes_128_cbc&quot;</span><span class="token punctuation">,</span> key<span class="token operator">=</span>PRIVATE_KEY<span class="token punctuation">,</span> init_vector<span class="token operator">=</span>INIT_VECTOR<span class="token punctuation">,</span> op<span class="token operator">=</span>ENCODE<span class="token punctuation">)</span>
    encrypted_bytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span>update<span class="token punctuation">(</span>obj_str<span class="token punctuation">)</span>
    encrypted_bytes <span class="token operator">+=</span> cipher<span class="token punctuation">.</span>final<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># flush out the current 128 bit block</span>
    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>urlsafe_b64encode<span class="token punctuation">(</span>encrypted_bytes<span class="token punctuation">)</span>
</code></pre></div><p>Then, the resulting code to execute the <em>real</em> logic of the program is simple:</p> <div class="language-js extra-class"><pre class="language-js"><code>user_info <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span>
url <span class="token operator">=</span> <span class="token string">&quot;http://example.com/?user_info=&quot;</span> <span class="token operator">+</span> <span class="token function">url_safe_encrypt</span> <span class="token punctuation">(</span>user_info<span class="token punctuation">)</span>
</code></pre></div><h2 id="taking-things-too-far"><a href="#taking-things-too-far" class="header-anchor">#</a> Taking Things Too Far</h2> <p>As we said at the beginning of the chapter, our goal is to “ <em>aggressively</em> identify and extract unrelated subproblems.” We say “aggressively” because most coders aren’t aggressive enough.</p> <p>But it’s possible to get overexcited and take things too far.</p> <p>For example, the code from the previous section could have been broken down much further, like this:</p> <div class="language-py extra-class"><pre class="language-py"><code>user_info <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;...&quot;</span> <span class="token punctuation">}</span>
url <span class="token operator">=</span> <span class="token string">&quot;http://example.com/?user_info=&quot;</span> <span class="token operator">+</span> url_safe_encrypt_obj <span class="token punctuation">(</span>user_info<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">url_safe_encrypt_obj</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    obj_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token keyword">return</span> url_safe_encrypt_str <span class="token punctuation">(</span>obj_str<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">url_safe_encrypt_str</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    encrypted_bytes <span class="token operator">=</span> encrypt <span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>urlsafe_b64encode<span class="token punctuation">(</span>encrypted_bytes<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> make_cipher <span class="token punctuation">(</span><span class="token punctuation">)</span>
    encrypted_bytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    encrypted_bytes <span class="token operator">+=</span> cipher<span class="token punctuation">.</span>final<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># flush out any remaining bytes</span>
    <span class="token keyword">return</span> encrypted_bytes

<span class="token keyword">def</span> <span class="token function">make_cipher</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Cipher<span class="token punctuation">(</span><span class="token string">&quot;aes_128_cbc&quot;</span><span class="token punctuation">,</span> key<span class="token operator">=</span>PRIVATE_KEY<span class="token punctuation">,</span> init_vector<span class="token operator">=</span>INIT_VECTOR<span class="token punctuation">,</span> op<span class="token operator">=</span>ENCODE<span class="token punctuation">)</span>
</code></pre></div><p>Introducing all these tiny functions actually hurts readability, because the reader has more to keep track of, and following the path of execution requires jumping around.</p> <p>There is a small (but tangible) readability cost of adding a new function to your code. In the previous case, nothing is being gained to offset this cost. It may make sense to add these smaller functions if they’re needed by other parts of your project. But until then, there is no need.</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>A simple way to think about this chapter is to <strong>separate the generic code from the project-specific code.</strong> As it turns out, most code is generic. By building a large set of libraries and helper functions to solve the general problems, what’s left will be a small core of what makes your program unique.</p> <p>The main reason this technique helps is that it lets the programmer focus on smaller, well-defined problems that are detached from the rest of your project. As a result, the solutions to those subproblems tend to be more thorough and correct. You might also be able to reuse them later.</p> <h3 id="further-reading"><a href="#further-reading" class="header-anchor">#</a> FURTHER READING</h3> <p>Martin Fowler’s <em>Refactoring: Improving the Design of Existing Code</em> (Fowler et al., Addison-Wesley Professional, 1999) describes the “Extract Method” of refactoring and catalogs many other ways to refactor your code.</p> <p>Kent Beck’s <em>Smalltalk Best Practice Patterns</em> (Prentice Hall, 1996) describes the “Composed Method Pattern,” which lists a number of principles for breaking down your code into lots of little functions.</p> <p>In particular, one of the principles is “Keep all of the operations in a single method at the same level of abstraction.”</p> <p>These ideas are similar to our advice of “extracting unrelated subproblems.” What we discussed in this chapter is a simple and particular case of when to extract a method.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/artofcode/c9.html" class="prev">
        9. Variables and Readability
      </a></span> <span class="next"><a href="/docs/kungfu/artofcode/c11.html">
        11. One Task at a Time
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.e28ba3f8.js" defer></script><script src="/docs/assets/js/2.77a4f111.js" defer></script><script src="/docs/assets/js/221.f53b37dc.js" defer></script><script src="/docs/assets/js/28.0ed72f23.js" defer></script>
  </body>
</html>
