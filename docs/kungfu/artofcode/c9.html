<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C H A P T E R 9 | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.5d974432.css" as="style"><link rel="preload" href="/docs/assets/js/app.feff3dbb.js" as="script"><link rel="preload" href="/docs/assets/js/2.aca46d71.js" as="script"><link rel="preload" href="/docs/assets/js/230.dcc8e04d.js" as="script"><link rel="preload" href="/docs/assets/js/27.5ed2ce18.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e2dac1de.js"><link rel="prefetch" href="/docs/assets/js/100.072f86f4.js"><link rel="prefetch" href="/docs/assets/js/101.fc0bc918.js"><link rel="prefetch" href="/docs/assets/js/102.ddeddef2.js"><link rel="prefetch" href="/docs/assets/js/103.a299e414.js"><link rel="prefetch" href="/docs/assets/js/104.29aa9c20.js"><link rel="prefetch" href="/docs/assets/js/105.5211965b.js"><link rel="prefetch" href="/docs/assets/js/106.f091e57b.js"><link rel="prefetch" href="/docs/assets/js/107.80acce0d.js"><link rel="prefetch" href="/docs/assets/js/108.b0108b40.js"><link rel="prefetch" href="/docs/assets/js/109.7953f94a.js"><link rel="prefetch" href="/docs/assets/js/11.34f9e1bc.js"><link rel="prefetch" href="/docs/assets/js/110.59b888f8.js"><link rel="prefetch" href="/docs/assets/js/111.5b11b553.js"><link rel="prefetch" href="/docs/assets/js/112.8a857b53.js"><link rel="prefetch" href="/docs/assets/js/113.5aab77e8.js"><link rel="prefetch" href="/docs/assets/js/114.aef8a2f2.js"><link rel="prefetch" href="/docs/assets/js/115.777be1e9.js"><link rel="prefetch" href="/docs/assets/js/116.3092451f.js"><link rel="prefetch" href="/docs/assets/js/117.3345c37e.js"><link rel="prefetch" href="/docs/assets/js/118.be055f62.js"><link rel="prefetch" href="/docs/assets/js/119.77b121e6.js"><link rel="prefetch" href="/docs/assets/js/12.a704c651.js"><link rel="prefetch" href="/docs/assets/js/120.2d64d4ae.js"><link rel="prefetch" href="/docs/assets/js/121.954a3ba9.js"><link rel="prefetch" href="/docs/assets/js/122.f8032cd6.js"><link rel="prefetch" href="/docs/assets/js/123.96d7858b.js"><link rel="prefetch" href="/docs/assets/js/124.f12d4c00.js"><link rel="prefetch" href="/docs/assets/js/125.47b679a8.js"><link rel="prefetch" href="/docs/assets/js/126.725c596d.js"><link rel="prefetch" href="/docs/assets/js/127.75f3139f.js"><link rel="prefetch" href="/docs/assets/js/128.9862473f.js"><link rel="prefetch" href="/docs/assets/js/129.0f09cf34.js"><link rel="prefetch" href="/docs/assets/js/13.66fe2f7e.js"><link rel="prefetch" href="/docs/assets/js/130.d20c4272.js"><link rel="prefetch" href="/docs/assets/js/131.771cb92a.js"><link rel="prefetch" href="/docs/assets/js/132.308ce22e.js"><link rel="prefetch" href="/docs/assets/js/133.99780c7f.js"><link rel="prefetch" href="/docs/assets/js/134.c8bb3739.js"><link rel="prefetch" href="/docs/assets/js/135.d22b8cd4.js"><link rel="prefetch" href="/docs/assets/js/136.0f7f2732.js"><link rel="prefetch" href="/docs/assets/js/137.66315d8b.js"><link rel="prefetch" href="/docs/assets/js/138.bc1e4151.js"><link rel="prefetch" href="/docs/assets/js/139.4bf7c284.js"><link rel="prefetch" href="/docs/assets/js/14.57825f78.js"><link rel="prefetch" href="/docs/assets/js/140.023cb781.js"><link rel="prefetch" href="/docs/assets/js/141.3ed2d77a.js"><link rel="prefetch" href="/docs/assets/js/142.97feece5.js"><link rel="prefetch" href="/docs/assets/js/143.22b3a1b2.js"><link rel="prefetch" href="/docs/assets/js/144.3b8c0d53.js"><link rel="prefetch" href="/docs/assets/js/145.c187e405.js"><link rel="prefetch" href="/docs/assets/js/146.02e7dc46.js"><link rel="prefetch" href="/docs/assets/js/147.1ea04230.js"><link rel="prefetch" href="/docs/assets/js/148.eceb141f.js"><link rel="prefetch" href="/docs/assets/js/149.7bc98406.js"><link rel="prefetch" href="/docs/assets/js/15.cbcf56bd.js"><link rel="prefetch" href="/docs/assets/js/150.345f53e1.js"><link rel="prefetch" href="/docs/assets/js/151.97fd5643.js"><link rel="prefetch" href="/docs/assets/js/152.0f0ace62.js"><link rel="prefetch" href="/docs/assets/js/153.5ae906c9.js"><link rel="prefetch" href="/docs/assets/js/154.4524d48f.js"><link rel="prefetch" href="/docs/assets/js/155.d7cbb04b.js"><link rel="prefetch" href="/docs/assets/js/156.51743cf0.js"><link rel="prefetch" href="/docs/assets/js/157.12aa1a8a.js"><link rel="prefetch" href="/docs/assets/js/158.04757c69.js"><link rel="prefetch" href="/docs/assets/js/159.7a8588a6.js"><link rel="prefetch" href="/docs/assets/js/16.b9864c9c.js"><link rel="prefetch" href="/docs/assets/js/160.79ec6015.js"><link rel="prefetch" href="/docs/assets/js/161.4f0b5cd9.js"><link rel="prefetch" href="/docs/assets/js/162.6cc1f3af.js"><link rel="prefetch" href="/docs/assets/js/163.187c5335.js"><link rel="prefetch" href="/docs/assets/js/164.556dc6d8.js"><link rel="prefetch" href="/docs/assets/js/165.6c6e1f75.js"><link rel="prefetch" href="/docs/assets/js/166.afe12552.js"><link rel="prefetch" href="/docs/assets/js/167.bd3dd81a.js"><link rel="prefetch" href="/docs/assets/js/168.b5e90a8d.js"><link rel="prefetch" href="/docs/assets/js/169.80b477b3.js"><link rel="prefetch" href="/docs/assets/js/17.8983ce9d.js"><link rel="prefetch" href="/docs/assets/js/170.4fcbc9a3.js"><link rel="prefetch" href="/docs/assets/js/171.6c7ccd83.js"><link rel="prefetch" href="/docs/assets/js/172.e02d80ea.js"><link rel="prefetch" href="/docs/assets/js/173.66fb904a.js"><link rel="prefetch" href="/docs/assets/js/174.4f18cc78.js"><link rel="prefetch" href="/docs/assets/js/175.b1c5644a.js"><link rel="prefetch" href="/docs/assets/js/176.bd684253.js"><link rel="prefetch" href="/docs/assets/js/177.c62f362d.js"><link rel="prefetch" href="/docs/assets/js/178.f953855f.js"><link rel="prefetch" href="/docs/assets/js/179.10404ee2.js"><link rel="prefetch" href="/docs/assets/js/18.5efe21b3.js"><link rel="prefetch" href="/docs/assets/js/180.c4330ec2.js"><link rel="prefetch" href="/docs/assets/js/181.02c26c33.js"><link rel="prefetch" href="/docs/assets/js/182.773ba280.js"><link rel="prefetch" href="/docs/assets/js/183.064d5ae1.js"><link rel="prefetch" href="/docs/assets/js/184.2c64e798.js"><link rel="prefetch" href="/docs/assets/js/185.38c7b6e9.js"><link rel="prefetch" href="/docs/assets/js/186.d95e2e7a.js"><link rel="prefetch" href="/docs/assets/js/187.8aad3033.js"><link rel="prefetch" href="/docs/assets/js/188.7f201e8d.js"><link rel="prefetch" href="/docs/assets/js/189.6cefdb59.js"><link rel="prefetch" href="/docs/assets/js/19.58823304.js"><link rel="prefetch" href="/docs/assets/js/190.90e5aa35.js"><link rel="prefetch" href="/docs/assets/js/191.3e1cf065.js"><link rel="prefetch" href="/docs/assets/js/192.a2c49267.js"><link rel="prefetch" href="/docs/assets/js/193.cd7650f2.js"><link rel="prefetch" href="/docs/assets/js/194.1d2ca753.js"><link rel="prefetch" href="/docs/assets/js/195.e29ca5e1.js"><link rel="prefetch" href="/docs/assets/js/196.ff519f9d.js"><link rel="prefetch" href="/docs/assets/js/197.d7c7a2c2.js"><link rel="prefetch" href="/docs/assets/js/198.77259c6a.js"><link rel="prefetch" href="/docs/assets/js/199.7983bd3b.js"><link rel="prefetch" href="/docs/assets/js/20.3b486daa.js"><link rel="prefetch" href="/docs/assets/js/200.e9a796d0.js"><link rel="prefetch" href="/docs/assets/js/201.b4449da8.js"><link rel="prefetch" href="/docs/assets/js/202.ab520617.js"><link rel="prefetch" href="/docs/assets/js/203.1944c871.js"><link rel="prefetch" href="/docs/assets/js/204.2ddfe4db.js"><link rel="prefetch" href="/docs/assets/js/205.3a4a5484.js"><link rel="prefetch" href="/docs/assets/js/206.9eaec970.js"><link rel="prefetch" href="/docs/assets/js/207.ca2acd17.js"><link rel="prefetch" href="/docs/assets/js/208.bc4e3070.js"><link rel="prefetch" href="/docs/assets/js/209.8194c212.js"><link rel="prefetch" href="/docs/assets/js/21.1e77a313.js"><link rel="prefetch" href="/docs/assets/js/210.473ccc45.js"><link rel="prefetch" href="/docs/assets/js/211.623b4033.js"><link rel="prefetch" href="/docs/assets/js/212.0f85a611.js"><link rel="prefetch" href="/docs/assets/js/213.191977aa.js"><link rel="prefetch" href="/docs/assets/js/214.a23c6dcc.js"><link rel="prefetch" href="/docs/assets/js/215.25321a42.js"><link rel="prefetch" href="/docs/assets/js/216.e450a05c.js"><link rel="prefetch" href="/docs/assets/js/217.abab04ca.js"><link rel="prefetch" href="/docs/assets/js/218.66e0082a.js"><link rel="prefetch" href="/docs/assets/js/219.5f4ee9fd.js"><link rel="prefetch" href="/docs/assets/js/22.1c51f113.js"><link rel="prefetch" href="/docs/assets/js/220.bbb5df8d.js"><link rel="prefetch" href="/docs/assets/js/221.0d3dfd46.js"><link rel="prefetch" href="/docs/assets/js/222.8e68bdb2.js"><link rel="prefetch" href="/docs/assets/js/223.6c582cd9.js"><link rel="prefetch" href="/docs/assets/js/224.f570e175.js"><link rel="prefetch" href="/docs/assets/js/225.b249063b.js"><link rel="prefetch" href="/docs/assets/js/226.48576d77.js"><link rel="prefetch" href="/docs/assets/js/227.8346e855.js"><link rel="prefetch" href="/docs/assets/js/228.8e3e6ca7.js"><link rel="prefetch" href="/docs/assets/js/229.faed0af8.js"><link rel="prefetch" href="/docs/assets/js/23.dc13f196.js"><link rel="prefetch" href="/docs/assets/js/231.611372c2.js"><link rel="prefetch" href="/docs/assets/js/232.aaaeb300.js"><link rel="prefetch" href="/docs/assets/js/233.819d8911.js"><link rel="prefetch" href="/docs/assets/js/234.41eb70ca.js"><link rel="prefetch" href="/docs/assets/js/235.acedc064.js"><link rel="prefetch" href="/docs/assets/js/236.fbc4b8f7.js"><link rel="prefetch" href="/docs/assets/js/237.7b217482.js"><link rel="prefetch" href="/docs/assets/js/238.6b2400f7.js"><link rel="prefetch" href="/docs/assets/js/239.570754bf.js"><link rel="prefetch" href="/docs/assets/js/24.d1deb976.js"><link rel="prefetch" href="/docs/assets/js/240.30c365e9.js"><link rel="prefetch" href="/docs/assets/js/241.aebbd7aa.js"><link rel="prefetch" href="/docs/assets/js/242.5df1a85a.js"><link rel="prefetch" href="/docs/assets/js/243.704fb61f.js"><link rel="prefetch" href="/docs/assets/js/244.9bc98748.js"><link rel="prefetch" href="/docs/assets/js/245.38e733b7.js"><link rel="prefetch" href="/docs/assets/js/246.b81c0b24.js"><link rel="prefetch" href="/docs/assets/js/247.c0a84943.js"><link rel="prefetch" href="/docs/assets/js/248.47e7f09b.js"><link rel="prefetch" href="/docs/assets/js/249.29294a64.js"><link rel="prefetch" href="/docs/assets/js/25.ddba0ef8.js"><link rel="prefetch" href="/docs/assets/js/250.7b97771f.js"><link rel="prefetch" href="/docs/assets/js/251.af134ede.js"><link rel="prefetch" href="/docs/assets/js/252.996a9add.js"><link rel="prefetch" href="/docs/assets/js/253.6b08af88.js"><link rel="prefetch" href="/docs/assets/js/254.a14372bd.js"><link rel="prefetch" href="/docs/assets/js/255.868fb43f.js"><link rel="prefetch" href="/docs/assets/js/256.606c2f81.js"><link rel="prefetch" href="/docs/assets/js/257.9c34c318.js"><link rel="prefetch" href="/docs/assets/js/258.236c65be.js"><link rel="prefetch" href="/docs/assets/js/259.dc9c78fd.js"><link rel="prefetch" href="/docs/assets/js/26.23be3024.js"><link rel="prefetch" href="/docs/assets/js/260.228e0898.js"><link rel="prefetch" href="/docs/assets/js/261.7dd0cc1f.js"><link rel="prefetch" href="/docs/assets/js/262.7c674375.js"><link rel="prefetch" href="/docs/assets/js/263.0d61e50b.js"><link rel="prefetch" href="/docs/assets/js/264.0595e5d9.js"><link rel="prefetch" href="/docs/assets/js/265.4f8cb07b.js"><link rel="prefetch" href="/docs/assets/js/266.fe3edb0f.js"><link rel="prefetch" href="/docs/assets/js/267.8942e793.js"><link rel="prefetch" href="/docs/assets/js/268.86eb0eb9.js"><link rel="prefetch" href="/docs/assets/js/269.03f58dca.js"><link rel="prefetch" href="/docs/assets/js/270.90b7be1d.js"><link rel="prefetch" href="/docs/assets/js/271.b556bf53.js"><link rel="prefetch" href="/docs/assets/js/272.0b7f4823.js"><link rel="prefetch" href="/docs/assets/js/273.d311f5f5.js"><link rel="prefetch" href="/docs/assets/js/274.06fb099b.js"><link rel="prefetch" href="/docs/assets/js/275.e40667a2.js"><link rel="prefetch" href="/docs/assets/js/276.d3ab71c4.js"><link rel="prefetch" href="/docs/assets/js/277.5feda584.js"><link rel="prefetch" href="/docs/assets/js/278.beaf14c2.js"><link rel="prefetch" href="/docs/assets/js/279.f7073aaf.js"><link rel="prefetch" href="/docs/assets/js/28.f7b1175c.js"><link rel="prefetch" href="/docs/assets/js/280.72c464b5.js"><link rel="prefetch" href="/docs/assets/js/281.1fc9c7ce.js"><link rel="prefetch" href="/docs/assets/js/282.4e16e559.js"><link rel="prefetch" href="/docs/assets/js/283.4fb4b1a6.js"><link rel="prefetch" href="/docs/assets/js/284.c3baaf64.js"><link rel="prefetch" href="/docs/assets/js/285.a7a948cc.js"><link rel="prefetch" href="/docs/assets/js/286.73a344a9.js"><link rel="prefetch" href="/docs/assets/js/287.6035b91a.js"><link rel="prefetch" href="/docs/assets/js/288.bb0dbdf9.js"><link rel="prefetch" href="/docs/assets/js/289.10918ad5.js"><link rel="prefetch" href="/docs/assets/js/29.d0e3b179.js"><link rel="prefetch" href="/docs/assets/js/290.20c7bcd8.js"><link rel="prefetch" href="/docs/assets/js/291.ee116400.js"><link rel="prefetch" href="/docs/assets/js/292.dfc2e949.js"><link rel="prefetch" href="/docs/assets/js/293.8a851721.js"><link rel="prefetch" href="/docs/assets/js/294.1f4a08e0.js"><link rel="prefetch" href="/docs/assets/js/295.7ba75a19.js"><link rel="prefetch" href="/docs/assets/js/296.b251d4cf.js"><link rel="prefetch" href="/docs/assets/js/297.d56d6d59.js"><link rel="prefetch" href="/docs/assets/js/298.2e259f4b.js"><link rel="prefetch" href="/docs/assets/js/299.7fed62ba.js"><link rel="prefetch" href="/docs/assets/js/3.054cc2ec.js"><link rel="prefetch" href="/docs/assets/js/30.b554c761.js"><link rel="prefetch" href="/docs/assets/js/300.1f947cef.js"><link rel="prefetch" href="/docs/assets/js/301.f708dd5e.js"><link rel="prefetch" href="/docs/assets/js/302.161104b1.js"><link rel="prefetch" href="/docs/assets/js/303.e23692dd.js"><link rel="prefetch" href="/docs/assets/js/304.05659027.js"><link rel="prefetch" href="/docs/assets/js/305.9bf971c9.js"><link rel="prefetch" href="/docs/assets/js/306.ca8deeea.js"><link rel="prefetch" href="/docs/assets/js/307.97a6667e.js"><link rel="prefetch" href="/docs/assets/js/308.693ca743.js"><link rel="prefetch" href="/docs/assets/js/309.fffb02db.js"><link rel="prefetch" href="/docs/assets/js/31.370bb99a.js"><link rel="prefetch" href="/docs/assets/js/310.2bc665a7.js"><link rel="prefetch" href="/docs/assets/js/311.7953e1c2.js"><link rel="prefetch" href="/docs/assets/js/312.fa9bc367.js"><link rel="prefetch" href="/docs/assets/js/313.ac895eeb.js"><link rel="prefetch" href="/docs/assets/js/314.3631b719.js"><link rel="prefetch" href="/docs/assets/js/315.74ff42ab.js"><link rel="prefetch" href="/docs/assets/js/316.3e76797f.js"><link rel="prefetch" href="/docs/assets/js/317.6fb15d7c.js"><link rel="prefetch" href="/docs/assets/js/318.79e44dca.js"><link rel="prefetch" href="/docs/assets/js/319.bc94de5a.js"><link rel="prefetch" href="/docs/assets/js/32.78d1f1eb.js"><link rel="prefetch" href="/docs/assets/js/320.50cf4d33.js"><link rel="prefetch" href="/docs/assets/js/321.92c73aef.js"><link rel="prefetch" href="/docs/assets/js/322.4b083d48.js"><link rel="prefetch" href="/docs/assets/js/323.26c3a0ab.js"><link rel="prefetch" href="/docs/assets/js/324.fcb79d62.js"><link rel="prefetch" href="/docs/assets/js/325.45cede6b.js"><link rel="prefetch" href="/docs/assets/js/326.199b7195.js"><link rel="prefetch" href="/docs/assets/js/327.c396bfb7.js"><link rel="prefetch" href="/docs/assets/js/328.988a3de9.js"><link rel="prefetch" href="/docs/assets/js/329.fe8358a3.js"><link rel="prefetch" href="/docs/assets/js/33.6b9b4e96.js"><link rel="prefetch" href="/docs/assets/js/34.76d3700c.js"><link rel="prefetch" href="/docs/assets/js/35.b61bf772.js"><link rel="prefetch" href="/docs/assets/js/36.7f32760f.js"><link rel="prefetch" href="/docs/assets/js/37.4079c117.js"><link rel="prefetch" href="/docs/assets/js/38.1ac45a99.js"><link rel="prefetch" href="/docs/assets/js/39.0b98297f.js"><link rel="prefetch" href="/docs/assets/js/4.98818668.js"><link rel="prefetch" href="/docs/assets/js/40.bc044ad5.js"><link rel="prefetch" href="/docs/assets/js/41.de0fe499.js"><link rel="prefetch" href="/docs/assets/js/42.e225df72.js"><link rel="prefetch" href="/docs/assets/js/43.5e38f722.js"><link rel="prefetch" href="/docs/assets/js/44.c7251ae2.js"><link rel="prefetch" href="/docs/assets/js/45.47147150.js"><link rel="prefetch" href="/docs/assets/js/46.b91db25b.js"><link rel="prefetch" href="/docs/assets/js/47.40a11e04.js"><link rel="prefetch" href="/docs/assets/js/48.02effbc8.js"><link rel="prefetch" href="/docs/assets/js/49.0daadd89.js"><link rel="prefetch" href="/docs/assets/js/5.c3703f1d.js"><link rel="prefetch" href="/docs/assets/js/50.821b5322.js"><link rel="prefetch" href="/docs/assets/js/51.907927f0.js"><link rel="prefetch" href="/docs/assets/js/52.fbd6f4cb.js"><link rel="prefetch" href="/docs/assets/js/53.f1a0dc32.js"><link rel="prefetch" href="/docs/assets/js/54.8b66e487.js"><link rel="prefetch" href="/docs/assets/js/55.07cf4188.js"><link rel="prefetch" href="/docs/assets/js/56.ba320d44.js"><link rel="prefetch" href="/docs/assets/js/57.13a27667.js"><link rel="prefetch" href="/docs/assets/js/58.ef5d7e10.js"><link rel="prefetch" href="/docs/assets/js/59.dd726a42.js"><link rel="prefetch" href="/docs/assets/js/6.a764175d.js"><link rel="prefetch" href="/docs/assets/js/60.77ab395a.js"><link rel="prefetch" href="/docs/assets/js/61.3634b93f.js"><link rel="prefetch" href="/docs/assets/js/62.4c2d18ec.js"><link rel="prefetch" href="/docs/assets/js/63.57de2c82.js"><link rel="prefetch" href="/docs/assets/js/64.7b6639a9.js"><link rel="prefetch" href="/docs/assets/js/65.563fdeff.js"><link rel="prefetch" href="/docs/assets/js/66.81bd4cf2.js"><link rel="prefetch" href="/docs/assets/js/67.7fa4933d.js"><link rel="prefetch" href="/docs/assets/js/68.beebaf3f.js"><link rel="prefetch" href="/docs/assets/js/69.64313c8f.js"><link rel="prefetch" href="/docs/assets/js/7.2960bb58.js"><link rel="prefetch" href="/docs/assets/js/70.96160c4a.js"><link rel="prefetch" href="/docs/assets/js/71.ddaef725.js"><link rel="prefetch" href="/docs/assets/js/72.96fd17ad.js"><link rel="prefetch" href="/docs/assets/js/73.7ccc2f65.js"><link rel="prefetch" href="/docs/assets/js/74.3198ebf4.js"><link rel="prefetch" href="/docs/assets/js/75.4886a68c.js"><link rel="prefetch" href="/docs/assets/js/76.8d13e16c.js"><link rel="prefetch" href="/docs/assets/js/77.adc7359e.js"><link rel="prefetch" href="/docs/assets/js/78.2e03c285.js"><link rel="prefetch" href="/docs/assets/js/79.7d0ac9a1.js"><link rel="prefetch" href="/docs/assets/js/8.4c0568fd.js"><link rel="prefetch" href="/docs/assets/js/80.0e2710e5.js"><link rel="prefetch" href="/docs/assets/js/81.cdf404cc.js"><link rel="prefetch" href="/docs/assets/js/82.01e97e1f.js"><link rel="prefetch" href="/docs/assets/js/83.90c08f77.js"><link rel="prefetch" href="/docs/assets/js/84.2225a6dc.js"><link rel="prefetch" href="/docs/assets/js/85.49171e3b.js"><link rel="prefetch" href="/docs/assets/js/86.b18603ac.js"><link rel="prefetch" href="/docs/assets/js/87.772b6e3a.js"><link rel="prefetch" href="/docs/assets/js/88.82fdaa52.js"><link rel="prefetch" href="/docs/assets/js/89.bfcd0e62.js"><link rel="prefetch" href="/docs/assets/js/9.c7f05dcb.js"><link rel="prefetch" href="/docs/assets/js/90.ebe887ad.js"><link rel="prefetch" href="/docs/assets/js/91.7006ce28.js"><link rel="prefetch" href="/docs/assets/js/92.e662a7e6.js"><link rel="prefetch" href="/docs/assets/js/93.b97b9d2a.js"><link rel="prefetch" href="/docs/assets/js/94.36f8f62e.js"><link rel="prefetch" href="/docs/assets/js/95.b7192aed.js"><link rel="prefetch" href="/docs/assets/js/96.f0bc5b58.js"><link rel="prefetch" href="/docs/assets/js/97.59dcee0b.js"><link rel="prefetch" href="/docs/assets/js/98.e16eec31.js"><link rel="prefetch" href="/docs/assets/js/99.26ea8045.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.5d974432.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>The Art of Readable Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/artofcode/c0.html" class="sidebar-link">The Art of Readable Code</a></li><li><a href="/docs/kungfu/artofcode/c1.html" class="sidebar-link">C H A P T E R 1</a></li><li><a href="/docs/kungfu/artofcode/c2.html" class="sidebar-link">Packing Information into Names (C2 - I)</a></li><li><a href="/docs/kungfu/artofcode/c3.html" class="sidebar-link">Names That Can’t Be Misconstrued</a></li><li><a href="/docs/kungfu/artofcode/c4.html" class="sidebar-link">C H A P T E R F O U R</a></li><li><a href="/docs/kungfu/artofcode/c5.html" class="sidebar-link">C H A P T E R F I V E</a></li><li><a href="/docs/kungfu/artofcode/c6.html" class="sidebar-link">C H A P T E R S I X</a></li><li><a href="/docs/kungfu/artofcode/c7.html" class="sidebar-link">C H A P T E R 7</a></li><li><a href="/docs/kungfu/artofcode/c8.html" class="sidebar-link">C H A P T E R 8</a></li><li><a href="/docs/kungfu/artofcode/c9.html" aria-current="page" class="active sidebar-link">C H A P T E R 9</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c9.html#eliminating-variables" class="sidebar-link">Eliminating Variables</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c9.html#shrink-the-scope-of-your-variables" class="sidebar-link">Shrink the Scope of Your Variables</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c9.html#a-final-example" class="sidebar-link">A Final Example</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c9.html#summary" class="sidebar-link">Summary</a></li></ul></li><li><a href="/docs/kungfu/artofcode/c10.html" class="sidebar-link">C H A P T E R T E N</a></li><li><a href="/docs/kungfu/artofcode/c11.html" class="sidebar-link">C H A P T E R E L E V E N</a></li><li><a href="/docs/kungfu/artofcode/c12.html" class="sidebar-link">C H A P T E R T W E L V E</a></li><li><a href="/docs/kungfu/artofcode/c13.html" class="sidebar-link">C H A P T E R T H I R T E E N</a></li><li><a href="/docs/kungfu/artofcode/c14.html" class="sidebar-link">Testing and Readability (C14 - IV)</a></li><li><a href="/docs/kungfu/artofcode/c15.html" class="sidebar-link">C H A P T E R F I F T E E N</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c-h-a-p-t-e-r-9"><a href="#c-h-a-p-t-e-r-9" class="header-anchor">#</a> C H A P T E R 9</h1> <p><strong>Variables and Readability (C9 - III)</strong></p> <p>In this chapter, you’ll see how sloppy use of <em>variables</em> makes a program harder to understand.</p> <p>Specifically, there are three problems to contend with:</p> <ol><li>The more variables there are, the harder it is to keep track of them all.</li> <li>The bigger a variable’s scope, the longer you have to keep track of it.
3.The more often a variable changes, the harder it is to keep track of its current value.</li></ol> <p>The next three sections discuss how to deal with these issues.</p> <h2 id="eliminating-variables"><a href="#eliminating-variables" class="header-anchor">#</a> Eliminating Variables</h2> <p>In <a href="/docs/kungfu/artofcode/c8.html">Chapter 8, <em>Breaking Down Giant Expressions</em></a> , we showed how introducing &quot;explaining” or “summary” variables can make code more readable. These variables were helpful because they broke down giant expressions and acted as a form of documentation.</p> <p>In this section, we’re interested in eliminating variables that <em>don’t</em> improve readability. When a variable like this is removed, the new code is more concise and just as easy to understand.</p> <p>In the following section are a few examples of how these unnecessary variables show up.</p> <h3 id="useless-temporary-variables"><a href="#useless-temporary-variables" class="header-anchor">#</a> <strong>Useless Temporary Variables</strong></h3> <p>In the following snippet of Python code, consider the now variable:</p> <div class="language-js extra-class"><pre class="language-js"><code>now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
root_message<span class="token punctuation">.</span>last_view_time <span class="token operator">=</span> now
</code></pre></div><p>Is now a variable worth keeping? No, and here are the reasons:</p> <ul><li>It isn’t breaking down a complex expression.</li> <li>It doesn’t add clarification — the expression <code>datetime.datetime.now()</code> is clear enough.</li> <li>It’s used only once, so it doesn’t compress any redundant code.</li></ul> <p>Without now, the code is just as easy to understand:</p> <div class="language-js extra-class"><pre class="language-js"><code>root_message<span class="token punctuation">.</span>last_view_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Variables like now are usually “leftovers” that remain after code has been edited. The variable now might have been used in multiple places originally. Or maybe the coder anticipated using now multiple times, but never actually needed it.</p> <h3 id="eliminating-intermediate-results"><a href="#eliminating-intermediate-results" class="header-anchor">#</a> <strong>Eliminating Intermediate Results</strong></h3> <p>Here’s an example of a JavaScript function that removes a value from an array:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">remove_one</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> value_to_remove</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> index_to_remove <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> value_to_remove<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            index_to_remove <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> index_to_remove <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span> index_to_remove <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The variable <code>index_to_remove</code> is just used to hold an <em>intermediate result</em>. Variables like this can sometimes be eliminated by handling the result as soon as you get it:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">remove_one</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> value_to_remove</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> value_to_remove<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>By allowing the code to return early, we got rid of <code>index_to_remove</code> altogether and simplified the code quite a bit.</p> <p>In general, it’s a good strategy to <strong>complete the task as quickly as possible</strong>.</p> <h3 id="eliminating-control-flow-variables"><a href="#eliminating-control-flow-variables" class="header-anchor">#</a> <strong>Eliminating Control Flow Variables</strong></h3> <p>Sometimes you’ll see this pattern of code in loops:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">boolean</span> done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token comment">/* condition */</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>done <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The variable <code>done</code> might even be set to true in multiple places throughout the loop.</p> <p>Code like this is often trying to satisfy some unspoken rule that you shouldn’t break out of the middle of a loop. There is no such rule!</p> <p>Variables like done are what we call “control flow variables.” Their sole purpose is to steer the program’s execution—they don’t contain any real program data. In our experience, control flow variables can often be eliminated by making better use of structured programming:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token comment">/* condition */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This case was pretty easy to fix, but what if there are <em>multiple</em> nested loops for which a simple break wouldn’t suffice? In more complicated cases like that, the solution often involves moving code into a new function (either the code inside the loop, or the entire loop itself).</p> <h3 id="⭐️-do-you-want-your-coworkers-to-feel-like-they-re-in-an-interview-all-the-time"><a href="#⭐️-do-you-want-your-coworkers-to-feel-like-they-re-in-an-interview-all-the-time" class="header-anchor">#</a> ⭐️ DO YOU WANT YOUR COWORKERS TO FEEL LIKE THEY’RE IN AN INTERVIEW ALL THE TIME?</h3> <blockquote><p>Microsoft’s Eric Brechner has talked about how a great interview question should involve at least three variables.* It’s probably because dealing with three variables at the same time forces you to think hard! This makes sense for an interview, where you’re trying to push a candidate to the limit. But do you want your coworkers to feel like they’re in an interview while they’re reading your code? - Eric Brechner’s <em>I. M. Wright’s “Hard Code”</em> (Microsoft Press, 2007), p. 166.</p></blockquote> <h2 id="shrink-the-scope-of-your-variables"><a href="#shrink-the-scope-of-your-variables" class="header-anchor">#</a> Shrink the Scope of Your Variables</h2> <p>We’ve all heard the advice to “avoid global variables.” This is good advice, because it’s hard to keep track of where and how all those global variables are being used. And by “polluting the namespace” (putting a bunch of names there that might conflict with your local variables), code might accidentally modify a global variable when it intended to use a local variable, or vice versa.</p> <p>In fact, it’s a good idea to “shrink the scope” of <em>all</em> your variables, not just the global ones.</p> <div class="custom-block tip"><p class="custom-block-title">K E Y I D E A</p> <p>Make your variable visible by as few lines of code as possible.</p></div> <p>Many programming languages offer multiple scope/access levels, including module, class, function, and block scope. Using more restricted access is generally better because it means the variable can be “seen” by fewer lines of code.</p> <p>Why do this? Because it effectively reduces the number of variables the reader has to think about at the same time. If you were to shrink the scope of all your variables by a factor of two, then on average there would be half as many variables in scope at any one time.</p> <p>For example, suppose you have a very large class, with a member variable that’s used by only two methods, in the following way:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">LargeClass</span> <span class="token punctuation">{</span>
    string str_ <span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token class-name">Method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        str_ <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
        <span class="token class-name">Method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token class-name">Method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Uses str_</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Lots of other methods that don't use str_ ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>In some sense, a class member variable is like a “mini-global” inside the realm of the class. For large classes especially, it’s hard to keep track of all the member variables and which methods modify each one. The fewer mini-globals, the better.</p> <p>For this case, it may make sense to “demote” <code>str_</code> to be a local variable:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">LargeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token class-name">Method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        string str <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
        <span class="token class-name">Method2</span><span class="token punctuation">(</span> str <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token class-name">Method2</span><span class="token punctuation">(</span>string str <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Uses str</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Now other methods can't see str.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Another way to restrict access to class members is to <strong>make as many methods static as possible</strong>. Static methods are a great way to let the reader know “these lines of code are isolated from those variables.”</p> <p>Or another approach is to <strong>break the large class into smaller classes</strong>. This approach is helpful only if the smaller classes are in fact isolated from each other. If you were to create two classes that access each other’s members, you haven’t really accomplished anything.</p> <p>The same goes for breaking up large files into smaller files or large functions into smaller functions. A big motivation for doing so is to isolate data (i.e., variables).</p> <p>But different languages have different rules for what exactly constitutes a scope. We’d like to point out just a few of the more interesting rules involving the scope of variables.</p> <h3 id="if-statement-scope-in-c"><a href="#if-statement-scope-in-c" class="header-anchor">#</a> <strong>if Statement Scope in C++</strong></h3> <p>Suppose you have the following C++ code:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>PaymentInfo<span class="token operator">*</span> info <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">ReadPaymentInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> info <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;User paid: &quot;</span> <span class="token operator">&lt;&lt;</span> info <span class="token operator">-&gt;</span><span class="token function">amount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Many more lines of code below ...</span>
</code></pre></div><p>The variable info will remain in scope for the rest of the function, so the person reading this code might keep info in mind, wondering if/how it will be used again.</p> <p>But in this case, info is only used inside the if statement. In C++, we can actually define info in the conditional expression:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> PaymentInfo<span class="token operator">*</span> info <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">ReadPaymentInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;User paid: &quot;</span> <span class="token operator">&lt;&lt;</span> info<span class="token operator">-&gt;</span><span class="token function">amount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now the reader can easily forget about info after it goes out of scope.</p> <h3 id="creating-private-variables-in-javascript"><a href="#creating-private-variables-in-javascript" class="header-anchor">#</a> <strong>Creating “Private” Variables in JavaScript</strong></h3> <p>Suppose you have a persistent variable that’s used by only one function:</p> <div class="language-js extra-class"><pre class="language-js"><code>submitted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Note: global variable</span>

<span class="token keyword">var</span> <span class="token function-variable function">submit_form</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">form_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> submitted <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// don't double-submit the form</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
    submitted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Global variables like submitted can cause the person reading this code a lot of angst. It seems like <code>submit_form()</code> is the only function that uses submitted, but you can’t know for sure. In fact, another JavaScript file might be using a global variable named submitted too, for a different purpose!</p> <p>You can prevent this issue by wrapping submitted inside a <em>closure</em> :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> submit_form <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> submitted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Note: can only be accessed by the function below</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">form_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> submitted <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// don't double-submit the form</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ...</span>
        submitted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><p>Note the parentheses on the last line—the anonymous outer function is immediately executed, returning the inner function.</p> <p>If you haven’t seen this technique before, it may look strange at first. It has the effect of making a “private” scope that only the inner function can access. Now the reader doesn’t have to wonder <em>Where else does</em> submitted <em>get used?</em> or worry about conflicting with other globals of the same name. (See <em>JavaScript: The Good Parts</em> by Douglas Crockford [O’Reilly, 2008] for more techniques like this.)</p> <h3 id="javascript-global-scope"><a href="#javascript-global-scope" class="header-anchor">#</a> <strong>JavaScript Global Scope</strong></h3> <p>In JavaScript, if you omit the keyword var from a variable definition (e.g., <code>x = 1</code> instead of <code>var x = 1</code>), the variable is put into the global scope, where <em>every</em> JavaScript file and <code>&lt;script&gt;</code> block can access it. Here is an example:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// DANGER: 'i' is not declared with 'var'!</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This code inadvertently puts <code>i</code> into the global scope, so a later block can still see it:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token function">alert</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Alerts '10'. 'i' is a global variable!</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Many programmers aren’t aware of this scoping rule, and this surprising behavior can cause strange bugs. A common manifestation of this bug is when two functions both create a local variable with the same name, but forget to use var. These functions will unknowingly “cross-talk” and the poor programmer might conclude that his computer is possessed or that this RAM has gone bad.</p> <p>The common “best practice” for JavaScript is to <strong>always define variables using the</strong> <code>var</code> <strong>keyword</strong> (e.g., var x = 1). This practice limits the scope of the variable to the (innermost) function where it’s defined.</p> <h3 id="no-nested-scope-in-python-and-javascript"><a href="#no-nested-scope-in-python-and-javascript" class="header-anchor">#</a> <strong>No Nested Scope in Python and JavaScript</strong></h3> <p>Languages like C++ and Java have <em>block scope</em> , where variables defined inside an <code>if</code>, <code>for</code>, <code>try</code>, or similar structure are confined to the nested scope of that block:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
x<span class="token operator">++</span> <span class="token punctuation">;</span> <span class="token comment">// Compile-error! 'x' is undefined.</span>
</code></pre></div><p>But in Python and JavaScript, variables defined in a block “spill out” to the whole function.</p> <p>For example, notice the use of <code>example_value</code> in this perfectly valid Python code:</p> <div class="language-PY extra-class"><pre class="language-py"><code><span class="token comment"># No use of example_value up to this point.</span>

<span class="token keyword">if</span> request<span class="token punctuation">:</span>
    <span class="token keyword">for</span> value <span class="token keyword">in</span> request<span class="token punctuation">.</span>values<span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            example_value <span class="token operator">=</span> value
            <span class="token keyword">break</span>

<span class="token keyword">for</span> logger <span class="token keyword">in</span> debug<span class="token punctuation">.</span>loggers<span class="token punctuation">:</span>
    logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Example:&quot;</span><span class="token punctuation">,</span> example_value <span class="token punctuation">)</span>
</code></pre></div><p>This scoping rule is surprising to many programmers, and code like this is harder to read. In other languages, it would be easier to find where <code>example_value</code> was first defined—you would look along the “left-hand edge” of the function you’re inside.</p> <p>The previous example is also buggy: if example_value is not set in the first part of the code, the second part will raise an exception: &quot;NameError: ‘example_value’ is not defined&quot;. We can fix this, and make the code more readable, by defining example_value at the “closest common ancestor” (in terms of nesting) to where it’s used:</p> <div class="language-PY extra-class"><pre class="language-py"><code>example_value <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> request<span class="token punctuation">:</span>
    <span class="token keyword">for</span> value <span class="token keyword">in</span> request<span class="token punctuation">.</span>values<span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            example_value <span class="token operator">=</span> value
            <span class="token keyword">break</span>

<span class="token keyword">if</span> example_value <span class="token punctuation">:</span>
    <span class="token keyword">for</span> logger <span class="token keyword">in</span> debug<span class="token punctuation">.</span>loggers<span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Example:&quot;</span><span class="token punctuation">,</span> example_value <span class="token punctuation">)</span>
</code></pre></div><p>However, this is a case where <code>example_value</code> can be eliminated altogether. <code>example_value</code> is just holding an intermediate result, and as we saw in “Eliminating Intermediate Results” on page 95, variables like these can often be eliminated by “completing the task as soon as possible.” In this case, that means logging the example value as soon as we find it.</p> <p>Here’s what the new code looks like:</p> <div class="language-PY extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">LogExample</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> logger <span class="token keyword">in</span> debug<span class="token punctuation">.</span>loggers<span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Example:&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>

<span class="token keyword">if</span> request<span class="token punctuation">:</span>
    <span class="token keyword">for</span> value <span class="token keyword">in</span> request<span class="token punctuation">.</span>values<span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            LogExample<span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment"># deal with 'value' immediately</span>
            <span class="token keyword">break</span>
</code></pre></div><h3 id="moving-definitions-down"><a href="#moving-definitions-down" class="header-anchor">#</a> <strong>Moving Definitions Down</strong></h3> <p>The original C programming language required all variable definitions to be at the top of the function or block. This requirement was unfortunate, because for long functions with many variables, it forced the reader to think about all those variables right away, even if they weren't used until much later. (C99 and C++ removed this requirement.)</p> <p>In the following example, all the variables are innocently defined at the top of the function:</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">ViewFilteredReplies</span><span class="token punctuation">(</span>original_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    filtered_replies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    root_message <span class="token operator">=</span> Messages<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>original_id<span class="token punctuation">)</span>
    all_replies <span class="token operator">=</span> Messages<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select<span class="token punctuation">(</span>root_id<span class="token operator">=</span>original_id<span class="token punctuation">)</span>

    root_message<span class="token punctuation">.</span>view_count <span class="token operator">+=</span> <span class="token number">1</span>
    root_message<span class="token punctuation">.</span>last_view_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root_message<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> reply <span class="token keyword">in</span> all_replies<span class="token punctuation">:</span>
        <span class="token keyword">if</span> reply<span class="token punctuation">.</span>spam_votes <span class="token operator">&lt;=</span> MAX_SPAM_VOTES<span class="token punctuation">:</span>
            filtered_replies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reply<span class="token punctuation">)</span>

    <span class="token keyword">return</span> filtered_replies
</code></pre></div><p>The problem with this example code is that it forces the reader to think about three variables at once, and switch gears between them.</p> <p>Because the reader doesn’t need to know about all of them until later, it’s easy to just move each definition right before its first use:</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">ViewFilteredReplies</span><span class="token punctuation">(</span>original_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    root_message <span class="token operator">=</span> Messages<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>original_id<span class="token punctuation">)</span>
    root_message<span class="token punctuation">.</span>view_count <span class="token operator">+=</span> <span class="token number">1</span>
    root_message<span class="token punctuation">.</span>last_view_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root_message<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

    all_replies <span class="token operator">=</span> Messages<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select<span class="token punctuation">(</span>root_id<span class="token operator">=</span>original_id<span class="token punctuation">)</span>
    filtered_replies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> reply <span class="token keyword">in</span> all_replies<span class="token punctuation">:</span>
        <span class="token keyword">if</span> reply<span class="token punctuation">.</span>spam_votes <span class="token operator">&lt;=</span> MAX_SPAM_VOTES<span class="token punctuation">:</span>
            filtered_replies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reply<span class="token punctuation">)</span>

    <span class="token keyword">return</span> filtered_replies
</code></pre></div><p>You might be wondering whether all_replies is a necessary variable, or if it could be eliminated by doing:</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">for</span> reply <span class="token keyword">in</span> Messages<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select<span class="token punctuation">(</span>root_id<span class="token operator">=</span>original_id<span class="token punctuation">)</span> <span class="token punctuation">:</span>
<span class="token operator">//</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>In this case, <code>all_replies</code> is a pretty good explaining variable, so we decided to keep it.</p> <h3 id="prefer-write-once-variables"><a href="#prefer-write-once-variables" class="header-anchor">#</a> Prefer Write-Once Variables</h3> <p>So far in this chapter, we’ve discussed how it’s harder to understand programs with lots of variables “in play.” Well, it’s even harder to think about variables that are constantly changing.</p> <p>Keeping track of their values adds an extra degree of difficulty.</p> <p>To combat this problem, we have a suggestion that may sound a little strange: <strong>prefer write-once variables</strong>.</p> <p>Variables that are a “permanent fixture” are easier to think about. Certainly, constants like:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> NUM_THREADS <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>don’t require much thought on the reader’s part. And for the same reason, use of const in C++ (and final in Java) is highly encouraged.</p> <p>In fact, in many languages (including Python and Java), some built-in types like string are <em>immutable</em>. As James Gosling (Java’s creator) said, “[Immutables] tend to more often be trouble free.”</p> <p>But even if you can’t make your variable write-once, it still helps if the variable changes in fewer places.</p> <div class="custom-block tip"><p class="custom-block-title">K E Y I D E A</p> <p>The more places a variable is manipulated, the harder it is to reason about its current value.</p></div> <p>So how do you do it? How can you change a variable to be write-once? Well, a lot of times it requires restructuring the code a bit, as you’ll see in the next example.</p> <h2 id="a-final-example"><a href="#a-final-example" class="header-anchor">#</a> A Final Example</h2> <p>For the final example of the chapter, we’d like to show an example demonstrating many of the principles we’ve discussed so far.</p> <p>Suppose you have a web page with a number of input text fields, arranged like this:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Dustin<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Trevor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Melissa<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
...
</code></pre></div><p>As you can see, the ids start with input1 and increment from there.</p> <p>Your job is to write a function named <code>setFirstEmptyInput()</code> that takes a string and puts it in the first empty <code>&lt;input&gt;</code> on the page (in the example shown, &quot;input3&quot;). The function should return  the DOM element that was updated (or null if there were no empty inputs left). Here is some code to do this that <em>doesn’t</em> apply the principles in this chapter:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">setFirstEmptyInput</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">new_value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>elem <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            found <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
        elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">)</span> elem<span class="token punctuation">.</span>value <span class="token operator">=</span> new_value<span class="token punctuation">;</span>
    <span class="token keyword">return</span> elem<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This code gets the job done, but it’s not pretty. What’s wrong with it, and how do we improve it?</p> <p>There are a lot of ways to think about improving this code, but we’re going to consider it from the perspective of the variables it uses:</p> <ul><li>var found</li> <li>var i</li> <li>var elem</li></ul> <p>All three of these variables exist for the entire function and are written to multiple times. Let’s try to improve the use of each of them.</p> <p>As we discussed earlier in the chapter, intermediate variables like found can often be eliminated by returning early. Here’s that improvement:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">setFirstEmptyInput</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">new_value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>elem <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span>value <span class="token operator">=</span> new_value<span class="token punctuation">;</span>
            <span class="token keyword">return</span> elem<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
        elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Next, take a look at elem. It’s used multiple times throughout the code in a very “loopy” way where it’s hard to keep track of its value. The code makes it seem as if elem is the value we’re iterating through, when really we’re just incrementing through i. So let’s restructure the while loop into a for loop over i:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">setFirstEmptyInput</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">new_value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token boolean">true</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>elem <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// Search Failed. No empty input found.</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span>value <span class="token operator">=</span> new_value<span class="token punctuation">;</span>
            <span class="token keyword">return</span> elem<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>In particular, notice how elem acts as a write-once variable whose lifespan is contained inside the loop. The use of true as a for loop condition is unusual, but in exchange, we are able to see the definition and modifications of <code>i</code> in a single line. (A traditional while (true) would also be reasonable.)</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>This chapter is about how the variables in a program can quickly accumulate and become too much to keep track of. You can make your code easier to read by having fewer variables and making them as “lightweight” as possible. Specifically:</p> <ul><li><strong>Eliminate variables</strong> that just get in the way. In particular, we showed a few examples of how to eliminate “intermediate result” variables by handling the result immediately.</li> <li><strong>Reduce the scope of each variable</strong> to be as small as possible. Move each variable to a place where the fewest lines of code can see it. Out of sight is out of mind.</li> <li><strong>Prefer write-once variables.</strong> Variables that are set only once (or const, final, or otherwise immutable) make code easier to understand.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/artofcode/c8.html" class="prev">
        C H A P T E R 8
      </a></span> <span class="next"><a href="/docs/kungfu/artofcode/c10.html">
        C H A P T E R T E N
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.feff3dbb.js" defer></script><script src="/docs/assets/js/2.aca46d71.js" defer></script><script src="/docs/assets/js/230.dcc8e04d.js" defer></script><script src="/docs/assets/js/27.5ed2ce18.js" defer></script>
  </body>
</html>
