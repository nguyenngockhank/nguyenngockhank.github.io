<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C H A P T E R 8 | Nguyễn Khánk&#39;s Wiki</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="apple-touch-icon" sizes="180x180" href="../public/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../public/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../public/favicons/favicon-16x16.png">
    <link rel="manifest" href="../public/favicons/manifest.json">
    <link rel="mask-icon" href="../public/favicons/safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../public/favicons/favicon.ico">
    <meta name="description" content="Wikipedia của tui">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="../public/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.5d974432.css" as="style"><link rel="preload" href="/docs/assets/js/app.feff3dbb.js" as="script"><link rel="preload" href="/docs/assets/js/2.aca46d71.js" as="script"><link rel="preload" href="/docs/assets/js/229.faed0af8.js" as="script"><link rel="preload" href="/docs/assets/js/27.5ed2ce18.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.e2dac1de.js"><link rel="prefetch" href="/docs/assets/js/100.072f86f4.js"><link rel="prefetch" href="/docs/assets/js/101.fc0bc918.js"><link rel="prefetch" href="/docs/assets/js/102.ddeddef2.js"><link rel="prefetch" href="/docs/assets/js/103.a299e414.js"><link rel="prefetch" href="/docs/assets/js/104.29aa9c20.js"><link rel="prefetch" href="/docs/assets/js/105.5211965b.js"><link rel="prefetch" href="/docs/assets/js/106.f091e57b.js"><link rel="prefetch" href="/docs/assets/js/107.80acce0d.js"><link rel="prefetch" href="/docs/assets/js/108.b0108b40.js"><link rel="prefetch" href="/docs/assets/js/109.7953f94a.js"><link rel="prefetch" href="/docs/assets/js/11.34f9e1bc.js"><link rel="prefetch" href="/docs/assets/js/110.59b888f8.js"><link rel="prefetch" href="/docs/assets/js/111.5b11b553.js"><link rel="prefetch" href="/docs/assets/js/112.8a857b53.js"><link rel="prefetch" href="/docs/assets/js/113.5aab77e8.js"><link rel="prefetch" href="/docs/assets/js/114.aef8a2f2.js"><link rel="prefetch" href="/docs/assets/js/115.777be1e9.js"><link rel="prefetch" href="/docs/assets/js/116.3092451f.js"><link rel="prefetch" href="/docs/assets/js/117.3345c37e.js"><link rel="prefetch" href="/docs/assets/js/118.be055f62.js"><link rel="prefetch" href="/docs/assets/js/119.77b121e6.js"><link rel="prefetch" href="/docs/assets/js/12.a704c651.js"><link rel="prefetch" href="/docs/assets/js/120.2d64d4ae.js"><link rel="prefetch" href="/docs/assets/js/121.954a3ba9.js"><link rel="prefetch" href="/docs/assets/js/122.f8032cd6.js"><link rel="prefetch" href="/docs/assets/js/123.96d7858b.js"><link rel="prefetch" href="/docs/assets/js/124.f12d4c00.js"><link rel="prefetch" href="/docs/assets/js/125.47b679a8.js"><link rel="prefetch" href="/docs/assets/js/126.725c596d.js"><link rel="prefetch" href="/docs/assets/js/127.75f3139f.js"><link rel="prefetch" href="/docs/assets/js/128.9862473f.js"><link rel="prefetch" href="/docs/assets/js/129.0f09cf34.js"><link rel="prefetch" href="/docs/assets/js/13.66fe2f7e.js"><link rel="prefetch" href="/docs/assets/js/130.d20c4272.js"><link rel="prefetch" href="/docs/assets/js/131.771cb92a.js"><link rel="prefetch" href="/docs/assets/js/132.308ce22e.js"><link rel="prefetch" href="/docs/assets/js/133.99780c7f.js"><link rel="prefetch" href="/docs/assets/js/134.c8bb3739.js"><link rel="prefetch" href="/docs/assets/js/135.d22b8cd4.js"><link rel="prefetch" href="/docs/assets/js/136.0f7f2732.js"><link rel="prefetch" href="/docs/assets/js/137.66315d8b.js"><link rel="prefetch" href="/docs/assets/js/138.bc1e4151.js"><link rel="prefetch" href="/docs/assets/js/139.4bf7c284.js"><link rel="prefetch" href="/docs/assets/js/14.57825f78.js"><link rel="prefetch" href="/docs/assets/js/140.023cb781.js"><link rel="prefetch" href="/docs/assets/js/141.3ed2d77a.js"><link rel="prefetch" href="/docs/assets/js/142.97feece5.js"><link rel="prefetch" href="/docs/assets/js/143.22b3a1b2.js"><link rel="prefetch" href="/docs/assets/js/144.3b8c0d53.js"><link rel="prefetch" href="/docs/assets/js/145.c187e405.js"><link rel="prefetch" href="/docs/assets/js/146.02e7dc46.js"><link rel="prefetch" href="/docs/assets/js/147.1ea04230.js"><link rel="prefetch" href="/docs/assets/js/148.eceb141f.js"><link rel="prefetch" href="/docs/assets/js/149.7bc98406.js"><link rel="prefetch" href="/docs/assets/js/15.cbcf56bd.js"><link rel="prefetch" href="/docs/assets/js/150.345f53e1.js"><link rel="prefetch" href="/docs/assets/js/151.97fd5643.js"><link rel="prefetch" href="/docs/assets/js/152.0f0ace62.js"><link rel="prefetch" href="/docs/assets/js/153.5ae906c9.js"><link rel="prefetch" href="/docs/assets/js/154.4524d48f.js"><link rel="prefetch" href="/docs/assets/js/155.d7cbb04b.js"><link rel="prefetch" href="/docs/assets/js/156.51743cf0.js"><link rel="prefetch" href="/docs/assets/js/157.12aa1a8a.js"><link rel="prefetch" href="/docs/assets/js/158.04757c69.js"><link rel="prefetch" href="/docs/assets/js/159.7a8588a6.js"><link rel="prefetch" href="/docs/assets/js/16.b9864c9c.js"><link rel="prefetch" href="/docs/assets/js/160.79ec6015.js"><link rel="prefetch" href="/docs/assets/js/161.4f0b5cd9.js"><link rel="prefetch" href="/docs/assets/js/162.6cc1f3af.js"><link rel="prefetch" href="/docs/assets/js/163.187c5335.js"><link rel="prefetch" href="/docs/assets/js/164.556dc6d8.js"><link rel="prefetch" href="/docs/assets/js/165.6c6e1f75.js"><link rel="prefetch" href="/docs/assets/js/166.afe12552.js"><link rel="prefetch" href="/docs/assets/js/167.bd3dd81a.js"><link rel="prefetch" href="/docs/assets/js/168.b5e90a8d.js"><link rel="prefetch" href="/docs/assets/js/169.80b477b3.js"><link rel="prefetch" href="/docs/assets/js/17.8983ce9d.js"><link rel="prefetch" href="/docs/assets/js/170.4fcbc9a3.js"><link rel="prefetch" href="/docs/assets/js/171.6c7ccd83.js"><link rel="prefetch" href="/docs/assets/js/172.e02d80ea.js"><link rel="prefetch" href="/docs/assets/js/173.66fb904a.js"><link rel="prefetch" href="/docs/assets/js/174.4f18cc78.js"><link rel="prefetch" href="/docs/assets/js/175.b1c5644a.js"><link rel="prefetch" href="/docs/assets/js/176.bd684253.js"><link rel="prefetch" href="/docs/assets/js/177.c62f362d.js"><link rel="prefetch" href="/docs/assets/js/178.f953855f.js"><link rel="prefetch" href="/docs/assets/js/179.10404ee2.js"><link rel="prefetch" href="/docs/assets/js/18.5efe21b3.js"><link rel="prefetch" href="/docs/assets/js/180.c4330ec2.js"><link rel="prefetch" href="/docs/assets/js/181.02c26c33.js"><link rel="prefetch" href="/docs/assets/js/182.773ba280.js"><link rel="prefetch" href="/docs/assets/js/183.064d5ae1.js"><link rel="prefetch" href="/docs/assets/js/184.2c64e798.js"><link rel="prefetch" href="/docs/assets/js/185.38c7b6e9.js"><link rel="prefetch" href="/docs/assets/js/186.d95e2e7a.js"><link rel="prefetch" href="/docs/assets/js/187.8aad3033.js"><link rel="prefetch" href="/docs/assets/js/188.7f201e8d.js"><link rel="prefetch" href="/docs/assets/js/189.6cefdb59.js"><link rel="prefetch" href="/docs/assets/js/19.58823304.js"><link rel="prefetch" href="/docs/assets/js/190.90e5aa35.js"><link rel="prefetch" href="/docs/assets/js/191.3e1cf065.js"><link rel="prefetch" href="/docs/assets/js/192.a2c49267.js"><link rel="prefetch" href="/docs/assets/js/193.cd7650f2.js"><link rel="prefetch" href="/docs/assets/js/194.1d2ca753.js"><link rel="prefetch" href="/docs/assets/js/195.e29ca5e1.js"><link rel="prefetch" href="/docs/assets/js/196.ff519f9d.js"><link rel="prefetch" href="/docs/assets/js/197.d7c7a2c2.js"><link rel="prefetch" href="/docs/assets/js/198.77259c6a.js"><link rel="prefetch" href="/docs/assets/js/199.7983bd3b.js"><link rel="prefetch" href="/docs/assets/js/20.3b486daa.js"><link rel="prefetch" href="/docs/assets/js/200.e9a796d0.js"><link rel="prefetch" href="/docs/assets/js/201.b4449da8.js"><link rel="prefetch" href="/docs/assets/js/202.ab520617.js"><link rel="prefetch" href="/docs/assets/js/203.1944c871.js"><link rel="prefetch" href="/docs/assets/js/204.2ddfe4db.js"><link rel="prefetch" href="/docs/assets/js/205.3a4a5484.js"><link rel="prefetch" href="/docs/assets/js/206.9eaec970.js"><link rel="prefetch" href="/docs/assets/js/207.ca2acd17.js"><link rel="prefetch" href="/docs/assets/js/208.bc4e3070.js"><link rel="prefetch" href="/docs/assets/js/209.8194c212.js"><link rel="prefetch" href="/docs/assets/js/21.1e77a313.js"><link rel="prefetch" href="/docs/assets/js/210.473ccc45.js"><link rel="prefetch" href="/docs/assets/js/211.623b4033.js"><link rel="prefetch" href="/docs/assets/js/212.0f85a611.js"><link rel="prefetch" href="/docs/assets/js/213.191977aa.js"><link rel="prefetch" href="/docs/assets/js/214.a23c6dcc.js"><link rel="prefetch" href="/docs/assets/js/215.25321a42.js"><link rel="prefetch" href="/docs/assets/js/216.e450a05c.js"><link rel="prefetch" href="/docs/assets/js/217.abab04ca.js"><link rel="prefetch" href="/docs/assets/js/218.66e0082a.js"><link rel="prefetch" href="/docs/assets/js/219.5f4ee9fd.js"><link rel="prefetch" href="/docs/assets/js/22.1c51f113.js"><link rel="prefetch" href="/docs/assets/js/220.bbb5df8d.js"><link rel="prefetch" href="/docs/assets/js/221.0d3dfd46.js"><link rel="prefetch" href="/docs/assets/js/222.8e68bdb2.js"><link rel="prefetch" href="/docs/assets/js/223.6c582cd9.js"><link rel="prefetch" href="/docs/assets/js/224.f570e175.js"><link rel="prefetch" href="/docs/assets/js/225.b249063b.js"><link rel="prefetch" href="/docs/assets/js/226.48576d77.js"><link rel="prefetch" href="/docs/assets/js/227.8346e855.js"><link rel="prefetch" href="/docs/assets/js/228.8e3e6ca7.js"><link rel="prefetch" href="/docs/assets/js/23.dc13f196.js"><link rel="prefetch" href="/docs/assets/js/230.dcc8e04d.js"><link rel="prefetch" href="/docs/assets/js/231.611372c2.js"><link rel="prefetch" href="/docs/assets/js/232.aaaeb300.js"><link rel="prefetch" href="/docs/assets/js/233.819d8911.js"><link rel="prefetch" href="/docs/assets/js/234.41eb70ca.js"><link rel="prefetch" href="/docs/assets/js/235.acedc064.js"><link rel="prefetch" href="/docs/assets/js/236.fbc4b8f7.js"><link rel="prefetch" href="/docs/assets/js/237.7b217482.js"><link rel="prefetch" href="/docs/assets/js/238.6b2400f7.js"><link rel="prefetch" href="/docs/assets/js/239.570754bf.js"><link rel="prefetch" href="/docs/assets/js/24.d1deb976.js"><link rel="prefetch" href="/docs/assets/js/240.30c365e9.js"><link rel="prefetch" href="/docs/assets/js/241.aebbd7aa.js"><link rel="prefetch" href="/docs/assets/js/242.5df1a85a.js"><link rel="prefetch" href="/docs/assets/js/243.704fb61f.js"><link rel="prefetch" href="/docs/assets/js/244.9bc98748.js"><link rel="prefetch" href="/docs/assets/js/245.38e733b7.js"><link rel="prefetch" href="/docs/assets/js/246.b81c0b24.js"><link rel="prefetch" href="/docs/assets/js/247.c0a84943.js"><link rel="prefetch" href="/docs/assets/js/248.47e7f09b.js"><link rel="prefetch" href="/docs/assets/js/249.29294a64.js"><link rel="prefetch" href="/docs/assets/js/25.ddba0ef8.js"><link rel="prefetch" href="/docs/assets/js/250.7b97771f.js"><link rel="prefetch" href="/docs/assets/js/251.af134ede.js"><link rel="prefetch" href="/docs/assets/js/252.996a9add.js"><link rel="prefetch" href="/docs/assets/js/253.6b08af88.js"><link rel="prefetch" href="/docs/assets/js/254.a14372bd.js"><link rel="prefetch" href="/docs/assets/js/255.868fb43f.js"><link rel="prefetch" href="/docs/assets/js/256.606c2f81.js"><link rel="prefetch" href="/docs/assets/js/257.9c34c318.js"><link rel="prefetch" href="/docs/assets/js/258.236c65be.js"><link rel="prefetch" href="/docs/assets/js/259.dc9c78fd.js"><link rel="prefetch" href="/docs/assets/js/26.23be3024.js"><link rel="prefetch" href="/docs/assets/js/260.228e0898.js"><link rel="prefetch" href="/docs/assets/js/261.7dd0cc1f.js"><link rel="prefetch" href="/docs/assets/js/262.7c674375.js"><link rel="prefetch" href="/docs/assets/js/263.0d61e50b.js"><link rel="prefetch" href="/docs/assets/js/264.0595e5d9.js"><link rel="prefetch" href="/docs/assets/js/265.4f8cb07b.js"><link rel="prefetch" href="/docs/assets/js/266.fe3edb0f.js"><link rel="prefetch" href="/docs/assets/js/267.8942e793.js"><link rel="prefetch" href="/docs/assets/js/268.86eb0eb9.js"><link rel="prefetch" href="/docs/assets/js/269.03f58dca.js"><link rel="prefetch" href="/docs/assets/js/270.90b7be1d.js"><link rel="prefetch" href="/docs/assets/js/271.b556bf53.js"><link rel="prefetch" href="/docs/assets/js/272.0b7f4823.js"><link rel="prefetch" href="/docs/assets/js/273.d311f5f5.js"><link rel="prefetch" href="/docs/assets/js/274.06fb099b.js"><link rel="prefetch" href="/docs/assets/js/275.e40667a2.js"><link rel="prefetch" href="/docs/assets/js/276.d3ab71c4.js"><link rel="prefetch" href="/docs/assets/js/277.5feda584.js"><link rel="prefetch" href="/docs/assets/js/278.beaf14c2.js"><link rel="prefetch" href="/docs/assets/js/279.f7073aaf.js"><link rel="prefetch" href="/docs/assets/js/28.f7b1175c.js"><link rel="prefetch" href="/docs/assets/js/280.72c464b5.js"><link rel="prefetch" href="/docs/assets/js/281.1fc9c7ce.js"><link rel="prefetch" href="/docs/assets/js/282.4e16e559.js"><link rel="prefetch" href="/docs/assets/js/283.4fb4b1a6.js"><link rel="prefetch" href="/docs/assets/js/284.c3baaf64.js"><link rel="prefetch" href="/docs/assets/js/285.a7a948cc.js"><link rel="prefetch" href="/docs/assets/js/286.73a344a9.js"><link rel="prefetch" href="/docs/assets/js/287.6035b91a.js"><link rel="prefetch" href="/docs/assets/js/288.bb0dbdf9.js"><link rel="prefetch" href="/docs/assets/js/289.10918ad5.js"><link rel="prefetch" href="/docs/assets/js/29.d0e3b179.js"><link rel="prefetch" href="/docs/assets/js/290.20c7bcd8.js"><link rel="prefetch" href="/docs/assets/js/291.ee116400.js"><link rel="prefetch" href="/docs/assets/js/292.dfc2e949.js"><link rel="prefetch" href="/docs/assets/js/293.8a851721.js"><link rel="prefetch" href="/docs/assets/js/294.1f4a08e0.js"><link rel="prefetch" href="/docs/assets/js/295.7ba75a19.js"><link rel="prefetch" href="/docs/assets/js/296.b251d4cf.js"><link rel="prefetch" href="/docs/assets/js/297.d56d6d59.js"><link rel="prefetch" href="/docs/assets/js/298.2e259f4b.js"><link rel="prefetch" href="/docs/assets/js/299.7fed62ba.js"><link rel="prefetch" href="/docs/assets/js/3.054cc2ec.js"><link rel="prefetch" href="/docs/assets/js/30.b554c761.js"><link rel="prefetch" href="/docs/assets/js/300.1f947cef.js"><link rel="prefetch" href="/docs/assets/js/301.f708dd5e.js"><link rel="prefetch" href="/docs/assets/js/302.161104b1.js"><link rel="prefetch" href="/docs/assets/js/303.e23692dd.js"><link rel="prefetch" href="/docs/assets/js/304.05659027.js"><link rel="prefetch" href="/docs/assets/js/305.9bf971c9.js"><link rel="prefetch" href="/docs/assets/js/306.ca8deeea.js"><link rel="prefetch" href="/docs/assets/js/307.97a6667e.js"><link rel="prefetch" href="/docs/assets/js/308.693ca743.js"><link rel="prefetch" href="/docs/assets/js/309.fffb02db.js"><link rel="prefetch" href="/docs/assets/js/31.370bb99a.js"><link rel="prefetch" href="/docs/assets/js/310.2bc665a7.js"><link rel="prefetch" href="/docs/assets/js/311.7953e1c2.js"><link rel="prefetch" href="/docs/assets/js/312.fa9bc367.js"><link rel="prefetch" href="/docs/assets/js/313.ac895eeb.js"><link rel="prefetch" href="/docs/assets/js/314.3631b719.js"><link rel="prefetch" href="/docs/assets/js/315.74ff42ab.js"><link rel="prefetch" href="/docs/assets/js/316.3e76797f.js"><link rel="prefetch" href="/docs/assets/js/317.6fb15d7c.js"><link rel="prefetch" href="/docs/assets/js/318.79e44dca.js"><link rel="prefetch" href="/docs/assets/js/319.bc94de5a.js"><link rel="prefetch" href="/docs/assets/js/32.78d1f1eb.js"><link rel="prefetch" href="/docs/assets/js/320.50cf4d33.js"><link rel="prefetch" href="/docs/assets/js/321.92c73aef.js"><link rel="prefetch" href="/docs/assets/js/322.4b083d48.js"><link rel="prefetch" href="/docs/assets/js/323.26c3a0ab.js"><link rel="prefetch" href="/docs/assets/js/324.fcb79d62.js"><link rel="prefetch" href="/docs/assets/js/325.45cede6b.js"><link rel="prefetch" href="/docs/assets/js/326.199b7195.js"><link rel="prefetch" href="/docs/assets/js/327.c396bfb7.js"><link rel="prefetch" href="/docs/assets/js/328.988a3de9.js"><link rel="prefetch" href="/docs/assets/js/329.fe8358a3.js"><link rel="prefetch" href="/docs/assets/js/33.6b9b4e96.js"><link rel="prefetch" href="/docs/assets/js/34.76d3700c.js"><link rel="prefetch" href="/docs/assets/js/35.b61bf772.js"><link rel="prefetch" href="/docs/assets/js/36.7f32760f.js"><link rel="prefetch" href="/docs/assets/js/37.4079c117.js"><link rel="prefetch" href="/docs/assets/js/38.1ac45a99.js"><link rel="prefetch" href="/docs/assets/js/39.0b98297f.js"><link rel="prefetch" href="/docs/assets/js/4.98818668.js"><link rel="prefetch" href="/docs/assets/js/40.bc044ad5.js"><link rel="prefetch" href="/docs/assets/js/41.de0fe499.js"><link rel="prefetch" href="/docs/assets/js/42.e225df72.js"><link rel="prefetch" href="/docs/assets/js/43.5e38f722.js"><link rel="prefetch" href="/docs/assets/js/44.c7251ae2.js"><link rel="prefetch" href="/docs/assets/js/45.47147150.js"><link rel="prefetch" href="/docs/assets/js/46.b91db25b.js"><link rel="prefetch" href="/docs/assets/js/47.40a11e04.js"><link rel="prefetch" href="/docs/assets/js/48.02effbc8.js"><link rel="prefetch" href="/docs/assets/js/49.0daadd89.js"><link rel="prefetch" href="/docs/assets/js/5.c3703f1d.js"><link rel="prefetch" href="/docs/assets/js/50.821b5322.js"><link rel="prefetch" href="/docs/assets/js/51.907927f0.js"><link rel="prefetch" href="/docs/assets/js/52.fbd6f4cb.js"><link rel="prefetch" href="/docs/assets/js/53.f1a0dc32.js"><link rel="prefetch" href="/docs/assets/js/54.8b66e487.js"><link rel="prefetch" href="/docs/assets/js/55.07cf4188.js"><link rel="prefetch" href="/docs/assets/js/56.ba320d44.js"><link rel="prefetch" href="/docs/assets/js/57.13a27667.js"><link rel="prefetch" href="/docs/assets/js/58.ef5d7e10.js"><link rel="prefetch" href="/docs/assets/js/59.dd726a42.js"><link rel="prefetch" href="/docs/assets/js/6.a764175d.js"><link rel="prefetch" href="/docs/assets/js/60.77ab395a.js"><link rel="prefetch" href="/docs/assets/js/61.3634b93f.js"><link rel="prefetch" href="/docs/assets/js/62.4c2d18ec.js"><link rel="prefetch" href="/docs/assets/js/63.57de2c82.js"><link rel="prefetch" href="/docs/assets/js/64.7b6639a9.js"><link rel="prefetch" href="/docs/assets/js/65.563fdeff.js"><link rel="prefetch" href="/docs/assets/js/66.81bd4cf2.js"><link rel="prefetch" href="/docs/assets/js/67.7fa4933d.js"><link rel="prefetch" href="/docs/assets/js/68.beebaf3f.js"><link rel="prefetch" href="/docs/assets/js/69.64313c8f.js"><link rel="prefetch" href="/docs/assets/js/7.2960bb58.js"><link rel="prefetch" href="/docs/assets/js/70.96160c4a.js"><link rel="prefetch" href="/docs/assets/js/71.ddaef725.js"><link rel="prefetch" href="/docs/assets/js/72.96fd17ad.js"><link rel="prefetch" href="/docs/assets/js/73.7ccc2f65.js"><link rel="prefetch" href="/docs/assets/js/74.3198ebf4.js"><link rel="prefetch" href="/docs/assets/js/75.4886a68c.js"><link rel="prefetch" href="/docs/assets/js/76.8d13e16c.js"><link rel="prefetch" href="/docs/assets/js/77.adc7359e.js"><link rel="prefetch" href="/docs/assets/js/78.2e03c285.js"><link rel="prefetch" href="/docs/assets/js/79.7d0ac9a1.js"><link rel="prefetch" href="/docs/assets/js/8.4c0568fd.js"><link rel="prefetch" href="/docs/assets/js/80.0e2710e5.js"><link rel="prefetch" href="/docs/assets/js/81.cdf404cc.js"><link rel="prefetch" href="/docs/assets/js/82.01e97e1f.js"><link rel="prefetch" href="/docs/assets/js/83.90c08f77.js"><link rel="prefetch" href="/docs/assets/js/84.2225a6dc.js"><link rel="prefetch" href="/docs/assets/js/85.49171e3b.js"><link rel="prefetch" href="/docs/assets/js/86.b18603ac.js"><link rel="prefetch" href="/docs/assets/js/87.772b6e3a.js"><link rel="prefetch" href="/docs/assets/js/88.82fdaa52.js"><link rel="prefetch" href="/docs/assets/js/89.bfcd0e62.js"><link rel="prefetch" href="/docs/assets/js/9.c7f05dcb.js"><link rel="prefetch" href="/docs/assets/js/90.ebe887ad.js"><link rel="prefetch" href="/docs/assets/js/91.7006ce28.js"><link rel="prefetch" href="/docs/assets/js/92.e662a7e6.js"><link rel="prefetch" href="/docs/assets/js/93.b97b9d2a.js"><link rel="prefetch" href="/docs/assets/js/94.36f8f62e.js"><link rel="prefetch" href="/docs/assets/js/95.b7192aed.js"><link rel="prefetch" href="/docs/assets/js/96.f0bc5b58.js"><link rel="prefetch" href="/docs/assets/js/97.59dcee0b.js"><link rel="prefetch" href="/docs/assets/js/98.e16eec31.js"><link rel="prefetch" href="/docs/assets/js/99.26ea8045.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.5d974432.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Nguyễn Khánk's Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/architect/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/docs/kungfu/letsgo.html" class="nav-link">
  Kungfu
</a></div><div class="nav-item"><a href="https://nguyenngockhank.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NoSql Distilled</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>A Philosophy of Software Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>97 Things Every Programmer Should Know</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>The Art of Readable Code</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/kungfu/artofcode/c0.html" class="sidebar-link">The Art of Readable Code</a></li><li><a href="/docs/kungfu/artofcode/c1.html" class="sidebar-link">C H A P T E R 1</a></li><li><a href="/docs/kungfu/artofcode/c2.html" class="sidebar-link">Packing Information into Names (C2 - I)</a></li><li><a href="/docs/kungfu/artofcode/c3.html" class="sidebar-link">Names That Can’t Be Misconstrued</a></li><li><a href="/docs/kungfu/artofcode/c4.html" class="sidebar-link">C H A P T E R F O U R</a></li><li><a href="/docs/kungfu/artofcode/c5.html" class="sidebar-link">C H A P T E R F I V E</a></li><li><a href="/docs/kungfu/artofcode/c6.html" class="sidebar-link">C H A P T E R S I X</a></li><li><a href="/docs/kungfu/artofcode/c7.html" class="sidebar-link">C H A P T E R 7</a></li><li><a href="/docs/kungfu/artofcode/c8.html" aria-current="page" class="active sidebar-link">C H A P T E R 8</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#explaining-variables" class="sidebar-link">Explaining Variables</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#summary-variables" class="sidebar-link">Summary Variables</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#using-de-morgan-s-laws" class="sidebar-link">Using De Morgan’s Laws</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#abusing-short-circuit-logic" class="sidebar-link">Abusing Short-Circuit Logic</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#example-wrestling-with-complicated-logic" class="sidebar-link">Example: Wrestling with Complicated Logic</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#breaking-down-giant-statements" class="sidebar-link">Breaking Down Giant Statements</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#another-creative-way-to-simplify-expressions" class="sidebar-link">Another Creative Way to Simplify Expressions</a></li><li class="sidebar-sub-header"><a href="/docs/kungfu/artofcode/c8.html#summary" class="sidebar-link">Summary</a></li></ul></li><li><a href="/docs/kungfu/artofcode/c9.html" class="sidebar-link">C H A P T E R 9</a></li><li><a href="/docs/kungfu/artofcode/c10.html" class="sidebar-link">C H A P T E R T E N</a></li><li><a href="/docs/kungfu/artofcode/c11.html" class="sidebar-link">C H A P T E R E L E V E N</a></li><li><a href="/docs/kungfu/artofcode/c12.html" class="sidebar-link">C H A P T E R T W E L V E</a></li><li><a href="/docs/kungfu/artofcode/c13.html" class="sidebar-link">C H A P T E R T H I R T E E N</a></li><li><a href="/docs/kungfu/artofcode/c14.html" class="sidebar-link">Testing and Readability (C14 - IV)</a></li><li><a href="/docs/kungfu/artofcode/c15.html" class="sidebar-link">C H A P T E R F I F T E E N</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c-h-a-p-t-e-r-8"><a href="#c-h-a-p-t-e-r-8" class="header-anchor">#</a> C H A P T E R 8</h1> <p><strong>Breaking Down Giant Expressions</strong></p> <p>The giant squid is an amazing and intelligent animal, but its near-perfect body design has one fatal flaw: it has a donut-shaped brain that wraps around its esophagus. So if it swallows too much food at once, it gets brain damage.</p> <p>What does this have to do with code? Well, code that comes in “chunks” that are too big can have the same kind of effect. Recent research suggests that most of us can only think about three or four “things” at a time.* Simply put, the larger an expression of code is, the harder it will be to understand.</p> <div class="custom-block tip"><p class="custom-block-title">K E Y I D E A</p> <p>Break down your giant expressions into more digestible pieces.</p></div> <p>In this chapter, we’ll go through various ways you can manipulate and break down your code so that it’s easier to swallow.</p> <h2 id="explaining-variables"><a href="#explaining-variables" class="header-anchor">#</a> Explaining Variables</h2> <p>The simplest way to break down an expression is to introduce an extra variable that captures a smaller subexpression. This extra variable is sometimes called an “explaining variable” because it helps explain what the subexpression means.</p> <p>Here is an example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> line<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;root&quot;</span><span class="token operator">:</span>
</code></pre></div><p>Here is the same code, now with an explaining variable:</p> <div class="language-js extra-class"><pre class="language-js"><code>username <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">&quot;root&quot;</span><span class="token operator">:</span>
</code></pre></div><h2 id="summary-variables"><a href="#summary-variables" class="header-anchor">#</a> Summary Variables</h2> <p>Even if an expression doesn’t <em>need</em> explaining (because you can figure out what it means), it can still be useful to capture that expression in a new variable. We call this a <em>summary variable</em> if its purpose is simply to replace a larger chunk of code with a smaller name that can be managed and thought about more easily.</p> <p>For example, consider the expressions in this code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id <span class="token operator">==</span> document<span class="token punctuation">.</span>owner_id <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// user can edit this document...</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id <span class="token operator">!=</span> document<span class="token punctuation">.</span>owner_id <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// document is read-only...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The expression <code>request.user.id == document.owner_id</code> may not seem that big, but it has five variables, so it takes a little extra time to think about.</p> <p>The main concept in this code is, “Does the user own the document?” That concept can be stated more clearly by adding a summary variable:</p> <div class="language-js extra-class"><pre class="language-js"><code>final boolean user_owns_document <span class="token operator">=</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id <span class="token operator">==</span> document<span class="token punctuation">.</span>owner_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span> user_owns_document <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// user can edit this document...</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> user_owns_document <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// document is read-only...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It may not seem like much, but the statement <code>if (user_owns_document)</code> is a little easier to think about. Also, having user_owns_document defined at the top tells the reader upfront that “this is a concept we’ll be referring to throughout this function.”</p> <h2 id="using-de-morgan-s-laws"><a href="#using-de-morgan-s-laws" class="header-anchor">#</a> Using De Morgan’s Laws</h2> <p>If you ever took a course in circuits or logic, you might remember <strong>De Morgan’s laws</strong>. They are two ways to rewrite a boolean expression into an equivalent one:</p> <div class="language- extra-class"><pre class="language-text"><code>1) not (a or b or c) ⇔ (not a) and (not b) and (not c)
2) not (a and b and c) ⇔ (not a) or (not b) or (not c)
</code></pre></div><p>If you have trouble remembering these laws, a simple summary is “Distribute the not and switch and/or.” (Or going the other way, you “factor out the not.”)</p> <p>You can sometimes use these laws to make a boolean expression more readable. For instance, if your code is:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token punctuation">(</span>file_exists <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>is_protected<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry, could not read file.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It can be rewritten to:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>file_exists <span class="token operator">||</span> is_protected <span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry, could not read file.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="abusing-short-circuit-logic"><a href="#abusing-short-circuit-logic" class="header-anchor">#</a> Abusing Short-Circuit Logic</h2> <p>In most programming languages, boolean operators perform short-circuit evaluation. For example, the statement <code>if (a || b)</code> won’t evaluate b if a is true. This behavior is very handy but can sometimes be abused to accomplish complex logic.</p> <p>Here is an example of a statement once written by one of the authors:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>bucket <span class="token operator">=</span> <span class="token function">FindBucket</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>bucket<span class="token operator">-&gt;</span><span class="token function">IsOccupied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In English, what this code is saying is, “Get the bucket for this key. If the bucket is not <code>null</code>, then make sure it isn’t occupied.”</p> <p>Even though it’s only one line of code, it really makes most programmers stop and think. Now compare it to this code:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>bucket <span class="token operator">=</span> <span class="token function">FindBucket</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>bucket <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span>bucket<span class="token operator">-&gt;</span><span class="token function">IsOccupied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It does exactly the same thing, and even though it’s two lines of code, it’s much easier to understand.</p> <p>So why was the code written as a single giant expression in the first place? At the time, it felt very clever. There’s a certain pleasure in paring logic down to a concise nugget of code. That’s understandable—it’s like solving a miniature puzzle, and we all like to have fun at work. The problem is that the code was a mental speed bump for anyone reading through the code.</p> <div class="custom-block tip"><p class="custom-block-title">K E Y I D E A</p> <p>Beware of “clever” nuggets of code—they’re often confusing when others read the code later.</p></div> <p>Does this mean you should avoid making use of short-circuit behavior? No. There are plenty of cases where it can be used cleanly, for instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token operator">&amp;&amp;</span> object<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">...</span>
</code></pre></div><p>There is also a newer idiom worth mentioning: in languages like Python, JavaScript, and Ruby, the “or” operator returns one of its arguments (it doesn’t convert to a boolean), so code like:</p> <div class="language-js extra-class"><pre class="language-js"><code>x <span class="token operator">=</span> a <span class="token operator">||</span> b <span class="token operator">||</span> c
</code></pre></div><p>can be used to pick out the first “truthy” value from a, b, or c.</p> <h2 id="example-wrestling-with-complicated-logic"><a href="#example-wrestling-with-complicated-logic" class="header-anchor">#</a> Example: Wrestling with Complicated Logic</h2> <p>Suppose you’re implementing the following <code>Range</code> class:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Range</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> begin<span class="token punctuation">;</span>
    <span class="token keyword">int</span> end<span class="token punctuation">;</span>
    <span class="token comment">// For example, [0,5) overlaps with [3,8)</span>
    <span class="token keyword">bool</span> <span class="token function">OverlapsWith</span><span class="token punctuation">(</span>Range other<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The following figure shows some example ranges:</p> <p>Note that end is noninclusive. So A, B, and C don’t overlap with each other, but D overlaps with all of them.</p> <p>Here is one attempt at implementing <code>OverlapsWith()</code> —it checks if either endpoint of its range falls inside the other’s range:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token class-name">Range</span><span class="token operator">::</span><span class="token function">OverlapsWith</span><span class="token punctuation">(</span>Range other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Check if 'begin' or 'end' falls inside 'other'.</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>begin <span class="token operator">&gt;=</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> begin <span class="token operator">&lt;=</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>end <span class="token operator">&gt;=</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> end <span class="token operator">&lt;=</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Even though the code is only two lines long, there’s a lot going on. The following figure shows all the logic involved.</p> <p>There are so many cases and conditions to think about that it’s easy for a bug to slip by.</p> <p>Speaking of which, there <em>is</em> a bug. The previous code will claim that the <code>Range [0,2)</code> overlaps with <code>[2,4)</code> when in fact it doesn’t.</p> <p>The problem is that you have to be careful when comparing begin/end values using <code>&lt;=</code> or just <code>&lt;</code>. Here’s a fix to this problem:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">return</span> <span class="token punctuation">(</span>begin <span class="token operator">&gt;=</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> begin <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> end <span class="token operator">&lt;=</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now it’s correct, right? Actually, there’s <em>another</em> bug. This code has ignored the case when begin/end completely surround other.</p> <p>Here’s a fix that handles this case, too:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">return</span> <span class="token punctuation">(</span>begin <span class="token operator">&gt;=</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> begin <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> end <span class="token operator">&lt;=</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span>begin <span class="token operator">&lt;=</span> other<span class="token punctuation">.</span>begin <span class="token operator">&amp;&amp;</span> end <span class="token operator">&gt;=</span> other<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre></div><p>Yikes—this code has become way too complicated. You can’t expect anyone to read this code and confidently know that it’s correct. So what do we do? How can we break down this giant expression?</p> <h3 id="finding-a-more-elegant-approach"><a href="#finding-a-more-elegant-approach" class="header-anchor">#</a> <strong>Finding a More Elegant Approach</strong></h3> <p>This is one of those times when you should stop and consider a different approach altogether.</p> <p>What started as a simple problem (checking whether two ranges overlap) turned into a surprisingly convoluted piece of logic. This is often a sign that <strong>there must be an easier way.</strong></p> <p>But finding a more elegant solution takes creativity. How do you go about it? One technique is to see if you can solve the problem the “opposite” way. Depending on the situation you’re in, this could mean iterating through arrays in reverse or filling in some data structure backward rather than forward.</p> <p>Here, the opposite of <code>OverlapsWith()</code> is “doesn’t overlap.” Determining if two ranges <em>don’t</em> overlap turns out to be a much simpler problem, because there are only two possibilities:</p> <p>1.The other range ends before this one begins.
2. The other range begins after this one ends.</p> <p>We can turn this into code quite easily:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token class-name">Range</span><span class="token operator">::</span><span class="token function">OverlapsWith</span><span class="token punctuation">(</span>Range other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>end <span class="token operator">&lt;=</span> begin<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// They end before we begin</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>begin <span class="token operator">&gt;=</span> end<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// They begin after we end</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Only possibility left: they overlap</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Each line of code here is much simpler—it involves only a single comparison. That leaves the reader with enough brainpower to focus on whether <code>&lt;=</code> is correct.</p> <h2 id="breaking-down-giant-statements"><a href="#breaking-down-giant-statements" class="header-anchor">#</a> Breaking Down Giant Statements</h2> <p>This chapter is about breaking down individual expressions, but the same techniques apply to breaking down larger statements as well. For example, the following JavaScript code has a lot to take in at once:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">update_highlight</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message_num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#vote_value&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;Up&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_up&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_down&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#vote_value&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;Down&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_up&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_down&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_up&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&quot;highighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_down&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The individual expressions in this code aren’t that big, but when placed all together, it forms one giant statement that hits you all at once.</p> <p>Fortunately, a lot of the expressions are the same, which means we can extract them out as summary variables at the top of the function (this is also an instance of the DRY — Don’t Repeat Yourself principle):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">update_highlight</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message_num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> thumbs_up <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_up&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> thumbs_down <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#thumbs_down&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> vote_value <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#vote_value&quot;</span> <span class="token operator">+</span> message_num<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> hi <span class="token operator">=</span> <span class="token string">&quot;highlighted&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span> vote_value <span class="token operator">===</span> <span class="token string">&quot;Up&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        thumbs_up <span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
        thumbs_down <span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> vote_value <span class="token operator">===</span> <span class="token string">&quot;Down&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        thumbs_up <span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
        thumbs_down <span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        thumbs_up <span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
        thumbs_down <span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span> hi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The creation of var <code>hi = &quot;highlighted&quot;</code> isn’t strictly needed, but as there were <em>six</em> copies of it, there were compelling benefits:</p> <ul><li>It helps avoid typing mistakes. (In fact, did you notice that in the first example, the string was misspelled as &quot;highighted&quot; in the fifth case?)</li> <li>It shrinks the line width even more, making the code easier to scan through.</li> <li>If the class name needed to change, there’s just one place to change it.</li></ul> <h2 id="another-creative-way-to-simplify-expressions"><a href="#another-creative-way-to-simplify-expressions" class="header-anchor">#</a> Another Creative Way to Simplify Expressions</h2> <p>Here’s another example with a lot going on in each expression, this time in C++:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">AddStats</span><span class="token punctuation">(</span><span class="token keyword">const</span> Stats<span class="token operator">&amp;</span> add_from<span class="token punctuation">,</span> Stats<span class="token operator">*</span> add_to<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    add_to<span class="token operator">-&gt;</span><span class="token function">set_total_memory</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">total_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">total_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    add_to<span class="token operator">-&gt;</span><span class="token function">set_free_memory</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">free_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">free_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    add_to<span class="token operator">-&gt;</span><span class="token function">set_swap_memory</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">swap_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">swap_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    add_to<span class="token operator">-&gt;</span><span class="token function">set_status_string</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">status_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">status_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    add_to<span class="token operator">-&gt;</span><span class="token function">set_num_processes</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">num_processes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">num_processes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once again, your eyes are faced with code that’s long and similar, but not exactly the same.</p> <p>After ten seconds of careful scrutiny, you might realize that each line is doing the same thing, just to a different field each time:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>add_to<span class="token operator">-&gt;</span>set_ <span class="token function">XXX</span> <span class="token punctuation">(</span>add_from<span class="token punctuation">.</span> <span class="token function">XXX</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span> <span class="token function">XXX</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In C++, we can define a macro to implement this:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">AddStats</span><span class="token punctuation">(</span><span class="token keyword">const</span> Stats<span class="token operator">&amp;</span> add_from<span class="token punctuation">,</span> Stats<span class="token operator">*</span> add_to<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span> add_to<span class="token operator">-&gt;</span>set_</span><span class="token punctuation">##</span><span class="token expression"><span class="token function">field</span><span class="token punctuation">(</span>add_from<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> add_to<span class="token operator">-&gt;</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

    <span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>total_memory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>free_memory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>swap_memory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>status_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ADD_FIELD</span><span class="token punctuation">(</span>num_processes<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">ADD_FIELD</span></span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that we’ve stripped away all the clutter, you can look at the code and immediately understand the essence of what’s happening. It’s very clear that each line is doing the same thing.</p> <p>Note that we’re not advocating using macros very often—in fact, we usually avoid them because they can make code confusing and introduce subtle bugs. But sometimes, as in this case, they’re simple and can provide a clear benefit to readability.</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>Giant expressions are hard to think about. This chapter showed a number of ways to break them down so the reader can digest them piece by piece.</p> <p>One simple technique is to introduce “explaining variables” that capture the value of some large subexpression. This approach has three benefits:</p> <ul><li>It breaks down a giant expression into pieces.</li> <li>It documents the code by describing the subexpression with a succinct name.</li> <li>It helps the reader identify the main “concepts” in the code.</li></ul> <p>Another technique is to manipulate your logic using De Morgan’s laws—this technique can sometimes rewrite a boolean expression in a cleaner way (e.g., <code>if (!(a &amp;&amp; !b))</code> turns into <code>if (!a || b)</code>).</p> <p>We showed an example where a complex logical condition was broken down into tiny statements like “<code>if (a &lt; b) ..</code>.”. In fact, <em>all</em> of the improved-code examples in this chapter had if statements with no more than <em>two</em> values inside them. This setup is ideal. It may not always seem possible to do this—sometimes it requires “negating” the problem or considering the opposite of your goal.</p> <p>Finally, even though this chapter is about breaking down individual expressions, these same techniques often apply to larger blocks of code, too. So be aggressive in breaking down complex logic wherever you see it.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/kungfu/artofcode/c7.html" class="prev">
        C H A P T E R 7
      </a></span> <span class="next"><a href="/docs/kungfu/artofcode/c9.html">
        C H A P T E R 9
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/docs/assets/js/app.feff3dbb.js" defer></script><script src="/docs/assets/js/2.aca46d71.js" defer></script><script src="/docs/assets/js/229.faed0af8.js" defer></script><script src="/docs/assets/js/27.5ed2ce18.js" defer></script>
  </body>
</html>
