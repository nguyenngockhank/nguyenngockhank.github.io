# 59: Thi·∫øu c∆° h·ªôi cho Polymorphism

Polymorphism l√† m·ªôt trong nh·ªØng √Ω t∆∞·ªüng l·ªõn l√†m n·ªÅn t·∫£ng cho OO. T·ª´ n√†y ƒë∆∞·ª£c l·∫•y t·ª´ ti·∫øng Hy L·∫°p, c√≥ nghƒ©a l√† nhi·ªÅu (poly) d·∫°ng (morph). 

Trong l·∫≠p tr√¨nh, Polymorphism ƒë·ªÅ c·∫≠p ƒë·∫øn nhi·ªÅu d·∫°ng c·ªßa m·ªôt class ƒë·ªëi t∆∞·ª£ng ho·∫∑c ph∆∞∆°ng th·ª©c c·ª• th·ªÉ. Nh∆∞ng Polymorphism kh√¥ng ch·ªâ ƒë∆°n thu·∫ßn l√† v·ªÅ vi·ªác tri·ªÉn khai thay th·∫ø. N·∫øu ƒë∆∞·ª£c s·ª≠ d·ª•ng c·∫©n th·∫≠n, Polymorphism s·∫Ω t·∫°o ra c√°c context th·ª±c thi c·ª•c b·ªô nh·ªè cho ph√©p ch√∫ng ta l√†m vi·ªác m√† kh√¥ng c·∫ßn ph·∫£i s·ª≠ d·ª•ng c√¢u l·ªánh *if-then-else* d√†i d√≤ng. ·ªû b√™n trong context cho ph√©p ch√∫ng ta l√†m vi·ªác tr·ª±c ti·∫øp, c√≤n ·ªü b√™n ngo√†i context, ch√∫ng ta bu·ªôc ph·∫£i x√¢y d·ª±ng l·∫°i n√≥ r·ªìi m·ªõi c√≥ th·ªÉ l√†m vi·ªác. V·ªõi vi·ªác s·ª≠ d·ª•ng c·∫©n th·∫≠n c√°c tri·ªÉn khai thay th·∫ø, ch√∫ng ta c√≥ th·ªÉ n·∫Øm b·∫Øt context, qua ƒë√≥ gi√∫p s·∫£n xu·∫•t √≠t m√£ h∆°n nh∆∞ng ƒëem l·∫°i hi·ªáu qu·∫£ cao h∆°n. ƒêi·ªÅu n√†y ƒë∆∞·ª£c th·ªÉ hi·ªán t·ªët nh·∫•t th√¥ng qua m·ªôt s·ªë m√£, ch·∫≥ng h·∫°n nh∆∞ gi·ªè h√†ng gi·∫£ ƒë·ªãnh ƒë∆°n gi·∫£n sau ƒë√¢y:

```java
public class ShoppingCart {
    private ArrayList<Item> cart = new ArrayList<Item>(); 

    public void add(Item item) { 
        cart.add(item); 
    } 
    
    public Item takeNext() { 
        return cart.remove(0); 
    } 
    
    public boolean isEmpty() {
        return cart.isEmpty(); 
    }
}
```
Gi·∫£ s·ª≠ webshop c·ªßa ch√∫ng t√¥i cung c·∫•p c√°c m·∫∑t h√†ng c√≥ th·ªÉ t·∫£i xu·ªëng v√† c√°c m·∫∑t h√†ng c·∫ßn v·∫≠n chuy·ªÉn. H√£y x√¢y d·ª±ng m·ªôt ƒë·ªëi t∆∞·ª£ng h·ªó tr·ª£ ho·∫°t ƒë·ªông n√†y:

```java
public class Shipping {
    public boolean ship(Item item, SurfaceAddress address) { ‚Ä¶ } 
    public boolean ship(Item item, EMailAddress address { ‚Ä¶ }
}
```
Khi m·ªôt kh√°ch h√†ng ƒë√£ thanh to√°n xong, ch√∫ng t√¥i c·∫ßn v·∫≠n chuy·ªÉn h√†ng h√≥a:

```java
while (!cart.isEmpty()) { 
    shipping.ship(cart.takeNext(), ???);
}
```

Tham s·ªë **???** kh√¥ng ph·∫£i l√† m·ªôt s·ªë to√°n t·ª≠ elvis m·ªõi. N√≥ h·ªèi t√¥i n√™n g·ª≠i email üìÆ hay g·ª≠i th∆∞ cho m·ª•c n√†y? Context c·∫ßn thi·∫øt ƒë·ªÉ tr·∫£ l·ªùi c√¢u h·ªèi n√†y kh√¥ng c√≤n t·ªìn t·∫°i. Ch√∫ng t√¥i c√≥ th·ªÉ n·∫Øm b·∫Øt ƒë∆∞·ª£c ph∆∞∆°ng th·ª©c giao h√†ng trong boolean ho·∫∑c enum v√† sau ƒë√≥ s·ª≠ d·ª•ng *if-then-else* ƒë·ªÉ ƒëi·ªÅn v√†o tham s·ªë b·ªã thi·∫øu. M·ªôt gi·∫£i ph√°p kh√°c s·∫Ω l√† t·∫°o hai class ƒë·ªÅu m·ªü r·ªông **Item**. H√£y g·ªçi ƒë√≥ l√† **DownloadableItem** v√† **SurfaceItem**. B√¢y gi·ªù h√£y vi·∫øt m·ªôt s·ªë code. T√¥i s·∫Ω qu·∫£ng c√°o **Item** nh∆∞ m·ªôt giao di·ªán h·ªó tr·ª£ ph∆∞∆°ng th·ª©c duy nh·∫•t- xu·∫•t x∆∞·ªüng. ƒê·ªÉ g·ª≠i gi·ªè h√†ng, ch√∫ng t√¥i s·∫Ω g·ªçi *item.ship(shipper)*. C√°c class **DownloadableItem** v√† **SurfaceItem** s·∫Ω c√πng th·ª±c hi·ªán vi·ªác giao h√†ng.

```java
public class DownloadableItem implements Item { 
    public boolean ship(Shipping shipper) { 
        shipper.ship(this, customer.getEmailAddress());
    }
}

public class SurfaceItem implements Item { 
    public boolean ship(Shipping shipper) { 
        shipper.ship(this, customer.getSurfaceAddress());
    }
}
```

Trong v√≠ d·ª• n√†y, ch√∫ng t√¥i ƒë√£ ·ªßy th√°c tr√°ch nhi·ªám l√†m vi·ªác v·ªõi **Shipping** cho t·ª´ng **Item**. V√¨ m·ªói m·∫∑t h√†ng ƒë·ªÅu ƒë∆∞·ª£c v·∫≠n chuy·ªÉn t·ªët, n√™n s·ª± s·∫Øp x·∫øp n√†y cho ph√©p ch√∫ng t√¥i ti·∫øp t·ª•c m√† kh√¥ng c·∫ßn *if-then-else*. Code n√†y c≈©ng minh ho·∫° cho hai m·∫´u th∆∞·ªùng ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi nhau: **Command** v√† **Double Dispatch**. Vi·ªác s·ª≠ d·ª•ng hi·ªáu qu·∫£ c√°c m·∫´u n√†y ph·ª• thu·ªôc v√†o vi·ªác s·ª≠ d·ª•ng Polymorphism m·ªôt c√°ch c·∫©n th·∫≠n. Khi ƒëi·ªÅu ƒë√≥ x·∫£y ra, s·ªë l∆∞·ª£ng c√¢u l·ªánh *if-then-else* trong code s·∫Ω gi·∫£m thi·ªÉu ƒë√°ng k·ªÉ

M·∫∑c d√π c√≥ nh·ªØng tr∆∞·ªùng h·ª£p s·∫Ω hi·ªáu qu·∫£ h∆°n nhi·ªÅu khi s·ª≠ d·ª•ng *if-then-else* thay v√¨ Polymorphism, nh∆∞ng th√¥ng th∆∞·ªùng, Polymorphism coding s·∫Ω mang l·∫°i m·ªôt c∆° s·ªü code nh·ªè h∆°n, d·ªÖ ƒë·ªçc h∆°n v√† √≠t mong manh h∆°n. S·ªë c∆° h·ªôi b·ªã b·ªè l·ª° l√† s·ªë l∆∞·ª£ng c√°c c√¢u l·ªánh *if-then-else* trong code.