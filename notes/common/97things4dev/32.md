# 32: ƒê√≥ng g√≥i ph∆∞∆°ng th·ª©c, kh√¥ng ch·ªâ l√† tr·∫°ng th√°i

Trong l√Ω thuy·∫øt h·ªá th·ªëng, ki·ªÉm so√°t l√† m·ªôt trong nh·ªØng c√°ch x·ª≠ l√Ω t·ªëi ∆∞u nh·∫•t khi x·ª≠ l√Ω c√°c h·ªá th·ªëng c√≥ c·∫•u tr√∫c l·ªõn v√† ph·ª©c t·∫°p. Trong ng√†nh c√¥ng nghi·ªáp ph·∫ßn m·ªÅm, vi·ªác ki·ªÉm so√°t l√† c·ª±c k·ª≥ c·∫ßn thi·∫øt. Vi·ªác ki·ªÉm so√°t ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi c√°c c·∫•u tr√∫c c·ªßa ng√¥n ng·ªØ l·∫≠p tr√¨nh nh∆∞ `subroutines` (c√°c ch∆∞∆°ng tr√¨nh con) v√† `functions`, `modules` v√† `packages`, `classes`,...

`Modules` v√† `packages` ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£i quy·∫øt c√°c nhu c·∫ßu l·ªõn h∆°n cho vi·ªác ki·ªÉm so√°t, trong khi c√°c `class`, `subroutine` v√† `function` l·∫°i ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£i quy·∫øt c√°c kh√≠a c·∫°nh chi ti·∫øt h∆°n c·ªßa v·∫•n ƒë·ªÅ. Trong nh·ªØng nƒÉm qua, t√¥i ph√°t hi·ªán ra r·∫±ng c√°c class d∆∞·ªùng nh∆∞ l√† m·ªôt trong nh·ªØng c·∫•u tr√∫c ki·ªÉm so√°t kh√≥ nh·∫•t cho c√°c nh√† ph√°t tri·ªÉn trong vi·ªác l·∫•y quy·ªÅn. ƒêi·ªÅu n√†y kh√¥ng ph·∫£i l√† hi·∫øm khi t√¨m th·∫•y m·ªôt class ch·ªâ v·ªõi duy nh·∫•t 1 main method (ph∆∞∆°ng th·ª©c ch√≠nh) v·ªõi `3000 d√≤ng l·ªánh` ho·∫∑c `m·ªôt class ch·ªâ c√≥ duy nh·∫•t c√°c ph∆∞∆°ng th·ª©c get v√† set cho c√°c thu·ªôc t√≠nh ban ƒë·∫ßu c·ªßa n√≥`.

Nh·ªØng v√≠ d·ª• n√†y ch·ª©ng minh r·∫±ng c√°c nh√† ph√°t tri·ªÉn ƒë√£ kh√¥ng hi·ªÉu ƒë·∫ßy ƒë·ªß v·ªÅ t∆∞ duy h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng, ƒë√£ kh√¥ng t·∫≠n d·ª•ng ƒë∆∞·ª£c s·ª©c m·∫°nh c·ªßa c√°c ƒë·ªëi t∆∞·ª£ng nh∆∞ c√°c c·∫•u tr√∫c m√¥ h√¨nh. ƒê·ªëi v·ªõi c√°c nh√† ph√°t tri·ªÉn ƒë√£ quen thu·ªôc v·ªõi thu·∫≠t ng·ªØ `POJO`(*Plain Old Java Object*) v√† `POCO` (*Plain Old C# Object* hay *Plain Old CLR Object*), th√¨ ƒë√¢y l√† s·ª± quay tr·ªü l·∫°i c√°c kh√°i ni·ªám c∆° b·∫£n c·ªßa OO nh∆∞ m·ªôt m√¥ h√¨nh ho√° c√°c ƒë·ªëi t∆∞·ª£ng r√µ r√†ng v√† ƒë∆°n gi·∫£n, nh∆∞ng kh√¥ng h·ªÅ ngu ng·ªëc.

M·ªôt ƒë·ªëi t∆∞·ª£ng g√≥i g·ªçn c·∫£ tr·∫°ng th√°i v√† ph∆∞∆°ng th·ª©c, trong ƒë√≥ ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c x√°c ƒë·ªãnh b·ªüi thu·ªôc t√≠nh th·ª±c t·∫ø. V√≠ d·ª• nh∆∞ m·ªôt object **c·ª≠a** üö™. N√≥ s·∫Ω c√≥ **4 tr·∫°ng th√°i**: *ƒë√≥ng*, *m·ªü*, *ƒëang ƒë√≥ng*, *ƒëang m·ªü*. N√≥ s·ª≠ d·ª•ng **2 qu√° tr√¨nh**: *m·ªü* v√† *ƒë√≥ng*. Ph·ª• thu·ªôc v√†o tr·∫°ng th√°i, c√°c qu√° tr√¨nh m·ªü v√† ƒë√≥ng s·∫Ω kh√°c nhau. Thu·ªôc t√≠nh v·ªën c√≥ c·ªßa 1 ƒë·ªëi t∆∞·ª£ng l√†m cho qu√° tr√¨nh thi·∫øt k·∫ø ƒë∆°n gi·∫£n h∆°n v·ªÅ m·∫∑t kh√°i ni·ªám. N√≥ n·∫Øm 2 nhi·ªám v·ª• ƒë∆°n gi·∫£n: ph√¢n b·ªï v√† giao tr√°ch nhi·ªám cho c√°c ƒë·ªëi t∆∞·ª£ng kh√°c nhau bao g·ªìm c√°c giao th·ª©c t∆∞∆°ng t√°c xen k·∫Ω.

C√°ch n√≥ ho·∫°t ƒë·ªông trong th·ª±c t·∫ø l√† m·ªôt v√≠ d·ª• minh ho·∫° r√µ r√†ng nh·∫•t. V√≠ d·ª• ch√∫ng ta c√≥ 3 class: **Customer**, **Order** v√† **Item**. **Customer** l√† ƒë·ªëi t∆∞·ª£ng y√™u c·∫ßu x√°c th·ª±c th√¥ng tin t·ªët nh·∫•t cho vi·ªác gi·ªõi h·∫°n t√≠n d·ª•ng v√† c√°c quy t·∫Øc x√°c th·ª±c t√≠n d·ª•ng. **Order** l√† ƒë·ªëi t∆∞·ª£ng x√°c ƒë·ªãnh m·ªëi li√™n k·∫øt gi·ªØa kh√°ch h√†ng v√† qu√° tr√¨nh *addItems* c·ªßa n√≥ b·∫±ng c√°ch g·ªçi ƒë·∫øn h√†m *customer.validateCredit(item.price())*, ƒë·ªÉ ki·ªÉm tra t√≠n d·ª•ng th·ª±c t·∫ø c·ªßa ƒë·ªëi t∆∞·ª£ng **Customer**. N·∫øu nh∆∞ h√†m ƒë√≥ kh√¥ng th√†nh c√¥ng, n√≥ s·∫Ω t·∫°o ra 1 ngo·∫°i l·ªá ‚ö† v√† hu·ª∑ b·ªè ‚ùå qu√° tr√¨nh mua.

C√°c nh√† ph√°t tri·ªÉn h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng √≠t kinh nghi·ªám h∆°n c√≥ th·ªÉ quy·∫øt ƒë·ªãnh g√≥i t·∫•t c·∫£ c√°c quy t·∫Øc kinh doanh v√†o m·ªôt ƒë·ªëi t∆∞·ª£ng nh∆∞ **OrderManager** ho·∫∑c **OrderService**. Trong c√°c thi·∫øt k·∫ø n√†y, **Order**, **Customer** v√† **Item** s·∫Ω ghi √≠t b·∫£n ghi h∆°n. T·∫•t c·∫£ c√°c x·ª≠ l√Ω logic s·∫Ω bao g·ªìm c√°c class v√† c√°c li√™n k·∫øt c·ªßa ch√∫ng trong m·ªôt ph∆∞∆°ng th·ª©c v·ªõi nhi·ªÅu c·∫•u tr√∫c *if-then-else*. C√°c method g·∫ßn nh∆∞ kh√¥ng th·ªÉ duy tr√¨ v√† d·ªÖ d√†ng b·ªã ph√° v·ª°. C√≤n l√Ω do? Do ki·ªÉm so√°t kh√¥ng tr·ªçn v·∫πn.

Do v·∫≠y, ƒë·ª´ng ph√° v·ª° s·ª± ƒë√≥ng g√≥i v√† s·ª≠ d·ª•ng s·ª©c m·∫°nh c·ªßa ng√¥n ng·ªØ l·∫≠p tr√¨nh m√† b·∫°n s·ª≠ d·ª•ng ƒë·ªÉ duy tr√¨ n√≥.
